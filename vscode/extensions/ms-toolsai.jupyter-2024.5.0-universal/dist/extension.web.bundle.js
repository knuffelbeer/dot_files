"use strict";var Kre=Object.create;var AE=Object.defineProperty;var J9=Object.getOwnPropertyDescriptor;var Fre=Object.getOwnPropertyNames;var Ure=Object.getPrototypeOf,Wre=Object.prototype.hasOwnProperty;var ee=(r,e)=>()=>(r&&(e=r(r=0)),e);var z=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Um=(r,e)=>{for(var t in e)AE(r,t,{get:e[t],enumerable:!0})},q9=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Fre(e))!Wre.call(r,i)&&i!==t&&AE(r,i,{get:()=>e[i],enumerable:!(n=J9(e,i))||n.enumerable});return r};var $=(r,e,t)=>(t=r!=null?Kre(Ure(r)):{},q9(e||!r||!r.__esModule?AE(t,"default",{value:r,enumerable:!0}):t,r)),sP=r=>q9(AE({},"__esModule",{value:!0}),r),E=(r,e,t,n)=>{for(var i=n>1?void 0:n?J9(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&AE(e,t,i),i},I=(r,e)=>(t,n)=>e(t,n,r);var process,d=ee(()=>{"use strict";process={platform:"web",cwd:()=>"",env:{NODE_ENV:"production"}}});var Y9=z(()=>{d();var G9;(function(r){(function(e){var t=typeof this=="object"?this:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=i(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=i(t.Reflect,n),e(n);function i(o,s){return function(a,l){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:l}),s&&s(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",i=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!s&&!a,c={create:s?function(){return ue(Object.create(null))}:a?function(){return ue({__proto__:null})}:function(){return ue({})},has:l?function(k,O){return t.call(k,O)}:function(k,O){return O in k},get:l?function(k,O){return t.call(k,O)?k[O]:void 0}:function(k,O){return k[O]}},u=Object.getPrototypeOf(Function),p=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!p&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Lt(),m=!p&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Tr(),h=!p&&typeof WeakMap=="function"?WeakMap:F(),g=new h;function v(k,O,X,ce){if(de(X)){if(!et(k))throw new TypeError;if(!W(O))throw new TypeError;return R(k,O)}else{if(!et(k))throw new TypeError;if(!we(O))throw new TypeError;if(!we(ce)&&!de(ce)&&!Te(ce))throw new TypeError;return Te(ce)&&(ce=void 0),X=Le(X),Z(k,O,X,ce)}}e("decorate",v);function S(k,O){function X(ce,ve){if(!we(ce))throw new TypeError;if(!de(ve)&&!pe(ve))throw new TypeError;Je(k,O,ce,ve)}return X}e("metadata",S);function _(k,O,X,ce){if(!we(X))throw new TypeError;return de(ce)||(ce=Le(ce)),Je(k,O,X,ce)}e("defineMetadata",_);function D(k,O,X){if(!we(O))throw new TypeError;return de(X)||(X=Le(X)),Ke(k,O,X)}e("hasMetadata",D);function P(k,O,X){if(!we(O))throw new TypeError;return de(X)||(X=Le(X)),Ce(k,O,X)}e("hasOwnMetadata",P);function M(k,O,X){if(!we(O))throw new TypeError;return de(X)||(X=Le(X)),ae(k,O,X)}e("getMetadata",M);function x(k,O,X){if(!we(O))throw new TypeError;return de(X)||(X=Le(X)),Nt(k,O,X)}e("getOwnMetadata",x);function A(k,O){if(!we(k))throw new TypeError;return de(O)||(O=Le(O)),vr(k,O)}e("getMetadataKeys",A);function j(k,O){if(!we(k))throw new TypeError;return de(O)||(O=Le(O)),Xr(k,O)}e("getOwnMetadataKeys",j);function re(k,O,X){if(!we(O))throw new TypeError;de(X)||(X=Le(X));var ce=ge(O,X,!1);if(de(ce)||!ce.delete(k))return!1;if(ce.size>0)return!0;var ve=g.get(O);return ve.delete(X),ve.size>0||g.delete(O),!0}e("deleteMetadata",re);function R(k,O){for(var X=k.length-1;X>=0;--X){var ce=k[X],ve=ce(O);if(!de(ve)&&!Te(ve)){if(!W(ve))throw new TypeError;O=ve}}return O}function Z(k,O,X,ce){for(var ve=k.length-1;ve>=0;--ve){var V=k[ve],G=V(O,X,ce);if(!de(G)&&!Te(G)){if(!we(G))throw new TypeError;ce=G}}return ce}function ge(k,O,X){var ce=g.get(k);if(de(ce)){if(!X)return;ce=new f,g.set(k,ce)}var ve=ce.get(O);if(de(ve)){if(!X)return;ve=new f,ce.set(O,ve)}return ve}function Ke(k,O,X){var ce=Ce(k,O,X);if(ce)return!0;var ve=Xt(O);return Te(ve)?!1:Ke(k,ve,X)}function Ce(k,O,X){var ce=ge(O,X,!1);return de(ce)?!1:he(ce.has(k))}function ae(k,O,X){var ce=Ce(k,O,X);if(ce)return Nt(k,O,X);var ve=Xt(O);if(!Te(ve))return ae(k,ve,X)}function Nt(k,O,X){var ce=ge(O,X,!1);if(!de(ce))return ce.get(k)}function Je(k,O,X,ce){var ve=ge(X,ce,!0);ve.set(k,O)}function vr(k,O){var X=Xr(k,O),ce=Xt(k);if(ce===null)return X;var ve=vr(ce,O);if(ve.length<=0)return X;if(X.length<=0)return ve;for(var V=new m,G=[],Y=0,oe=X;Y<oe.length;Y++){var Ie=oe[Y],q=V.has(Ie);q||(V.add(Ie),G.push(Ie))}for(var se=0,K=ve;se<K.length;se++){var Ie=K[se],q=V.has(Ie);q||(V.add(Ie),G.push(Ie))}return G}function Xr(k,O){var X=[],ce=ge(k,O,!1);if(de(ce))return X;for(var ve=ce.keys(),V=Ae(ve),G=0;;){var Y=ze(V);if(!Y)return X.length=G,X;var oe=Yt(Y);try{X[G]=oe}catch(Ie){try{bt(V)}finally{throw Ie}}G++}}function H(k){if(k===null)return 1;switch(typeof k){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return k===null?1:6;default:return 6}}function de(k){return k===void 0}function Te(k){return k===null}function be(k){return typeof k=="symbol"}function we(k){return typeof k=="object"?k!==null:typeof k=="function"}function L(k,O){switch(H(k)){case 0:return k;case 1:return k;case 2:return k;case 3:return k;case 4:return k;case 5:return k}var X=O===3?"string":O===5?"number":"default",ce=_e(k,i);if(ce!==void 0){var ve=ce.call(k,X);if(we(ve))throw new TypeError;return ve}return le(k,X==="default"?"number":X)}function le(k,O){if(O==="string"){var X=k.toString;if(N(X)){var ce=X.call(k);if(!we(ce))return ce}var ve=k.valueOf;if(N(ve)){var ce=ve.call(k);if(!we(ce))return ce}}else{var ve=k.valueOf;if(N(ve)){var ce=ve.call(k);if(!we(ce))return ce}var V=k.toString;if(N(V)){var ce=V.call(k);if(!we(ce))return ce}}throw new TypeError}function he(k){return!!k}function xe(k){return""+k}function Le(k){var O=L(k,3);return be(O)?O:xe(O)}function et(k){return Array.isArray?Array.isArray(k):k instanceof Object?k instanceof Array:Object.prototype.toString.call(k)==="[object Array]"}function N(k){return typeof k=="function"}function W(k){return typeof k=="function"}function pe(k){switch(H(k)){case 3:return!0;case 4:return!0;default:return!1}}function _e(k,O){var X=k[O];if(X!=null){if(!N(X))throw new TypeError;return X}}function Ae(k){var O=_e(k,o);if(!N(O))throw new TypeError;var X=O.call(k);if(!we(X))throw new TypeError;return X}function Yt(k){return k.value}function ze(k){var O=k.next();return O.done?!1:O}function bt(k){var O=k.return;O&&O.call(k)}function Xt(k){var O=Object.getPrototypeOf(k);if(typeof k!="function"||k===u||O!==u)return O;var X=k.prototype,ce=X&&Object.getPrototypeOf(X);if(ce==null||ce===Object.prototype)return O;var ve=ce.constructor;return typeof ve!="function"||ve===k?O:ve}function Lt(){var k={},O=[],X=function(){function G(Y,oe,Ie){this._index=0,this._keys=Y,this._values=oe,this._selector=Ie}return G.prototype["@@iterator"]=function(){return this},G.prototype[o]=function(){return this},G.prototype.next=function(){var Y=this._index;if(Y>=0&&Y<this._keys.length){var oe=this._selector(this._keys[Y],this._values[Y]);return Y+1>=this._keys.length?(this._index=-1,this._keys=O,this._values=O):this._index++,{value:oe,done:!1}}return{value:void 0,done:!0}},G.prototype.throw=function(Y){throw this._index>=0&&(this._index=-1,this._keys=O,this._values=O),Y},G.prototype.return=function(Y){return this._index>=0&&(this._index=-1,this._keys=O,this._values=O),{value:Y,done:!0}},G}();return function(){function G(){this._keys=[],this._values=[],this._cacheKey=k,this._cacheIndex=-2}return Object.defineProperty(G.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),G.prototype.has=function(Y){return this._find(Y,!1)>=0},G.prototype.get=function(Y){var oe=this._find(Y,!1);return oe>=0?this._values[oe]:void 0},G.prototype.set=function(Y,oe){var Ie=this._find(Y,!0);return this._values[Ie]=oe,this},G.prototype.delete=function(Y){var oe=this._find(Y,!1);if(oe>=0){for(var Ie=this._keys.length,q=oe+1;q<Ie;q++)this._keys[q-1]=this._keys[q],this._values[q-1]=this._values[q];return this._keys.length--,this._values.length--,Y===this._cacheKey&&(this._cacheKey=k,this._cacheIndex=-2),!0}return!1},G.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=k,this._cacheIndex=-2},G.prototype.keys=function(){return new X(this._keys,this._values,ce)},G.prototype.values=function(){return new X(this._keys,this._values,ve)},G.prototype.entries=function(){return new X(this._keys,this._values,V)},G.prototype["@@iterator"]=function(){return this.entries()},G.prototype[o]=function(){return this.entries()},G.prototype._find=function(Y,oe){return this._cacheKey!==Y&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Y)),this._cacheIndex<0&&oe&&(this._cacheIndex=this._keys.length,this._keys.push(Y),this._values.push(void 0)),this._cacheIndex},G}();function ce(G,Y){return G}function ve(G,Y){return Y}function V(G,Y){return[G,Y]}}function Tr(){return function(){function k(){this._map=new f}return Object.defineProperty(k.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),k.prototype.has=function(O){return this._map.has(O)},k.prototype.add=function(O){return this._map.set(O,O),this},k.prototype.delete=function(O){return this._map.delete(O)},k.prototype.clear=function(){this._map.clear()},k.prototype.keys=function(){return this._map.keys()},k.prototype.values=function(){return this._map.values()},k.prototype.entries=function(){return this._map.entries()},k.prototype["@@iterator"]=function(){return this.keys()},k.prototype[o]=function(){return this.keys()},k}()}function F(){var k=16,O=c.create(),X=ce();return function(){function oe(){this._key=ce()}return oe.prototype.has=function(Ie){var q=ve(Ie,!1);return q!==void 0?c.has(q,this._key):!1},oe.prototype.get=function(Ie){var q=ve(Ie,!1);return q!==void 0?c.get(q,this._key):void 0},oe.prototype.set=function(Ie,q){var se=ve(Ie,!0);return se[this._key]=q,this},oe.prototype.delete=function(Ie){var q=ve(Ie,!1);return q!==void 0?delete q[this._key]:!1},oe.prototype.clear=function(){this._key=ce()},oe}();function ce(){var oe;do oe="@@WeakMap@@"+Y();while(c.has(O,oe));return O[oe]=!0,oe}function ve(oe,Ie){if(!t.call(oe,X)){if(!Ie)return;Object.defineProperty(oe,X,{value:c.create()})}return oe[X]}function V(oe,Ie){for(var q=0;q<Ie;++q)oe[q]=Math.random()*255|0;return oe}function G(oe){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(oe)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(oe)):V(new Uint8Array(oe),oe):V(new Array(oe),oe)}function Y(){var oe=G(k);oe[6]=oe[6]&79|64,oe[8]=oe[8]&191|128;for(var Ie="",q=0;q<k;++q){var se=oe[q];(q===4||q===6||q===8)&&(Ie+="-"),se<16&&(Ie+="0"),Ie+=se.toString(16).toLowerCase()}return Ie}}function ue(k){return k.__=void 0,delete k.__,k}})})(G9||(G9={}))});var $9={};Um($9,{isPreRelesVersionOfJupyterExtension:()=>Vre});var Vre,z9=ee(()=>{"use strict";d();Vre=!1});var Vn=z(nr=>{"use strict";d();Object.defineProperty(nr,"__esModule",{value:!0});nr.NON_CUSTOM_TAG_KEYS=nr.PRE_DESTROY=nr.POST_CONSTRUCT=nr.DESIGN_PARAM_TYPES=nr.PARAM_TYPES=nr.TAGGED_PROP=nr.TAGGED=nr.MULTI_INJECT_TAG=nr.INJECT_TAG=nr.OPTIONAL_TAG=nr.UNMANAGED_TAG=nr.NAME_TAG=nr.NAMED_TAG=void 0;nr.NAMED_TAG="named";nr.NAME_TAG="name";nr.UNMANAGED_TAG="unmanaged";nr.OPTIONAL_TAG="optional";nr.INJECT_TAG="inject";nr.MULTI_INJECT_TAG="multi_inject";nr.TAGGED="inversify:tagged";nr.TAGGED_PROP="inversify:tagged_props";nr.PARAM_TYPES="inversify:paramtypes";nr.DESIGN_PARAM_TYPES="design:paramtypes";nr.POST_CONSTRUCT="post_construct";nr.PRE_DESTROY="pre_destroy";function fne(){return[nr.INJECT_TAG,nr.MULTI_INJECT_TAG,nr.NAME_TAG,nr.UNMANAGED_TAG,nr.NAMED_TAG,nr.OPTIONAL_TAG]}nr.NON_CUSTOM_TAG_KEYS=fne()});var Ba=z(Dp=>{"use strict";d();Object.defineProperty(Dp,"__esModule",{value:!0});Dp.TargetTypeEnum=Dp.BindingTypeEnum=Dp.BindingScopeEnum=void 0;var mne={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Dp.BindingScopeEnum=mne;var hne={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Dp.BindingTypeEnum=hne;var gne={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Dp.TargetTypeEnum=gne});var Pp=z(RP=>{"use strict";d();Object.defineProperty(RP,"__esModule",{value:!0});RP.id=void 0;var vne=0;function yne(){return vne++}RP.id=yne});var HB=z(AP=>{"use strict";d();Object.defineProperty(AP,"__esModule",{value:!0});AP.Binding=void 0;var BB=Ba(),bne=Pp(),Ine=function(){function r(e,t){this.id=(0,bne.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=BB.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===BB.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();AP.Binding=Ine});var $i=z(Ve=>{"use strict";d();Object.defineProperty(Ve,"__esModule",{value:!0});Ve.STACK_OVERFLOW=Ve.CIRCULAR_DEPENDENCY_IN_FACTORY=Ve.ON_DEACTIVATION_ERROR=Ve.PRE_DESTROY_ERROR=Ve.POST_CONSTRUCT_ERROR=Ve.ASYNC_UNBIND_REQUIRED=Ve.MULTIPLE_POST_CONSTRUCT_METHODS=Ve.MULTIPLE_PRE_DESTROY_METHODS=Ve.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ve.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ve.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ve.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ve.ARGUMENTS_LENGTH_MISMATCH=Ve.INVALID_DECORATOR_OPERATION=Ve.INVALID_TO_SELF_VALUE=Ve.LAZY_IN_SYNC=Ve.INVALID_FUNCTION_BINDING=Ve.INVALID_MIDDLEWARE_RETURN=Ve.NO_MORE_SNAPSHOTS_AVAILABLE=Ve.INVALID_BINDING_TYPE=Ve.NOT_IMPLEMENTED=Ve.CIRCULAR_DEPENDENCY=Ve.UNDEFINED_INJECT_ANNOTATION=Ve.MISSING_INJECT_ANNOTATION=Ve.MISSING_INJECTABLE_ANNOTATION=Ve.NOT_REGISTERED=Ve.CANNOT_UNBIND=Ve.AMBIGUOUS_MATCH=Ve.KEY_NOT_FOUND=Ve.NULL_ARGUMENT=Ve.DUPLICATED_METADATA=Ve.DUPLICATED_INJECTABLE_DECORATOR=void 0;Ve.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";Ve.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";Ve.NULL_ARGUMENT="NULL argument";Ve.KEY_NOT_FOUND="Key Not Found";Ve.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";Ve.CANNOT_UNBIND="Could not unbind serviceIdentifier:";Ve.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";Ve.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";Ve.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var Sne=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Ve.UNDEFINED_INJECT_ANNOTATION=Sne;Ve.CIRCULAR_DEPENDENCY="Circular dependency found:";Ve.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";Ve.INVALID_BINDING_TYPE="Invalid binding type:";Ve.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";Ve.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";Ve.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var _ne=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};Ve.LAZY_IN_SYNC=_ne;Ve.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";Ve.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Ene=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};Ve.ARGUMENTS_LENGTH_MISMATCH=Ene;Ve.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";Ve.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').";Ve.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";Ve.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";Ve.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";Ve.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";Ve.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var Cne=function(r,e){return"@postConstruct error in class "+r+": "+e};Ve.POST_CONSTRUCT_ERROR=Cne;var wne=function(r,e){return"@preDestroy error in class "+r+": "+e};Ve.PRE_DESTROY_ERROR=wne;var xne=function(r,e){return"onDeactivation() error in class "+r+": "+e};Ve.ON_DEACTIVATION_ERROR=xne;var Dne=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with"+("service identifier '"+e+"'.")};Ve.CIRCULAR_DEPENDENCY_IN_FACTORY=Dne;Ve.STACK_OVERFLOW="Maximum call stack size exceeded"});var dL=z(cc=>{"use strict";d();var Pne=cc&&cc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Tne=cc&&cc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kne=cc&&cc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Pne(e,r,t);return Tne(e,r),e};Object.defineProperty(cc,"__esModule",{value:!0});cc.MetadataReader=void 0;var uL=kne(Vn()),Nne=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(uL.PARAM_TYPES,e),n=Reflect.getMetadata(uL.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(uL.TAGGED_PROP,e)||[];return t},r}();cc.MetadataReader=Nne});var JB=z(MP=>{"use strict";d();Object.defineProperty(MP,"__esModule",{value:!0});MP.BindingCount=void 0;var Rne={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};MP.BindingCount=Rne});var pL=z(na=>{"use strict";d();var Ane=na&&na.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Mne=na&&na.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),One=na&&na.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Ane(e,r,t);return Mne(e,r),e};Object.defineProperty(na,"__esModule",{value:!0});na.tryAndThrowErrorIfStackOverflow=na.isStackOverflowExeption=void 0;var Lne=One($i());function qB(r){return r instanceof RangeError||r.message===Lne.STACK_OVERFLOW}na.isStackOverflowExeption=qB;var Kne=function(r,e){try{return r()}catch(t){throw qB(t)&&(t=e()),t}};na.tryAndThrowErrorIfStackOverflow=Kne});var ry=z(jn=>{"use strict";d();var Fne=jn&&jn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Une=jn&&jn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Wne=jn&&jn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Fne(e,r,t);return Une(e,r),e};Object.defineProperty(jn,"__esModule",{value:!0});jn.getSymbolDescription=jn.circularDependencyToException=jn.listMetadataForTarget=jn.listRegisteredBindingsForServiceIdentifier=jn.getServiceIdentifierAsString=jn.getFunctionName=void 0;var Vne=Wne($i());function GB(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}jn.getServiceIdentifierAsString=GB;function jne(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=zB(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}jn.listRegisteredBindingsForServiceIdentifier=jne;function YB(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:YB(r.parentRequest,e)}function Bne(r){function e(n,i){i===void 0&&(i=[]);var o=GB(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function $B(r){r.childRequests.forEach(function(e){if(YB(e,e.serviceIdentifier)){var t=Bne(e);throw new Error(Vne.CIRCULAR_DEPENDENCY+" "+t)}else $B(e)})}jn.circularDependencyToException=$B;function Hne(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}jn.listMetadataForTarget=Hne;function zB(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}jn.getFunctionName=zB;function Jne(r){return r.toString().slice(7,-1)}jn.getSymbolDescription=Jne});var QB=z(OP=>{"use strict";d();Object.defineProperty(OP,"__esModule",{value:!0});OP.Context=void 0;var qne=Pp(),Gne=function(){function r(e){this.id=(0,qne.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();OP.Context=Gne});var Ha=z(uc=>{"use strict";d();var Yne=uc&&uc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$ne=uc&&uc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),zne=uc&&uc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Yne(e,r,t);return $ne(e,r),e};Object.defineProperty(uc,"__esModule",{value:!0});uc.Metadata=void 0;var Qne=zne(Vn()),Xne=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===Qne.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();uc.Metadata=Xne});var XB=z(LP=>{"use strict";d();Object.defineProperty(LP,"__esModule",{value:!0});LP.Plan=void 0;var Zne=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();LP.Plan=Zne});var fL=z(KP=>{"use strict";d();Object.defineProperty(KP,"__esModule",{value:!0});KP.LazyServiceIdentifer=void 0;var eie=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();KP.LazyServiceIdentifer=eie});var ZB=z(FP=>{"use strict";d();Object.defineProperty(FP,"__esModule",{value:!0});FP.QueryableString=void 0;var tie=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();FP.QueryableString=tie});var mL=z(dc=>{"use strict";d();var rie=dc&&dc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nie=dc&&dc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iie=dc&&dc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rie(e,r,t);return nie(e,r),e};Object.defineProperty(dc,"__esModule",{value:!0});dc.Target=void 0;var Wu=iie(Vn()),oie=Pp(),sie=ry(),eH=Ha(),aie=ZB(),lie=function(){function r(e,t,n,i){this.id=(0,oie.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,sie.getSymbolDescription)(t):t;this.name=new aie.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new eH.Metadata(Wu.NAMED_TAG,i):i instanceof eH.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(Wu.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(Wu.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(Wu.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return Wu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(Wu.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===Wu.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return Wu.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(Wu.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();dc.Target=lie});var lH=z(zi=>{"use strict";d();var cie=zi&&zi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),uie=zi&&zi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),tH=zi&&zi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cie(e,r,t);return uie(e,r),e},UP=zi&&zi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(zi,"__esModule",{value:!0});zi.getFunctionName=zi.getBaseClassDependencyCount=zi.getDependencies=void 0;var die=fL(),hL=tH($i()),rH=Ba(),YE=tH(Vn()),gL=ry();Object.defineProperty(zi,"getFunctionName",{enumerable:!0,get:function(){return gL.getFunctionName}});var nH=mL();function pie(r,e){var t=(0,gL.getFunctionName)(e);return iH(r,t,e,!1)}zi.getDependencies=pie;function iH(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=hL.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,l=Object.keys(a),c=t.length===0&&l.length>0,u=l.length>t.length,p=c||u?l.length:t.length,f=mie(n,e,o,a,p),m=oH(r,t,e),h=UP(UP([],f,!0),m,!0);return h}function fie(r,e,t,n,i){var o=i[r.toString()]||[],s=aH(o),a=s.unmanaged!==!0,l=n[r],c=s.inject||s.multiInject;if(l=c||l,l instanceof die.LazyServiceIdentifer&&(l=l.unwrap()),a){var u=l===Object,p=l===Function,f=l===void 0,m=u||p||f;if(!e&&m){var h=hL.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(h)}var g=new nH.Target(rH.TargetTypeEnum.ConstructorArgument,s.targetName,l);return g.metadata=o,g}return null}function mie(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,l=fie(a,r,e,t,n);l!==null&&o.push(l)}return o}function hie(r,e,t,n){var i=r||e;if(i===void 0){var o=hL.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function oH(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),l=0,c=a;l<c.length;l++){var u=c[l],p=n[u],f=aH(p),m=f.targetName||u,h=hie(f.inject,f.multiInject,u,t),g=new nH.Target(rH.TargetTypeEnum.ClassProperty,m,h);g.metadata=p,i.push(g)}var v=Object.getPrototypeOf(e.prototype).constructor;if(v!==Object){var S=oH(r,v,t);i=UP(UP([],i,!0),S,!0)}return i}function sH(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,gL.getFunctionName)(t),i=iH(r,n,t,!0),o=i.map(function(l){return l.metadata.filter(function(c){return c.key===YE.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:sH(r,t)}else return 0}zi.getBaseClassDependencyCount=sH;function aH(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[YE.INJECT_TAG],multiInject:e[YE.MULTI_INJECT_TAG],targetName:e[YE.NAME_TAG],unmanaged:e[YE.UNMANAGED_TAG]}}});var cH=z(WP=>{"use strict";d();Object.defineProperty(WP,"__esModule",{value:!0});WP.Request=void 0;var gie=Pp(),vie=function(){function r(e,t,n,i,o){this.id=(0,gie.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();WP.Request=vie});var SL=z(Ho=>{"use strict";d();var yie=Ho&&Ho.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bie=Ho&&Ho.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),pH=Ho&&Ho.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&yie(e,r,t);return bie(e,r),e};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.getBindingDictionary=Ho.createMockRequest=Ho.plan=void 0;var VP=JB(),yL=pH($i()),fH=Ba(),uH=pH(Vn()),Iie=pL(),ny=ry(),mH=QB(),bL=Ha(),Sie=XB(),vL=lH(),IL=cH(),hH=mL();function gH(r){return r._bindingDictionary}Ho.getBindingDictionary=gH;function _ie(r,e,t,n,i,o){var s=r?uH.MULTI_INJECT_TAG:uH.INJECT_TAG,a=new bL.Metadata(s,t),l=new hH.Target(e,n,t,a);if(i!==void 0){var c=new bL.Metadata(i,o);l.metadata.push(c)}return l}function dH(r,e,t,n,i){var o=$E(t.container,i.serviceIdentifier),s=[];return o.length===VP.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=$E(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var l=new IL.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(l)}),Eie(i.serviceIdentifier,s,i,t.container),s}function Eie(r,e,t,n){switch(e.length){case VP.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,ny.getServiceIdentifierAsString)(r),o=yL.NOT_REGISTERED;throw o+=(0,ny.listMetadataForTarget)(i,t),o+=(0,ny.listRegisteredBindingsForServiceIdentifier)(n,i,$E),new Error(o);case VP.BindingCount.OnlyOneBindingAvailable:return e;case VP.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,ny.getServiceIdentifierAsString)(r),o=yL.AMBIGUOUS_MATCH+" "+i;throw o+=(0,ny.listRegisteredBindingsForServiceIdentifier)(n,i,$E),new Error(o)}}function vH(r,e,t,n,i,o){var s,a;if(i===null){s=dH(r,e,n,null,o),a=new IL.Request(t,n,null,s,o);var l=new Sie.Plan(n,a);n.addPlan(l)}else s=dH(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(c){var u=null;if(o.isArray())u=a.addChildRequest(c.serviceIdentifier,c,o);else{if(c.cache)return;u=a}if(c.type===fH.BindingTypeEnum.Instance&&c.implementationType!==null){var p=(0,vL.getDependencies)(r,c.implementationType);if(!n.container.options.skipBaseClassChecks){var f=(0,vL.getBaseClassDependencyCount)(r,c.implementationType);if(p.length<f){var m=yL.ARGUMENTS_LENGTH_MISMATCH((0,vL.getFunctionName)(c.implementationType));throw new Error(m)}}p.forEach(function(h){vH(r,!1,h.serviceIdentifier,n,u,h)})}})}function $E(r,e){var t=[],n=gH(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=$E(r.parent,e)),t}function Cie(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var l=new mH.Context(e),c=_ie(t,n,i,"",o,s);try{return vH(r,a,i,l,null,c),l}catch(u){throw(0,Iie.isStackOverflowExeption)(u)&&(0,ny.circularDependencyToException)(l.plan.rootRequest),u}}Ho.plan=Cie;function wie(r,e,t,n){var i=new hH.Target(fH.TargetTypeEnum.Variable,"",e,new bL.Metadata(t,n)),o=new mH.Context(r),s=new IL.Request(e,o,null,[],i);return s}Ho.createMockRequest=wie});var zE=z(iy=>{"use strict";d();Object.defineProperty(iy,"__esModule",{value:!0});iy.isPromiseOrContainsPromise=iy.isPromise=void 0;function _L(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}iy.isPromise=_L;function xie(r){return _L(r)?!0:Array.isArray(r)&&r.some(_L)}iy.isPromiseOrContainsPromise=xie});var yH=z(pc=>{"use strict";d();var Die=pc&&pc.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},Pie=pc&&pc.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(pc,"__esModule",{value:!0});pc.saveToScope=pc.tryGetFromScope=void 0;var jP=te(),Tie=zE(),kie=function(r,e){return e.scope===jP.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===jP.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};pc.tryGetFromScope=kie;var Nie=function(r,e,t){e.scope===jP.BindingScopeEnum.Singleton&&Aie(e,t),e.scope===jP.BindingScopeEnum.Request&&Rie(r,e,t)};pc.saveToScope=Nie;var Rie=function(r,e,t){r.has(e.id)||r.set(e.id,t)},Aie=function(r,e){r.cache=e,r.activated=!0,(0,Tie.isPromise)(e)&&Mie(r,e)},Mie=function(r,e){return Die(void 0,void 0,void 0,function(){var t,n;return Pie(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var bH=z(QE=>{"use strict";d();Object.defineProperty(QE,"__esModule",{value:!0});QE.FactoryType=void 0;var Oie;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(Oie=QE.FactoryType||(QE.FactoryType={}))});var CL=z(Jo=>{"use strict";d();var Lie=Jo&&Jo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kie=Jo&&Jo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fie=Jo&&Jo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lie(e,r,t);return Kie(e,r),e};Object.defineProperty(Jo,"__esModule",{value:!0});Jo.getFactoryDetails=Jo.ensureFullyBound=Jo.multiBindToService=void 0;var Uie=te(),Wie=Fie($i()),fc=Ba(),EL=bH(),Vie=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};Jo.multiBindToService=Vie;var jie=function(r){var e=null;switch(r.type){case fc.BindingTypeEnum.ConstantValue:case fc.BindingTypeEnum.Function:e=r.cache;break;case fc.BindingTypeEnum.Constructor:case fc.BindingTypeEnum.Instance:e=r.implementationType;break;case fc.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case fc.BindingTypeEnum.Provider:e=r.provider;break;case fc.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,Uie.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(Wie.INVALID_BINDING_TYPE+" "+t)}};Jo.ensureFullyBound=jie;var Bie=function(r){switch(r.type){case fc.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:EL.FactoryType.Factory};case fc.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:EL.FactoryType.Provider};case fc.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:EL.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};Jo.getFactoryDetails=Bie});var wH=z(yi=>{"use strict";d();var oy=yi&&yi.__assign||function(){return oy=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},oy.apply(this,arguments)},Hie=yi&&yi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jie=yi&&yi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),qie=yi&&yi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Hie(e,r,t);return Jie(e,r),e},_H=yi&&yi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},EH=yi&&yi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},Gie=yi&&yi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(yi,"__esModule",{value:!0});yi.resolveInstance=void 0;var wL=$i(),DL=Ba(),xL=qie(Vn()),PL=zE();function Yie(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===DL.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,PL.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function $ie(r,e,t){var n;if(e.length>0){var i=Yie(e,t),o=oy(oy({},i),{constr:r});i.isAsync?n=zie(o):n=CH(o)}else n=new r;return n}function CH(r){var e,t=new((e=r.constr).bind.apply(e,Gie([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];t[o]=s}),t}function zie(r){return _H(this,void 0,void 0,function(){var e,t;return EH(this,function(n){switch(n.label){case 0:return[4,IH(r.constructorInjections)];case 1:return e=n.sent(),[4,IH(r.propertyInjections)];case 2:return t=n.sent(),[2,CH(oy(oy({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function IH(r){return _H(this,void 0,void 0,function(){var e,t,n,i;return EH(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function SH(r,e){var t=Qie(r,e);return(0,PL.isPromise)(t)?t.then(function(){return e}):e}function Qie(r,e){var t,n;if(Reflect.hasMetadata(xL.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(xL.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){throw new Error((0,wL.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function Xie(r,e){r.scope!==DL.BindingScopeEnum.Singleton&&Zie(r,e)}function Zie(r,e){var t="Class cannot be instantiated in "+(r.scope===DL.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,wL.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(xL.PRE_DESTROY,e))throw new Error((0,wL.PRE_DESTROY_ERROR)(e.name,t))}function eoe(r,e,t,n){Xie(r,e);var i=$ie(e,t,n);return(0,PL.isPromise)(i)?i.then(function(o){return SH(e,o)}):SH(e,i)}yi.resolveInstance=eoe});var kH=z(qo=>{"use strict";d();var toe=qo&&qo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),roe=qo&&qo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),noe=qo&&qo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&toe(e,r,t);return roe(e,r),e},ioe=qo&&qo.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},ooe=qo&&qo.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(qo,"__esModule",{value:!0});qo.resolve=void 0;var soe=noe($i()),BP=Ba(),aoe=SL(),xH=yH(),TL=zE(),PH=CL(),loe=pL(),coe=wH(),kL=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var l=kL(r);return l(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return foe(r,e,s)}},uoe=function(r,e){var t=(0,PH.getFactoryDetails)(r);return(0,loe.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(soe.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},doe=function(r,e,t){var n,i=e.childRequests;switch((0,PH.ensureFullyBound)(t),t.type){case BP.BindingTypeEnum.ConstantValue:case BP.BindingTypeEnum.Function:n=t.cache;break;case BP.BindingTypeEnum.Constructor:n=t.implementationType;break;case BP.BindingTypeEnum.Instance:n=(0,coe.resolveInstance)(t,t.implementationType,i,kL(r));break;default:n=uoe(t,e.parentContext)}return n},poe=function(r,e,t){var n=(0,xH.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,xH.saveToScope)(r,e,n)),n},foe=function(r,e,t){return poe(r,t,function(){var n=doe(r,e,t);return(0,TL.isPromise)(n)?n=n.then(function(i){return DH(e,t,i)}):n=DH(e,t,n),n})};function DH(r,e,t){var n=moe(r.parentContext,e,t),i=voe(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,l=r.serviceIdentifier,c=goe(o,l);(0,TL.isPromise)(n)?n=TH(c,a,n):n=hoe(c,a,n),s=i.next()}while(s.done!==!0&&!(0,aoe.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var moe=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},hoe=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,TL.isPromise)(t))return TH(r,e,t);n=r.next()}return t},TH=function(r,e,t){return ioe(void 0,void 0,void 0,function(){var n,i;return ooe(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},goe=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},voe=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function yoe(r){var e=kL(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}qo.resolve=yoe});var NL=z(Qi=>{"use strict";d();var boe=Qi&&Qi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ioe=Qi&&Qi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Soe=Qi&&Qi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&boe(e,r,t);return Ioe(e,r),e};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.typeConstraint=Qi.namedConstraint=Qi.taggedConstraint=Qi.traverseAncerstors=void 0;var _oe=Soe(Vn()),Eoe=Ha(),NH=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:NH(t,e):!1};Qi.traverseAncerstors=NH;var RH=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new Eoe.Metadata(r,e),t}};Qi.taggedConstraint=RH;var Coe=RH(_oe.NAMED_TAG);Qi.namedConstraint=Coe;var woe=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Qi.typeConstraint=woe});var JP=z(HP=>{"use strict";d();Object.defineProperty(HP,"__esModule",{value:!0});HP.BindingWhenSyntax=void 0;var Io=qP(),ei=NL(),xoe=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new Io.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,ei.namedConstraint)(e),new Io.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new Io.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,ei.taggedConstraint)(e)(t),new Io.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ei.typeConstraint)(e)(t.parentRequest)},new Io.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ei.namedConstraint)(e)(t.parentRequest)},new Io.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ei.taggedConstraint)(e)(t)(n.parentRequest)},new Io.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ei.traverseAncerstors)(t,(0,ei.typeConstraint)(e))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ei.traverseAncerstors)(t,(0,ei.typeConstraint)(e))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ei.traverseAncerstors)(t,(0,ei.namedConstraint)(e))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ei.traverseAncerstors)(t,(0,ei.namedConstraint)(e))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ei.traverseAncerstors)(n,(0,ei.taggedConstraint)(e)(t))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,ei.traverseAncerstors)(n,(0,ei.taggedConstraint)(e)(t))},new Io.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ei.traverseAncerstors)(t,e)},new Io.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ei.traverseAncerstors)(t,e)},new Io.BindingOnSyntax(this._binding)},r}();HP.BindingWhenSyntax=xoe});var qP=z(GP=>{"use strict";d();Object.defineProperty(GP,"__esModule",{value:!0});GP.BindingOnSyntax=void 0;var AH=JP(),Doe=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new AH.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new AH.BindingWhenSyntax(this._binding)},r}();GP.BindingOnSyntax=Doe});var RL=z(YP=>{"use strict";d();Object.defineProperty(YP,"__esModule",{value:!0});YP.BindingWhenOnSyntax=void 0;var Poe=qP(),Toe=JP(),koe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Toe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Poe.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();YP.BindingWhenOnSyntax=koe});var MH=z($P=>{"use strict";d();Object.defineProperty($P,"__esModule",{value:!0});$P.BindingInSyntax=void 0;var AL=Ba(),ML=RL(),Noe=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=AL.BindingScopeEnum.Request,new ML.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=AL.BindingScopeEnum.Singleton,new ML.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=AL.BindingScopeEnum.Transient,new ML.BindingWhenOnSyntax(this._binding)},r}();$P.BindingInSyntax=Noe});var OH=z(zP=>{"use strict";d();Object.defineProperty(zP,"__esModule",{value:!0});zP.BindingInWhenOnSyntax=void 0;var Roe=MH(),Aoe=qP(),Moe=JP(),Ooe=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Moe.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Aoe.BindingOnSyntax(this._binding),this._bindingInSyntax=new Roe.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();zP.BindingInWhenOnSyntax=Ooe});var FH=z(mc=>{"use strict";d();var Loe=mc&&mc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Koe=mc&&mc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Foe=mc&&mc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Loe(e,r,t);return Koe(e,r),e};Object.defineProperty(mc,"__esModule",{value:!0});mc.BindingToSyntax=void 0;var LH=Foe($i()),So=Ba(),KH=OH(),sy=RL(),Uoe=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=So.BindingTypeEnum.Instance,this._binding.implementationType=e,new KH.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+LH.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=So.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=So.BindingScopeEnum.Singleton,new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=So.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new KH.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=So.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=So.BindingScopeEnum.Singleton,new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=So.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=So.BindingScopeEnum.Singleton,new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(LH.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=So.BindingTypeEnum.Function,this._binding.scope=So.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=So.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=So.BindingScopeEnum.Singleton,new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=So.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=So.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=So.BindingScopeEnum.Singleton,new sy.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();mc.BindingToSyntax=Uoe});var UH=z(QP=>{"use strict";d();Object.defineProperty(QP,"__esModule",{value:!0});QP.ContainerSnapshot=void 0;var Woe=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();QP.ContainerSnapshot=Woe});var WH=z(XP=>{"use strict";d();Object.defineProperty(XP,"__esModule",{value:!0});XP.isClonable=void 0;function Voe(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}XP.isClonable=Voe});var OL=z(hc=>{"use strict";d();var joe=hc&&hc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Boe=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hoe=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&joe(e,r,t);return Boe(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.Lookup=void 0;var Vm=Hoe($i()),Joe=WH(),qoe=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(Vm.NULL_ARGUMENT);if(t==null)throw new Error(Vm.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(Vm.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(Vm.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(Vm.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(Vm.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(l){return a===l})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,l=i;a<l.length;a++){var c=l[a],u=e(c);u?n.push(c):s.push(c)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(Vm.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,Joe.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();hc.Lookup=qoe});var jH=z(ZP=>{"use strict";d();Object.defineProperty(ZP,"__esModule",{value:!0});ZP.ModuleActivationStore=void 0;var VH=OL(),Goe=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new VH.Lookup,onDeactivations:new VH.Lookup};return e},r}();ZP.ModuleActivationStore=Goe});var LL=z(bi=>{"use strict";d();var tT=bi&&bi.__assign||function(){return tT=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},tT.apply(this,arguments)},Yoe=bi&&bi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),$oe=bi&&bi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),BH=bi&&bi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Yoe(e,r,t);return $oe(e,r),e},ia=bi&&bi.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(n.next(u))}catch(p){s(p)}}function l(u){try{c(n.throw(u))}catch(p){s(p)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((n=n.apply(r,e||[])).next())})},oa=bi&&bi.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){t.label=c[1];break}if(c[0]===6&&t.label<o[1]){t.label=o[1],o=c;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(c);break}o[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(u){c=[6,u],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},zoe=bi&&bi.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(bi,"__esModule",{value:!0});bi.Container=void 0;var Qoe=HB(),Ja=BH($i()),ay=Ba(),jm=BH(Vn()),Xoe=dL(),eT=SL(),Zoe=kH(),ese=FH(),Bm=zE(),tse=Pp(),rse=ry(),nse=UH(),XE=OL(),ise=jH(),ose=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+Ja.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=ay.BindingScopeEnum.Transient;else if(t.defaultScope!==ay.BindingScopeEnum.Singleton&&t.defaultScope!==ay.BindingScopeEnum.Transient&&t.defaultScope!==ay.BindingScopeEnum.Request)throw new Error(""+Ja.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+Ja.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+Ja.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,tse.id)(),this._bindingDictionary=new XE.Lookup,this._snapshots=[],this._middleware=null,this._activations=new XE.Lookup,this._deactivations=new XE.Lookup,this.parent=null,this._metadataReader=new Xoe.MetadataReader,this._moduleActivationStore=new ise.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=zoe([e,t],n,!0).map(function(c){return(0,eT.getBindingDictionary)(c)}),a=(0,eT.getBindingDictionary)(o);function l(c,u){c.traverse(function(p,f){f.forEach(function(m){u.add(m.serviceIdentifier,m.clone())})})}return s.forEach(function(c){l(c,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ia(this,void 0,void 0,function(){var n,i,o,s,a;return oa(this,function(l){switch(l.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,l.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:l.sent(),l.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ia(this,void 0,void 0,function(){var n,i,o,s;return oa(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||ay.BindingScopeEnum.Transient,n=new Qoe.Binding(e,t);return this._bindingDictionary.add(e,n),new ese.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return ia(this,void 0,void 0,function(){return oa(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return ia(this,void 0,void 0,function(){var t;return oa(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new XE.Lookup},r.prototype.unbindAllAsync=function(){return ia(this,void 0,void 0,function(){var e,t=this;return oa(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new XE.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,jm.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,eT.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(nse.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(Ja.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return ia(this,void 0,void 0,function(){var t;return oa(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return ia(this,void 0,void 0,function(){var i;return oa(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,jm.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,jm.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,jm.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,jm.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(jm.PRE_DESTROY,e)){var n=Reflect.getMetadata(jm.PRE_DESTROY,e);return t[n.value]()}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Bm.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Bm.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){throw new Error(Ja.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return ia(this,void 0,void 0,function(){var n;return oa(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(Ja.ON_DEACTIVATION_ERROR(t.name,n.message));case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Bm.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return ia(this,void 0,void 0,function(){var n;return oa(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(u,p){u._binding.moduleId=p},n=function(u){return function(p){var f=e.bind(p);return t(f,u),f}},i=function(){return function(u){return e.unbind(u)}},o=function(){return function(u){return e.unbindAsync(u)}},s=function(){return function(u){return e.isBound(u)}},a=function(u){return function(p){var f=e.rebind(p);return t(f,u),f}},l=function(u){return function(p,f){e._moduleActivationStore.addActivation(u,p,f),e.onActivation(p,f)}},c=function(u){return function(p,f){e._moduleActivationStore.addDeactivation(u,p,f),e.onDeactivation(p,f)}};return function(u){return{bindFunction:n(u),isboundFunction:s(),onActivationFunction:l(u),onDeactivationFunction:c(u),rebindFunction:a(u),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=tT(tT({},e),{contextInterceptor:function(i){return i},targetType:ay.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(Ja.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Bm.isPromiseOrContainsPromise)(t))throw new Error(Ja.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,eT.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,Zoe.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Bm.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Bm.isPromise)(o))throw new Error(Ja.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return ia(this,void 0,void 0,function(){var t=this;return oa(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return ia(this,void 0,void 0,function(){return oa(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(Ja.CANNOT_UNBIND+" "+(0,rse.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Bm.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return ia(this,void 0,void 0,function(){return oa(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();bi.Container=ose});var JH=z(ly=>{"use strict";d();Object.defineProperty(ly,"__esModule",{value:!0});ly.AsyncContainerModule=ly.ContainerModule=void 0;var HH=Pp(),sse=function(){function r(e){this.id=(0,HH.id)(),this.registry=e}return r}();ly.ContainerModule=sse;var ase=function(){function r(e){this.id=(0,HH.id)(),this.registry=e}return r}();ly.AsyncContainerModule=ase});var qH=z(rT=>{"use strict";d();Object.defineProperty(rT,"__esModule",{value:!0});rT.getFirstArrayDuplicate=void 0;function lse(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}rT.getFirstArrayDuplicate=lse});var Vu=z(Xi=>{"use strict";d();var cse=Xi&&Xi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),use=Xi&&Xi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),YH=Xi&&Xi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cse(e,r,t);return use(e,r),e};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.createTaggedDecorator=Xi.tagProperty=Xi.tagParameter=Xi.decorate=void 0;var nT=YH($i()),$H=YH(Vn()),dse=qH();function pse(r){return r.prototype!==void 0}function fse(r){if(r!==void 0)throw new Error(nT.INVALID_DECORATOR_OPERATION)}function zH(r,e,t,n){fse(e),XH($H.TAGGED,r,t.toString(),n)}Xi.tagParameter=zH;function QH(r,e,t){if(pse(r))throw new Error(nT.INVALID_DECORATOR_OPERATION);XH($H.TAGGED_PROP,r.constructor,e,t)}Xi.tagProperty=QH;function mse(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,dse.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(nT.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function XH(r,e,t,n){var i=mse(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(p){if(i.some(function(f){return f.key===p.key}))throw new Error(nT.DUPLICATED_METADATA+" "+p.key.toString())},l=0,c=s;l<c.length;l++){var u=c[l];a(u)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function hse(r){return function(e,t,n){typeof n=="number"?zH(e,t,n,r):QH(e,t,r)}}Xi.createTaggedDecorator=hse;function GH(r,e){Reflect.decorate(r,e)}function gse(r,e){return function(t,n){e(t,n,r)}}function vse(r,e,t){typeof t=="number"?GH([gse(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):GH([r],e)}Xi.decorate=vse});var e7=z(gc=>{"use strict";d();var yse=gc&&gc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bse=gc&&gc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ZH=gc&&gc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&yse(e,r,t);return bse(e,r),e};Object.defineProperty(gc,"__esModule",{value:!0});gc.injectable=void 0;var Ise=ZH($i()),KL=ZH(Vn());function Sse(){return function(r){if(Reflect.hasOwnMetadata(KL.PARAM_TYPES,r))throw new Error(Ise.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(KL.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(KL.PARAM_TYPES,e,r),r}}gc.injectable=Sse});var t7=z(iT=>{"use strict";d();Object.defineProperty(iT,"__esModule",{value:!0});iT.tagged=void 0;var _se=Ha(),Ese=Vu();function Cse(r,e){return(0,Ese.createTaggedDecorator)(new _se.Metadata(r,e))}iT.tagged=Cse});var r7=z(vc=>{"use strict";d();var wse=vc&&vc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),xse=vc&&vc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Dse=vc&&vc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&wse(e,r,t);return xse(e,r),e};Object.defineProperty(vc,"__esModule",{value:!0});vc.named=void 0;var Pse=Dse(Vn()),Tse=Ha(),kse=Vu();function Nse(r){return(0,kse.createTaggedDecorator)(new Tse.Metadata(Pse.NAMED_TAG,r))}vc.named=Nse});var FL=z(oT=>{"use strict";d();Object.defineProperty(oT,"__esModule",{value:!0});oT.injectBase=void 0;var Rse=$i(),Ase=Ha(),Mse=Vu();function Ose(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,Rse.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,Mse.createTaggedDecorator)(new Ase.Metadata(r,e))(t,n,i)}}}oT.injectBase=Ose});var n7=z(yc=>{"use strict";d();var Lse=yc&&yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Kse=yc&&yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Fse=yc&&yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lse(e,r,t);return Kse(e,r),e};Object.defineProperty(yc,"__esModule",{value:!0});yc.inject=void 0;var Use=Fse(Vn()),Wse=FL(),Vse=(0,Wse.injectBase)(Use.INJECT_TAG);yc.inject=Vse});var i7=z(bc=>{"use strict";d();var jse=bc&&bc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Bse=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hse=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&jse(e,r,t);return Bse(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.optional=void 0;var Jse=Hse(Vn()),qse=Ha(),Gse=Vu();function Yse(){return(0,Gse.createTaggedDecorator)(new qse.Metadata(Jse.OPTIONAL_TAG,!0))}bc.optional=Yse});var o7=z(Ic=>{"use strict";d();var $se=Ic&&Ic.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),zse=Ic&&Ic.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Qse=Ic&&Ic.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$se(e,r,t);return zse(e,r),e};Object.defineProperty(Ic,"__esModule",{value:!0});Ic.unmanaged=void 0;var Xse=Qse(Vn()),Zse=Ha(),eae=Vu();function tae(){return function(r,e,t){var n=new Zse.Metadata(Xse.UNMANAGED_TAG,!0);(0,eae.tagParameter)(r,e,t,n)}}Ic.unmanaged=tae});var s7=z(Sc=>{"use strict";d();var rae=Sc&&Sc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nae=Sc&&Sc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iae=Sc&&Sc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rae(e,r,t);return nae(e,r),e};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.multiInject=void 0;var oae=iae(Vn()),sae=FL(),aae=(0,sae.injectBase)(oae.MULTI_INJECT_TAG);Sc.multiInject=aae});var a7=z(_c=>{"use strict";d();var lae=_c&&_c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),cae=_c&&_c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),uae=_c&&_c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&lae(e,r,t);return cae(e,r),e};Object.defineProperty(_c,"__esModule",{value:!0});_c.targetName=void 0;var dae=uae(Vn()),pae=Ha(),fae=Vu();function mae(r){return function(e,t,n){var i=new pae.Metadata(dae.NAME_TAG,r);(0,fae.tagParameter)(e,t,n,i)}}_c.targetName=mae});var UL=z(sT=>{"use strict";d();Object.defineProperty(sT,"__esModule",{value:!0});sT.propertyEventDecorator=void 0;var hae=Ha();function gae(r,e){return function(){return function(t,n){var i=new hae.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}sT.propertyEventDecorator=gae});var c7=z(Ec=>{"use strict";d();var vae=Ec&&Ec.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),yae=Ec&&Ec.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),l7=Ec&&Ec.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vae(e,r,t);return yae(e,r),e};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.postConstruct=void 0;var bae=l7($i()),Iae=l7(Vn()),Sae=UL(),_ae=(0,Sae.propertyEventDecorator)(Iae.POST_CONSTRUCT,bae.MULTIPLE_POST_CONSTRUCT_METHODS);Ec.postConstruct=_ae});var d7=z(Cc=>{"use strict";d();var Eae=Cc&&Cc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cae=Cc&&Cc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),u7=Cc&&Cc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Eae(e,r,t);return Cae(e,r),e};Object.defineProperty(Cc,"__esModule",{value:!0});Cc.preDestroy=void 0;var wae=u7($i()),xae=u7(Vn()),Dae=UL(),Pae=(0,Dae.propertyEventDecorator)(xae.PRE_DESTROY,wae.MULTIPLE_PRE_DESTROY_METHODS);Cc.preDestroy=Pae});var p7=z(aT=>{"use strict";d();Object.defineProperty(aT,"__esModule",{value:!0});aT.interfaces=void 0;var WL;WL||(WL={});aT.interfaces=WL});var te=z(je=>{"use strict";d();var Tae=je&&je.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),kae=je&&je.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Nae=je&&je.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Tae(e,r,t);return kae(e,r),e};Object.defineProperty(je,"__esModule",{value:!0});je.multiBindToService=je.getServiceIdentifierAsString=je.typeConstraint=je.namedConstraint=je.taggedConstraint=je.traverseAncerstors=je.decorate=je.interfaces=je.id=je.MetadataReader=je.preDestroy=je.postConstruct=je.targetName=je.multiInject=je.unmanaged=je.optional=je.LazyServiceIdentifer=je.inject=je.named=je.tagged=je.injectable=je.createTaggedDecorator=je.ContainerModule=je.AsyncContainerModule=je.TargetTypeEnum=je.BindingTypeEnum=je.BindingScopeEnum=je.Container=je.METADATA_KEY=void 0;var Rae=Nae(Vn());je.METADATA_KEY=Rae;var Aae=LL();Object.defineProperty(je,"Container",{enumerable:!0,get:function(){return Aae.Container}});var VL=Ba();Object.defineProperty(je,"BindingScopeEnum",{enumerable:!0,get:function(){return VL.BindingScopeEnum}});Object.defineProperty(je,"BindingTypeEnum",{enumerable:!0,get:function(){return VL.BindingTypeEnum}});Object.defineProperty(je,"TargetTypeEnum",{enumerable:!0,get:function(){return VL.TargetTypeEnum}});var f7=JH();Object.defineProperty(je,"AsyncContainerModule",{enumerable:!0,get:function(){return f7.AsyncContainerModule}});Object.defineProperty(je,"ContainerModule",{enumerable:!0,get:function(){return f7.ContainerModule}});var Mae=Vu();Object.defineProperty(je,"createTaggedDecorator",{enumerable:!0,get:function(){return Mae.createTaggedDecorator}});var Oae=e7();Object.defineProperty(je,"injectable",{enumerable:!0,get:function(){return Oae.injectable}});var Lae=t7();Object.defineProperty(je,"tagged",{enumerable:!0,get:function(){return Lae.tagged}});var Kae=r7();Object.defineProperty(je,"named",{enumerable:!0,get:function(){return Kae.named}});var Fae=n7();Object.defineProperty(je,"inject",{enumerable:!0,get:function(){return Fae.inject}});var Uae=fL();Object.defineProperty(je,"LazyServiceIdentifer",{enumerable:!0,get:function(){return Uae.LazyServiceIdentifer}});var Wae=i7();Object.defineProperty(je,"optional",{enumerable:!0,get:function(){return Wae.optional}});var Vae=o7();Object.defineProperty(je,"unmanaged",{enumerable:!0,get:function(){return Vae.unmanaged}});var jae=s7();Object.defineProperty(je,"multiInject",{enumerable:!0,get:function(){return jae.multiInject}});var Bae=a7();Object.defineProperty(je,"targetName",{enumerable:!0,get:function(){return Bae.targetName}});var Hae=c7();Object.defineProperty(je,"postConstruct",{enumerable:!0,get:function(){return Hae.postConstruct}});var Jae=d7();Object.defineProperty(je,"preDestroy",{enumerable:!0,get:function(){return Jae.preDestroy}});var qae=dL();Object.defineProperty(je,"MetadataReader",{enumerable:!0,get:function(){return qae.MetadataReader}});var Gae=Pp();Object.defineProperty(je,"id",{enumerable:!0,get:function(){return Gae.id}});var Yae=p7();Object.defineProperty(je,"interfaces",{enumerable:!0,get:function(){return Yae.interfaces}});var $ae=Vu();Object.defineProperty(je,"decorate",{enumerable:!0,get:function(){return $ae.decorate}});var lT=NL();Object.defineProperty(je,"traverseAncerstors",{enumerable:!0,get:function(){return lT.traverseAncerstors}});Object.defineProperty(je,"taggedConstraint",{enumerable:!0,get:function(){return lT.taggedConstraint}});Object.defineProperty(je,"namedConstraint",{enumerable:!0,get:function(){return lT.namedConstraint}});Object.defineProperty(je,"typeConstraint",{enumerable:!0,get:function(){return lT.typeConstraint}});var zae=ry();Object.defineProperty(je,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return zae.getServiceIdentifierAsString}});var Qae=CL();Object.defineProperty(je,"multiBindToService",{enumerable:!0,get:function(){return Qae.multiBindToService}})});var g7=z(Tp=>{"use strict";d();Object.defineProperty(Tp,"__esModule",{value:!0});Tp.PythonExtension=Tp.PVSC_EXTENSION_ID=void 0;var Zae=require("vscode");Tp.PVSC_EXTENSION_ID="ms-python.python";var ele;(function(r){async function e(){let t=Zae.extensions.getExtension(Tp.PVSC_EXTENSION_ID);if(t===void 0)throw new Error("Python extension is not installed or is disabled");return t.isActive||await t.activate(),t.exports}r.api=e})(ele=Tp.PythonExtension||(Tp.PythonExtension={}))});var HL=z((_Re,x7)=>{d();function ile(r){var e=/(%?)(%([jds]))/g,t=Array.prototype.slice.call(arguments,1);return t.length&&(r=r.replace(e,function(n,i,o,s){var a=t.shift();switch(s){case"s":a=""+a;break;case"d":a=Number(a);break;case"j":a=JSON.stringify(a);break}return i?(t.unshift(a),n):a})),t.length&&(r+=" "+t.join(" ")),r=r.replace(/%{2,2}/g,"%"),""+r}x7.exports=ile});var $7=z((XRe,YL)=>{"use strict";d();var vy=typeof Reflect=="object"?Reflect:null,U7=vy&&typeof vy.apply=="function"?vy.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},yT;vy&&typeof vy.ownKeys=="function"?yT=vy.ownKeys:Object.getOwnPropertySymbols?yT=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:yT=function(e){return Object.getOwnPropertyNames(e)};function vle(r){console&&console.warn&&console.warn(r)}var V7=Number.isNaN||function(e){return e!==e};function kr(){kr.init.call(this)}YL.exports=kr;YL.exports.once=Sle;kr.EventEmitter=kr;kr.prototype._events=void 0;kr.prototype._eventsCount=0;kr.prototype._maxListeners=void 0;var W7=10;function bT(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(kr,"defaultMaxListeners",{enumerable:!0,get:function(){return W7},set:function(r){if(typeof r!="number"||r<0||V7(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");W7=r}});kr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||V7(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function j7(r){return r._maxListeners===void 0?kr.defaultMaxListeners:r._maxListeners}kr.prototype.getMaxListeners=function(){return j7(this)};kr.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")U7(l,this,t);else for(var c=l.length,u=G7(l,c),n=0;n<c;++n)U7(u[n],this,t);return!0};function B7(r,e,t,n){var i,o,s;if(bT(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=j7(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,vle(a)}return r}kr.prototype.addListener=function(e,t){return B7(this,e,t,!1)};kr.prototype.on=kr.prototype.addListener;kr.prototype.prependListener=function(e,t){return B7(this,e,t,!0)};function yle(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function H7(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=yle.bind(n);return i.listener=t,n.wrapFn=i,i}kr.prototype.once=function(e,t){return bT(t),this.on(e,H7(this,e,t)),this};kr.prototype.prependOnceListener=function(e,t){return bT(t),this.prependListener(e,H7(this,e,t)),this};kr.prototype.removeListener=function(e,t){var n,i,o,s,a;if(bT(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():ble(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};kr.prototype.off=kr.prototype.removeListener;kr.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function J7(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?Ile(i):G7(i,i.length)}kr.prototype.listeners=function(e){return J7(this,e,!0)};kr.prototype.rawListeners=function(e){return J7(this,e,!1)};kr.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):q7.call(r,e)};kr.prototype.listenerCount=q7;function q7(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}kr.prototype.eventNames=function(){return this._eventsCount>0?yT(this._events):[]};function G7(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function ble(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Ile(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Sle(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}Y7(r,e,o,{once:!0}),e!=="error"&&_le(r,i,{once:!0})})}function _le(r,e,t){typeof r.on=="function"&&Y7(r,"error",e,t)}function Y7(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var X7=z((by,Q7)=>{"use strict";d();var Ele=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Ju!="undefined")return Ju;throw new Error("unable to locate global object")},Ju=Ele();Q7.exports=by=Ju.fetch;Ju.fetch&&(by.default=Ju.fetch.bind(Ju));by.Headers=Ju.Headers;by.Request=Ju.Request;by.Response=Ju.Response});var Z7=z(nC=>{d();nC.get=function(r){var e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(o,s){return s},Error.captureStackTrace(t,r||nC.get);var i=t.stack;return Error.prepareStackTrace=n,Error.stackTraceLimit=e,i};nC.parse=function(r){if(!r.stack)return[];var e=this,t=r.stack.split(`
`).slice(1);return t.map(function(n){if(n.match(/^\s*[-]{4,}$/))return e._createParsedCallSite({fileName:n,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var i=n.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(i){var o=null,s=null,a=null,l=null,c=null,u=i[5]==="native";if(i[1]){a=i[1];var p=a.lastIndexOf(".");if(a[p-1]=="."&&p--,p>0){o=a.substr(0,p),s=a.substr(p+1);var f=o.indexOf(".Module");f>0&&(a=a.substr(f+1),o=o.substr(0,f))}l=null}s&&(l=o,c=s),s==="<anonymous>"&&(c=null,a=null);var m={fileName:i[2]||null,lineNumber:parseInt(i[3],10)||null,functionName:a,typeName:l,methodName:c,columnNumber:parseInt(i[4],10)||null,native:u};return e._createParsedCallSite(m)}}).filter(function(n){return!!n})};function rC(r){for(var e in r)this[e]=r[e]}var Cle=["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"],wle=["topLevel","eval","native","constructor"];Cle.forEach(function(r){rC.prototype[r]=null,rC.prototype["get"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});wle.forEach(function(r){rC.prototype[r]=!1,rC.prototype["is"+r[0].toUpperCase()+r.substr(1)]=function(){return this[r]}});nC._createParsedCallSite=function(r){return new rC(r)}});var on,pt,Zt,Ft,oC,wr,sa,$a,ST,Co,ar,_T=ee(()=>{d();on="function",pt="object",Zt="undefined",Ft="prototype",oC="hasOwnProperty",wr=Object,sa=wr[Ft],$a=wr.assign,ST=wr.create,Co=wr.defineProperty,ar=sa[oC]});function Bn(r){r===void 0&&(r=!0);var e=r===!1?null:a8;return e||(typeof globalThis!==Zt&&(e=globalThis),!e&&typeof self!==Zt&&(e=self),!e&&typeof window!==Zt&&(e=window),!e&&typeof this!==Zt&&(e=this),a8=e),e}function aa(r){throw new TypeError(r)}function wo(r){var e=ST;if(e)return e(r);if(r==null)return{};var t=typeof r;t!==pt&&t!==on&&aa("Object prototype may only be an Object:"+r);function n(){}return n[Ft]=r,new n}var a8,ZL=ee(()=>{d();_T();a8=null});function _n(r,e){typeof e!==on&&e!==null&&aa("Class extends value "+String(e)+" is not a constructor or null"),eK(r,e);function t(){this.constructor=r}r[Ft]=e===null?wo(e):(t[Ft]=e[Ft],new t)}function qm(r,e){for(var t=0,n=e.length,i=r.length;t<n;t++,i++)r[i]=e[t];return r}var X1e,Z1e,Mle,xo,eK,l8=ee(()=>{d();_T();ZL();X1e=(Bn()||{}).Symbol,Z1e=(Bn()||{}).Reflect,Mle=function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)sa[oC].call(e,i)&&(r[i]=e[i])}return r},xo=$a||Mle,eK=function(r,e){return eK=wr.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n[oC](i)&&(t[i]=n[i])},eK(r,e)}});var c8=ee(()=>{d()});var lr=ee(()=>{d();_T();ZL();l8();c8()});var tK,u8=ee(()=>{"use strict";d();tK=100});var za,Ri,sC,Qa,Ut,ws,xc,ET,Yo,tt,Gm,jr,CT,Ym,$m,rK,aC,zm,_y,lC,qu,xs,Ey,Lp,Xa,Cy,Qm,Ds,la,Kp,Gu,wT,Fp,Za,wy,Up,cC,Wp,xT,xy,el,nK,iK,DT,Hn,$o,uC,Xm,dC,Zm,tl,PT,eh,Dy,Vp,pC,Nn=ee(()=>{d();za="initialize",Ri="name",sC="getNotifyMgr",Qa="identifier",Ut="push",ws="isInitialized",xc="config",ET="instrumentationKey",Yo="logger",tt="length",Gm="time",jr="processNext",CT="getProcessTelContext",Ym="addNotificationListener",$m="removeNotificationListener",rK="stopPollingInternalLogs",aC="onComplete",zm="getPlugin",_y="flush",lC="_extensions",qu="splice",xs="teardown",Ey="messageId",Lp="message",Xa="isAsync",Cy="_doTeardown",Qm="update",Ds="getNext",la="diagLog",Kp="setNextPlugin",Gu="createNew",wT="cookieCfg",Fp="indexOf",Za="substring",wy="userAgent",Up="split",cC="setEnabled",Wp="substr",xT="nodeType",xy="apply",el="replace",nK="enableDebugExceptions",iK="logInternalMessage",DT="toLowerCase",Hn="call",$o="type",uC="handler",Xm="listeners",dC="isChildEvt",Zm="getCtx",tl="setCtx",PT="complete",eh="traceId",Dy="spanId",Vp="traceFlags",pC="version"});var ft,oK,pn,sK,fC,Py,d8,zo,ca,Ty,jp,ky,Bp,TT,mC,th,Ii=ee(()=>{d();ft="",oK="channels",pn="core",sK="createPerfMgr",fC="disabled",Py="extensionConfig",d8="extensions",zo="processTelemetry",ca="priority",Ty="eventsSent",jp="eventsDiscarded",ky="eventsSendRequest",Bp="perfEvent",TT="errorToConsole",mC="warnToConsole",th="getPerfMgr"});function Gle(r){if(r){if(NT)return NT(r);var e=r[Ole]||r[Ft]||r[kT];if(e)return e}return null}function Ny(r,e){return typeof r===e}function fr(r){return r===void 0||typeof r===Zt}function Et(r){return r===null||fr(r)}function pK(r){return!Et(r)}function Yu(r,e){return!!(r&&ar[Hn](r,e))}function Ai(r){return!!(r&&typeof r===pt)}function $t(r){return!!(r&&typeof r===on)}function rh(r){var e=r;return e&&fn(e)&&(e=e[el](Hle,function(t,n){return n.toUpperCase()}),e=e[el](Jle,"_"),e=e[el](qle,function(t,n){return"_"+n})),e}function Br(r,e){if(r)for(var t in r)ar[Hn](r,t)&&e[Hn](r,t,r[t])}function nh(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Fle?r[I8](e):Yle(r,e)),t}function Yle(r,e){var t=!1,n=e?e[tt]:0,i=r?r[tt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Ry(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=Ule?r[S8](e):$le(r,e)),t}function $le(r,e){var t=!1,n=e?e[tt]:0;if(r&&n&&r[tt]>=n&&!(t=r===e)){for(var i=0;i<n;i++)if(r[i]!==e[i])return!1;t=!0}return t}function Rn(r,e){return r&&e?r[Fp](e)!==-1:!1}function Ay(r){return!!(r&&dK[Hn](r)==="[object Date]")}function zle(r){return!!(r&&dK[Hn](r)==="[object Array]")}function ih(r){return!!(r&&dK[Hn](r)==="[object Error]")}function fn(r){return typeof r=="string"}function Qo(r){return typeof r=="number"}function $u(r){return typeof r=="boolean"}function v8(r){var e=!1;if(r&&typeof r=="object"){var t=NT?NT(r):Gle(r);t?(t[kT]&&ar[Hn](t,kT)&&(t=t[kT]),e=typeof t===on&&E8[Hn](t)===Ble):e=!0}return e}function ua(r){if(r)return Vle?r[b8]():Qle(r)}function Qle(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[tt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Fe(r,e,t){var n=r[tt];try{for(var i=0;i<n&&!(i in r&&e[Hn](t||r,r[i],i,r)===-1);i++);}catch(o){}}function ri(r,e,t){if(r){if(r[p8])return r[p8](e,t);var n=r[tt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function oh(r,e,t){var n;if(r){if(r[f8])return r[f8](e,t);var i=r[tt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[Hn](o,r[s],r))}catch(a){}}return n}function sh(r,e,t){var n;if(r){if(r[m8])return r[m8](e,t);var i=r[tt],o=0;if(arguments[tt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Hr(r){return r&&(r=Kle&&r[lK]?r[lK]():r[el]?r[el](/^\s+|(?=\s)\s+$/g,ft):r),r}function Do(r){var e=typeof r;if(e!==on&&(e!==pt||r===null)&&aa("objKeys called on non-object"),!y8&&g8)return g8(r);var t=[];for(var n in r)r&&ar[Hn](r,n)&&t[Ut](n);if(y8)for(var i=aK[tt],o=0;o<i;o++)r&&ar[Hn](r,aK[o])&&t[Ut](aK[o]);return t}function Ps(r,e,t,n){if(h8)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),h8(r,e,i),!0}catch(o){}return!1}function C8(r){return r}function fK(r){return cK&&Br(r,function(e,t){(gt(t)||Ai(t))&&cK(t)}),Xo(r)}function ni(){var r=Date;return r.now?r.now():new r().getTime()}function ah(r){return ih(r)?r[Ri]:ft}function Zo(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Hp(r,e,t){var n;return r?(n=r[e],!n&&Et(n)&&(n=fr(t)?{}:t,r[e]=n)):n=fr(t)?{}:t,n}function da(r,e){return Et(r)?e:r}function hK(r){return!r}function My(r){return!!r}function ii(r){throw new Error(r)}function w8(r,e){var t=null,n=null;return $t(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][xy](n,i)}}function gK(r,e,t){if(r&&e&&Ai(r)&&Ai(e)){var n=function(o){if(fn(o)){var s=e[o];$t(s)?(!t||t(o,!0,e,r))&&(r[o]=w8(e,o)):(!t||t(o,!1,e,r))&&(Yu(r,o)&&delete r[o],Ps(r,o,function(){return e[o]},function(a){e[o]=a})||(r[o]=s))}};for(var i in e)n(i)}return r}function Jp(r,e,t,n,i){r&&e&&t&&(i!==!1||fr(r[e]))&&(r[e]=w8(t,n))}function lh(r,e,t,n){return r&&e&&Ai(r)&&gt(t)&&Fe(t,function(i){fn(i)&&Jp(r,i,e,i,n)}),r}function zu(r){return r&&$a&&(r=wr($a({},r))),r}function Oy(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[tt],c=!1,u=1;for(l>0&&$u(a)&&(c=a,a=s[u]||{},u++),Ai(a)||(a={});u<l;u++){var p=s[u],f=gt(p),m=Ai(p);for(var h in p){var g=f&&h in p||m&&ar[Hn](p,h);if(g){var v=p[h],S=void 0;if(c&&v&&((S=gt(v))||v8(v))){var _=a[h];S?gt(_)||(_=[]):v8(_)||(_={}),v=Oy(c,_,v)}v!==void 0&&(a[h]=v)}}}return a}var b8,I8,S8,p8,f8,m8,lK,_8,Ole,kT,h8,cK,Lle,g8,uK,Kle,Fle,Ule,Wle,Vle,jle,dK,E8,Ble,Hle,Jle,qle,NT,gt,y8,aK,Xo,mK,An=ee(()=>{d();lr();Nn();Ii();b8="toISOString",I8="endsWith",S8="startsWith",p8="indexOf",f8="map",m8="reduce",lK="trim",_8="toString",Ole="__proto__",kT="constructor",h8=Co,cK=wr.freeze,Lle=wr.seal,g8=wr.keys,uK=String[Ft],Kle=uK[lK],Fle=uK[I8],Ule=uK[S8],Wle=Date[Ft],Vle=Wle[b8],jle=Array.isArray,dK=sa[_8],E8=ar[_8],Ble=E8[Hn](wr),Hle=/-([a-z])/g,Jle=/([^\w\d_$])/g,qle=/^(\d+[\w\d_$])/,NT=Object.getPrototypeOf;gt=jle||zle;y8=!{toString:null}.propertyIsEnumerable("toString"),aK=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Xo=cK||C8,mK=Lle||C8});function Po(r){var e={};return Br(r,function(t,n){e[t]=n,e[n]=t}),fK(e)}var RT=ee(()=>{d();An()});var rl,x8=ee(()=>{d();RT();rl=Po({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5})});function Zle(){var r;return typeof globalThis!==MT&&(r=globalThis),!r&&typeof self!==MT&&(r=self),!r&&typeof window!==MT&&(r=window),!r&&typeof this!==MT&&(r=this),r||{}}function Xu(r,e){return r&&jT[Qu].hasOwnProperty.call(r,e)}function A8(r){return r&&(r===jT[Qu]||r===Array[Qu])}function EK(r){return A8(r)||r===Function[Qu]}function ch(r){var e;if(r){if(gC)return gC(r);var t=r[R8]||r[Qu]||(r[KT]?r[KT][Qu]:null);e=r[OT]||t,Xu(r,OT)||(delete r[vK],e=r[OT]=r[vK]||r[OT],r[vK]=t)}return e}function WT(r,e){var t=[];if(T8)t=T8(r);else for(var n in r)typeof n=="string"&&Xu(r,n)&&t.push(n);if(t&&t.length>0)for(var i=0;i<t.length;i++)e(t[i])}function CK(r,e,t){return e!==KT&&typeof r[e]===FT&&(t||Xu(r,e))}function VT(r){throw new TypeError("DynamicProto: "+r)}function ece(r){var e={};return WT(r,function(t){!e[t]&&CK(r,t,!1)&&(e[t]=r[t])}),e}function wK(r,e){for(var t=r.length-1;t>=0;t--)if(r[t]===e)return!0;return!1}function tce(r,e,t,n){function i(l,c,u){var p=c[u];if(p[bK]&&n){var f=l[UT]||{};f[hC]!==!1&&(p=(f[c[Ly]]||{})[u]||p)}return function(){return p.apply(l,arguments)}}var o={};WT(t,function(l){o[l]=i(e,t,l)});for(var s=ch(r),a=[];s&&!EK(s)&&!wK(a,s);)WT(s,function(l){!o[l]&&CK(s,l,!gC)&&(o[l]=i(e,s,l))}),a.push(s),s=ch(s);return o}function rce(r,e,t,n){var i=null;if(r&&Xu(t,Ly)){var o=r[UT]||{};if(i=(o[t[Ly]]||{})[e],i||VT("Missing ["+e+"] "+FT),!i[IK]&&o[hC]!==!1){for(var s=!Xu(r,e),a=ch(r),l=[];s&&a&&!EK(a)&&!wK(l,a);){var c=a[e];if(c){s=c===n;break}l.push(a),a=ch(a)}try{s&&(r[e]=i),i[IK]=1}catch(u){o[hC]=!1}}}return i}function nce(r,e,t){var n=e[r];return n===t&&(n=ch(e)[r]),typeof n!==FT&&VT("["+r+"] is not a "+FT),n}function ice(r,e,t,n,i){function o(l,c){var u=function(){var p=rce(this,c,l,u)||nce(c,l,u);return p.apply(this,arguments)};return u[bK]=1,u}if(!A8(r)){var s=t[UT]=t[UT]||{},a=s[e]=s[e]||{};s[hC]!==!1&&(s[hC]=!!i),WT(t,function(l){CK(t,l,!1)&&t[l]!==n[l]&&(a[l]=t[l],delete t[l],(!Xu(r,l)||r[l]&&!r[l][bK])&&(r[l]=o(r,l)))})}}function oce(r,e){if(gC){for(var t=[],n=ch(e);n&&!EK(n)&&!wK(t,n);){if(n===r)return!0;t.push(n),n=ch(n)}return!1}return!0}function yK(r,e){return Xu(r,Qu)?r.name||e||D8:((r||{})[KT]||{}).name||e||D8}function Be(r,e,t,n){Xu(r,Qu)||VT("theClass is an invalid class definition.");var i=r[Qu];oce(i,e)||VT("["+yK(r)+"] not in hierarchy of ["+yK(e)+"]");var o=null;Xu(i,Ly)?o=i[Ly]:(o=Xle+yK(r,"_")+"$"+_K.n,_K.n++,i[Ly]=o);var s=Be[N8],a=!!s[LT];a&&n&&n[LT]!==void 0&&(a=!!n[LT]);var l=ece(e),c=tce(i,e,l,a);t(e,c);var u=!!gC&&!!s[SK];u&&n&&(u=!!n[SK]),ice(i,o,e,l,u!==!1)}var AT,MT,KT,Qu,FT,UT,bK,Ly,Xle,IK,hC,N8,D8,R8,OT,P8,vK,LT,SK,jT,gC,T8,k8,_K,mr=ee(()=>{d();MT="undefined",KT="constructor",Qu="prototype",FT="function",UT="_dynInstFuncs",bK="_isDynProxy",Ly="_dynClass",Xle="_dynCls$",IK="_dynInstChk",hC=IK,N8="_dfOpts",D8="_unknown_",R8="__proto__",OT="_dyn"+R8,P8="__dynProto$Gbl",vK="_dynInstProto",LT="useBaseInst",SK="setInstFuncs",jT=Object,gC=jT.getPrototypeOf,T8=jT.getOwnPropertyNames;k8=Zle(),_K=k8[P8]||(k8[P8]={o:(AT={},AT[SK]=!0,AT[LT]=!0,AT),n:1e3});Be[N8]=_K.o});function F8(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Ft];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!fr(i[e])}catch(o){}}return t}function NK(r){K8=r}function mn(r){var e=Bn();return e&&e[r]?e[r]:r===M8&&vC()?window:null}function vC(){return!!(typeof window===pt&&window)}function Dc(){return vC()?window:mn(M8)}function BT(){return!!(typeof document===pt&&document)}function es(){return BT()?document:mn(sce)}function yC(){return!!(typeof navigator===pt&&navigator)}function Ts(){return yC()?navigator:mn(lce)}function HT(){return!!(typeof history===pt&&history)}function RK(){return HT()?history:mn(cce)}function uh(r){if(r&&K8){var e=mn("__mockLocation");if(e)return e}return typeof location===pt&&location?location:mn(uce)}function bC(){return typeof console!==Zt?console:mn(dce)}function Fy(){return mn(pce)}function dh(){return!!(typeof JSON===pt&&JSON||mn(O8)!==null)}function Uy(){return dh()?JSON||mn(O8):null}function IC(){return mn(fce)}function SC(){return mn(mce)}function Zu(){var r=Ts();return r&&r.product?r.product===hce:!1}function nl(){var r=Ts();if(r&&(r[wy]!==DK||xK===null)){DK=r[wy];var e=(DK||ft)[DT]();xK=Rn(e,TK)||Rn(e,kK)}return xK}function AK(r){if(r===void 0&&(r=null),!r){var e=Ts()||{};r=e?(e[wy]||ft)[DT]():ft}var t=(r||ft)[DT]();if(Rn(t,TK)){var n=es()||{};return Math.max(parseInt(t[Up](TK)[1]),n[ace]||0)}else if(Rn(t,kK)){var i=parseInt(t[Up](kK)[1]);if(i)return i+4}return null}function sn(r){var e=Object[Ft].toString[Hn](r),t=ft;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Ri]+"'":dh()&&(t=Uy().stringify(r)),e+t}function qp(){return PK===null&&(PK=yC()&&!!Ts().sendBeacon),PK}function Wy(r){var e=!1;try{e=!!mn("fetch");var t=mn("Request");e&&r&&t&&(e=F8(t,"keepalive"))}catch(n){}return e}function ph(){return Ky===null&&(Ky=typeof XDomainRequest!==Zt,Ky&&Vy()&&(Ky=Ky&&!F8(mn(L8),"withCredentials"))),Ky}function Vy(){var r=!1;try{var e=mn(L8);r=!!e}catch(t){}return r}function U8(r,e){if(r)for(var t=0;t<r[tt];t++){var n=r[t];if(n[Ri]&&n[Ri]===e)return n}return{}}function MK(r){var e=es();return e&&r?U8(e.querySelectorAll("meta"),r).content:null}function OK(r){var e,t=Fy();if(t){var n=t.getEntriesByType("navigation")||[];e=U8((n[tt]>0?n[0]:{}).serverTiming,r).description}return e}var M8,sce,ace,lce,cce,uce,dce,pce,O8,fce,mce,hce,TK,kK,L8,xK,DK,K8,Ky,PK,pa=ee(()=>{"use strict";d();lr();Nn();An();Ii();M8="window",sce="document",ace="documentMode",lce="navigator",cce="history",uce="location",dce="console",pce="performance",O8="JSON",fce="crypto",mce="msCrypto",hce="ReactNative",TK="msie",kK="trident/",L8="XMLHttpRequest",xK=null,DK=null,K8=!1,Ky=null,PK=null});function gce(r,e){return function(){var t=arguments,n=KK(e);if(n){var i=n.listener;i&&i[r]&&i[r][xy](i,t)}}}function vce(){var r=mn("Microsoft");return r&&(qT=r.ApplicationInsights),qT}function KK(r){var e=qT;return!e&&r.disableDbgExt!==!0&&(e=qT||vce()),e?e.ChromeDbgExt:null}function W8(r){if(!JT){JT={};for(var e=0;e<LK[tt];e++)JT[LK[e]]=gce(LK[e],r)}return JT}var LK,qT,JT,FK=ee(()=>{d();Nn();pa();LK=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],qT=null});function V8(r){return r?'"'+r[el](/\"/g,ft)+'"':ft}function j8(r,e){var t=bC();if(t){var n="log";t[r]&&(n=r),$t(t[n])&&t[n](e)}}function _C(r,e){return(r||{})[Yo]||new il(e)}function UK(r){return r||new il}function en(r,e,t,n,i,o){o===void 0&&(o=!1),UK(r).throwInternal(e,t,n,i,o)}function ol(r,e){UK(r)[mC](e)}function WK(r,e,t){UK(r)[iK](e,t)}var yce,bce,Ice,fh,il,Gp=ee(()=>{"use strict";d();mr();Nn();FK();pa();An();Ii();yce="AI (Internal): ",bce="AI: ",Ice="AITR_";fh=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Ey]=e,o[Lp]=(n?bce:yce)+e;var s=ft;dh()&&(s=Uy().stringify(i));var a=(t?" message:"+V8(t):ft)+(i?" props:"+V8(s):ft);o[Lp]+=a}return r.dataType="MessageData",r}();il=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[nK]=function(){return a},l.throwInternal=function(m,h,g,v,S){S===void 0&&(S=!1);var _=new fh(h,g,S,v);if(a)throw sn(_);var D=m===1?TT:mC;if(fr(_[Lp]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[Ey];!n[P]&&i>=m&&(l[D](_[Lp]),n[P]=!0)}else i>=m&&l[D](_[Lp]);c(m,_)}},l[mC]=function(m){j8("warn",m),f("warning",m)},l[TT]=function(m){j8("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[iK]=c;function c(m,h){if(!p()){var g=!0,v=Ice+h[Ey];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[Ut](h),t++,f(m===1?"error":"warn",h)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new fh(23,S,!1);l.queue[Ut](_),m===1?l[TT](S):l[mC](S)}}}function u(m){i=da(m.loggingLevelConsole,0),o=da(m.loggingLevelTelemetry,1),s=da(m.maxMessageLimit,25),a=da(m[nK],!1)}function p(){return t>=s}function f(m,h){var g=KK(e||{});g&&g[la]&&g[la](m,h)}})}return r.__ieDyn=1,r}()});function En(r,e,t,n,i){if(r){var o=r;if(o[th]&&(o=o[th]()),o){var s=void 0,a=o[Zm](VK);try{if(s=o.create(e(),n,i),s){if(a&&s[tl]&&(s[tl](mh[jK],a),a[Zm]&&a[tl])){var l=a[Zm](mh[EC]);l||(l=[],a[tl](mh[EC],l)),l[Ut](s)}return o[tl](VK,s),t(s)}}catch(c){s&&s[tl]&&s[tl]("exception",c)}finally{s&&o.fire(s),o[tl](VK,a)}}}return t()}function BK(){return Sce}var jy,jK,EC,Sce,mh,CC,VK,wC=ee(()=>{d();mr();Nn();An();Ii();jy="ctx",jK="ParentContextKey",EC="ChildrenContextKey",Sce=null,mh=function(){function r(e,t,n){var i=this,o=!1;if(i.start=ni(),i[Ri]=e,i[Xa]=n,i[dC]=function(){return!1},$t(t)){var s;o=Ps(i,"payload",function(){return!s&&$t(t)&&(s=t(),t=null),s})}i[Zm]=function(a){return a?a===r[jK]||a===r[EC]?i[a]:(i[jy]||{})[a]:null},i[tl]=function(a,l){if(a)if(a===r[jK])i[a]||(i[dC]=function(){return!0}),i[a]=l;else if(a===r[EC])i[a]=l;else{var c=i[jy]=i[jy]||{};c[a]=l}},i[PT]=function(){var a=0,l=i[Zm](r[EC]);if(gt(l))for(var c=0;c<l[tt];c++){var u=l[c];u&&(a+=u[Gm])}i[Gm]=ni()-i.start,i.exTime=i[Gm]-a,i[PT]=function(){},!o&&$t(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),CC=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new mh(n,i,o)},t.fire=function(n){n&&(n[PT](),e&&$t(e[Bp])&&e[Bp](n))},t[tl]=function(n,i){if(n){var o=t[jy]=t[jy]||{};o[n]=i}},t[Zm]=function(n){return(t[jy]||{})[n]}})}return r.__ieDyn=1,r}(),VK="CoreUtils.doPerf"});function J8(r){r<0&&(r>>>=0),xC=123456789+r&Yp,DC=987654321-r&Yp,H8=!0}function q8(){try{var r=ni()&2147483647;J8((Math.random()*B8^r)+r)}catch(e){}}function By(r){return r>0?Math.floor(sl()/Yp*(r+1))>>>0:0}function sl(r){var e=0,t=IC()||SC();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Yp),e===0&&nl()&&(H8||q8(),e=PC()&Yp),e===0&&(e=Math.floor(B8*Math.random()|0)),r||(e>>>=0),e}function GT(r){r?J8(r):q8()}function PC(r){DC=36969*(DC&65535)+(DC>>16)&Yp,xC=18e3*(xC&65535)+(xC>>16)&Yp;var e=(DC<<16)+(xC&65535)>>>0&Yp|0;return r||(e>>>=0),e}function $p(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=sl()>>>0,n=0,i=ft;i[tt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(sl()<<2&4294967295|t&3)>>>0,n=0);return i}var B8,Yp,H8,xC,DC,YT=ee(()=>{d();Nn();pa();An();Ii();B8=4294967296,Yp=4294967295,H8=!1,xC=123456789,DC=987654321});function Cce(r,e,t){if(G8)try{return G8(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function $8(r){return r[xT]===1||r[xT]===9||!+r[xT]}function wce(r,e){var t=e[r.id];if(!t){t={};try{$8(e)&&(Cce(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function al(r,e){return e===void 0&&(e=!1),rh(r+Ece+++(e?"."+Y8:ft)+_ce)}function $T(r){var e={id:al("_aiData-"+(r||ft)+"."+Y8),accept:function(t){return $8(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[rh(n)]:(o&&(s=wce(e,t),s[rh(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var G8,Y8,_ce,Ece,TC=ee(()=>{d();lr();Nn();An();Ii();YT();G8=Co,Y8="2.8.10",_ce="."+$p(6),Ece=0});function xce(r,e){var t=ed[zp]||XT[zp];return t||(t=ed[zp]=ed(r,e),XT[zp]=t),t}function QT(r){return r?r.isEnabled():!0}function Dce(r){var e=r[wT]=r[wT]||{};if(Zo(e,"domain",r.cookieDomain,pK,Et),Zo(e,"path",r.cookiePath||"/",null,Et),Et(e[qK])){var t=void 0;fr(r[X8])||(t=!r[X8]),fr(r[Z8])||(t=!r[Z8]),e[qK]=t}return e}function o5(r,e){return e&&r&&gt(r.ignoreCookies)?r.ignoreCookies[Fp](e)!==-1:!1}function Pce(r,e){return e&&r&&gt(r.blockedCookies)&&r.blockedCookies[Fp](e)!==-1?!0:o5(r,e)}function Qp(r,e){var t;if(r)t=r.getCookieMgr();else if(e){var n=e[wT];n[zp]?t=n[zp]:t=ed(e)}return t||(t=xce(e,(r||{})[Yo])),t}function ed(r,e){var t,n=Dce(r||XT),i=n.path||"/",o=n.domain,s=n[qK]!==!1,a=(t={isEnabled:function(){var l=s&&ll(e),c=XT[zp];return l&&c&&a!==c&&(l=QT(c)),l}},t[cC]=function(l){s=l!==!1},t.set=function(l,c,u,p,f){var m=!1;if(QT(a)&&!Pce(n,l)){var h={},g=Hr(c||ft),v=g[Fp](";");if(v!==-1&&(g=Hr(c[Za](0,v)),h=s5(c[Za](v+1))),Zo(h,"domain",p||o,My,fr),!Et(u)){var S=nl();if(fr(h[HK])){var _=ni(),D=_+u*1e3;if(D>0){var P=new Date;P.setTime(D),Zo(h,HK,r5(P,S?z8:Q8)||r5(P,S?z8:Q8)||ft,My)}}S||Zo(h,"max-age",ft+u,null,fr)}var M=uh();M&&M.protocol==="https:"&&(Zo(h,"secure",null,null,fr),JK===null&&(JK=!Hy((Ts()||{})[wy])),JK&&Zo(h,"SameSite","None",null,fr)),Zo(h,"path",f||i,null,fr);var x=n.setCookie||i5;x(l,n5(g,h)),m=!0}return m},t.get=function(l){var c=ft;return QT(a)&&!o5(n,l)&&(c=(n.getCookie||Tce)(l)),c},t.del=function(l,c){var u=!1;return QT(a)&&(u=a.purge(l,c)),u},t.purge=function(l,c){var u,p=!1;if(ll(e)){var f=(u={},u.path=c||"/",u[HK]="Thu, 01 Jan 1970 00:00:01 GMT",u);nl()||(f["max-age"]="0");var m=n.delCookie||i5;m(l,n5(ft,f)),p=!0}return p},t);return a[zp]=a,a}function ll(r){if(zT===null){zT=!1;try{var e=kC||{};zT=e[GK]!==void 0}catch(t){en(r,2,68,"Cannot access document.cookie - "+ah(t),{exception:sn(t)})}}return zT}function s5(r){var e={};if(r&&r[tt]){var t=Hr(r)[Up](";");Fe(t,function(n){if(n=Hr(n||ft),n){var i=n[Fp]("=");i===-1?e[n]=null:e[Hr(n[Za](0,i))]=Hr(n[Za](i+1))}})}return e}function r5(r,e){return $t(r[e])?r[e]():null}function n5(r,e){var t=r||ft;return Br(e,function(n,i){t+="; "+n+(Et(i)?ft:"="+i)}),t}function Tce(r){var e=ft;if(kC){var t=kC[GK]||ft;e5!==t&&(t5=s5(t),e5=t),e=Hr(t5[r]||ft)}return e}function i5(r,e){kC&&(kC[GK]=r+"="+e)}function Hy(r){return fn(r)?!!(Rn(r,"CPU iPhone OS 12")||Rn(r,"iPad; CPU OS 12")||Rn(r,"Macintosh; Intel Mac OS X 10_14")&&Rn(r,"Version/")&&Rn(r,"Safari")||Rn(r,"Macintosh; Intel Mac OS X 10_14")&&nh(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Rn(r,"Chrome/5")||Rn(r,"Chrome/6")||Rn(r,"UnrealEngine")&&!Rn(r,"Chrome")||Rn(r,"UCBrowser/12")||Rn(r,"UCBrowser/11")):!1}var z8,Q8,GK,HK,qK,X8,Z8,zp,zT,JK,e5,kC,t5,XT,YK=ee(()=>{d();Nn();Gp();pa();An();Ii();z8="toGMTString",Q8="toUTCString",GK="cookie",HK="expires",qK="enabled",X8="isCookieUseDisabled",Z8="disableCookiesUsage",zp="_ckMgr",zT=null,JK=null,e5=null,kC=es(),t5={},XT={}});function d5(r){return r&&r[el]?r[el](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,ft):r}function tk(r,e){var t;if(e){var n=ft;gt(e)?(n=ft,Fe(e,function(o){o=d5(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=d5(e),n&&(n[0]!=="."&&(n="."+n),r=(r||ft)+n)}var i=Ace.exec(r||ft)||[];return t={},t[$o]=i[1],t.ns=(i[2]||ft).replace(kce,".").replace(Nce,ft)[Up](".").sort().join("."),t}function $K(r,e,t){var n=[],i=RC.get(r,ZT,{},!1),o=tk(e,t);return Br(i,function(s,a){Fe(a,function(l){var c;(!o[$o]||o[$o]===l.evtName[$o])&&(!o.ns||o.ns===o.ns)&&n[Ut]((c={},c[Ri]=l.evtName[$o]+(l.evtName.ns?"."+l.evtName.ns:ft),c.handler=l[uC],c))})}),n}function b5(r,e,t){t===void 0&&(t=!0);var n=RC.get(r,ZT,{},t),i=n[e];return i||(i=n[e]=[]),i}function I5(r,e,t,n){r&&e&&e[$o]&&(r[u5]?r[u5](e[$o],t,n):r[c5]&&r[c5](f5+e[$o],t))}function Mce(r,e,t,n){var i=!1;return r&&e&&e[$o]&&t&&(r[l5]?(r[l5](e[$o],t,n),i=!0):r[a5]&&(r[a5](f5+e[$o],t),i=!0)),i}function p5(r,e,t,n){for(var i=e[tt];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(I5(r,o.evtName,o[uC],o.capture),e[qu](i,1))}}function Oce(r,e,t){if(e[$o])p5(r,b5(r,e[$o]),e,t);else{var n=RC.get(r,ZT,{});Br(n,function(i,o){p5(r,o,e,t)}),Do(n)[tt]===0&&RC.kill(r,ZT)}}function td(r,e){var t;return e?(gt(e)?t=[r].concat(e):t=[r,e],t=tk("xx",t).ns[Up](".")):t=r,t}function hh(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=tk(e,n);if(s=Mce(r,a,t,i),s&&RC.accept(r)){var l=(o={guid:Rce++,evtName:a},o[uC]=t,o.capture=i,o);b5(r,a.type)[Ut](l)}}catch(c){}return s}function gh(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=tk(e,n),s=!1;Oce(r,o,function(a){return o.ns&&!t||a[uC]===t?(s=!0,!0):!1}),s||I5(r,o,t,i)}catch(a){}}function qy(r,e,t,n){return n===void 0&&(n=!1),hh(r,e,t,null,n)}function Gy(r,e,t,n){n===void 0&&(n=!1),gh(r,e,t,null,n)}function Zp(r,e,t){var n=!1,i=Dc();i&&(n=hh(i,r,e,t),n=hh(i.body,r,e,t)||n);var o=es();return o&&(n=hh(o,r,e,t)||n),n}function rk(r,e,t){var n=Dc();n&&(gh(n,r,e,t),gh(n.body,r,e,t));var i=es();i&&gh(i,r,e,t)}function Jy(r,e,t,n){var i=!1;return e&&r&&r[tt]>0&&Fe(r,function(o){o&&(!t||ri(t,o)===-1)&&(i=Zp(o,e,n)||i)}),i}function nk(r,e,t,n){var i=!1;return e&&r&&gt(r)&&(i=Jy(r,e,t,n),!i&&t&&t[tt]>0&&(i=Jy(r,e,null,n))),i}function Xp(r,e,t){r&&gt(r)&&Fe(r,function(n){n&&rk(n,e,t)})}function vh(r,e,t){return nk([g5,h5,ek],r,e,t)}function AC(r,e){Xp([g5,h5,ek],r,e)}function Yy(r,e,t){function n(s){var a=es();r&&a&&a.visibilityState==="hidden"&&r(s)}var i=td(v5,t),o=Jy([ek],r,e,i);return(!e||ri(e,NC)===-1)&&(o=Jy([NC],n,e,i)||o),!o&&e&&(o=Yy(r,null,t)),o}function MC(r,e){var t=td(v5,e);Xp([ek],r,t),Xp([NC],null,t)}function $y(r,e,t){function n(s){var a=es();r&&a&&a.visibilityState==="visible"&&r(s)}var i=td(y5,t),o=Jy([m5],r,e,i);return o=Jy([NC],n,e,i)||o,!o&&e&&(o=$y(r,null,t)),o}function OC(r,e){var t=td(y5,e);Xp([m5],r,t),Xp([NC],null,t)}var f5,a5,l5,c5,u5,ZT,NC,ek,m5,h5,g5,v5,y5,kce,Nce,Rce,RC,Ace,zK=ee(()=>{d();Nn();TC();pa();An();Ii();f5="on",a5="attachEvent",l5="addEventListener",c5="detachEvent",u5="removeEventListener",ZT="events",NC="visibilitychange",ek="pagehide",m5="pageshow",h5="unload",g5="beforeunload",v5=al("aiEvtPageHide"),y5=al("aiEvtPageShow"),kce=/\.[\.]+/g,Nce=/[\.]+$/,Rce=1,RC=$T("events"),Ace=/^([^.]*)(?:\.(.+)|)/});function zy(){var r=rd();return r[Za](0,8)+"-"+r[Za](8,12)+"-"+r[Za](12,16)+"-"+r[Za](16,20)+"-"+r[Za](20)}function Qy(){var r=Fy();return r&&r.now?r.now():ni()}function rd(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=ft,t,n=0;n<4;n++)t=sl(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(sl()&3)|0];return e[Wp](0,8)+e[Wp](9,4)+"4"+e[Wp](13,3)+i+e[Wp](16,3)+e[Wp](19,12)}var QK,XK=ee(()=>{"use strict";d();Nn();pa();zK();An();Ii();YT();QK={Attach:qy,AttachEvent:qy,Detach:Gy,DetachEvent:Gy}});function nd(r,e,t){return r&&r[tt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function _5(r,e,t){return nd(r,e)?r:t}function E5(r){(isNaN(r)||r<0||r>255)&&(r=1);for(var e=r.toString(16);e[tt]<2;)e="0"+e;return e}function tF(r,e,t,n){var i;return i={},i[pC]=nd(n,2,eF)?n:ZK,i[eh]=Xy(r)?r:rd(),i.spanId=Zy(e)?e:rd()[Wp](0,16),i.traceFlags=t>=0&&t<=255?t:1,i}function LC(r){var e;if(!r||(gt(r)&&(r=r[0]||""),!r||!fn(r)||r[tt]>8192))return null;var t=Lce.exec(Hr(r));return!t||t[1]===eF||t[2]===ik||t[3]===ok?null:(e={},e[pC]=t[1],e[eh]=t[2],e[Dy]=t[3],e[Vp]=parseInt(t[4],16),e)}function Xy(r){return nd(r,32,ik)}function Zy(r){return nd(r,16,ok)}function sk(r){return!(!r||!nd(r[pC],2,eF)||!nd(r[eh],32,ik)||!nd(r[Dy],16,ok)||!nd(E5(r[Vp]),2))}function rF(r){return sk(r)?(r[Vp]&S5)===S5:!1}function nF(r){if(r){var e=E5(r[Vp]);nd(e,2)||(e="01");var t=r[pC]||ZK;return t!=="00"&&t!=="ff"&&(t=ZK),"".concat(t,"-").concat(_5(r.traceId,32,ik),"-").concat(_5(r.spanId,16,ok),"-").concat(e)}return""}function iF(){var r="traceparent",e=LC(MK(r));return e||(e=LC(OK(r))),e}var Lce,ZK,eF,ik,ok,S5,oF=ee(()=>{d();Nn();XK();pa();An();Lce=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]*)?$/,ZK="00",eF="ff",ik="00000000000000000000000000000000",ok="0000000000000000",S5=1});function id(r){return Kce.get(r,"state",{},!0)}function ak(r,e){for(var t=[],n=null,i=r[Ds](),o;i;){var s=i[zm]();if(s){n&&$t(n[Kp])&&$t(s[zo])&&n[Kp](s);var a=!1;$t(s[ws])?a=s[ws]():(o=id(s),a=o[ws]),a||t[Ut](s),n=s,i=i[Ds]()}}Fe(t,function(l){var c=r[pn]();l[za](r.getCfg(),c,e,r[Ds]()),o=id(l),!l[pn]&&!o[pn]&&(o[pn]=c),o[ws]=!0,delete o[xs]})}function lk(r){return r.sort(function(e,t){var n=0;if(t){var i=$t(t[zo]);$t(e[zo])?n=i?e[ca]-t[ca]:1:i&&(n=-1)}else n=e?1:-1;return n})}function C5(r){var e={};return{getName:function(){return e[Ri]},setName:function(t){r&&r.setName(t),e[Ri]=t},getTraceId:function(){return e[eh]},setTraceId:function(t){r&&r.setTraceId(t),Xy(t)&&(e[eh]=t)},getSpanId:function(){return e[Dy]},setSpanId:function(t){r&&r.setSpanId(t),Zy(t)&&(e[Dy]=t)},getTraceFlags:function(){return e[Vp]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[Vp]=t}}}var Kce,ck=ee(()=>{"use strict";d();Nn();TC();An();Ii();oF();Kce=$T("plugin")});function Uce(r,e,t){for(;r;){if(r[zm]()===t)return r;r=r[Ds]()}return Pc([t],e[xc]||{},e)}function sF(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Uce(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return _C(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[Ut]({func:f,self:fr(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[Ds]():null,!f){var m=o;m&&m[tt]>0&&(Fe(m,function(h){try{h.func[Hn](h.self,h.args)}catch(g){en(t[Yo],2,73,"Unexpected Exception during onComplete - "+sn(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[Py];v&&f&&(g=v[f])}if(!g)g=m;else if(Ai(m)&&h!==0){var S=Oy(!0,m,g);e&&h===2&&Br(m,function(_){if(Et(S[_])){var D=e[_];Et(D)||(S[_]=D)}}),g=S}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!Et(v[m])?g=v[m]:e&&!Et(e[m])&&(g=e[m]),Et(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[zm]();h&&f(h)}}return s}function ts(r,e,t,n){var i=sF(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[zo](l,o),!c}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Pc(l,e,t,c)),ts(l||o[Ds](),e,t,c)}return o[jr]=s,o[Gu]=a,o}function eb(r,e,t){var n=e[xc]||{},i=sF(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Pc(l,n,e,c)),eb(l||o[Ds](),e,c)}return o[jr]=s,o[Gu]=a,o}function KC(r,e,t){var n=e[xc]||{},i=sF(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){$t(c[Qm])&&c[Qm](o,l)})}function a(l,c){return l===void 0&&(l=null),gt(l)&&(l=Pc(l,n,e,c)),KC(l||o[Ds](),e,c)}return o[jr]=s,o[Gu]=a,o}function Pc(r,e,t,n){var i=null,o=!n;if(gt(r)&&r[tt]>0){var s=null;Fe(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&$t(a[zo])){var l=Wce(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Pc([n],e,t):i}function Wce(r,e,t){var n=null,i=$t(r[zo]),o=$t(r[Kp]),s;r?s=r[Qa]+"-"+r[ca]+"-"+D5++:s="Unknown-0-"+D5++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&$t(r[x5])&&(m=r[x5]()),m||(m=ts(a,e,t)),m}function c(m,h,g,v,S){var _=!1,D=r?r[Qa]:Fce,P=m[w5];return P||(P=m[w5]={}),m.setNext(n),r&&En(m[pn](),function(){return D+":"+g},function(){P[s]=!0;try{var M=n?n._id:ft;M&&(P[M]=!1),_=h(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&en(m[la](),1,73,"Plugin ["+D+"] failed during "+g+" - "+sn(A)+", run flags: "+sn(P))}},v,S),_}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var S=id(r);return S[xs]||S[fC]?!1:(o&&r[Kp](n),r[zo](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[jr](m)}function p(m,h){function g(){var v=!1;if(r){var S=id(r),_=r[pn]||S[pn];r&&(!_||_===m.core())&&!S[xs]&&(S[pn]=null,S[xs]=!0,S[ws]=!1,r[xs]&&r[xs](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[Xa])||m[jr](h)}function f(m,h){function g(){var v=!1;if(r){var S=id(r),_=r[pn]||S[pn];r&&(!_||_===m.core())&&!S[xs]&&r[Qm]&&r[Qm](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[jr](h)}return Xo(a)}var Fce,w5,x5,D5,aF,FC=ee(()=>{"use strict";d();Nn();Gp();pa();An();Ii();wC();ck();Fce="TelemetryPluginChain",w5="_hasRun",x5="_getTelCtx",D5=0;aF=function(){function r(e,t,n,i){var o=this,s=ts(e,t,n,i);lh(o,s,Do(s))}return r}()});function P5(r,e,t){e&&gt(e)&&e[tt]>0&&(e=e.sort(function(n,i){return n[ca]-i[ca]}),Fe(e,function(n){n[ca]<UC&&ii(Vce+n[Qa])}),r[Ut]({queue:Xo(e),chain:Pc(e,t[xc],t)}))}function T5(r,e){function t(){return ts(null,e[xc],e,null)}function n(c,u,p,f){var m=c?c[tt]+1:1;function h(){m--,m===0&&(f&&f(),f=null)}m>0&&Fe(c,function(g){if(g&&g.queue[tt]>0){var v=g.chain,S=u[Gu](v);S[aC](h),p(S)}else m--}),h()}function i(c,u){var p=u||{reason:0};return n(r,c,function(f){f[jr](p)},function(){c[jr](p)}),!0}function o(c,u){var p=u||{reason:0,isAsync:!1};return n(r,c,function(f){f[jr](p)},function(){c[jr](p),a=!1}),!0}function s(c){var u=null;return r&&r[tt]>0&&Fe(r,function(p){if(p&&p.queue[tt]>0&&(Fe(p.queue,function(f){if(f[Qa]===c)return u=f,-1}),u))return-1}),u}var a=!1,l={identifier:"ChannelControllerPlugin",priority:UC,initialize:function(c,u,p,f){a=!0,Fe(r,function(m){m&&m.queue[tt]>0&&ak(ts(m.chain,c,u),p)})},isInitialized:function(){return a},processTelemetry:function(c,u){n(r,u||t(),function(p){p[jr](c)},function(){u[jr](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(u){u.pause&&u.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(u){u.resume&&u.resume()})},null)},teardown:o,getChannel:s,flush:function(c,u,p,f){var m=1,h=!1,g=null;f=f||5e3;function v(){m--,h&&m===0&&(g&&(clearTimeout(g),g=null),u&&u(h),u=null)}return n(r,t(),function(S){S.iterate(function(_){if(_[_y]){m++;var D=!1;_[_y](c,function(){D=!0,v()},p)||D||(c&&g==null?g=setTimeout(function(){g=null,v()},f):v())}})},function(){h=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function k5(r,e,t){var n=[];if(r&&Fe(r,function(o){return P5(n,o,t)}),e){var i=[];Fe(e,function(o){o[ca]>UC&&i[Ut](o)}),P5(n,i,t)}return n}var UC,Vce,N5=ee(()=>{d();Nn();An();Ii();FC();ck();UC=500,Vce="Channel has invalid priority - "});function yh(){var r=[];function e(n){n&&r[Ut](n)}function t(n,i){Fe(r,function(o){try{o(n,i)}catch(s){en(n[la](),2,73,"Unexpected error calling unload handler - "+sn(s))}}),r=[]}return{add:e,run:t}}var uk=ee(()=>{d();Nn();Gp();pa();An()});var ef,bh,lF=ee(()=>{"use strict";d();mr();Nn();An();Ii();FC();uk();ef="getPlugin",bh=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(u){u[za]=function(p,f,m,h){l(p,f,h),t=!0},u[xs]=function(p,f){var m,h=u[pn];if(!h||p&&h!==p[pn]())return;var g,v=!1,S=p||eb(null,h,i&&i[ef]?i[ef]():i),_=f||(m={reason:0},m[Xa]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],Fe(P,function(M){M.rm()}),g===!0&&S[jr](_),c()}}return!u[Cy]||u[Cy](S,_,D)!==!0?D():g=!0,g},u[Qm]=function(p,f){var m=u[pn];if(!m||p&&m!==p[pn]())return;var h,g=!1,v=p||KC(null,m,i&&i[ef]?i[ef]():i),S=f||{reason:0};function _(){g||(g=!0,l(v.getCfg(),v.core(),v[Ds]()))}return!u._doUpdate||u._doUpdate(v,S,_)!==!0?_():h=!0,h},u._addHook=function(p){p&&(gt(p)?s=s.concat(p):s[Ut](p))},Jp(u,"_addUnloadCb",function(){return o},"add")}),e[la]=function(u){return a(u)[la]()},e[ws]=function(){return t},e.setInitialized=function(u){t=u},e[Kp]=function(u){i=u},e[jr]=function(u,p){p?p[jr](u):i&&$t(i[zo])&&i[zo](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||ts(null,{},e[pn]);i&&i[ef]?p=f[Gu](null,i[ef]):p=f[Gu](null,i)}return p}function l(u,p,f){u&&Zo(u,Py,[],null,Et),!f&&p&&(f=p[CT]()[Ds]());var m=i;i&&i[ef]&&(m=i[ef]()),e[pn]=p,n=ts(f,u,p,m)}function c(){t=!1,e[pn]=null,n=null,i=null,s=[],o=yh()}}return r.__ieDyn=1,r}()});var R5,A5=ee(()=>{d();lr();mr();Nn();lF();Gp();pa();An();Ii();R5=function(r){_n(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Be(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[Ut](c);var u={remove:function(){Fe(i,function(p,f){if(p.id===c.id)return i[qu](f,1),-1})}};return u},s[zo]=function(l,c){for(var u=!1,p=i[tt],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[xy](null,[l])===!1){u=!0;break}}catch(h){en(c[la](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+ah(h),{exception:sn(h)},!0)}}u||s[jr](l,c)},s[Cy]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(bh)});function Hce(r,e){return new CC(e)}function Jce(r,e,t){var n,i=[],o={};return Fe(t,function(s){(Et(s)||Et(s[za]))&&ii(K5);var a=s[ca],l=s[Qa];s&&a&&(Et(o[a])?o[a]=l:ol(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Ut](s)}),n={all:t},n[pn]=i,n}function L5(r,e){var t=!1;return Fe(e,function(n){if(n===r)return t=!0,-1}),t}function qce(){var r;return wo((r={},r[Ym]=function(e){},r[$m]=function(e){},r[Ty]=function(e){},r[jp]=function(e,t){},r[ky]=function(e,t){},r))}var K5,M5,O5,jce,Bce,Ih,cF=ee(()=>{"use strict";d();lr();mr();lr();Nn();N5();YK();TC();FK();Gp();An();Ii();wC();FC();ck();A5();uk();K5="Plugins must provide initialize method",M5="_notificationManager",O5="SDK is still unloading...",jce="SDK is not initialized",Bce={loggingLevelConsole:1};Ih=function(){function r(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h,g,v,S,_,D,P,M=0;Be(r,this,function(x){A(),x[ws]=function(){return t},x[za]=function(H,de,Te,be){h&&ii(O5),x[ws]()&&ii("Core should not be initialized more than once"),e=H||{},x[xc]=e,Et(H[ET])&&ii("Please provide instrumentation key"),i=be,x[M5]=be,ae(),Nt(),Je(),Te&&(x[Yo]=Te);var we=Hp(e,d8,[]);c=[],c[Ut].apply(c,qm(qm([],de,!1),we,!1)),f=Hp(e,oK,[]),re(null),(!m||m[tt]===0)&&ii("No "+oK+" available"),t=!0,x.releaseQueue()},x.getTransmissionControls=function(){var H=[];return m&&Fe(m,function(de){H[Ut](de.queue)}),Xo(H)},x.track=function(H){H.iKey=H.iKey||e[ET],H[Gm]=H[Gm]||ua(new Date),H.ver=H.ver||"4.0",!h&&x[ws]()?j()[jr](H):n[Ut](H)},x[CT]=j,x[sC]=function(){return i||(i=qce(),x[M5]=i),i},x[Ym]=function(H){i&&i[Ym](H)},x[$m]=function(H){i&&i[$m](H)},x.getCookieMgr=function(){return a||(a=ed(e,x[Yo])),a},x.setCookieMgr=function(H){a=H},x[th]=function(){if(!o&&!s&&da(e.enablePerfMgr)){var H=da(e[sK]);$t(H)&&(s=H(x,x[sC]()))}return o||s||BK()},x.setPerfMgr=function(H){o=H},x.eventCnt=function(){return n[tt]},x.releaseQueue=function(){if(t&&n[tt]>0){var H=n;n=[],Fe(H,function(de){j()[jr](de)})}},x.pollInternalLogs=function(H){v=H||null;var de=da(e.diagnosticLogInterval);return(!de||!(de>0))&&(de=1e4),M&&clearInterval(M),M=setInterval(function(){Ke()},de),M},x[rK]=function(){M&&(clearInterval(M),M=0,Ke())},lh(x,function(){return g},["addTelemetryInitializer"]),x.unload=function(H,de,Te){var be;H===void 0&&(H=!0),t||ii(jce),h&&ii(O5);var we=(be={reason:50},be[Xa]=H,be.flushComplete=!1,be),L=eb(Z(),x);L[aC](function(){A(),de&&de(we)},x);function le(he){we.flushComplete=he,h=!0,_.run(L,we),x[rK](),L[jr](we)}Ce(H,le,6,Te)||le(!1)},x[zm]=R,x.addPlugin=function(H,de,Te,be){if(!H){be&&be(!1),Xr(K5);return}var we=R(H[Qa]);if(we&&!de){be&&be(!1),Xr("Plugin ["+H[Qa]+"] is already loaded!");return}var L={reason:16};function le(Le){c[Ut](H),L.added=[H],re(L),be&&be(!0)}if(we){var he=[we.plugin],xe={reason:2,isAsync:!!Te};ge(he,xe,function(Le){Le?(L.removed=he,L.reason|=32,le(!0)):be&&be(!1)})}else le(!1)},x.evtNamespace=function(){return S},x[_y]=Ce,x.getTraceCtx=function(H){return P||(P=C5()),P},x.setTraceCtx=function(H){P=H||null},Jp(x,"addUnloadCb",function(){return _},"add");function A(){t=!1,e=Oy(!0,{},Bce),x[xc]=e,x[Yo]=new il(e),x[lC]=[],g=new R5,n=[],i=null,o=null,s=null,a=null,l=null,u=null,c=[],p=null,f=null,m=null,h=!1,v=null,S=al("AIBaseCore",!0),_=yh(),P=null}function j(){return ts(Z(),e,x)}function re(H){var de=Jce(x[Yo],UC,c);u=de[pn],l=null;var Te=de.all;if(m=Xo(k5(f,Te,x)),p){var be=ri(Te,p);be!==-1&&Te[qu](be,1),be=ri(u,p),be!==-1&&u[qu](be,1),p._setQueue(m)}else p=T5(m,x);Te[Ut](p),u[Ut](p),x[lC]=lk(Te),p[za](e,x,Te),ak(j(),Te),x[lC]=Xo(lk(u||[])).slice(),H&&vr(H)}function R(H){var de,Te=null,be=null;return Fe(x[lC],function(we){if(we[Qa]===H&&we!==p&&we!==g)return be=we,-1}),!be&&p&&(be=p.getChannel(H)),be&&(Te=(de={plugin:be},de[cC]=function(we){id(be)[fC]=!we},de.isEnabled=function(){var we=id(be);return!we[xs]&&!we[fC]},de.remove=function(we,L){var le;we===void 0&&(we=!0);var he=[be],xe=(le={reason:1},le[Xa]=we,le);ge(he,xe,function(Le){Le&&re({reason:32,removed:he}),L&&L(Le)})},de)),Te}function Z(){if(!l){var H=(u||[]).slice();ri(H,g)===-1&&H[Ut](g),l=Pc(lk(H),e,x)}return l}function ge(H,de,Te){if(H&&H[tt]>0){var be=Pc(H,e,x),we=eb(be,x);we[aC](function(){var L=!1,le=[];Fe(c,function(xe,Le){L5(xe,H)?L=!0:le[Ut](xe)}),c=le;var he=[];f&&(Fe(f,function(xe,Le){var et=[];Fe(xe,function(N){L5(N,H)?L=!0:et[Ut](N)}),he[Ut](et)}),f=he),Te&&Te(L)}),we[jr](de)}else Te(!1)}function Ke(){var H=x[Yo]?x[Yo].queue:[];H&&(Fe(H,function(de){var Te,be=(Te={},Te[Ri]=v||"InternalMessageId: "+de[Ey],Te.iKey=da(e[ET]),Te.time=ua(new Date),Te.baseType=fh.dataType,Te.baseData={message:de[Lp]},Te);x.track(be)}),H[tt]=0)}function Ce(H,de,Te,be){return p?p[_y](H,de,Te||6,be):(de&&de(!1),!0)}function ae(){var H=da(e.disableDbgExt);H===!0&&D&&(i[$m](D),D=null),i&&!D&&H!==!0&&(D=W8(e),i[Ym](D))}function Nt(){var H=da(e.enablePerfMgr);!H&&s&&(s=null),H&&Hp(e,sK,Hce)}function Je(){var H=Hp(e,Py,{});H.NotificationManager=i}function vr(H){var de=KC(Z(),x);(!x._updateHook||x._updateHook(de,H)!==!0)&&de[jr](H)}function Xr(H){var de=x[Yo];de?en(de,2,73,H):ii(H)}})}return r.__ieDyn=1,r}()});function dk(r,e,t,n){Fe(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var WC,uF=ee(()=>{d();mr();Nn();An();Ii();WC=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Be(r,this,function(n){n[Ym]=function(i){n.listeners[Ut](i)},n[$m]=function(i){for(var o=ri(n[Xm],i);o>-1;)n.listeners[qu](o,1),o=ri(n[Xm],i)},n[Ty]=function(i){dk(n[Xm],Ty,!0,function(o){o[Ty](i)})},n[jp]=function(i,o){dk(n[Xm],jp,!0,function(s){s[jp](i,o)})},n[ky]=function(i,o){dk(n[Xm],ky,o,function(s){s[ky](i,o)})},n[Bp]=function(i){i&&(t||!i[dC]())&&dk(n[Xm],Bp,!1,function(o){i[Xa]?setTimeout(function(){return o[Bp](i)},0):o[Bp](i)})}})}return r.__ieDyn=1,r}()});var VC,F5=ee(()=>{d();lr();mr();Nn();cF();Gp();An();Ii();uF();wC();VC=function(r){_n(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n[za]=function(a,l,c,u){i[za](a,l,c||new il(a),u||new WC(a))},n.track=function(a){En(n[th](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ii("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){Et(a[Ri])&&(s(a),ii("telemetry name required"))}function s(a){var l=n[sC]();l&&l[jp]([a],2)}}),t}return e.__ieDyn=1,e}(Ih)});var De,Nr,Sh,cl,U5,W5,pk,dF,jC,fk,tb,ul,tf,od,BC,V5,pF,HC,j5=ee(()=>{d();RT();Nr="Failed",Sh=Nr+"MonitorAjax",cl="Track",U5="Start",W5="Stop",pk="Event",dF="AuthContext",jC="Exception",fk="Local",tb="Session",ul="Storage",tf="Browser",od="Cannot",BC="Buffer",V5="InstrumentationKey",pF=Po({CRITICAL:1,WARNING:2}),HC=Po((De={},De[tf+"DoesNotSupport"+fk+ul]=0,De[tf+od+"Read"+fk+ul]=1,De[tf+od+"Read"+tb+ul]=2,De[tf+od+"Write"+fk+ul]=3,De[tf+od+"Write"+tb+ul]=4,De[tf+Nr+"RemovalFrom"+fk+ul]=5,De[tf+Nr+"RemovalFrom"+tb+ul]=6,De[od+"SendEmptyTelemetry"]=7,De.ClientPerformanceMathError=8,De["ErrorParsingAI"+tb+"Cookie"]=9,De.ErrorPVCalc=10,De[jC+"WhileLoggingError"]=11,De[Nr+"AddingTelemetryTo"+BC]=12,De[Sh+"Abort"]=13,De[Sh+"Dur"]=14,De[Sh+"Open"]=15,De[Sh+"RSC"]=16,De[Sh+"Send"]=17,De[Sh+"GetCorrelationHeader"]=18,De[Nr+"ToAddHandlerForOnBeforeUnload"]=19,De[Nr+"ToSendQueuedTelemetry"]=20,De[Nr+"ToReportDataLoss"]=21,De["Flush"+Nr]=22,De.MessageLimitPerPVExceeded=23,De.MissingRequiredFieldSpecification=24,De.NavigationTimingNotSupported=25,De.OnError=26,De[tb+"RenewalDateIsZero"]=27,De.SenderNotInitialized=28,De[U5+cl+pk+Nr]=29,De[W5+cl+pk+Nr]=30,De[U5+cl+Nr]=31,De[W5+cl+Nr]=32,De.TelemetrySampledAndNotSent=33,De[cl+pk+Nr]=34,De[cl+jC+Nr]=35,De[cl+"Metric"+Nr]=36,De[cl+"PV"+Nr]=37,De[cl+"PV"+Nr+"Calc"]=38,De[cl+"Trace"+Nr]=39,De["Transmission"+Nr]=40,De[Nr+"ToSet"+ul+BC]=41,De[Nr+"ToRestore"+ul+BC]=42,De.InvalidBackendResponse=43,De[Nr+"ToFixDepricatedValues"]=44,De.InvalidDurationValue=45,De.TelemetryEnvelopeInvalid=46,De.CreateEnvelopeError=47,De[od+"SerializeObject"]=48,De[od+"SerializeObjectNonSerializable"]=49,De.CircularReferenceDetected=50,De["Clear"+dF+Nr]=51,De[jC+"Truncated"]=52,De.IllegalCharsInName=53,De.ItemNotInArray=54,De.MaxAjaxPerPVExceeded=55,De.MessageTruncated=56,De.NameTooLong=57,De.SampleRateOutOfRange=58,De["Set"+dF+Nr]=59,De["Set"+dF+Nr+"AccountName"]=60,De.StringValueTooLong=61,De.StartCalledMoreThanOnce=62,De.StopCalledWithoutStart=63,De["TelemetryInitializer"+Nr]=64,De.TrackArgumentsNotSpecified=65,De.UrlTooLong=66,De[tb+ul+BC+"Full"]=67,De[od+"AccessCookie"]=68,De.IdTooLong=69,De.InvalidEvent=70,De[Sh+"SetRequestHeader"]=71,De["Send"+tf+"InfoOnUserInit"]=72,De["Plugin"+jC]=73,De["Notification"+jC]=74,De.SnippetScriptLoadFailure=99,De["Invalid"+V5]=100,De[od+"ParseAiBlobValue"]=101,De.InvalidContentBlob=102,De[cl+"PageAction"+pk+Nr]=103,De[Nr+"AddingCustomDefinedRequestContext"]=104,De["InMemory"+ul+BC+"Full"]=105,De[V5+"Deprecation"]=106,De))});var sd=ee(()=>{d();u8();x8();F5();cF();lF();YT();XK();An();RT();zK();pa();lr();uF();wC();Gp();FC();j5();YK();TC();uk();oF()});var B5,H5,J5,q5,G5,Y5,$5=ee(()=>{d();lr();sd();B5=Po({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32}),H5=Po({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),J5=Po({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),q5=Po({Normal:1,Critical:2}),G5=Po({NONE:0,ERROR:1,WARNING:2,INFORMATION:3}),Y5=Xo(xo(xo({},HC),Po({AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})))});var dl,mk,Gce,bKe,fF,hk,JC=ee(()=>{d();dl="",mk="https://browser.events.data.microsoft.com/OneCollector/1.0/",Gce="pluginVersionString",bKe=Gce+"Arr",fF="version",hk="properties"});function Jn(r){return!(r===dl||Et(r))}function GC(r){if(r){var e=r.indexOf("-");if(e>-1)return r.substring(0,e)}return dl}function gF(){return mF===null&&(mF=!fr(Uint8Array)&&!Xce()&&!Zu()),mF}function YC(r){return!!(r&&Qo(r)&&r>=1&&r<=4)}function $C(r,e,t){if(!e&&!Jn(e)||typeof r!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||gt(e))e={value:e};else if(n==="object"&&!ar.call(e,"value"))e={value:t?JSON.stringify(e):e};else if(Et(e.value)||e.value===dl||!fn(e.value)&&!Qo(e.value)&&!$u(e.value)&&!gt(e.value))return null;if(gt(e.value)&&!vk(e.value))return null;if(!Et(e.kind)){if(gt(e.value)||!rb(e.kind))return null;e.value=e.value.toString()}return e}function zC(r,e,t){var n=-1;if(!fr(r))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),Qce(t))n===-1&&(n=0),n|=t;else{var i=zce[pl(r)]||-1;n!==-1&&i!==-1?n|=i:i===6&&(n=i)}return n}function vF(){Qp(null).setEnabled(!1)}function yF(r,e,t){ll(null)&&Qp(null).set(r,e,t*86400,null,"/")}function bF(r){ll(null)&&Qp(null).del(r)}function IF(r){return ll(null)?SF(Qp(null),r):dl}function SF(r,e,t){t===void 0&&(t=!0);var n;return r&&(n=r.get(e),t&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||dl}function _F(r){r===void 0&&(r="D");var e=zy();return r==="B"?e="{"+e+"}":r==="P"?e="("+e+")":r==="N"&&(e=e.replace(/-/g,dl)),e}function rf(r,e,t,n,i){var o={},s=!1,a=0,l=arguments.length,c=Object[Ft],u=arguments;for(c.toString.call(u[0])==="[object Boolean]"&&(s=u[0],a++);a<l;a++){var r=u[a];Br(r,function(f,m){s&&m&&Ai(m)?gt(m)?(o[f]=o[f]||[],Fe(m,function(h,g){h&&Ai(h)?o[f][g]=rf(!0,o[f][g],h):o[f][g]=h})):o[f]=rf(!0,o[f],m):o[f]=m})}return o}function rb(r){return r===0||r>0&&r<=13||r===32}function Qce(r){return r>=0&&r<=9}function Xce(){var r=Ts();if(!fr(r)&&r.userAgent){var e=r.userAgent.toLowerCase();if((e.indexOf("safari")>=0||e.indexOf("firefox")>=0)&&e.indexOf("chrome")<0)return!0}return!1}function vk(r){return r.length>0}function _h(r,e){var t=r;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[e]=To()}function pl(r){var e=0;if(r!=null){var t=typeof r;t==="string"?e=1:t==="number"?e=2:t==="boolean"?e=3:t===pt&&(e=4,gt(r)?(e=4096,r.length>0&&(e|=pl(r[0]))):ar.call(r,"value")&&(e=8192|pl(r.value)))}return e}function yk(){return!!mn("chrome")}function bk(r,e,t,n,i,o){n===void 0&&(n=!1),i===void 0&&(i=!1);function s(l,c,u){try{l[c]=u}catch(p){}}var a=new XMLHttpRequest;return n&&s(a,Yce,n),t&&s(a,z5,t),a.open(r,e,!i),t&&s(a,z5,t),!i&&o&&s(a,$ce,o),a}var ad,gk,ld,Yce,z5,$ce,zce,mF,qC,hF,To,Q5,X5,QC=ee(()=>{d();sd();lr();JC();gk="3.2.9",ld="1DS-Web-JS-"+gk,Yce="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",z5="withCredentials",$ce="timeout",zce=(ad={},ad[0]=0,ad[2]=6,ad[1]=1,ad[3]=7,ad[4098]=6,ad[4097]=1,ad[4099]=7,ad),mF=null,qC=!!es(),hF=!!Dc();To=Qy;Q5={Version:gk,FullVersionString:ld,strUndefined:Zt,strObject:pt,Undefined:Zt,arrForEach:Fe,arrIndexOf:ri,arrMap:oh,arrReduce:sh,objKeys:Do,toISOString:ua,isReactNative:Zu,isString:fn,isNumber:Qo,isBoolean:$u,isFunction:$t,isArray:gt,isObject:Ai,strTrim:Hr,isDocumentObjectAvailable:qC,isWindowObjectAvailable:hF,isValueAssigned:Jn,getTenantId:GC,isBeaconsSupported:qp,isUint8ArrayAvailable:gF,isLatency:YC,sanitizeProperty:$C,getISOString:ua,useXDomainRequest:ph,getCommonSchemaMetaData:zC,cookieAvailable:ll,disallowsSameSiteNone:Hy,setCookie:yF,deleteCookie:bF,getCookie:IF,createGuid:_F,extend:rf,getTime:To,isValueKind:rb,isArrayValid:vk,objDefineAccessors:Ps,addPageUnloadEventListener:vh,setProcessTelemetryTimings:_h,addEventHandler:Zp,getFieldValueType:pl,strEndsWith:nh,objForEachKey:Br},X5={_canUseCookies:void 0,isTypeof:Ny,isUndefined:fr,isNullOrUndefined:Et,hasOwnProperty:Yu,isFunction:$t,isObject:Ai,isDate:Ay,isArray:gt,isError:ih,isString:fn,isNumber:Qo,isBoolean:$u,toISOString:ua,arrForEach:Fe,arrIndexOf:ri,arrMap:oh,arrReduce:sh,strTrim:Hr,objCreate:wo,objKeys:Do,objDefineAccessors:Ps,addEventHandler:Zp,dateNow:ni,isIE:nl,disableCookies:vF,newGuid:zy,perfNow:Qy,newId:$p,randomValue:By,random32:sl,mwcRandomSeed:GT,mwcRandom32:PC,generateW3CId:rd}});var Zce,Z5,e6=ee(()=>{d();lr();mr();sd();JC();QC();Zce=function(r){_n(e,r);function e(){var t=r.call(this)||this;return t.pluginVersionStringArr=[],Be(e,t,function(n,i){(!n.logger||!n.logger.queue)&&(n.logger=new il({loggingLevelConsole:1})),n.initialize=function(o,s,a,l){En(n,function(){return"AppInsightsCore.initialize"},function(){var c=n.pluginVersionStringArr;if(o){o.endpointUrl||(o.endpointUrl=mk);var u=o.propertyStorageOverride;u&&(!u.getProperty||!u.setProperty)&&ii("Invalid property storage override passed."),o.channels&&Fe(o.channels,function(m){m&&Fe(m,function(h){if(h.identifier&&h.version){var g=h.identifier+"="+h.version;c.push(g)}})})}n.getWParam=function(){return typeof document!="undefined"||o.enableWParam?0:-1},s&&Fe(s,function(m){if(m&&m.identifier&&m.version){var h=m.identifier+"="+m.version;c.push(h)}}),n.pluginVersionString=c.join(";"),n.pluginVersionStringArr=c;try{i.initialize(o,s,a,l),n.pollInternalLogs("InternalLog")}catch(m){var p=n.logger,f=sn(m);f.indexOf("channels")!==-1&&(f+=`
 - Channels must be provided through config.channels only!`),en(p,1,514,"SDK Initialization Failed - no telemetry will be sent: "+f)}},function(){return{config:o,extensions:s,logger:a,notificationManager:l}})},n.track=function(o){En(n,function(){return"AppInsightsCore.track"},function(){var s=o;if(s){s.timings=s.timings||{},s.timings.trackStart=To(),YC(s.latency)||(s.latency=1);var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=ld;var l=s.baseData=s.baseData||{};l[hk]=l[hk]||{};var c=l[hk];c[fF]=c[fF]||n.pluginVersionString||dl}i.track(s)},function(){return{item:o}},!o.sync)}}),t}return e.__ieDyn=1,e}(VC),Z5=Zce});var eue,t6,r6=ee(()=>{d();lr();mr();sd();JC();QC();eue=function(r){_n(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n.initialize=function(o,s,a,l){o&&!o.endpointUrl&&(o.endpointUrl=mk),n.getWParam=function(){return qC||o.enableWParam?0:-1};try{i.initialize(o,s,a,l)}catch(c){en(n.logger,1,514,"Initialization Failed: "+sn(c)+`
 - Note: Channels must be provided through config.channels only`)}},n.track=function(o){var s=o;if(s){var a=s.ext=s.ext||{};a.sdk=a.sdk||{},a.sdk.ver=ld}i.track(s)}}),t}return e.__ieDyn=1,e}(Ih),t6=eue});function tue(r,e,t){return function(n){r[e]=n,t()}}var Eh,rue,nf,EF=ee(()=>{d();mr();sd();Eh=$t;rue=function(){function r(e){var t=0,n=null,i=[];Be(r,this,function(c){c.then=function(u,p){return new r(function(f,m){o(u,p,f,m)})},c.catch=function(u){return c.then(null,u)}});function o(c,u,p,f){i.push(function(){var m;try{t===1?m=Eh(c)?c(n):n:m=Eh(u)?u(n):n,m instanceof r?m.then(p,f):t===2&&!Eh(u)?f(m):p(m)}catch(h){f(h);return}}),t!==0&&s()}function s(){if(i.length>0){var c=i.slice();i=[],setTimeout(function(){for(var u=0,p=c.length;u<p;++u)try{c[u]()}catch(f){}},0)}}function a(c){t===0&&(n=c,t=1,s())}function l(c){t===0&&(n=c,t=2,s())}(function(){if(!Eh(e))throw new TypeError("ESPromise: resolvedFunc argument is not a Function");try{e(a,l)}catch(u){l(u)}})()}return r.resolve=function(e){return e instanceof r?e:e&&Eh(e.then)?new r(function(t,n){try{e.then(t,n)}catch(i){n(i)}}):new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.all=function(e){if(!(!e||!e.length))return new r(function(t,n){try{for(var i=[],o=0,s=0;s<e.length;s++){var a=e[s];a&&Eh(a.then)?(o++,a.then(tue(i,s,function(){--o===0&&t(i)}),n)):i[s]=a}o===0&&setTimeout(function(){t(i)},0)}catch(l){n(l)}})},r.race=function(e){return new r(function(t,n){if(!(!e||!e.length))try{for(var i=function(s){var a=e[s];a&&Eh(a.then)?a.then(t,n):setTimeout(function(){t(a)},0)},o=0;o<e.length;o++)i(o)}catch(s){n(s)}})},r}(),nf=rue});function nb(){return new Date().getTime()}var nue,n6,XC,Ch,CF,iue,i6,o6=ee(()=>{d();mr();EF();sd();nue=6e5,n6=0,XC=[],Ch=[],CF=[];iue=function(){function r(e,t){var n=0,i=(e||"<unnamed>")+"."+n6;n6++,Be(r,this,function(a){var l=null,c=0;a.scheduleEvent=function(p,f,m){var h=i+"."+c;c++,f&&(h+="-("+f+")");var g=h+"{"+n+"}";n++;var v={evt:null,tm:nb(),id:g,isRunning:!1,isAborted:!1};return l?v.evt=A(v,l):v.evt=x(v),l=v,l.evt._schId=g,v.evt;function S(j){for(var re=nb(),R=re-nue,Z=j.length,ge=0;ge<Z;){var Ke=j[ge];if(Ke&&Ke.tm<R){var Ce=null;Ke.abort?(Ce="Aborting ["+Ke.id+"] due to Excessive runtime ("+(re-Ke.tm)+" ms)",Ke.abort(Ce)):Ce="Removing ["+Ke.id+"] due to Excessive runtime ("+(re-Ke.tm)+" ms)",s(Ce),j.splice(ge,1),Z--}else ge++}}function _(j,re){var R=!1,Z=u(XC,j);if(Z||(Z=u(CF,j),R=!0),Z){Z.to&&(clearTimeout(Z.to),Z.to=null);var ge=nb()-Z.tm;re?R?s("Timed out event ["+j+"] finally complete -- "+ge+" ms"):o("Promise ["+j+"] Complete -- "+ge+" ms"):(CF.push(Z),s("Event ["+j+"] Timed out and removed -- "+ge+" ms"))}else o("Failed to remove ["+j+"] from running queue");l&&l.id===j&&(l=null),S(XC),S(Ch),S(CF)}function D(j,re){return function(R){return _(j,!0),re&&re(R),R}}function P(j,re,R,Z){re.then(function(ge){return ge instanceof nf?(o("Event ["+j+"] returned a promise -- waiting"),P(j,ge,R,Z),ge):D(j,R)(ge)},D(j,Z))}function M(j,re){var R=j.id;return new nf(function(Z,ge){o("Event ["+R+"] Starting -- waited for "+(j.wTm||"--")+" ms"),j.isRunning=!0,j.abort=function(Ce){j.abort=null,j.isAborted=!0,_(R,!1),ge(new Error(Ce))};var Ke=re(R);Ke instanceof nf?(m&&(j.to=setTimeout(function(){_(R,!1),ge(new Error("Timed out after ["+m+"] ms"))},m)),P(R,Ke,function(Ce){o("Event ["+R+"] Resolving after "+(nb()-j.tm)+" ms"),Z(Ce)},ge)):(o("Promise ["+R+"] Auto completed as the start action did not return a promise"),Z())})}function x(j){var re=nb();return j.wTm=re-j.tm,j.tm=re,j.isAborted?nf.reject(new Error("["+h+"] was aborted")):(XC.push(j),M(j,p))}function A(j,re){var R=new nf(function(Z,ge){var Ke=nb()-re.tm,Ce=re.id;o("["+h+"] is waiting for ["+Ce+":"+Ke+" ms] to complete before starting -- ["+Ch.length+"] waiting and ["+XC.length+"] running"),j.abort=function(ae){j.abort=null,u(Ch,h),j.isAborted=!0,ge(new Error(ae))},re.evt.then(function(ae){u(Ch,h),x(j).then(Z,ge)},function(ae){u(Ch,h),x(j).then(Z,ge)})});return Ch.push(j),R}};function u(p,f){for(var m=0;m<p.length;m++)if(p[m].id===f)return p.splice(m,1)[0];return null}});function o(a){var l=Bn();l&&l.QUnit&&console&&console.log("ESPromiseScheduler["+i+"] "+a)}function s(a){ol(t,"ESPromiseScheduler["+i+"] "+a)}}return r.incomplete=function(){return XC},r.waitingToStart=function(){return Ch},r}(),i6=iue});var s6,a6=ee(()=>{d();sd();JC();QC();s6=function(){function r(e){var t=this,n={},i=[],o=[];e&&o.push(e);function s(u,p){var f,m=n[u];if(m&&(f=m[p]),!f&&f!==null){if(fn(u)&&fn(p))if(o.length>0){for(var h=0;h<o.length;h++)if(o[h].handleField(u,p)){f={canHandle:!0,fieldHandler:o[h]};break}}else i.length===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<i.length;h++)if(i[h].handleField(u,p)){f={canHandle:!0,handler:i[h],fieldHandler:null};break}}m||(m=n[u]={}),m[p]=f}return f}t.addSanitizer=function(u){u&&(i.push(u),n={})},t.addFieldSanitizer=function(u){u&&(o.push(u),n={})},t.handleField=function(u,p){var f=s(u,p);return f?f.canHandle:!1},t.value=function(u,p,f,m){var h=s(u,p);if(h&&h.canHandle){if(!h||!h.canHandle)return null;if(h.handler)return h.handler.value(u,p,f,m);if(!fn(p)||Et(f)||f===dl)return null;var g=null,v=pl(f);if((v&8192)===8192){var S=v&-8193;if(g=f,!Jn(g.value)||S!==1&&S!==2&&S!==3&&(S&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?g=l(u,p,f):v===4&&(g=l(u,p,m?JSON.stringify(f):f));if(g)return a(h,u,p,v,g,m)}return null},t.property=function(u,p,f,m){var h=s(u,p);if(!h||!h.canHandle||!fn(p)||Et(f)||!Jn(f.value))return null;var g=pl(f.value);return g===0?null:a(h,u,p,g,f,m)};function a(u,p,f,m,h,g){if(u.handler)return u.handler.property(p,f,h,g);if(!Et(h.kind)){if((m&4096)===4096||!rb(h.kind))return null;h.value=h.value.toString()}return c(u.fieldHandler,p,f,m,h)}function l(u,p,f){return Jn(f)?{value:f}:null}function c(u,p,f,m,h){if(h&&u){var g=u.getSanitizer(p,f,m,h.kind,h.propertyType);if(g)if(m===4){var v={},S=h.value;Br(S,function(D,P){var M=p+"."+f;if(Jn(P)){var x=l(M,D,P);x=c(u,M,D,pl(P),x),x&&(v[D]=x.value)}}),h.value=v}else{var _={path:p,name:f,type:m,prop:h,sanitizer:t};h=g.call(t,_)}}return h}}return r.getFieldType=pl,r}()});var l6={};Um(l6,{AppInsightsCore:()=>Z5,BaseCore:()=>t6,BaseTelemetryPlugin:()=>bh,CoreUtils:()=>X5,DiagnosticLogger:()=>il,ESPromise:()=>nf,ESPromiseScheduler:()=>i6,EventHelper:()=>QK,EventLatency:()=>H5,EventPersistence:()=>q5,EventPropertyType:()=>J5,EventsDiscardedReason:()=>rl,FullVersionString:()=>ld,InternalAppInsightsCore:()=>VC,InternalBaseCore:()=>Ih,LoggingSeverity:()=>pF,MinChannelPriorty:()=>tK,NotificationManager:()=>WC,PerfEvent:()=>mh,PerfManager:()=>CC,ProcessTelemetryContext:()=>aF,TraceLevel:()=>G5,Undefined:()=>Zt,Utils:()=>Q5,ValueKind:()=>B5,ValueSanitizer:()=>s6,Version:()=>gk,_ExtendedInternalMessageId:()=>Y5,_InternalLogMessage:()=>fh,_InternalMessageId:()=>HC,__getRegisteredEvents:()=>$K,_logInternalMessage:()=>WK,_throwInternal:()=>en,_warnToConsole:()=>ol,addEventHandler:()=>Zp,addEventListeners:()=>nk,addPageHideEventListener:()=>Yy,addPageShowEventListener:()=>$y,addPageUnloadEventListener:()=>vh,areCookiesSupported:()=>ll,arrForEach:()=>Fe,arrIndexOf:()=>ri,arrMap:()=>oh,arrReduce:()=>sh,attachEvent:()=>qy,cookieAvailable:()=>ll,createCookieMgr:()=>ed,createEnumStyle:()=>Po,createGuid:()=>_F,createProcessTelemetryContext:()=>ts,createTraceParent:()=>tF,createUniqueNamespace:()=>al,createUnloadHandlerContainer:()=>yh,dateNow:()=>ni,deleteCookie:()=>bF,detachEvent:()=>Gy,disableCookies:()=>vF,disallowsSameSiteNone:()=>Hy,doPerf:()=>En,dumpObj:()=>sn,eventOff:()=>gh,eventOn:()=>hh,extend:()=>rf,findW3cTraceParent:()=>iF,formatTraceParent:()=>nF,generateW3CId:()=>rd,getCommonSchemaMetaData:()=>zC,getConsole:()=>bC,getCookie:()=>IF,getCookieValue:()=>SF,getCrypto:()=>IC,getDocument:()=>es,getExceptionName:()=>ah,getFieldValueType:()=>pl,getGlobal:()=>Bn,getGlobalInst:()=>mn,getHistory:()=>RK,getIEVersion:()=>AK,getISOString:()=>ua,getJSON:()=>Uy,getLocation:()=>uh,getMsCrypto:()=>SC,getNavigator:()=>Ts,getPerformance:()=>Fy,getSetValue:()=>Hp,getTenantId:()=>GC,getTime:()=>To,getWindow:()=>Dc,hasDocument:()=>BT,hasHistory:()=>HT,hasJSON:()=>dh,hasNavigator:()=>yC,hasOwnProperty:()=>Yu,hasWindow:()=>vC,isArray:()=>gt,isArrayValid:()=>vk,isBeaconsSupported:()=>qp,isBoolean:()=>$u,isChromium:()=>yk,isDate:()=>Ay,isDocumentObjectAvailable:()=>qC,isError:()=>ih,isFetchSupported:()=>Wy,isFunction:()=>$t,isIE:()=>nl,isLatency:()=>YC,isNotTruthy:()=>hK,isNullOrUndefined:()=>Et,isNumber:()=>Qo,isObject:()=>Ai,isReactNative:()=>Zu,isSampledFlag:()=>rF,isString:()=>fn,isTruthy:()=>My,isTypeof:()=>Ny,isUint8ArrayAvailable:()=>gF,isUndefined:()=>fr,isValidSpanId:()=>Zy,isValidTraceId:()=>Xy,isValidTraceParent:()=>sk,isValueAssigned:()=>Jn,isValueKind:()=>rb,isWindowObjectAvailable:()=>hF,isXhrSupported:()=>Vy,mergeEvtNamespace:()=>td,newGuid:()=>zy,newId:()=>$p,normalizeJsName:()=>rh,objCreate:()=>wo,objDefineAccessors:()=>Ps,objForEachKey:()=>Br,objFreeze:()=>Xo,objKeys:()=>Do,objSeal:()=>mK,openXhr:()=>bk,optimizeObject:()=>zu,parseTraceParent:()=>LC,perfNow:()=>Qy,proxyAssign:()=>gK,proxyFunctionAs:()=>Jp,proxyFunctions:()=>lh,random32:()=>sl,randomValue:()=>By,removeEventHandler:()=>rk,removeEventListeners:()=>Xp,removePageHideEventListener:()=>MC,removePageShowEventListener:()=>OC,removePageUnloadEventListener:()=>AC,safeGetCookieMgr:()=>Qp,safeGetLogger:()=>_C,sanitizeProperty:()=>$C,setCookie:()=>yF,setEnableEnvMocks:()=>NK,setProcessTelemetryTimings:()=>_h,setValue:()=>Zo,strContains:()=>Rn,strEndsWith:()=>nh,strFunction:()=>on,strObject:()=>pt,strPrototype:()=>Ft,strStartsWith:()=>Ry,strTrim:()=>Hr,strUndefined:()=>Zt,throwError:()=>ii,toISOString:()=>ua,useXDomainRequest:()=>ph});var wh=ee(()=>{d();$5();e6();r6();EF();o6();a6();sd();QC()});var xh,Ik,Sk,wF=ee(()=>{d();xh="REAL_TIME",Ik="NEAR_REAL_TIME",Sk="BEST_EFFORT"});var fl,_k,c6,Ek,u6,xF,d6,p6,f6,DF,PF,Ck,m6,TF,h6,kF,wk,NF,xk,Dk,Pk,ZC,RF,g6,ib,AF,Tk,ew=ee(()=>{d();fl="",_k="POST",c6="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Ek="drop",u6="send",xF="requeue",d6="rspFail",p6="oth",f6="no-cache, no-store",DF="application/x-json-stream",PF="cache-control",Ck="content-type",m6="kill-tokens",TF="kill-duration",h6="kill-duration-seconds",kF="time-delta-millis",wk="client-version",NF="client-id",xk="time-delta-to-apply-millis",Dk="upload-time",Pk="apikey",ZC="AuthMsaDeviceTicket",RF="AuthXToken",g6="NoResponseBody",ib="msfpc",AF="trace",Tk="user"});function y6(r){var e=(r.ext||{}).intweb;return e&&Jn(e[ib])?e[ib]:null}function v6(r){for(var e=null,t=0;e===null&&t<r.length;t++)e=y6(r[t]);return e}var ob,MF=ee(()=>{d();wh();ew();ob=function(){function r(e,t){var n=t?[].concat(t):[],i=this,o=v6(n);i.iKey=function(){return e},i.Msfpc=function(){return o||fl},i.count=function(){return n.length},i.events=function(){return n},i.addEvent=function(s){return s?(n.push(s),o||(o=y6(s)),!0):!1},i.split=function(s,a){var l;if(s<n.length){var c=n.length-s;Et(a)||(c=a<c?a:c),l=n.splice(s,c),o=v6(n)}return new r(e,l)}}return r.create=function(e,t){return new r(e,t)},r}()});var oue,b6,I6=ee(()=>{d();mr();oue=function(){function r(){var e=!0,t=!0,n=!0,i="use-collector-delta",o=!1;Be(r,this,function(s){s.allowRequestSending=function(){return e},s.firstRequestSent=function(){n&&(n=!1,o||(e=!1))},s.shouldAddClockSkewHeaders=function(){return t},s.getClockSkewHeaderValue=function(){return i},s.setClockSkew=function(a){o||(a?(i=a,t=!0,o=!0):t=!1,e=!0)}})}return r.__ieDyn=1,r}(),b6=oue});var sue,aue,S6,_6=ee(()=>{d();mr();wh();sue=1e3,aue=function(){function r(){var e={};function t(n){var i=[];return n&&Fe(n,function(o){i.push(Hr(o))}),i}Be(r,this,function(n){n.setKillSwitchTenants=function(i,o){if(i&&o)try{var s=t(i.split(","));if(o==="this-request-only")return s;for(var a=parseInt(o,10)*sue,l=0;l<s.length;++l)e[s[l]]=ni()+a}catch(c){return[]}return[]},n.isTenantKilled=function(i){var o=e,s=Hr(i);return o[s]!==void 0&&o[s]>ni()?!0:(delete o[s],!1)}})}return r.__ieDyn=1,r}(),S6=aue});function C6(r){return!(r>=300&&r<500&&r!=408&&r!=429||r==501||r==505)}function kk(r){var e=0,t=E6*lue,n=E6*cue,i=Math.floor(Math.random()*(n-t))+t;return e=Math.pow(2,r)*i,Math.min(e,uue)}var lue,cue,E6,uue,OF=ee(()=>{d();lue=.8,cue=1.2,E6=3e3,uue=6e5});function x6(r,e,t,n){if(n&&r){var i=zC(n.value,n.kind,n.propertyType);if(i>-1){var o=r[w6];o||(o=r[w6]={f:{}});var s=o[Nk];if(s||(s=o[Nk]={}),e)for(var a=0;a<e.length;a++){var l=e[a];s[l]||(s[l]={f:{}});var c=s[l][Nk];c||(c=s[l][Nk]={}),s=c}s=s[t]={},gt(n.value)?s.a={t:i}:s.t=i}}}var due,pue,D6,P6,fue,w6,Nk,mue,T6,k6=ee(()=>{d();mr();wh();MF();ew();due=20,pue=3984588,D6=65e3,P6=2e6,fue=Math.min(P6,D6),w6="metadata",Nk="f",mue=/\./,T6=function(){function r(e,t,n,i){var o="data",s="baseData",a="ext",l=!!i,c=!0,u=t,p={};Be(r,this,function(f){f.createPayload=function(g,v,S,_,D,P){return{apiKeys:[],payloadBlob:fl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:g,isTeardown:v,isSync:S,isBeacon:_,sendType:P,sendReason:D}},f.appendPayload=function(g,v,S){var _=g&&v&&!g.overflow;return _&&En(e,function(){return"Serializer:appendPayload"},function(){for(var D=v.events(),P=g.payloadBlob,M=g.numEvents,x=!1,A=[],j=[],re=g.isBeacon,R=re?D6:pue,Z=re?fue:P6,ge=0,Ke=0;ge<D.length;){var Ce=D[ge];if(Ce){if(M>=S){g.overflow=v.split(ge);break}var ae=f.getEventBlob(Ce);if(ae&&ae.length<=Z){var Nt=ae.length,Je=P.length;if(Je+Nt>R){g.overflow=v.split(ge);break}P&&(P+=`
`),P+=ae,Ke++,Ke>due&&(P.substr(0,1),Ke=0),x=!0,M++}else ae?A.push(Ce):j.push(Ce),D.splice(ge,1),ge--}ge++}if(A&&A.length>0&&g.sizeExceed.push(ob.create(v.iKey(),A)),j&&j.length>0&&g.failedEvts.push(ob.create(v.iKey(),j)),x){g.batches.push(v),g.payloadBlob=P,g.numEvents=M;var vr=v.iKey();ri(g.apiKeys,vr)===-1&&g.apiKeys.push(vr)}},function(){return{payload:g,theBatch:{iKey:v.iKey(),evts:v.events()},max:S}}),_},f.getEventBlob=function(g){try{return En(e,function(){return"Serializer.getEventBlob"},function(){var v={};v.name=g.name,v.time=g.time,v.ver=g.ver,v.iKey="o:"+GC(g.iKey);var S={},_=g[a];_&&(v[a]=S,Br(_,function(M,x){var A=S[M]={};h(x,A,"ext."+M,!0,null,null,!0)}));var D=v[o]={};D.baseType=g.baseType;var P=D[s]={};return h(g.baseData,P,s,!1,[s],function(M,x,A){x6(S,M,x,A)},c),h(g.data,D,o,!1,[],function(M,x,A){x6(S,M,x,A)},c),JSON.stringify(v)},function(){return{item:g}})}catch(v){return null}};function m(g,v){var S=p[g];return S===void 0&&(g.length>=7&&(S=Ry(g,"ext.metadata")||Ry(g,"ext.web")),p[g]=S),S}function h(g,v,S,_,D,P,M){Br(g,function(x,A){var j=null;if(A||Jn(A)){var re=S,R=x,Z=D,ge=v;if(l&&!_&&mue.test(x)){var Ke=x.split("."),Ce=Ke.length;if(Ce>1){Z&&(Z=Z.slice());for(var ae=0;ae<Ce-1;ae++){var Nt=Ke[ae];ge=ge[Nt]=ge[Nt]||{},re+="."+Nt,Z&&Z.push(Nt)}R=Ke[Ce-1]}}var Je=_&&m(re,R);if(!Je&&u&&u.handleField(re,R)?j=u.value(re,R,A,n):j=$C(R,A,n),j){var vr=j.value;if(ge[R]=vr,P&&P(Z,R,j),M&&typeof vr=="object"&&!gt(vr)){var Xr=Z;Xr&&(Xr=Xr.slice(),Xr.push(R)),h(A,vr,re+"."+R,_,Xr,P,M)}}}})}})}return r.__ieDyn=1,r}()});function Ph(r,e,t){KF[r]=e,t!==!1&&(FF[e]=r)}function R6(r){try{return r.responseText}catch(e){}return fl}function A6(r,e){var t=!1;if(r&&e){var n=Do(r);if(n&&n.length>0)for(var i=e.toLowerCase(),o=0;o<n.length;o++){var s=n[o];if(s&&Yu(e,s)&&s.toLowerCase()===i){t=!0;break}}}return t}function sb(r,e,t,n){e&&t&&t.length>0&&(n&&KF[e]?(r.hdrs[KF[e]]=t,r.useHdrs=!0):r.url+="&"+e+"="+t)}function M6(r,e){return e&&(Qo(e)?r=[e].concat(r):gt(e)&&(r=e.concat(r))),r}var Dh,LF,N6,hue,KF,FF,O6,L6=ee(()=>{d();mr();I6();_6();wh();ew();OF();k6();LF="sendAttempt",N6="&"+g6+"=true",hue=(Dh={},Dh[1]=xF,Dh[100]=xF,Dh[200]="sent",Dh[8004]=Ek,Dh[8003]=Ek,Dh),KF={},FF={};Ph(ZC,ZC,!1);Ph(wk,wk);Ph(NF,"Client-Id");Ph(Pk,Pk);Ph(xk,xk);Ph(Dk,Dk);Ph(RF,RF);O6=function(){function r(e,t,n,i,o){this._responseHandlers=[];var s="?cors=true&"+Ck.toLowerCase()+"="+DF,a=new S6,l=!1,c=new b6,u=!1,p=0,f,m,h,g,v=!0,S=[],_={},D=[],P=null,M=!1,x,A=!1,j=!1,re,R,Z,ge,Ke;Be(r,this,function(Ce){var ae=!0;Ce.initialize=function(F,ue,k,O,X){var ce;X||(X={}),s=F+s,j=fr(X.avoidOptions)?!0:!X.avoidOptions,g=ue,x=ue.getCookieMgr(),M=!g.config.disableEventTimings;var ve=!!g.config.enableCompoundKey;f=k,m=f.diagLog();var V=X.valueSanitizer,G=X.stringifyObjects;fr(X.enableCompoundKey)||(ve=!!X.enableCompoundKey),re=X.xhrTimeout,R=!!X.disableXhrSync,Z=!!X.disableFetchKeepAlive,Ke=X.addNoResponse!==!1,u=!Zu(),P=new T6(g,V,G,ve),Et(X.useSendBeacon)||(u=!!X.useSendBeacon);var Y=O,oe=X.alwaysUseXhrOverride?O:null,Ie=X.alwaysUseXhrOverride?O:null,q=[3,2];if(!O){v=!1;var se=uh();se&&se.protocol&&se.protocol.toLowerCase()==="file:"&&(ae=!1);var K=[];Zu()?(K=[2,1],q=[2,1,3]):K=[1,2,3],K=M6(K,X.transports),O=Nt(K,!1),O||ol(m,"No available transport to send events"),Y=Nt(K,!0)}oe||(q=M6(q,X.unloadTransports),oe=Nt(q,!0)),ge=!v&&(u&&qp()||!Z&&Wy(!0)),h=(ce={},ce[0]=O,ce[1]=Y||Nt([1,2,3],!0),ce[2]=oe||Y||Nt([1],!0),ce[3]=Ie||Nt([2,3],!0)||Y||Nt([1],!0),ce)};function Nt(F,ue){for(var k=0,O=null,X=0;O==null&&X<F.length;)k=F[X],k===1?ph()?O=Je:Vy()&&(O=Xr):k===2&&Wy(ue)&&(!ue||ue&&!Z)?O=vr:u&&k===3&&qp()&&(O=de),X++;return O?{_transport:k,_isSync:ue,sendPOST:O}:null}Ce._getDbgPlgTargets=function(){return[h[0],a,P,h]};function Je(F,ue,k){var O=new XDomainRequest;O.open(_k,F.urlString),F.timeout&&(O.timeout=F.timeout),O.onload=function(){var X=R6(O);H(ue,200,{},X),Xt(X)},O.onerror=function(){H(ue,400,{})},O.ontimeout=function(){H(ue,500,{})},O.onprogress=function(){},k?O.send(F.data):o.set(function(){O.send(F.data)},0)}function vr(F,ue,k){var O,X=F.urlString,ce=!1,ve=!1,V=(O={body:F.data,method:_k},O[c6]=!0,O);k&&(V.keepalive=!0,F._sendReason===2&&(ce=!0,Ke&&(X+=N6))),ae&&(V.credentials="include"),F.headers&&Do(F.headers).length>0&&(V.headers=F.headers),fetch(X,V).then(function(G){var Y={},oe=fl,Ie=G.headers;Ie&&Ie.forEach(function(q,se){Y[se]=q}),G.body&&G.text().then(function(q){oe=q}),ve||(ve=!0,H(ue,G.status,Y,oe),Xt(oe))}).catch(function(G){ve||(ve=!0,H(ue,0,{}))}),ce&&!ve&&(ve=!0,H(ue,200,{})),!ve&&F.timeout>0&&o.set(function(){ve||(ve=!0,H(ue,500,{}))},F.timeout)}function Xr(F,ue,k){var O=F.urlString;function X(G,Y,oe){if(!G[oe]&&Y&&Y.getResponseHeader){var Ie=Y.getResponseHeader(oe);Ie&&(G[oe]=Hr(Ie))}return G}function ce(G){var Y={};return G.getAllResponseHeaders?Y=ze(G.getAllResponseHeaders()):(Y=X(Y,G,kF),Y=X(Y,G,TF),Y=X(Y,G,h6)),Y}function ve(G,Y){H(ue,G.status,ce(G),Y)}k&&F.disableXhrSync&&(k=!1);var V=bk(_k,O,ae,!0,k,F.timeout);Br(F.headers,function(G,Y){V.setRequestHeader(G,Y)}),V.onload=function(){var G=R6(V);ve(V,G),Xt(G)},V.onerror=function(){ve(V)},V.ontimeout=function(){ve(V)},V.send(F.data)}function H(F,ue,k,O){try{F(ue,k,O)}catch(X){en(m,2,518,sn(X))}}function de(F,ue,k){var O=F,X=200,ce=O._thePayload,ve=F.urlString+(Ke?N6:fl);try{var V=Ts();if(!V.sendBeacon(ve,F.data))if(ce){var G=[];Fe(ce.batches,function(Y){if(G&&Y&&Y.count()>0){for(var oe=Y.events(),Ie=0;Ie<oe.length;Ie++)if(!V.sendBeacon(ve,P.getEventBlob(oe[Ie]))){G.push(Y.split(Ie));break}}else G.push(Y.split(0))}),Lt(G,8003,ce.sendType,!0)}else X=0}catch(Y){ol(m,"Failed to send telemetry using sendBeacon API. Ex:"+sn(Y)),X=0}finally{H(ue,X,{},fl)}}function Te(F){return F===2||F===3}function be(F){return A&&Te(F)&&(F=2),F}Ce.addQueryStringParameter=function(F,ue){for(var k=0;k<S.length;k++)if(S[k].name===F){S[k].value=ue;return}S.push({name:F,value:ue})},Ce.addHeader=function(F,ue){_[F]=ue},Ce.canSendRequest=function(){return we()&&c.allowRequestSending()},Ce.sendQueuedRequests=function(F,ue){fr(F)&&(F=0),A&&(F=be(F),ue=2),le(D,F,0)&&xe(L(),0,!1,F,ue||0)},Ce.isCompletelyIdle=function(){return!l&&p===0&&D.length===0},Ce.setUnloading=function(F){A=F},Ce.addBatch=function(F){if(F&&F.count()>0){if(a.isTenantKilled(F.iKey()))return!1;D.push(F)}return!0},Ce.teardown=function(){D.length>0&&xe(L(),0,!0,2,2)},Ce.pause=function(){l=!0},Ce.resume=function(){l=!1,Ce.sendQueuedRequests(0,4)},Ce.sendSynchronousBatch=function(F,ue,k){F&&F.count()>0&&(Et(ue)&&(ue=1),A&&(ue=be(ue),k=2),xe([F],0,!1,ue,k||0))};function we(){return!l&&p<t}function L(){var F=D;return D=[],F}function le(F,ue,k){var O=!1;return F&&F.length>0&&!l&&h[ue]&&P&&(O=ue!==0||we()&&(k>0||c.allowRequestSending())),O}function he(F){var ue={};return F&&Fe(F,function(k,O){ue[O]={iKey:k.iKey(),evts:k.events()}}),ue}function xe(F,ue,k,O,X){if(!(!F||F.length===0)){if(l){Lt(F,1,O);return}O=be(O);try{var ce=F,ve=O!==0;En(g,function(){return"HttpManager:_sendBatches"},function(V){V&&(F=F.slice(0));for(var G=[],Y=null,oe=To(),Ie=h[O]||(ve?h[1]:h[0]),q=Ie&&Ie._transport,se=ge&&(A||Te(O)||q===3||Ie._isSync&&q===2);le(F,O,ue);){var K=F.shift();K&&K.count()>0&&(a.isTenantKilled(K.iKey())?G.push(K):(Y=Y||P.createPayload(ue,k,ve,se,X,O),P.appendPayload(Y,K,e)?Y.overflow!==null&&(F=[Y.overflow].concat(F),Y.overflow=null,N(Y,oe,To(),X),oe=To(),Y=null):(N(Y,oe,To(),X),oe=To(),F=[K].concat(F),Y=null)))}Y&&N(Y,oe,To(),X),F.length>0&&(D=F.concat(D)),Lt(G,8004,O)},function(){return{batches:he(ce),retryCount:ue,isTeardown:k,isSynchronous:ve,sendReason:X,useSendBeacon:Te(O),sendType:O}},!ve)}catch(V){en(m,2,48,"Unexpected Exception sending batch: "+sn(V))}}}function Le(F,ue){var k={url:s,hdrs:{},useHdrs:!1};ue?(k.hdrs=rf(k.hdrs,_),k.useHdrs=Do(k.hdrs).length>0):Br(_,function(V,G){FF[V]?sb(k,FF[V],G,!1):(k.hdrs[V]=G,k.useHdrs=!0)}),sb(k,NF,"NO_AUTH",ue),sb(k,wk,ld,ue);var O=fl;Fe(F.apiKeys,function(V){O.length>0&&(O+=","),O+=V}),sb(k,Pk,O,ue),sb(k,Dk,ni().toString(),ue);var X=bt(F);if(Jn(X)&&(k.url+="&ext.intweb.msfpc="+X),c.shouldAddClockSkewHeaders()&&sb(k,xk,c.getClockSkewHeaderValue(),ue),g.getWParam){var ce=g.getWParam();ce>=0&&(k.url+="&w="+ce)}for(var ve=0;ve<S.length;ve++)k.url+="&"+S[ve].name+"="+S[ve].value;return k}function et(F,ue,k){F[ue]=F[ue]||{},F[ue][f.identifier]=k}function N(F,ue,k,O){if(F&&F.payloadBlob&&F.payloadBlob.length>0){var X=!!Ce.sendHook,ce=h[F.sendType];!Te(F.sendType)&&F.isBeacon&&F.sendReason===2&&(ce=h[2]||h[3]||ce);var ve=j;(F.isBeacon||ce._transport===3)&&(ve=!1);var V=Le(F,ve);ve=ve||V.useHdrs;var G=To();En(g,function(){return"HttpManager:_doPayloadSend"},function(){for(var Y=0;Y<F.batches.length;Y++)for(var oe=F.batches[Y],Ie=oe.events(),q=0;q<Ie.length;q++){var se=Ie[q];if(M){var K=se.timings=se.timings||{};et(K,"sendEventStart",G),et(K,"serializationStart",ue),et(K,"serializationCompleted",k)}se[LF]>0?se[LF]++:se[LF]=1}Lt(F.batches,1e3+(O||0),F.sendType,!0);var U={data:F.payloadBlob,urlString:V.url,headers:V.hdrs,_thePayload:F,_sendReason:O,timeout:re,disableXhrSync:R,disableFetchKeepAlive:Z};ve&&(A6(U.headers,PF)||(U.headers[PF]=f6),A6(U.headers,Ck)||(U.headers[Ck]=DF));var ne=null;ce&&(ne=function(Ne){c.firstRequestSent();var Oe=function(mi,Lu){pe(mi,Lu,F,O)},Kt=F.isTeardown||F.isSync;try{ce.sendPOST(Ne,Oe,Kt),Ce.sendListener&&Ce.sendListener(U,Ne,Kt,F.isBeacon)}catch(mi){ol(m,"Unexpected exception sending payload. Ex:"+sn(mi)),H(Oe,0,{})}}),En(g,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(ne)if(F.sendType===0&&p++,X&&!F.isBeacon&&ce._transport!==3){var Ne={data:U.data,urlString:U.urlString,headers:rf({},U.headers),timeout:U.timeout,disableXhrSync:U.disableXhrSync,disableFetchKeepAlive:U.disableFetchKeepAlive},Oe=!1;En(g,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{Ce.sendHook(Ne,function(Kt){Oe=!0,!v&&!Kt._thePayload&&(Kt._thePayload=Kt._thePayload||U._thePayload,Kt._sendReason=Kt._sendReason||U._sendReason),ne(Kt)},F.isSync||F.isTeardown)}catch(Kt){Oe||ne(U)}})}else ne(U)})},function(){return{thePayload:F,serializationStart:ue,serializationCompleted:k,sendReason:O}},F.isSync)}F.sizeExceed&&F.sizeExceed.length>0&&Lt(F.sizeExceed,8003,F.sendType),F.failedEvts&&F.failedEvts.length>0&&Lt(F.failedEvts,8002,F.sendType)}function W(F,ue){M&&Fe(F,function(k){var O=k.timings=k.timings||{};et(O,"sendEventCompleted",ue)})}function pe(F,ue,k,O){var X=9e3,ce=null,ve=!1,V=!1;try{var G=!0;if(typeof F!==Zt){if(ue){c.setClockSkew(ue[kF]);var Y=ue[TF]||ue["kill-duration-seconds"];Fe(a.setKillSwitchTenants(ue[m6],Y),function(Ie){Fe(k.batches,function(q){if(q.iKey()===Ie){ce=ce||[];var se=q.split(0);k.numEvents-=se.count(),ce.push(se)}})})}if(F==200||F==204){X=200;return}(!C6(F)||k.numEvents<=0)&&(G=!1),X=9e3+F%1e3}if(G){X=100;var oe=k.retryCnt;k.sendType===0&&(oe<n?(ve=!0,Yt(function(){k.sendType===0&&p--,xe(k.batches,oe+1,k.isTeardown,A?2:k.sendType,5)},A,kk(oe))):(V=!0,A&&(X=8001)))}}finally{ve||(c.setClockSkew(),_e(k,X,O,V)),Lt(ce,8004,k.sendType)}}function _e(F,ue,k,O){try{O&&f._backOffTransmission(),ue===200&&(!O&&!F.isSync&&f._clearBackOff(),Ae(F.batches)),Lt(F.batches,ue,F.sendType,!0)}finally{F.sendType===0&&(p--,k!==5&&Ce.sendQueuedRequests(F.sendType,k))}}function Ae(F){if(M){var ue=To();Fe(F,function(k){k&&k.count()>0&&W(k.events(),ue)})}}function Yt(F,ue,k){ue?F():o.set(F,k)}function ze(F){var ue={};if(fn(F)){var k=Hr(F).split(/[\r\n]+/);Fe(k,function(O){if(O){var X=O.indexOf(": ");if(X!==-1){var ce=Hr(O.substring(0,X)).toLowerCase(),ve=Hr(O.substring(X+1));ue[ce]=ve}else ue[Hr(O)]=1}})}return ue}function bt(F){for(var ue=0;ue<F.batches.length;ue++){var k=F.batches[ue].Msfpc();if(k)return encodeURIComponent(k)}return fl}function Xt(F){var ue=Ce._responseHandlers;try{for(var k=0;k<ue.length;k++)try{ue[k](F)}catch(X){en(m,1,519,"Response handler failed: "+X)}if(F){var O=JSON.parse(F);Jn(O.webResult)&&Jn(O.webResult[ib])&&x.set("MSFPC",O.webResult[ib],365*86400)}}catch(X){}}function Lt(F,ue,k,O){if(F&&F.length>0&&i){var X=i[Tr(ue)];if(X){var ce=k!==0;En(g,function(){return"HttpManager:_sendBatchesNotification"},function(){Yt(function(){try{X.call(i,F,ue,ce,k)}catch(ve){en(m,1,74,"send request notification failed: "+ve)}},O||ce,0)},function(){return{batches:he(F),reason:ue,isSync:ce,sendSync:O,sendType:k}},!ce)}}}function Tr(F){var ue=hue[F];return Jn(ue)||(ue=p6,F>=9e3&&F<=9999?ue=d6:F>=8e3&&F<=8999?ue=Ek:F>=1e3&&F<=1999&&(ue=u6)),ue}})}return r.__ieDyn=1,r}()});function gue(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];return setTimeout(r,e,t)}function vue(r){clearTimeout(r)}function tw(r,e){return{set:r||gue,clear:e||vue}}var K6=ee(()=>{d()});var yue,F6,bue,U6,W6,Iue,V6,Sue,Th,Rk,j6,B6,_ue,Eue,H6,J6=ee(()=>{d();lr();mr();wh();wF();MF();L6();ew();OF();K6();yue=.25,F6=500,bue=20,U6=6,W6=2,Iue=4,V6=2,Sue=1,Th="eventsDiscarded",Rk="overrideInstrumentationKey",j6="maxEventRetryAttempts",B6="maxUnloadEventRetryAttempts",_ue="addUnloadCb",Eue=function(r){_n(e,r);function e(){var t=r.call(this)||this;t.identifier="PostChannel",t.priority=1011,t.version="3.2.9";var n,i=!1,o=[],s=null,a=!1,l=0,c=500,u=0,p=1e4,f={},m=xh,h=null,g=null,v=0,S=0,_,D,P={},M,x,A=-1,j,re=!0,R=!1,Z=U6,ge=W6,Ke,Ce;return Be(e,t,function(ae,Nt){we(),ae._getDbgPlgTargets=function(){return[D]},ae.initialize=function(V,G,Y){En(G,function(){return"PostChannel:initialize"},function(){var oe=G;Nt.initialize(V,G,Y);try{var Ie=!!G[_ue];Ke=td(al(ae.identifier),G.evtNamespace&&G.evtNamespace());var q=ae._getTelCtx();V.extensionConfig[ae.identifier]=V.extensionConfig[ae.identifier]||{},n=q.getExtCfg(ae.identifier),Ce=tw(n.setTimeoutOverride,n.clearTimeoutOverride),re=!n.disableOptimizeObj&&yk(),Je(oe),n.eventsLimitInMem>0&&(p=n.eventsLimitInMem),n.immediateEventLimit>0&&(c=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(M=n.autoFlushEventsLimit),Qo(n[j6])&&(Z=n[j6]),Qo(n[B6])&&(ge=n[B6]),ve(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(_=n.httpXHROverride),Jn(V.anonCookieName)&&D.addQueryStringParameter("anoncknm",V.anonCookieName),D.sendHook=n.payloadPreprocessor,D.sendListener=n.payloadListener;var se=n.overrideEndpointUrl?n.overrideEndpointUrl:V.endpointUrl;ae._notificationManager=G.getNotifyMgr(),D.initialize(se,ae.core,ae,_,n);var K=V.disablePageUnloadEvents||[];vh(vr,K,Ke),Yy(vr,K,Ke),$y(Xr,V.disablePageShowEvents,Ke)}catch(U){throw ae.setInitialized(!1),U}},function(){return{coreConfig:V,core:G,extensions:Y}})},ae.processTelemetry=function(V,G){_h(V,ae.identifier),G=ae._getTelCtx(G);var Y=G.getExtCfg(ae.identifier),oe=!!n.disableTelemetry;Y&&(oe=oe||!!Y.disableTelemetry);var Ie=V;!oe&&!i&&(n[Rk]&&(Ie.iKey=n[Rk]),Y&&Y[Rk]&&(Ie.iKey=Y[Rk]),H(Ie,!0),R?he(2,2):be()),ae.processNext(Ie,G)},ae._doTeardown=function(V,G){he(2,2),i=!0,D.teardown(),AC(null,Ke),MC(null,Ke),OC(null,Ke),we()};function Je(V){var G=V.getWParam;V.getWParam=function(){var Y=0;return n.ignoreMc1Ms0CookieProcessing&&(Y=Y|2),Y|G()}}function vr(V){var G=V||Dc().event;G.type!=="beforeunload"&&(R=!0,D.setUnloading(R)),he(2,2)}function Xr(V){R=!1,D.setUnloading(R)}function H(V,G){if(V.sendAttempt||(V.sendAttempt=0),V.latency||(V.latency=1),V.ext&&V.ext[AF]&&delete V.ext[AF],V.ext&&V.ext[Tk]&&V.ext[Tk].id&&delete V.ext[Tk].id,re&&(_h,V.ext=zu(V.ext),V.baseData&&(V.baseData=zu(V.baseData)),V.data&&(V.data=zu(V.data))),V.sync){if(v||a)V.latency=3,V.sync=!1;else if(D){re&&(V=zu(V)),D.sendSynchronousBatch(ob.create(V.iKey,[V]),V.sync===!0?1:V.sync,3);return}}var Y=V.latency,oe=u,Ie=p;Y===4&&(oe=l,Ie=c);var q=!1;if(oe<Ie)q=!N(V,G);else{var se=1,K=bue;Y===4&&(se=4,K=1),q=!0,W(V.iKey,V.latency,se,K)&&(q=!N(V,G))}q&&Tr(Th,[V],rl.QueueFull)}ae.setEventQueueLimits=function(V,G){p=V>0?V:1e4,M=G>0?G:0,ve();var Y=u>V;if(!Y&&x>0)for(var oe=1;!Y&&oe<=3;oe++){var Ie=P[oe];Ie&&Ie.batches&&Fe(Ie.batches,function(q){q&&q.count()>=x&&(Y=!0)})}et(!0,Y)},ae.pause=function(){le(),a=!0,D.pause()},ae.resume=function(){a=!1,D.resume(),be()},ae.addResponseHandler=function(V){D._responseHandlers.push(V)},ae._loadTransmitProfiles=function(V){ze(),Br(V,function(G,Y){var oe=Y.length;if(oe>=2){var Ie=oe>2?Y[2]:0;if(Y.splice(0,oe-2),Y[1]<0&&(Y[0]=-1),Y[1]>0&&Y[0]>0){var q=Y[0]/Y[1];Y[0]=Math.ceil(q)*Y[1]}Ie>=0&&Y[1]>=0&&Ie>Y[1]&&(Ie=Y[1]),Y.push(Ie),f[G]=Y}})},ae.flush=function(V,G,Y){if(V===void 0&&(V=!0),!a)if(Y=Y||1,V)s==null?(le(),_e(1,0,Y),s=L(function(){s=null,Ae(G,Y)},0)):o.push(G);else{var oe=le();de(1,1,Y),G!=null&&G(),oe&&be()}},ae.setMsaAuthTicket=function(V){D.addHeader(ZC,V)},ae.hasEvents=Te,ae._setTransmitProfile=function(V){m!==V&&f[V]!==void 0&&(le(),m=V,be())};function de(V,G,Y){var oe=_e(V,G,Y);return D.sendQueuedRequests(G,Y),oe}function Te(){return u>0}function be(){if(A>=0&&_e(A,0,j)&&D.sendQueuedRequests(0,j),l>0&&!g&&!a){var V=f[m][2];V>=0&&(g=L(function(){g=null,de(4,0,1),be()},V))}var G=f[m][1];!h&&!s&&G>=0&&!a&&(Te()?h=L(function(){h=null,de(S===0?3:1,0,1),S++,S%=2,be()},G):S=0)}ae._backOffTransmission=function(){v<Iue&&(v++,le(),be())},ae._clearBackOff=function(){v&&(v=0,le(),be())};function we(){n=null,i=!1,o=[],s=null,a=!1,l=0,c=500,u=0,p=1e4,f={},m=xh,h=null,g=null,v=0,S=0,_=null,P={},M=void 0,x=0,A=-1,j=null,re=!0,R=!1,Z=U6,ge=W6,Ke=null,Ce=tw(),D=new O6(F6,V6,Sue,{requeue:Xt,send:ue,sent:k,drop:O,rspFail:X,oth:ce},Ce),bt(),xe(),ve()}function L(V,G){G===0&&v&&(G=1);var Y=1e3;return v&&(Y=kk(v-1)),Ce.set(V,G*Y)}function le(){return h!==null?(Ce.clear(h),h=null,S=0,!0):!1}function he(V,G){le(),s&&(Ce.clear(s),s=null),a||de(1,V,G)}function xe(){P[4]={batches:[],iKeyMap:{}},P[3]={batches:[],iKeyMap:{}},P[2]={batches:[],iKeyMap:{}},P[1]={batches:[],iKeyMap:{}}}function Le(V,G,Y){var oe=P[G];oe||(G=1,oe=P[G]);var Ie=oe.iKeyMap[V];return!Ie&&Y&&(Ie=ob.create(V),oe.batches.push(Ie),oe.iKeyMap[V]=Ie),Ie}function et(V,G){D.canSendRequest()&&!v&&(M>0&&u>M&&(G=!0),G&&s==null&&ae.flush(V,null,20))}function N(V,G){re&&(V=zu(V));var Y=V.latency,oe=Le(V.iKey,Y,!0);return oe.addEvent(V)?(Y!==4?(u++,G&&V.sendAttempt===0&&et(!V.sync,x>0&&oe.count()>=x)):l++,!0):!1}function W(V,G,Y,oe){for(;Y<=G;){var Ie=Le(V,G,!0);if(Ie&&Ie.count()>0){var q=Ie.split(0,oe),se=q.count();if(se>0)return Y===4?l-=se:u-=se,F(Th,[q],rl.QueueFull),!0}Y++}return pe(),!1}function pe(){for(var V=0,G=0,Y=function(Ie){var q=P[Ie];q&&q.batches&&Fe(q.batches,function(se){Ie===4?V+=se.count():G+=se.count()})},oe=1;oe<=4;oe++)Y(oe);u=G,l=V}function _e(V,G,Y){var oe=!1,Ie=G===0;return!Ie||D.canSendRequest()?En(ae.core,function(){return"PostChannel._queueBatches"},function(){for(var q=[],se=4;se>=V;){var K=P[se];K&&K.batches&&K.batches.length>0&&(Fe(K.batches,function(U){D.addBatch(U)?oe=oe||U&&U.count()>0:q=q.concat(U.events()),se===4?l-=U.count():u-=U.count()}),K.batches=[],K.iKeyMap={}),se--}q.length>0&&Tr(Th,q,rl.KillSwitch),oe&&A>=V&&(A=-1,j=0)},function(){return{latency:V,sendType:G,sendReason:Y}},!Ie):(A=A>=0?Math.min(A,V):V,j=Math.max(j,Y)),oe}function Ae(V,G){de(1,0,G),pe(),Yt(function(){V&&V(),o.length>0?s=L(function(){s=null,Ae(o.shift(),G)},0):(s=null,be())})}function Yt(V){D.isCompletelyIdle()?V():s=L(function(){s=null,Yt(V)},yue)}function ze(){le(),bt(),m=xh,be()}function bt(){f={},f[xh]=[2,1,0],f[Ik]=[6,3,0],f[Sk]=[18,9,0]}function Xt(V,G){var Y=[],oe=Z;R&&(oe=ge),Fe(V,function(Ie){Ie&&Ie.count()>0&&Fe(Ie.events(),function(q){q&&(q.sync&&(q.latency=4,q.sync=!1),q.sendAttempt<oe?(_h(q,ae.identifier),H(q,!1)):Y.push(q))})}),Y.length>0&&Tr(Th,Y,rl.NonRetryableStatus),R&&he(2,2)}function Lt(V,G){var Y=ae._notificationManager||{},oe=Y[V];if(oe)try{oe.apply(Y,G)}catch(Ie){en(ae.diagLog(),1,74,V+" notification failed: "+Ie)}}function Tr(V,G){for(var Y=[],oe=2;oe<arguments.length;oe++)Y[oe-2]=arguments[oe];G&&G.length>0&&Lt(V,[G].concat(Y))}function F(V,G){for(var Y=[],oe=2;oe<arguments.length;oe++)Y[oe-2]=arguments[oe];G&&G.length>0&&Fe(G,function(Ie){Ie&&Ie.count()>0&&Lt(V,[Ie.events()].concat(Y))})}function ue(V,G,Y){V&&V.length>0&&Lt("eventsSendRequest",[G>=1e3&&G<=1999?G-1e3:0,Y!==!0])}function k(V,G){F("eventsSent",V,G),be()}function O(V,G){F(Th,V,G>=8e3&&G<=8999?G-8e3:rl.Unknown)}function X(V){F(Th,V,rl.NonRetryableStatus),be()}function ce(V,G){F(Th,V,rl.Unknown),be()}function ve(){!n||!n.disableAutoBatchFlushLimit?x=Math.max(F6*(V6+1),p/6):x=0}Ps(ae,"_setTimeoutOverride",function(){return Ce.set},function(V){Ce=tw(V,Ce.clear)}),Ps(ae,"_clearTimeoutOverride",function(){return Ce.clear},function(V){Ce=tw(Ce.set,V)})}),t}return e.__ieDyn=1,e}(bh),H6=Eue});var q6={};Um(q6,{BE_PROFILE:()=>Sk,NRT_PROFILE:()=>Ik,PostChannel:()=>H6,RT_PROFILE:()=>xh});var G6=ee(()=>{d();J6();wF()});var Cue,Y6,$6=ee(()=>{d();Cue=async(r,e,t)=>{let n=await Promise.resolve().then(()=>(wh(),l6)),i=await Promise.resolve().then(()=>(G6(),q6)),o=new n.AppInsightsCore,s=new i.PostChannel,a={instrumentationKey:r,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[s]]};if(t){a.extensionConfig={};let u={alwaysUseXhrOverride:!0,httpXHROverride:t};a.extensionConfig[s.identifier]=u}let c=e.workspace.getConfiguration("telemetry").get("internalTesting");return o.initialize(a,[]),o.addTelemetryInitializer(u=>{var p,f;c&&(u.ext=(p=u.ext)!=null?p:{},u.ext.utc=(f=u.ext.utc)!=null?f:{},u.ext.utc.flags=8462029)}),o},Y6=async(r,e,t)=>{let n=await Cue(r,e,t);return{logEvent:(o,s)=>{try{n==null||n.track({name:o,baseData:{name:o,properties:s==null?void 0:s.properties,measurements:s==null?void 0:s.measurements}})}catch(a){throw new Error(`Failed to log event to app insights!
`+a.message)}},flush:async()=>{try{n==null||n.unload()}catch(o){throw new Error(`Failed to flush app insights!
`+o.message)}}}}});var cd,Ak,z6=ee(()=>{d();(function(r){r[r.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",r[r.INSTANTIATING=1]="INSTANTIATING",r[r.INSTANTIATED=2]="INSTANTIATED"})(cd||(cd={}));Ak=class{constructor(e,t){this._instantiationStatus=cd.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=t,this._key=e}sendEventData(e,t){if(!this._telemetryClient){this._instantiationStatus!==cd.INSTANTIATED&&this._eventQueue.push({eventName:e,data:t});return}this._telemetryClient.logEvent(e,t)}sendErrorData(e,t){if(!this._telemetryClient){this._instantiationStatus!==cd.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:t});return}}async flush(){this._telemetryClient&&(await this._telemetryClient.flush(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:t})=>this.sendEventData(e,t)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:t})=>this.sendErrorData(e,t)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===cd.NOT_INSTANTIATED&&(this._instantiationStatus=cd.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=cd.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=cd.INSTANTIATED}))}}});var Mk,Q6=ee(()=>{d();Mk=class{constructor(e,t,n){this.telemetrySender=e,this.vscodeAPI=t,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logUsage(e,{properties:t,measurements:n})}sendTelemetryEvent(e,t,n){this.internalSendTelemetryEvent(e,t,n,!1)}sendDangerousTelemetryEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,t,n,!0)}internalSendTelemetryErrorEvent(e,t,n,i){i?this.telemetrySender.sendEventData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryErrorEvent(e,t,n){this.internalSendTelemetryErrorEvent(e,t,n,!1)}sendDangerousTelemetryErrorEvent(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,t,n,!0)}internalSendTelemetryException(e,t,n,i){i?this.telemetrySender.sendErrorData(e,{properties:t,measurements:n}):this.telemetryLogger.logError(e,{properties:t,measurements:n})}sendTelemetryException(e,t,n){this.internalSendTelemetryException(e,t,n,!1)}sendDangerousTelemetryException(e,t,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryException(e,t,n,!0)}dispose(){return this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}}});var ab,X6=ee(()=>{d();ab=class r{static applyReplacements(e,t){for(let n of Object.keys(e))for(let i of t)i.lookup.test(n)&&(i.replacementString!==void 0?e[n]=i.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.7.7"}}static getInstance(){return r._instance||(r._instance=new r),r._instance}}});var Ok,lb,ud,Lk,cb,UF,rw,WF,Z6,fa,Kk=ee(()=>{d();Ok="name",lb="push",ud="length",Lk="messageId",cb="message",UF="diagLog",rw="replace",WF="enableDebugExceptions",Z6="logInternalMessage",fa="call"});var ml,Fk,Uk,Wk=ee(()=>{d();ml="",Fk="errorToConsole",Uk="warnToConsole"});function Vk(r){return r===void 0||typeof r===Zt}function kh(r){return r===null||Vk(r)}function Nh(r){return!!(r&&typeof r===pt)}function nw(r){return!!(r&&typeof r===on)}function Tc(r,e){if(r)for(var t in r)ar[fa](r,t)&&e[fa](r,t,r[t])}function Aue(r){return!!(r&&a3[fa](r)==="[object Array]")}function iw(r){return!!(r&&a3[fa](r)==="[object Error]")}function rs(r){return typeof r=="string"}function jk(r){if(r)return kue?r[o3]():Mue(r)}function Mue(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[ud]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ow(r,e,t){var n=r[ud];try{for(var i=0;i<n&&!(i in r&&e[fa](t||r,r[i],i,r)===-1);i++);}catch(o){}}function JF(r,e,t){if(r){if(r[e3])return r[e3](e,t);var n=r[ud],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function Ah(r,e,t){var n;if(r){if(r[t3])return r[t3](e,t);var i=r[ud],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[fa](o,r[s],r))}catch(a){}}return n}function qF(r,e,t){var n;if(r){if(r[r3])return r[r3](e,t);var i=r[ud],o=0;if(arguments[ud]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function hl(r){return r&&(r=Pue&&r[jF]?r[jF]():r[rw]?r[rw](/^\s+|(?=\s)\s+$/g,ml):r),r}function GF(r){var e=typeof r;if(e!==on&&(e!==pt||r===null)&&aa("objKeys called on non-object"),!i3&&n3)return n3(r);var t=[];for(var n in r)r&&ar[fa](r,n)&&t[lb](n);if(i3)for(var i=VF[ud],o=0;o<i;o++)r&&ar[fa](r,VF[o])&&t[lb](VF[o]);return t}function Oue(r){return r}function Bk(r){return BF&&Tc(r,function(e,t){(Rh(t)||Nh(t))&&BF(t)}),l3(r)}function sw(r){return iw(r)?r[Ok]:ml}function aw(r,e){return kh(r)?e:r}function YF(r){return function(){function e(){var t=this;r&&Tc(r,function(n,i){t[n]=i})}return e}()}var o3,xue,Due,e3,t3,r3,jF,s3,BF,IUe,n3,HF,Pue,SUe,_Ue,Tue,kue,Nue,a3,Rue,EUe,Rh,i3,VF,l3,Hk=ee(()=>{d();lr();Kk();Wk();o3="toISOString",xue="endsWith",Due="startsWith",e3="indexOf",t3="map",r3="reduce",jF="trim",s3="toString",BF=wr.freeze,IUe=wr.seal,n3=wr.keys,HF=String[Ft],Pue=HF[jF],SUe=HF[xue],_Ue=HF[Due],Tue=Date[Ft],kue=Tue[o3],Nue=Array.isArray,a3=sa[s3],Rue=ar[s3],EUe=Rue[fa](wr);Rh=Nue||Aue;i3=!{toString:null}.propertyIsEnumerable("toString"),VF=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];l3=BF||Oue});function ub(r){var e={};return Tc(r,function(t,n){e[t]=n,e[n]=t}),Bk(e)}function $F(r){var e={};return Tc(r,function(t,n){e[t]=n[1],e[n[0]]=n[1]}),Bk(e)}var c3=ee(()=>{d();Hk()});function dd(r){var e=Bn();return e&&e[r]?e[r]:r===Lue&&d3()?window:null}function d3(){return!!(typeof window===pt&&window)}function p3(){return!!(typeof document===pt&&document)}function zF(){return p3()?document:dd(Kue)}function QF(){return typeof console!==Zt?console:dd(Fue)}function Mh(){return!!(typeof JSON===pt&&JSON||dd(u3)!==null)}function db(){return Mh()?JSON||dd(u3):null}function Oh(r){var e=Object[Ft].toString[fa](r),t=ml;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Ok]+"'":Mh()&&(t=db().stringify(r)),e+t}var Lue,Kue,Fue,u3,Jk=ee(()=>{"use strict";d();lr();Kk();Wk();Lue="window",Kue="document",Fue="console",u3="JSON"});function Uue(){var r=dd("Microsoft");return r&&(qk=r.ApplicationInsights),qk}function f3(r){var e=qk;return!e&&r.disableDbgExt!==!0&&(e=qk||Uue()),e?e.ChromeDbgExt:null}var qk,m3=ee(()=>{d();Jk();qk=null});function h3(r){return r?'"'+r[rw](/\"/g,ml)+'"':ml}function g3(r,e){var t=QF();if(t){var n="log";t[r]&&(n=r),nw(t[n])&&t[n](e)}}function Bue(r){return r||new v3}function gl(r,e,t,n,i,o){o===void 0&&(o=!1),Bue(r).throwInternal(e,t,n,i,o)}var Wue,Vue,jue,XF,v3,y3=ee(()=>{"use strict";d();mr();Kk();m3();Jk();Hk();Wk();Wue="AI (Internal): ",Vue="AI: ",jue="AITR_";XF=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Lk]=e,o[cb]=(n?Vue:Wue)+e;var s=ml;Mh()&&(s=db().stringify(i));var a=(t?" message:"+h3(t):ml)+(i?" props:"+h3(s):ml);o[cb]+=a}return r.dataType="MessageData",r}(),v3=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[WF]=function(){return a},l.throwInternal=function(m,h,g,v,S){S===void 0&&(S=!1);var _=new XF(h,g,S,v);if(a)throw Oh(_);var D=m===1?Fk:Uk;if(Vk(_[cb]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[Lk];!n[P]&&i>=m&&(l[D](_[cb]),n[P]=!0)}else i>=m&&l[D](_[cb]);c(m,_)}},l[Uk]=function(m){g3("warn",m),f("warning",m)},l[Fk]=function(m){g3("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[Z6]=c;function c(m,h){if(!p()){var g=!0,v=jue+h[Lk];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[lb](h),t++,f(m===1?"error":"warn",h)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new XF(23,S,!1);l.queue[lb](_),m===1?l[Fk](S):l[Uk](S)}}}function u(m){i=aw(m.loggingLevelConsole,0),o=aw(m.loggingLevelTelemetry,1),s=aw(m.maxMessageLimit,25),a=aw(m[WF],!1)}function p(){return t>=s}function f(m,h){var g=f3(e||{});g&&g[UF]&&g[UF](m,h)}})}return r.__ieDyn=1,r}()});var ma=ee(()=>{d();Hk();c3();Jk();lr();y3()});var lw,cw,uw,Gk,Lh,pd,Mi,vl=ee(()=>{d();lw="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",cw="sampleRate",uw="ProcessLegacy",Gk="http.method",Lh="https://dc.services.visualstudio.com",pd="/v2/track",Mi="not_specified"});var Kh,At,Fh,dw,yl,b3,eo,fd,I3,pw,fw,Yk,Uh,ha,to,ro,Wh,kc,Vh,$k,zk,ZF,jh,mw,hw,Bh,pb,fb,Hh,eU,Jh,S3,_3,E3,C3,ko=ee(()=>{d();Kh="split",At="length",Fh="toLowerCase",dw="ingestionendpoint",yl="toString",b3="removeItem",eo="name",fd="message",I3="count",pw="stringify",fw="pathname",Yk="indexOf",Uh="exceptions",ha="parsedStack",to="properties",ro="measurements",Wh="sizeInBytes",kc="typeName",Vh="severityLevel",$k="problemGroup",zk="isManual",ZF="CreateFromInterface",jh="assembly",mw="hasFullStack",hw="level",Bh="method",pb="fileName",fb="line",Hh="duration",eU="receivedResponse",Jh="substring",S3="sanitizeKeyAndAddUniqueness",_3="sanitizeException",E3="sanitizeProperties",C3="sanitizeMeasurements"});function Qk(r){(isNaN(r)||r<0)&&(r=0),r=Math.round(r);var e=gw+r%1e3,t=gw+Math.floor(r/1e3)%60,n=gw+Math.floor(r/(1e3*60))%60,i=gw+Math.floor(r/(1e3*60*60))%24,o=Math.floor(r/(1e3*60*60*24));return e=e[At]===1?"00"+e:e[At]===2?"0"+e:e,t=t[At]<2?"0"+t:t,n=n[At]<2?"0"+n:n,i=i[At]<2?"0"+i:i,(o>0?o+".":gw)+i+":"+n+":"+t+"."+e}var gw,tU=ee(()=>{d();ko();gw=""});var mb,w3=ee(()=>{d();ma();mb=$F({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Xk,iWe,x3=ee(()=>{d();ma();Xk=ub({LocalStorage:0,SessionStorage:1}),iWe=ub({AI:0,AI_AND_W3C:1,W3C:2})});function D3(r){try{if(kh(Bn()))return null;var e=new Date()[yl](),t=dd(r===Xk.LocalStorage?"localStorage":"sessionStorage");t.setItem(e,e);var n=t.getItem(e)!==e;if(t[b3](e),!n)return t}catch(i){}return null}function P3(){return Zk()?D3(Xk.SessionStorage):null}function Zk(r){return(r||vw===void 0)&&(vw=!!D3(Xk.SessionStorage)),vw}function rU(r,e){var t=P3();if(t!==null)try{return t.getItem(e)}catch(n){vw=!1,gl(r,2,2,"Browser failed read of session storage. "+sw(n),{exception:Oh(n)})}return null}function eN(r,e,t){var n=P3();if(n!==null)try{return n.setItem(e,t),!0}catch(i){vw=!1,gl(r,2,4,"Browser failed write to session storage. "+sw(i),{exception:Oh(i)})}return!1}var vw,T3=ee(()=>{d();ma();x3();ko();vw=void 0});function tN(r,e,t){var n=e[At],i=nU(r,e);if(i[At]!==n){for(var o=0,s=i;t[s]!==void 0;)o++,s=i[Jh](0,150-3)+iU(o);i=s}return i}function nU(r,e){var t;return e&&(e=hl(e[yl]()),e[At]>150&&(t=e[Jh](0,150),gl(r,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),t||e}function tn(r,e,t){t===void 0&&(t=1024);var n;return e&&(t=t||1024,e=hl(e),e.toString()[At]>t&&(n=e[yl]()[Jh](0,t),gl(r,2,61,"string value is too long. It has been truncated to "+t+" characters.",{value:e},!0))),n||e}function of(r,e){return iN(r,e,2048,66)}function hb(r,e){var t;return e&&e[At]>32768&&(t=e[Jh](0,32768),gl(r,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),t||e}function rN(r,e){var t;if(e){var n=""+e;n[At]>32768&&(t=n[Jh](0,32768),gl(r,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return t||e}function no(r,e){if(e){var t={};Tc(e,function(n,i){if(Nh(i)&&Mh())try{i=db()[pw](i)}catch(o){gl(r,2,49,"custom property is not valid",{exception:o},!0)}i=tn(r,i,8192),n=tN(r,n,t),t[n]=i}),e=t}return e}function io(r,e){if(e){var t={};Tc(e,function(n,i){n=tN(r,n,t),t[n]=i}),e=t}return e}function nN(r,e){return e&&iN(r,e,128,69)[yl]()}function iN(r,e,t,n){var i;return e&&(e=hl(e),e[At]>t&&(i=e[Jh](0,t),gl(r,2,n,"input is too long, it has been truncated to "+t+" characters.",{data:e},!0))),i||e}function iU(r){var e="00"+r;return e.substr(e[At]-3)}var ns,$ue,bl=ee(()=>{d();ma();ko();$ue=(ns={MAX_NAME_LENGTH:150,MAX_ID_LENGTH:128,MAX_PROPERTY_LENGTH:8192,MAX_STRING_LENGTH:1024,MAX_URL_LENGTH:2048,MAX_MESSAGE_LENGTH:32768,MAX_EXCEPTION_LENGTH:32768},ns[S3]=tN,ns.sanitizeKey=nU,ns.sanitizeString=tn,ns.sanitizeUrl=of,ns.sanitizeMessage=hb,ns[_3]=rN,ns[E3]=no,ns[C3]=io,ns.sanitizeId=nN,ns.sanitizeInput=iN,ns.padNumber=iU,ns.trim=hl,ns)});function R3(r){var e=N3,t=zue,n=t[e];return k3.createElement?t[e]||(n=t[e]=k3.createElement("a")):n={host:A3(r,!0)},n.href=r,e++,e>=t[At]&&(e=0),N3=e,n}function A3(r,e){var t=M3(r,e)||"";if(t){var n=t.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>3&&rs(n[2])&&n[2][At]>0)return n[2]+(n[3]||"")}return t}function M3(r,e){var t=null;if(r){var n=r.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[At]>2&&rs(n[2])&&n[2][At]>0&&(t=n[2]||"",e&&n[At]>2)){var i=(n[1]||"")[Fh](),o=n[3]||"";(i==="http"&&o===":80"||i==="https"&&o===":443")&&(o=""),t+=o}}return t}var k3,N3,zue,O3=ee(()=>{d();ma();ko();k3=zF()||{},N3=0,zue=[null,null,null,null,null]});function yw(r){return JF(Que,r[Fh]())!==-1}function L3(r,e,t,n){var i,o=n,s=n;if(e&&e[At]>0){var a=R3(e);if(i=a.host,!o)if(a[fw]!=null){var l=a.pathname[At]===0?"/":a[fw];l.charAt(0)!=="/"&&(l="/"+l),s=a[fw],o=tn(r,t?t+" "+l:l)}else o=tn(r,e)}else i=n,o=n;return{target:i,name:o,data:s}}var Que,oU=ee(()=>{d();ma();vl();bl();O3();ko();Que=[Lh+pd,"https://breeze.aimon.applicationinsights.io"+pd,"https://dc-int.services.visualstudio.com"+pd]});function sU(r){if(!r)return{};var e=r[Kh](Xue),t=qF(e,function(i,o){var s=o[Kh](Zue);if(s[At]===2){var a=s[0][Fh](),l=s[1];i[a]=l}return i},{});if(GF(t)[At]>0){if(t.endpointsuffix){var n=t.location?t.location+".":"";t[dw]=t[dw]||"https://"+n+"dc."+t.endpointsuffix}t[dw]=t[dw]||Lh}return t}var Xue,Zue,K3=ee(()=>{d();ma();vl();ko();Xue=";",Zue="="});var aU,F3=ee(()=>{d();ma();vl();ko();bl();aU=function(){function r(e,t,n){var i=this,o=this;o.ver=1,o.sampleRate=100,o.tags={},o[eo]=tn(e,n)||Mi,o.data=t,o.time=jk(new Date),o.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return i.sampleRate===100?4:1},tags:1,data:1}}return r}()});var md,U3=ee(()=>{d();vl();ko();bl();md=function(){function r(e,t,n,i){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var o=this;o.ver=2,o[eo]=tn(e,t)||Mi,o[to]=no(e,n),o[ro]=io(e,i)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Event",r.dataType="EventData",r}()});function dU(r,e){var t=r;return t&&!rs(t)&&(JSON&&JSON[pw]?(t=JSON[pw](r),e&&(!t||t==="{}")&&(nw(r[yl])?t=r[yl]():t=""+r)):t=""+r+" - (Missing JSON.stringify)"),t||""}function H3(r,e){var t=r;return r&&(t&&!rs(t)&&(t=r[uU]||r[B3]||t),t&&!rs(t)&&(t=dU(t,!0)),r.filename&&(t=t+" @"+(r.filename||"")+":"+(r.lineno||"?")+":"+(r.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&(t||"")[Yk](e)===-1&&(t=e+": "+t),t||""}function tde(r){try{if(Nh(r))return"hasFullStack"in r&&"typeName"in r}catch(e){}return!1}function rde(r){try{if(Nh(r))return"ver"in r&&"exceptions"in r&&"properties"in r}catch(e){}return!1}function V3(r){return r&&r.src&&rs(r.src)&&r.obj&&Rh(r.obj)}function qh(r){var e=r||"";rs(e)||(rs(e[is])?e=e[is]:e=""+e);var t=e[Kh](`
`);return{src:e,obj:t}}function nde(r){for(var e=[],t=r[Kh](`
`),n=0;n<t[At];n++){var i=t[n];t[n+1]&&(i+="@"+t[n+1],n++),e.push(i)}return{src:r,obj:e}}function J3(r){var e=null;if(r)try{if(r[is])e=qh(r[is]);else if(r[gb]&&r[gb][is])e=qh(r[gb][is]);else if(r.exception&&r.exception[is])e=qh(r.exception[is]);else if(V3(r))e=r;else if(V3(r[cU]))e=r[cU];else if(window&&window.opera&&r[uU])e=nde(r[fd]);else if(r.reason&&r.reason[is])e=qh(r.reason[is]);else if(rs(r))e=qh(r);else{var t=r[uU]||r[B3]||"";rs(r[W3])&&(t&&(t+=`
`),t+=" from "+r[W3]),t&&(e=qh(t))}}catch(n){e=qh(n)}return e||{src:"",obj:null}}function ide(r){var e="";return r&&(r.obj?ow(r.obj,function(t){e+=t+`
`}):e=r.src||""),e}function ode(r){var e,t=r.obj;if(t&&t[At]>0){e=[];var n=0,i=0;ow(t,function(h){var g=h[yl]();if(pU.regex.test(g)){var v=new pU(g,n++);i+=v[Wh],e.push(v)}});var o=32*1024;if(i>o)for(var s=0,a=e[At]-1,l=0,c=s,u=a;s<a;){var p=e[s][Wh],f=e[a][Wh];if(l+=p+f,l>o){var m=u-c+1;e.splice(c,m);break}c=s,u=a,s++,a--}}return e}function oN(r){var e="";if(r&&(e=r.typeName||r[eo]||"",!e))try{var t=/function (.{1,200})\(/,n=t.exec(r.constructor[yl]());e=n&&n[At]>1?n[1]:""}catch(i){}return e}function lU(r){if(r)try{if(!rs(r)){var e=oN(r),t=dU(r,!1);return(!t||t==="{}")&&(r[gb]&&(r=r[gb],e=oN(r)),t=dU(r,!0)),t[Yk](e)!==0&&e!=="String"?e+":"+t:t}}catch(n){}return""+(r||"")}var ede,gb,is,cU,W3,uU,B3,Gh,j3,pU,q3=ee(()=>{d();lr();ma();vl();ko();bl();ede="<no_method>",gb="error",is="stack",cU="stackDetails",W3="errorSrc",uU="message",B3="description";Gh=function(){function r(e,t,n,i,o,s){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var a=this;a.ver=2,rde(t)?(a[Uh]=t[Uh]||[],a[to]=t[to],a[ro]=t[ro],t[Vh]&&(a[Vh]=t[Vh]),t.id&&(a.id=t.id),t[$k]&&(a[$k]=t[$k]),kh(t[zk])||(a[zk]=t[zk])):(n||(n={}),a[Uh]=[new j3(e,t,n)],a[to]=no(e,n),a[ro]=io(e,i),o&&(a[Vh]=o),s&&(a.id=s))}return r.CreateAutoException=function(e,t,n,i,o,s,a,l){var c,u=oN(o||s||e);return c={},c[fd]=H3(e,u),c.url=t,c.lineNumber=n,c.columnNumber=i,c.error=lU(o||s||e),c.evt=lU(s||e),c[kc]=u,c.stackDetails=J3(a||o||s),c.errorSrc=l,c},r.CreateFromInterface=function(e,t,n,i){var o=t[Uh]&&Ah(t[Uh],function(a){return j3[ZF](e,a)}),s=new r(e,xo(xo({},t),{exceptions:o}),n,i);return s},r.prototype.toInterface=function(){var e,t=this,n=t.exceptions,i=t.properties,o=t.measurements,s=t.severityLevel,a=t.problemGroup,l=t.id,c=t.isManual,u=n instanceof Array&&Ah(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[Uh]=u,e.severityLevel=s,e.properties=i,e.measurements=o,e.problemGroup=a,e.id=l,e.isManual=c,e},r.CreateSimpleException=function(e,t,n,i,o,s){var a;return{exceptions:[(a={},a[mw]=!0,a.message=e,a.stack=o,a.typeName=t,a)]}},r.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",r.dataType="ExceptionData",r.formatError=lU,r}(),j3=function(){function r(e,t,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var i=this;if(tde(t))i[kc]=t[kc],i[fd]=t[fd],i[is]=t[is],i[ha]=t[ha]||[],i[mw]=t[mw];else{var o=t,s=o&&o.evt;iw(o)||(o=o[gb]||s||o),i[kc]=tn(e,oN(o))||Mi,i[fd]=hb(e,H3(t||o,i[kc]))||Mi;var a=t[cU]||J3(t);i[ha]=ode(a),Rh(i[ha])&&Ah(i[ha],function(l){return l[jh]=tn(e,l[jh])}),i[is]=rN(e,ide(a)),i.hasFullStack=Rh(i.parsedStack)&&i.parsedStack[At]>0,n&&(n[kc]=n[kc]||i[kc])}}return r.prototype.toInterface=function(){var e,t=this,n=t[ha]instanceof Array&&Ah(t[ha],function(o){return o.toInterface()}),i=(e={id:t.id,outerId:t.outerId,typeName:t[kc],message:t[fd],hasFullStack:t[mw],stack:t[is]},e[ha]=n||void 0,e);return i},r.CreateFromInterface=function(e,t){var n=t[ha]instanceof Array&&Ah(t[ha],function(o){return pU[ZF](o)})||t[ha],i=new r(e,xo(xo({},t),{parsedStack:n}));return i},r}(),pU=function(){function r(e,t){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[Wh]=0,typeof e=="string"){var i=e;n[hw]=t,n[Bh]=ede,n[jh]=hl(i),n[pb]="",n[fb]=0;var o=i.match(r.regex);o&&o[At]>=5&&(n[Bh]=hl(o[2])||n[Bh],n[pb]=hl(o[4]),n[fb]=parseInt(o[5])||0)}else n[hw]=e[hw],n[Bh]=e[Bh],n[jh]=e[jh],n[pb]=e[pb],n[fb]=e[fb],n[Wh]=0;n.sizeInBytes+=n.method[At],n.sizeInBytes+=n.fileName[At],n.sizeInBytes+=n.assembly[At],n[Wh]+=r.baseSize,n.sizeInBytes+=n.level.toString()[At],n.sizeInBytes+=n.line.toString()[At]}return r.CreateFromInterface=function(e){return new r(e,null)},r.prototype.toInterface=function(){var e=this;return{level:e[hw],method:e[Bh],assembly:e[jh],fileName:e[pb],line:e[fb]}},r.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,r.baseSize=58,r}()});var G3,Y3=ee(()=>{d();G3=function(){function r(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return r}()});var hd,$3=ee(()=>{d();vl();ko();Y3();bl();hd=function(){function r(e,t,n,i,o,s,a,l,c){this.aiDataContract={ver:1,metrics:1,properties:0};var u=this;u.ver=2;var p=new G3;p[I3]=i>0?i:void 0,p.max=isNaN(s)||s===null?void 0:s,p.min=isNaN(o)||o===null?void 0:o,p[eo]=tn(e,t)||Mi,p.value=n,p.stdDev=isNaN(a)||a===null?void 0:a,u.metrics=[p],u[to]=no(e,l),u[ro]=io(e,c)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",r.dataType="MetricData",r}()});var Yh,z3=ee(()=>{d();vl();tU();ko();bl();Yh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var l=this;l.ver=2,l.id=nN(e,a),l.url=of(e,n),l[eo]=tn(e,t)||Mi,isNaN(i)||(l[Hh]=Qk(i)),l[to]=no(e,o),l[ro]=io(e,s)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",r.dataType="PageviewData",r}()});var $h,Q3=ee(()=>{d();tU();oU();ko();bl();$h=function(){function r(e,t,n,i,o,s,a,l,c,u,p,f){c===void 0&&(c="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=t,m[Hh]=Qk(o),m.success=s,m.resultCode=a+"",m.type=tn(e,c);var h=L3(e,n,l,i);m.data=of(e,i)||h.data,m.target=tn(e,h.target),u&&(m.target="".concat(m.target," | ").concat(u)),m[eo]=tn(e,h[eo]),m[to]=no(e,p),m[ro]=io(e,f)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",r.dataType="RemoteDependencyData",r}()});var zh,X3=ee(()=>{d();vl();ko();bl();zh=function(){function r(e,t,n,i,o){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var s=this;s.ver=2,t=t||Mi,s[fd]=hb(e,t),s[to]=no(e,i),s[ro]=io(e,o),n&&(s[Vh]=n)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.Message",r.dataType="MessageData",r}()});var Qh,Z3=ee(()=>{d();vl();ko();bl();Qh=function(){function r(e,t,n,i,o,s,a){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var l=this;l.ver=2,l.url=of(e,n),l[eo]=tn(e,t)||Mi,l[to]=no(e,o),l[ro]=io(e,s),a&&(l.domProcessing=a.domProcessing,l[Hh]=a[Hh],l.networkConnect=a.networkConnect,l.perfTotal=a.perfTotal,l[eU]=a[eU],l.sentRequest=a.sentRequest)}return r.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",r.dataType="PageviewPerformanceData",r}()});var gd,eJ=ee(()=>{d();gd=function(){function r(e,t){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=t}return r}()});var fU,tJ=ee(()=>{d();ma();fU=ub({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});function af(r){var e="ai."+r+".";return function(t){return e+t}}var bw,oi,sN,vb,mU,sf,Xh,Iw,Sw,hU=ee(()=>{d();lr();ma();bw=af("application"),oi=af("device"),sN=af("location"),vb=af("operation"),mU=af("session"),sf=af("user"),Xh=af("cloud"),Iw=af("internal"),Sw=function(r){_n(e,r);function e(){return r.call(this)||this}return e}(YF({applicationVersion:bw("ver"),applicationBuild:bw("build"),applicationTypeId:bw("typeId"),applicationId:bw("applicationId"),applicationLayer:bw("layer"),deviceId:oi("id"),deviceIp:oi("ip"),deviceLanguage:oi("language"),deviceLocale:oi("locale"),deviceModel:oi("model"),deviceFriendlyName:oi("friendlyName"),deviceNetwork:oi("network"),deviceNetworkName:oi("networkName"),deviceOEMName:oi("oemName"),deviceOS:oi("os"),deviceOSVersion:oi("osVersion"),deviceRoleInstance:oi("roleInstance"),deviceRoleName:oi("roleName"),deviceScreenResolution:oi("screenResolution"),deviceType:oi("type"),deviceMachineName:oi("machineName"),deviceVMName:oi("vmName"),deviceBrowser:oi("browser"),deviceBrowserVersion:oi("browserVersion"),locationIp:sN("ip"),locationCountry:sN("country"),locationProvince:sN("province"),locationCity:sN("city"),operationId:vb("id"),operationName:vb("name"),operationParentId:vb("parentId"),operationRootId:vb("rootId"),operationSyntheticSource:vb("syntheticSource"),operationCorrelationVector:vb("correlationVector"),sessionId:mU("id"),sessionIsFirst:mU("isFirst"),sessionIsNew:mU("isNew"),userAccountAcquisitionDate:sf("accountAcquisitionDate"),userAccountId:sf("accountId"),userAgent:sf("userAgent"),userId:sf("id"),userStoreRegion:sf("storeRegion"),userAuthUserId:sf("authUserId"),userAnonymousUserAcquisitionDate:sf("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:sf("authUserAcquisitionDate"),cloudName:Xh("name"),cloudRole:Xh("role"),cloudRoleVer:Xh("roleVer"),cloudRoleInstance:Xh("roleInstance"),cloudEnvironment:Xh("environment"),cloudLocation:Xh("location"),cloudDeploymentUnit:Xh("deploymentUnit"),internalNodeName:Iw("nodeName"),internalSdkVersion:Iw("sdkVersion"),internalAgentVersion:Iw("agentVersion"),internalSnippet:Iw("snippet"),internalSdkSrc:Iw("sdkSrc")}))});var si,rJ=ee(()=>{d();hU();si=new Sw});var nJ,lf=ee(()=>{d();oU();K3();w3();vl();F3();U3();q3();$3();z3();Q3();X3();Z3();eJ();tJ();hU();bl();rJ();T3();nJ="AppInsightsChannelPlugin"});var iJ,Zh,gU,oo,aN,lN,cN,Oi,uN,Il,oJ,vU,sJ,vd,dN,yb,bb,yU,eg,yd,Nc,_w,tg,bU,pN,Ib,fN,aJ,bd,IU,lJ,mN,so,Rc,hN,SU,rg,Sl,gN,_l=ee(()=>{d();iJ="initialize",Zh="name",gU="identifier",oo="push",aN="isInitialized",lN="config",cN="logger",Oi="length",uN="time",Il="processNext",oJ="getProcessTelContext",vU="getPlugin",sJ="splice",vd="teardown",dN="messageId",yb="message",bb="isAsync",yU="_doTeardown",eg="update",yd="getNext",Nc="diagLog",_w="setNextPlugin",tg="createNew",bU="indexOf",pN="userAgent",Ib="split",fN="nodeType",aJ="apply",bd="replace",IU="enableDebugExceptions",lJ="logInternalMessage",mN="toLowerCase",so="call",Rc="type",hN="handler",SU="isChildEvt",rg="getCtx",Sl="setCtx",gN="complete"});var xr,No,cJ,vN,cf,uJ,_U,yN,Ew,EU,Ac=ee(()=>{d();xr="",No="core",cJ="disabled",vN="extensionConfig",cf="processTelemetry",uJ="priority",_U="perfEvent",yN="errorToConsole",Ew="warnToConsole",EU="getPerfMgr"});function yde(r){if(r){if(IN)return IN(r);var e=r[cde]||r[Ft]||r[bN];if(e)return e}return null}function El(r){return r===void 0||typeof r===Zt}function Ht(r){return r===null||El(r)}function uf(r){return!!(r&&typeof r===pt)}function an(r){return!!(r&&typeof r===on)}function Cw(r){var e=r;return e&&df(e)&&(e=e[bd](hde,function(t,n){return n.toUpperCase()}),e=e[bd](gde,"_"),e=e[bd](vde,function(t,n){return"_"+n})),e}function ao(r,e){if(r)for(var t in r)ar[so](r,t)&&e[so](r,t,r[t])}function Sb(r,e){return r&&e?r[bU](e)!==-1:!1}function bde(r){return!!(r&&yJ[so](r)==="[object Array]")}function IJ(r){return!!(r&&yJ[so](r)==="[object Error]")}function df(r){return typeof r=="string"}function xU(r){return typeof r=="number"}function SJ(r){return typeof r=="boolean"}function mJ(r){var e=!1;if(r&&typeof r=="object"){var t=IN?IN(r):yde(r);t?(t[bN]&&ar[so](t,bN)&&(t=t[bN]),e=typeof t===on&&bJ[so](t)===mde):e=!0}return e}function DU(r){if(r)return pde?r[gJ]():Ide(r)}function Ide(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[Oi]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Si(r,e,t){var n=r[Oi];try{for(var i=0;i<n&&!(i in r&&e[so](t||r,r[i],i,r)===-1);i++);}catch(o){}}function SN(r,e,t){if(r){if(r[dJ])return r[dJ](e,t);var n=r[Oi],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function pf(r){var e=typeof r;if(e!==on&&(e!==pt||r===null)&&aa("objKeys called on non-object"),!hJ&&fJ)return fJ(r);var t=[];for(var n in r)r&&ar[so](r,n)&&t[oo](n);if(hJ)for(var i=CU[Oi],o=0;o<i;o++)r&&ar[so](r,CU[o])&&t[oo](CU[o]);return t}function PU(r,e,t,n){if(pJ)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),pJ(r,e,i),!0}catch(o){}return!1}function Sde(r){return r}function Id(){var r=Date;return r.now?r.now():new r().getTime()}function ga(r){return IJ(r)?r[Zh]:xr}function ww(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function xw(r,e){return Ht(r)?e:r}function kU(r){return!!r}function _de(r,e){var t=null,n=null;return an(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][aJ](n,i)}}function _N(r,e,t,n,i){r&&e&&t&&(i!==!1||El(r[e]))&&(r[e]=_de(t,n))}function NU(r,e,t,n){return r&&e&&uf(r)&&rn(t)&&Si(t,function(i){df(i)&&_N(r,i,e,i,n)}),r}function EN(r){return r&&$a&&(r=wr($a({},r))),r}function CN(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[Oi],c=!1,u=1;for(l>0&&SJ(a)&&(c=a,a=s[u]||{},u++),uf(a)||(a={});u<l;u++){var p=s[u],f=rn(p),m=uf(p);for(var h in p){var g=f&&h in p||m&&ar[so](p,h);if(g){var v=p[h],S=void 0;if(c&&v&&((S=rn(v))||mJ(v))){var _=a[h];S?rn(_)||(_=[]):mJ(_)||(_={}),v=CN(c,_,v)}v!==void 0&&(a[h]=v)}}}return a}var gJ,sde,ade,dJ,lde,vJ,cde,bN,pJ,ude,Hje,fJ,wU,Jje,qje,Gje,dde,pde,fde,yJ,bJ,mde,hde,gde,vde,IN,rn,hJ,CU,TU,Cl=ee(()=>{d();lr();_l();Ac();gJ="toISOString",sde="endsWith",ade="startsWith",dJ="indexOf",lde="trim",vJ="toString",cde="__proto__",bN="constructor",pJ=Co,ude=wr.freeze,Hje=wr.seal,fJ=wr.keys,wU=String[Ft],Jje=wU[lde],qje=wU[sde],Gje=wU[ade],dde=Date[Ft],pde=dde[gJ],fde=Array.isArray,yJ=sa[vJ],bJ=ar[vJ],mde=bJ[so](wr),hde=/-([a-z])/g,gde=/([^\w\d_$])/g,vde=/^(\d+[\w\d_$])/,IN=Object.getPrototypeOf;rn=fde||bde;hJ=!{toString:null}.propertyIsEnumerable("toString"),CU=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];TU=ude||Sde});function wJ(r,e){var t=!1;if(r){try{if(t=e in r,!t){var n=r[Ft];n&&(t=e in n)}}catch(o){}if(!t)try{var i=new r;t=!El(i[e])}catch(o){}}return t}function Ro(r){var e=Bn();return e&&e[r]?e[r]:r===_J&&KU()?window:null}function KU(){return!!(typeof window===pt&&window)}function Eb(){return KU()?window:Ro(_J)}function xJ(){return!!(typeof document===pt&&document)}function wN(){return xJ()?document:Ro(Ede)}function FU(){return!!(typeof navigator===pt&&navigator)}function ff(){return FU()?navigator:Ro(wde)}function UU(){return typeof console!==Zt?console:Ro(xde)}function ng(){return!!(typeof JSON===pt&&JSON||Ro(EJ)!==null)}function os(){return ng()?JSON||Ro(EJ):null}function WU(){return Ro(Dde)}function VU(){return Ro(Pde)}function jU(){var r=ff();if(r&&(r[pN]!==AU||RU===null)){AU=r[pN];var e=(AU||xr)[mN]();RU=Sb(e,OU)||Sb(e,LU)}return RU}function BU(r){if(r===void 0&&(r=null),!r){var e=ff()||{};r=e?(e[pN]||xr)[mN]():xr}var t=(r||xr)[mN]();if(Sb(t,OU)){var n=wN()||{};return Math.max(parseInt(t[Ib](OU)[1]),n[Cde]||0)}else if(Sb(t,LU)){var i=parseInt(t[Ib](LU)[1]);if(i)return i+4}return null}function qn(r){var e=Object[Ft].toString[so](r),t=xr;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[Zh]+"'":ng()&&(t=os().stringify(r)),e+t}function Cb(){return MU===null&&(MU=FU()&&!!ff().sendBeacon),MU}function xN(r){var e=!1;try{e=!!Ro("fetch");var t=Ro("Request");e&&r&&t&&(e=wJ(t,"keepalive"))}catch(n){}return e}function DN(){return _b===null&&(_b=typeof XDomainRequest!==Zt,_b&&Dw()&&(_b=_b&&!wJ(Ro(CJ),"withCredentials"))),_b}function Dw(){var r=!1;try{var e=Ro(CJ);r=!!e}catch(t){}return r}var _J,Ede,Cde,wde,xde,EJ,Dde,Pde,OU,LU,CJ,RU,AU,_b,MU,ig=ee(()=>{"use strict";d();lr();_l();Cl();Ac();_J="window",Ede="document",Cde="documentMode",wde="navigator",xde="console",EJ="JSON",Dde="crypto",Pde="msCrypto",OU="msie",LU="trident/",CJ="XMLHttpRequest",RU=null,AU=null,_b=null,MU=null});function Tde(){var r=Ro("Microsoft");return r&&(PN=r.ApplicationInsights),PN}function DJ(r){var e=PN;return!e&&r.disableDbgExt!==!0&&(e=PN||Tde()),e?e.ChromeDbgExt:null}var PN,PJ=ee(()=>{d();ig();PN=null});function TJ(r){return r?'"'+r[bd](/\"/g,xr)+'"':xr}function kJ(r,e){var t=UU();if(t){var n="log";t[r]&&(n=r),an(t[n])&&t[n](e)}}function Pw(r,e){return(r||{})[cN]||new JU(e)}function NJ(r){return r||new JU}function mt(r,e,t,n,i,o){o===void 0&&(o=!1),NJ(r).throwInternal(e,t,n,i,o)}function Tw(r,e){NJ(r)[Ew](e)}var kde,Nde,Rde,HU,JU,TN=ee(()=>{"use strict";d();mr();_l();PJ();ig();Cl();Ac();kde="AI (Internal): ",Nde="AI: ",Rde="AITR_";HU=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[dN]=e,o[yb]=(n?Nde:kde)+e;var s=xr;ng()&&(s=os().stringify(i));var a=(t?" message:"+TJ(t):xr)+(i?" props:"+TJ(s):xr);o[yb]+=a}return r.dataType="MessageData",r}();JU=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[IU]=function(){return a},l.throwInternal=function(m,h,g,v,S){S===void 0&&(S=!1);var _=new HU(h,g,S,v);if(a)throw qn(_);var D=m===1?yN:Ew;if(El(_[yb]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[dN];!n[P]&&i>=m&&(l[D](_[yb]),n[P]=!0)}else i>=m&&l[D](_[yb]);c(m,_)}},l[Ew]=function(m){kJ("warn",m),f("warning",m)},l[yN]=function(m){kJ("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[lJ]=c;function c(m,h){if(!p()){var g=!0,v=Rde+h[dN];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[oo](h),t++,f(m===1?"error":"warn",h)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new HU(23,S,!1);l.queue[oo](_),m===1?l[yN](S):l[Ew](S)}}}function u(m){i=xw(m.loggingLevelConsole,0),o=xw(m.loggingLevelTelemetry,1),s=xw(m.maxMessageLimit,25),a=xw(m[IU],!1)}function p(){return t>=s}function f(m,h){var g=DJ(e||{});g&&g[Nc]&&g[Nc](m,h)}})}return r.__ieDyn=1,r}()});function RJ(r,e,t,n,i){if(r){var o=r;if(o[EU]&&(o=o[EU]()),o){var s=void 0,a=o[rg](qU);try{if(s=o.create(e(),n,i),s){if(a&&s[Sl]&&(s[Sl](kN[GU],a),a[rg]&&a[Sl])){var l=a[rg](kN[kw]);l||(l=[],a[Sl](kN[kw],l)),l[oo](s)}return o[Sl](qU,s),t(s)}}catch(c){s&&s[Sl]&&s[Sl]("exception",c)}finally{s&&o.fire(s),o[Sl](qU,a)}}}return t()}var wb,GU,kw,kN,v9e,qU,AJ=ee(()=>{d();mr();_l();Cl();Ac();wb="ctx",GU="ParentContextKey",kw="ChildrenContextKey",kN=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Id(),i[Zh]=e,i[bb]=n,i[SU]=function(){return!1},an(t)){var s;o=PU(i,"payload",function(){return!s&&an(t)&&(s=t(),t=null),s})}i[rg]=function(a){return a?a===r[GU]||a===r[kw]?i[a]:(i[wb]||{})[a]:null},i[Sl]=function(a,l){if(a)if(a===r[GU])i[a]||(i[SU]=function(){return!0}),i[a]=l;else if(a===r[kw])i[a]=l;else{var c=i[wb]=i[wb]||{};c[a]=l}},i[gN]=function(){var a=0,l=i[rg](r[kw]);if(rn(l))for(var c=0;c<l[Oi];c++){var u=l[c];u&&(a+=u[uN])}i[uN]=Id()-i.start,i.exTime=i[uN]-a,i[gN]=function(){},!o&&an(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),v9e=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new kN(n,i,o)},t.fire=function(n){n&&(n[gN](),e&&an(e[_U])&&e[_U](n))},t[Sl]=function(n,i){if(n){var o=t[wb]=t[wb]||{};o[n]=i}},t[rg]=function(n){return(t[wb]||{})[n]}})}return r.__ieDyn=1,r}(),qU="CoreUtils.doPerf"});function Ade(r){r<0&&(r>>>=0),Nw=123456789+r&og,Rw=987654321-r&og,LJ=!0}function Mde(){try{var r=Id()&2147483647;Ade((Math.random()*OJ^r)+r)}catch(e){}}function MJ(r){var e=0,t=WU()||VU();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&og),e===0&&jU()&&(LJ||Mde(),e=Ode()&og),e===0&&(e=Math.floor(OJ*Math.random()|0)),r||(e>>>=0),e}function Ode(r){Rw=36969*(Rw&65535)+(Rw>>16)&og,Nw=18e3*(Nw&65535)+(Nw>>16)&og;var e=(Rw<<16)+(Nw&65535)>>>0&og|0;return r||(e>>>=0),e}function KJ(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=MJ()>>>0,n=0,i=xr;i[Oi]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(MJ()<<2&4294967295|t&3)>>>0,n=0);return i}var OJ,og,LJ,Nw,Rw,FJ=ee(()=>{d();_l();ig();Cl();Ac();OJ=4294967296,og=4294967295,LJ=!1,Nw=123456789,Rw=987654321});function Fde(r,e,t){if(UJ)try{return UJ(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function VJ(r){return r[fN]===1||r[fN]===9||!+r[fN]}function Ude(r,e){var t=e[r.id];if(!t){t={};try{VJ(e)&&(Fde(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function Sd(r,e){return e===void 0&&(e=!1),Cw(r+Kde+++(e?"."+WJ:xr)+Lde)}function NN(r){var e={id:Sd("_aiData-"+(r||xr)+"."+WJ),accept:function(t){return VJ(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[Cw(n)]:(o&&(s=Ude(e,t),s[Cw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var UJ,WJ,Lde,Kde,RN=ee(()=>{d();lr();_l();Cl();Ac();FJ();UJ=Co,WJ="2.8.11",Lde="."+KJ(6),Kde=0});function qJ(r){return r&&r[bd]?r[bd](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,xr):r}function $U(r,e){var t;if(e){var n=xr;rn(e)?(n=xr,Si(e,function(o){o=qJ(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=qJ(e),n&&(n[0]!=="."&&(n="."+n),r=(r||xr)+n)}var i=Bde.exec(r||xr)||[];return t={},t[Rc]=i[1],t.ns=(i[2]||xr).replace(Wde,".").replace(Vde,xr)[Ib](".").sort().join("."),t}function $J(r,e,t){t===void 0&&(t=!0);var n=AN.get(r,YU,{},t),i=n[e];return i||(i=n[e]=[]),i}function zJ(r,e,t,n){r&&e&&e[Rc]&&(r[JJ]?r[JJ](e[Rc],t,n):r[HJ]&&r[HJ](YJ+e[Rc],t))}function Hde(r,e,t,n){var i=!1;return r&&e&&e[Rc]&&t&&(r[BJ]?(r[BJ](e[Rc],t,n),i=!0):r[jJ]&&(r[jJ](YJ+e[Rc],t),i=!0)),i}function GJ(r,e,t,n){for(var i=e[Oi];i--;){var o=e[i];o&&(!t.ns||t.ns===o.evtName.ns)&&(!n||n(o))&&(zJ(r,o.evtName,o[hN],o.capture),e[sJ](i,1))}}function Jde(r,e,t){if(e[Rc])GJ(r,$J(r,e[Rc]),e,t);else{var n=AN.get(r,YU,{});ao(n,function(i,o){GJ(r,o,e,t)}),pf(n)[Oi]===0&&AN.kill(r,YU)}}function Aw(r,e){var t;return e?(rn(e)?t=[r].concat(e):t=[r,e],t=$U("xx",t).ns[Ib](".")):t=r,t}function MN(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=$U(e,n);if(s=Hde(r,a,t,i),s&&AN.accept(r)){var l=(o={guid:jde++,evtName:a},o[hN]=t,o.capture=i,o);$J(r,a.type)[oo](l)}}catch(c){}return s}function zU(r,e,t,n,i){if(i===void 0&&(i=!1),r)try{var o=$U(e,n),s=!1;Jde(r,o,function(a){return o.ns&&!t||a[hN]===t?(s=!0,!0):!1}),s||zJ(r,o,t,i)}catch(a){}}var YJ,jJ,BJ,HJ,JJ,YU,K9e,F9e,Wde,Vde,jde,AN,Bde,QJ=ee(()=>{d();_l();RN();Cl();Ac();YJ="on",jJ="attachEvent",BJ="addEventListener",HJ="detachEvent",JJ="removeEventListener",YU="events",K9e=Sd("aiEvtPageHide"),F9e=Sd("aiEvtPageShow"),Wde=/\.[\.]+/g,Vde=/[\.]+$/,jde=1,AN=NN("events"),Bde=/^([^.]*)(?:\.(.+)|)/});function ON(r){return qde.get(r,"state",{},!0)}var qde,XJ=ee(()=>{"use strict";d();RN();qde=NN("plugin")});function Yde(r,e,t){for(;r;){if(r[vU]()===t)return r;r=r[yd]()}return Mw([t],e[lN]||{},e)}function QU(r,e,t,n){var i=null,o=[];n!==null&&(i=n?Yde(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return Pw(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[oo]({func:f,self:El(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[yd]():null,!f){var m=o;m&&m[Oi]>0&&(Si(m,function(h){try{h.func[so](h.self,h.args)}catch(g){mt(t[cN],2,73,"Unexpected Exception during onComplete - "+qn(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[vN];v&&f&&(g=v[f])}if(!g)g=m;else if(uf(m)&&h!==0){var S=CN(!0,m,g);e&&h===2&&ao(m,function(_){if(Ht(S[_])){var D=e[_];Ht(D)||(S[_]=D)}}),g=S}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!Ht(v[m])?g=v[m]:e&&!Ht(e[m])&&(g=e[m]),Ht(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[vU]();h&&f(h)}}return s}function xb(r,e,t,n){var i=QU(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[cf](l,o),!c}function a(l,c){return l===void 0&&(l=null),rn(l)&&(l=Mw(l,e,t,c)),xb(l||o[yd](),e,t,c)}return o[Il]=s,o[tg]=a,o}function XU(r,e,t){var n=e[lN]||{},i=QU(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),rn(l)&&(l=Mw(l,n,e,c)),XU(l||o[yd](),e,c)}return o[Il]=s,o[tg]=a,o}function ZU(r,e,t){var n=e[lN]||{},i=QU(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){an(c[eg])&&c[eg](o,l)})}function a(l,c){return l===void 0&&(l=null),rn(l)&&(l=Mw(l,n,e,c)),ZU(l||o[yd](),e,c)}return o[Il]=s,o[tg]=a,o}function Mw(r,e,t,n){var i=null,o=!n;if(rn(r)&&r[Oi]>0){var s=null;Si(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&an(a[cf])){var l=$de(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Mw([n],e,t):i}function $de(r,e,t){var n=null,i=an(r[cf]),o=an(r[_w]),s;r?s=r[gU]+"-"+r[uJ]+"-"+tq++:s="Unknown-0-"+tq++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&an(r[eq])&&(m=r[eq]()),m||(m=xb(a,e,t)),m}function c(m,h,g,v,S){var _=!1,D=r?r[gU]:Gde,P=m[ZJ];return P||(P=m[ZJ]={}),m.setNext(n),r&&RJ(m[No](),function(){return D+":"+g},function(){P[s]=!0;try{var M=n?n._id:xr;M&&(P[M]=!1),_=h(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&mt(m[Nc](),1,73,"Plugin ["+D+"] failed during "+g+" - "+qn(A)+", run flags: "+qn(P))}},v,S),_}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var S=ON(r);return S[vd]||S[cJ]?!1:(o&&r[_w](n),r[cf](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[Il](m)}function p(m,h){function g(){var v=!1;if(r){var S=ON(r),_=r[No]||S[No];r&&(!_||_===m.core())&&!S[vd]&&(S[No]=null,S[vd]=!0,S[aN]=!1,r[vd]&&r[vd](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[bb])||m[Il](h)}function f(m,h){function g(){var v=!1;if(r){var S=ON(r),_=r[No]||S[No];r&&(!_||_===m.core())&&!S[vd]&&r[eg]&&r[eg](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[Il](h)}return TU(a)}var Gde,ZJ,eq,tq,Q9e,rq=ee(()=>{"use strict";d();_l();TN();ig();Cl();Ac();AJ();XJ();Gde="TelemetryPluginChain",ZJ="_hasRun",eq="_getTelCtx",tq=0;Q9e=function(){function r(e,t,n,i){var o=this,s=xb(e,t,n,i);NU(o,s,pf(s))}return r}()});function nq(){var r=[];function e(n){n&&r[oo](n)}function t(n,i){Si(r,function(o){try{o(n,i)}catch(s){mt(n[Nc](),2,73,"Unexpected error calling unload handler - "+qn(s))}}),r=[]}return{add:e,run:t}}var iq=ee(()=>{d();_l();TN();ig();Cl()});var mf,e2,oq=ee(()=>{"use strict";d();mr();_l();Cl();Ac();rq();iq();mf="getPlugin",e2=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(u){u[iJ]=function(p,f,m,h){l(p,f,h),t=!0},u[vd]=function(p,f){var m,h=u[No];if(!h||p&&h!==p[No]())return;var g,v=!1,S=p||XU(null,h,i&&i[mf]?i[mf]():i),_=f||(m={reason:0},m[bb]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],Si(P,function(M){M.rm()}),g===!0&&S[Il](_),c()}}return!u[yU]||u[yU](S,_,D)!==!0?D():g=!0,g},u[eg]=function(p,f){var m=u[No];if(!m||p&&m!==p[No]())return;var h,g=!1,v=p||ZU(null,m,i&&i[mf]?i[mf]():i),S=f||{reason:0};function _(){g||(g=!0,l(v.getCfg(),v.core(),v[yd]()))}return!u._doUpdate||u._doUpdate(v,S,_)!==!0?_():h=!0,h},u._addHook=function(p){p&&(rn(p)?s=s.concat(p):s[oo](p))},_N(u,"_addUnloadCb",function(){return o},"add")}),e[Nc]=function(u){return a(u)[Nc]()},e[aN]=function(){return t},e.setInitialized=function(u){t=u},e[_w]=function(u){i=u},e[Il]=function(u,p){p?p[Il](u):i&&an(i[cf])&&i[cf](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||xb(null,{},e[No]);i&&i[mf]?p=f[tg](null,i[mf]):p=f[tg](null,i)}return p}function l(u,p,f){u&&ww(u,vN,[],null,Ht),!f&&p&&(f=p[oJ]()[yd]());var m=i;i&&i[mf]&&(m=i[mf]()),e[No]=p,n=xb(f,u,p,m)}function c(){t=!1,e[No]=null,n=null,i=null,s=[],o=nq()}}return r.__ieDyn=1,r}()});var sg=ee(()=>{d();oq();Cl();QJ();ig();TN();RN()});var hf,sq=ee(()=>{d();hf="duration"});var Gn,LN,ss,Mc,ag,Pt,gf,vf,va,yf,_d,Ow,lg,bf,Ed,Lw,If,cg,Sf,ug,Db,_f,Pb,Cd,KN,dg,lo,t2,FN,Tb,Jr,pg,r2,n2,Kw,Ef,i2,kb,o2,UN,WN,Nb,s2,aq,ya,VN,Fw,Uw,lq,Rb,jN,a2,l2,c2,BN,cq,wd=ee(()=>{d();Gn="tags",LN="deviceType",ss="data",Mc="name",ag="traceID",Pt="length",gf="stringify",vf="measurements",va="dataType",yf="envelopeType",_d="toString",Ow="onLine",lg="enqueue",bf="count",Ed="push",Lw="emitLineDelimitedJson",If="clear",cg="batchPayloads",Sf="markAsSent",ug="clearSent",Db="BUFFER_KEY",_f="SENT_BUFFER_KEY",Pb="MAX_BUFFER_SIZE",Cd="namePrefix",KN="maxBatchSizeInBytes",dg="triggerSend",lo="diagLog",t2="onunloadDisableBeacon",FN="isBeaconApiDisabled",Tb="_sender",Jr="_senderConfig",pg="_buffer",r2="enableSessionStorageBuffer",n2="samplingPercentage",Kw="instrumentationKey",Ef="endpointUrl",i2="customHeaders",kb="disableXhr",o2="onunloadDisableFetch",UN="disableTelemetry",WN="baseType",Nb="sampleRate",s2="convertUndefined",aq="_xhrReadyStateChange",ya="_onError",VN="_onPartialSuccess",Fw="_onSuccess",Uw="itemsAccepted",lq="itemsReceived",Rb="isRetryDisabled",jN="setRequestHeader",a2="maxBatchInterval",l2="eventsSendRequest",c2="disableInstrumentationKeyValidation",BN="getSamplingScore",cq="getHashCodeScore"});function Yn(r,e,t){return ww(r,e,t,kU)}function zde(r,e,t){var n=t[Gn]=t[Gn]||{},i=e.ext=e.ext||{},o=e[Gn]=e[Gn]||[],s=i.user;s&&(Yn(n,si.userAuthUserId,s.authId),Yn(n,si.userId,s.id||s.localId));var a=i.app;a&&Yn(n,si.sessionId,a.sesId);var l=i.device;l&&(Yn(n,si.deviceId,l.id||l.localId),Yn(n,si[LN],l.deviceClass),Yn(n,si.deviceIp,l.ip),Yn(n,si.deviceModel,l.model),Yn(n,si[LN],l[LN]));var c=e.ext.web;if(c){Yn(n,si.deviceLanguage,c.browserLang),Yn(n,si.deviceBrowserVersion,c.browserVer),Yn(n,si.deviceBrowser,c.browser);var u=t[ss]=t[ss]||{},p=u[ln]=u[ln]||{},f=p[_i]=p[_i]||{};Yn(f,"domain",c.domain),Yn(f,"isManual",c.isManual?uq:null),Yn(f,"screenRes",c.screenRes),Yn(f,"userConsent",c.userConsent?uq:null)}var m=i.os;m&&Yn(n,si.deviceOS,m[Mc]);var h=i.trace;h&&(Yn(n,si.operationParentId,h.parentID),Yn(n,si.operationName,tn(r,h[Mc])),Yn(n,si.operationId,h[ag]));for(var g={},v=o[Pt]-1;v>=0;v--){var S=o[v];ao(S,function(D,P){g[D]=P}),o.splice(v,1)}ao(o,function(D,P){g[D]=P});var _=xo(xo({},n),g);_[si.internalSdkVersion]||(_[si.internalSdkVersion]="javascript:".concat(Qde.Version)),t[Gn]=EN(_)}function Cf(r,e,t){Ht(r)||ao(r,function(n,i){xU(i)?t[n]=i:df(i)?e[n]=i:ng()&&(e[n]=os()[gf](i))})}function fg(r,e){Ht(r)||ao(r,function(t,n){r[t]=n||e})}function mg(r,e,t,n){var i=new aU(r,n,e);Yn(i,"sampleRate",t[cw]),(t[ln]||{}).startTime&&(i.time=DU(t[ln].startTime)),i.iKey=t.iKey;var o=t.iKey.replace(/-/g,"");return i[Mc]=i[Mc].replace("{0}",o),zde(r,t,i),t[Gn]=t[Gn]||[],EN(i)}function hg(r,e){Ht(e[ln])&&mt(r,1,46,"telemetryItem.baseData cannot be null.")}function dq(r,e,t){hg(r,e);var n=e[ln][vf]||{},i=e[ln][_i]||{};Cf(e[ss],i,n),Ht(t)||fg(i,t);var o=e[ln];if(Ht(o))return Tw(r,"Invalid input for dependency data"),null;var s=o[_i]&&o[_i][Gk]?o[_i][Gk]:"GET",a=new $h(r,o.id,o.target,o[Mc],o[hf],o.success,o.responseCode,s,o.type,o.correlationContext,i,n),l=new gd($h[va],a);return mg(r,$h[yf],e,l)}function d2(r,e,t){hg(r,e);var n={},i={};e[u2]!==md[va]&&(n.baseTypeSource=e[u2]),e[u2]===md[va]?(n=e[ln][_i]||{},i=e[ln][vf]||{}):e[ln]&&Cf(e[ln],n,i),Cf(e[ss],n,i),Ht(t)||fg(n,t);var o=e[ln][Mc],s=new md(r,o,n,i),a=new gd(md[va],s);return mg(r,md[yf],e,a)}function pq(r,e,t){hg(r,e);var n=e[ln][vf]||{},i=e[ln][_i]||{};Cf(e[ss],i,n),Ht(t)||fg(i,t);var o=e[ln],s=Gh.CreateFromInterface(r,o,i,n),a=new gd(Gh[va],s);return mg(r,Gh[yf],e,a)}function fq(r,e,t){hg(r,e);var n=e[ln],i=n[_i]||{},o=n[vf]||{};Cf(e[ss],i,o),Ht(t)||fg(i,t);var s=new hd(r,n[Mc],n.average,n.sampleCount,n.min,n.max,n.stdDev,i,o),a=new gd(hd[va],s);return mg(r,hd[yf],e,a)}function mq(r,e,t){hg(r,e);var n,i=e[ln];!Ht(i)&&!Ht(i[_i])&&!Ht(i[_i][hf])?(n=i[_i][hf],delete i[_i][hf]):!Ht(e[ss])&&!Ht(e[ss][hf])&&(n=e[ss][hf],delete e[ss][hf]);var o=e[ln],s;((e.ext||{}).trace||{})[ag]&&(s=e.ext.trace[ag]);var a=o.id||s,l=o[Mc],c=o.uri,u=o[_i]||{},p=o[vf]||{};if(Ht(o.refUri)||(u.refUri=o.refUri),Ht(o.pageType)||(u.pageType=o.pageType),Ht(o.isLoggedIn)||(u.isLoggedIn=o.isLoggedIn[_d]()),!Ht(o[_i])){var f=o[_i];ao(f,function(g,v){u[g]=v})}Cf(e[ss],u,p),Ht(t)||fg(u,t);var m=new Yh(r,l,c,n,u,p,a),h=new gd(Yh[va],m);return mg(r,Yh[yf],e,h)}function hq(r,e,t){hg(r,e);var n=e[ln],i=n[Mc],o=n.uri||n.url,s=n[_i]||{},a=n[vf]||{};Cf(e[ss],s,a),Ht(t)||fg(s,t);var l=new Qh(r,i,o,void 0,s,a,n),c=new gd(Qh[va],l);return mg(r,Qh[yf],e,c)}function gq(r,e,t){hg(r,e);var n=e[ln].message,i=e[ln].severityLevel,o=e[ln][_i]||{},s=e[ln][vf]||{};Cf(e[ss],o,s),Ht(t)||fg(o,t);var a=new zh(r,n,i,o,s),l=new gd(zh[va],a);return mg(r,zh[yf],e,l)}var u2,ln,_i,uq,Qde,vq=ee(()=>{d();lr();lf();sg();sq();wd();u2="baseType",ln="baseData",_i="properties",uq="true";Qde={Version:"2.8.11"}});function yq(r,e){zU(r,null,null,e)}function bq(r){var e=wN(),t=ff(),n=!1,i=!0,o=Aw(Sd("OfflineListener"),r);try{if(a(Eb())&&(n=!0),e){var s=e.body||e;s.ononline&&a(s)&&(n=!0)}n&&t&&!Ht(t[Ow])&&(i=t[Ow])}catch(f){n=!1}function a(f){var m=!1;return f&&(m=MN(f,"online",l,o),m&&MN(f,"offline",c,o)),m}function l(){i=!0}function c(){i=!1}function u(){var f=!0;return n?f=i:t&&!Ht(t[Ow])&&(f=t[Ow]),f}function p(){var f=Eb();if(f&&n){if(yq(f,o),e){var m=e.body||e;El(m.ononline)||yq(m,o)}n=!1}}return{isOnline:u,isListening:function(){return n},unload:p}}var Iq=ee(()=>{d();sg();wd()});var Sq,_q,Eq,Cq=ee(()=>{d();lr();mr();lf();sg();wd();Sq=function(){function r(e,t){var n=[],i=!1;this._get=function(){return n},this._set=function(o){return n=o,n},Be(r,this,function(o){o[lg]=function(s){if(o[bf]()>=t.eventsLimitInMem()){i||(mt(e,2,105,"Maximum in-memory buffer size reached: "+o[bf](),!0),i=!0);return}n[Ed](s)},o[bf]=function(){return n[Pt]},o.size=function(){for(var s=n[Pt],a=0;a<n[Pt];a++)s+=n[a][Pt];return t[Lw]()||(s+=2),s},o[If]=function(){n=[],i=!1},o.getItems=function(){return n.slice(0)},o[cg]=function(s){if(s&&s[Pt]>0){var a=t[Lw]()?s.join(`
`):"["+s.join(",")+"]";return a}return null}})}return r.__ieDyn=1,r}(),_q=function(r){_n(e,r);function e(t,n){var i=r.call(this,t,n)||this;return Be(e,i,function(o,s){o[Sf]=function(a){s[If]()},o[ug]=function(a){}}),i}return e.__ieDyn=1,e}(Sq),Eq=function(r){_n(e,r);function e(t,n){var i=r.call(this,t,n)||this,o=!1;return Be(e,i,function(s,a){var l=f(e[Db]),c=f(e[_f]),u=s._set(l.concat(c));u[Pt]>e[Pb]&&(u[Pt]=e[Pb]),m(e[_f],[]),m(e[Db],u),s[lg]=function(h){if(s[bf]()>=e[Pb]){o||(mt(t,2,67,"Maximum buffer size reached: "+s[bf](),!0),o=!0);return}a[lg](h),m(e[Db],s._get())},s[If]=function(){a[If](),m(e[Db],s._get()),m(e[_f],[]),o=!1},s[Sf]=function(h){m(e[Db],s._set(p(h,s._get())));var g=f(e[_f]);g instanceof Array&&h instanceof Array&&(g=g.concat(h),g[Pt]>e[Pb]&&(mt(t,1,67,"Sent buffer reached its maximum size: "+g[Pt],!0),g[Pt]=e[Pb]),m(e[_f],g))},s[ug]=function(h){var g=f(e[_f]);g=p(h,g),m(e[_f],g)};function p(h,g){var v=[];return Si(g,function(S){!an(S)&&SN(h,S)===-1&&v[Ed](S)}),v}function f(h){var g=h;try{g=n[Cd]&&n[Cd]()?n[Cd]()+"_"+g:g;var v=rU(t,g);if(v){var S=os().parse(v);if(df(S)&&(S=os().parse(S)),S&&rn(S))return S}}catch(_){mt(t,1,42," storage key: "+g+", "+ga(_),{exception:qn(_)})}return[]}function m(h,g){var v=h;try{v=n[Cd]&&n[Cd]()?n[Cd]()+"_"+v:v;var S=JSON[gf](g);eN(t,v,S)}catch(_){eN(t,v,JSON[gf]([])),mt(t,2,41," storage key: "+v+", "+ga(_)+". Buffer cleared",{exception:qn(_)})}}}),i}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(Sq)});var wq,xq=ee(()=>{d();mr();sg();wd();wq=function(){function r(e){Be(r,this,function(t){t.serialize=function(s){var a=n(s,"root");try{return os()[gf](a)}catch(l){mt(e,1,48,l&&an(l[_d])?l[_d]():"Error serializing object",null,!0)}};function n(s,a){var l="__aiCircularRefCheck",c={};if(!s)return mt(e,1,48,"cannot serialize object because it is null or undefined",{name:a},!0),c;if(s[l])return mt(e,2,50,"Circular reference detected while serializing object",{name:a},!0),c;if(!s.aiDataContract){if(a==="measurements")c=o(s,"number",a);else if(a==="properties")c=o(s,"string",a);else if(a==="tags")c=o(s,"string",a);else if(rn(s))c=i(s,a);else{mt(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:a},!0);try{os()[gf](s),c=s}catch(u){mt(e,1,48,u&&an(u[_d])?u[_d]():"Error serializing object",null,!0)}}return c}return s[l]=!0,ao(s.aiDataContract,function(u,p){var f=an(p)?p()&1:p&1,m=an(p)?p()&4:p&4,h=p&2,g=s[u]!==void 0,v=uf(s[u])&&s[u]!==null;if(f&&!g&&!h)mt(e,1,24,"Missing required field specification. The field is required but not present on source",{field:u,name:a});else if(!m){var S=void 0;v?h?S=i(s[u],u):S=n(s[u],u):S=s[u],S!==void 0&&(c[u]=S)}}),delete s[l],c}function i(s,a){var l;if(s)if(!rn(s))mt(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:a},!0);else{l=[];for(var c=0;c<s[Pt];c++){var u=s[c],p=n(u,a+"["+c+"]");l[Ed](p)}}return l}function o(s,a,l){var c;return s&&(c={},ao(s,function(u,p){if(a==="string")p===void 0?c[u]="undefined":p===null?c[u]="null":p[_d]?c[u]=p[_d]():c[u]="invalid field: toString() is not defined.";else if(a==="number")if(p===void 0)c[u]="undefined";else if(p===null)c[u]="null";else{var f=parseFloat(p);isNaN(f)?c[u]="NaN":c[u]=f}else c[u]="invalid field: "+l+" is of unknown type.",mt(e,1,c[u],null,!0)})),c}})}return r.__ieDyn=1,r}()});var Xde,Dq,Pq=ee(()=>{d();wd();Xde=8,Dq=function(){function r(){}return r.prototype.getHashCodeScore=function(e){var t=this.getHashCode(e)/r.INT_MAX_VALUE;return t*100},r.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Pt]<Xde;)e=e.concat(e);for(var t=5381,n=0;n<e[Pt];++n)t=(t<<5)+t+e.charCodeAt(n),t=t&t;return Math.abs(t)},r.INT_MAX_VALUE=2147483647,r}()});var Tq,kq=ee(()=>{d();lf();wd();Pq();Tq=function(){function r(){var e=this,t=new Dq,n=new Sw;e[BN]=function(i){var o=0;return i[Gn]&&i[Gn][n.userId]?o=t.getHashCodeScore(i[Gn][n.userId]):i.ext&&i.ext.user&&i.ext.user.id?o=t[cq](i.ext.user.id):i[Gn]&&i[Gn][n.operationId]?o=t.getHashCodeScore(i[Gn][n.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace[ag]?o=t.getHashCodeScore(i.ext.telemetryTrace[ag]):o=Math.random()*100,o}}return r}()});var Nq,Rq=ee(()=>{d();lf();sg();wd();kq();Nq=function(){function r(e,t){this.INT_MAX_VALUE=2147483647;var n=t||Pw(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[Nb]=e,this.samplingScoreGenerator=new Tq}return r.prototype.isSampledIn=function(e){var t=this[Nb],n=!1;return t==null||t>=100||e.baseType===hd[va]?!0:(n=this.samplingScoreGenerator[BN](e)<t,n)},r}()});function HN(r){try{return r.responseText}catch(e){}return null}function Aq(){var r,e,t;return r={endpointUrl:function(){return Lh+pd}},r[Lw]=function(){return!1},r[a2]=function(){return 15e3},r[KN]=function(){return 102400},r[UN]=function(){return!1},r[r2]=function(){return!0},r[Rb]=function(){return!1},r[FN]=function(){return!0},r[kb]=function(){return!1},r[o2]=function(){return!1},r[t2]=function(){return!1},r[Kw]=function(){return e},r[Cd]=function(){return e},r[n2]=function(){return 100},r[i2]=function(){return t},r[s2]=function(){return e},r.eventsLimitInMem=function(){return 1e4},r}var xd,Zde,epe,Ww,Mq=ee(()=>{d();lr();mr();lf();sg();vq();Iq();Cq();xq();Rq();wd();Zde=65e3;epe=(xd={},xd[md.dataType]=d2,xd[zh.dataType]=gq,xd[Yh.dataType]=mq,xd[Qh.dataType]=hq,xd[Gh.dataType]=pq,xd[hd.dataType]=fq,xd[$h.dataType]=dq,xd),Ww=function(r){_n(e,r);function e(){var t=r.call(this)||this;t.priority=1001,t.identifier=nJ,t._senderConfig=Aq();var n,i,o,s,a,l,c,u,p=0,f,m,h,g;return Be(e,t,function(v,S){we(),v.pause=function(){Nt(),s=!0},v.resume=function(){s&&(s=!1,i=null,v._buffer.size()>v._senderConfig[KN]()&&v[dg](!0,null,10),ae())},v.flush=function(L,le,he){if(L===void 0&&(L=!0),!s){Nt();try{v[dg](L,null,he||1)}catch(xe){mt(v[lo](),1,22,"flush failed, telemetry will not be collected: "+ga(xe),{exception:qn(xe)})}}},v.onunloadFlush=function(){if(!s)if((v._senderConfig[t2]()===!1||v[Jr][FN]()===!1)&&Cb())try{v[dg](!0,M,2)}catch(L){mt(v[lo](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ga(L),{exception:qn(L)})}else v.flush()},v.addHeader=function(L,le){u[L]=le},v.initialize=function(L,le,he,xe){v.isInitialized()&&mt(v[lo](),1,28,"Sender is already initialized"),S.initialize(L,le,he,xe);var Le=v._getTelCtx(),et=v.identifier;l=new wq(le.logger),n=0,i=null,o=0,v[Tb]=null,c=0;var N=v[lo]();g=Aw(Sd("Sender"),le.evtNamespace&&le.evtNamespace()),h=bq(g);var W=Aq();ao(W,function(Ae,Yt){v[Jr][Ae]=function(){var ze=Le.getConfig(et,Ae,Yt());return!ze&&Ae==="endpointUrl"&&(ze=Yt()),ze}}),v._buffer=v[Jr][r2]()&&Zk()?new Eq(N,v[Jr]):new _q(N,v[Jr]),v._sample=new Nq(v[Jr][n2](),N),be(L)||mt(N,1,100,"Invalid Instrumentation key "+L[Kw]),!yw(v._senderConfig.endpointUrl())&&v._senderConfig.customHeaders()&&v._senderConfig.customHeaders()[Pt]>0&&Si(v[Jr][i2](),function(Ae){t.addHeader(Ae.header,Ae.value)});var pe=v[Jr],_e=null;!pe[kb]()&&DN()?_e=Xr:!pe[kb]()&&Dw()&&(_e=j),!_e&&xN()&&(_e=R),f=_e||j,!pe[FN]()&&Cb()&&(_e=A),v[Tb]=_e||j,!pe[o2]()&&xN(!0)?m=re:Cb()?m=A:!pe[kb]()&&DN()?m=Xr:!pe[kb]()&&Dw()?m=j:m=f},v.processTelemetry=function(L,le){le=v._getTelCtx(le);var he=le[lo]();try{if(v[Jr][UN]())return;if(!L){mt(he,1,7,"Cannot send empty telemetry");return}if(L.baseData&&!L[WN]){mt(he,1,70,"Cannot send telemetry without baseData and baseType");return}if(L[WN]||(L[WN]="EventData"),!v[Tb]){mt(he,1,28,"Sender was not initialized");return}if(_(L))L[cw]=v._sample[Nb];else{mt(he,2,33,"Telemetry item was sampled out and not sent",{SampleRate:v._sample[Nb]});return}var xe=v[Jr][s2]()||void 0,Le=L.iKey||v[Jr][Kw](),et=e.constructEnvelope(L,Le,he,xe);if(!et){mt(he,1,47,"Unable to create an AppInsights envelope");return}var N=!1;if(L[Gn]&&L[Gn][uw]&&(Si(L[Gn][uw],function(Ae){try{Ae&&Ae(et)===!1&&(N=!0,Tw(he,"Telemetry processor check returns false"))}catch(Yt){mt(he,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+ga(Yt),{exception:qn(Yt)},!0)}}),delete L[Gn][uw]),N)return;var W=l.serialize(et),pe=v[pg],_e=pe.size();_e+W[Pt]>v[Jr][KN]()&&v[dg](!0,null,10),pe[lg](W),ae()}catch(Ae){mt(he,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ga(Ae),{exception:qn(Ae)})}v.processNext(L,le)},v[aq]=function(L,le,he){L.readyState===4&&D(L.status,le,L.responseURL,he,vr(L),HN(L)||L.response)},v[dg]=function(L,le,he){if(L===void 0&&(L=!0),!s)try{var xe=v[pg];if(v[Jr][UN]())xe[If]();else{if(xe[bf]()>0){var Le=xe.getItems();Te(he||0,L),le?le.call(t,Le,L):v[Tb](Le,L)}o=+new Date}Nt()}catch(N){var et=BU();(!et||et>9)&&mt(v[lo](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+ga(N),{exception:qn(N)})}},v._doTeardown=function(L,le){v.onunloadFlush(),h.unload(),we()},v[ya]=function(L,le,he){mt(v[lo](),2,26,"Failed to send telemetry.",{message:le}),v._buffer[ug](L)},v[VN]=function(L,le){for(var he=[],xe=[],Le=le.errors.reverse(),et=0,N=Le;et<N.length;et++){var W=N[et],pe=L.splice(W.index,1)[0];Je(W.statusCode)?xe[Ed](pe):he[Ed](pe)}L[Pt]>0&&v[Fw](L,le[Uw]),he[Pt]>0&&v[ya](he,vr(null,["partial success",le[Uw],"of",le.itemsReceived].join(" "))),xe[Pt]>0&&(Ke(xe),mt(v[lo](),2,40,"Partial success. Delivered: "+L[Pt]+", Failed: "+he[Pt]+". Will retry to send "+xe[Pt]+" our of "+le[lq]+" items"))},v[Fw]=function(L,le){v._buffer[ug](L)},v._xdrOnLoad=function(L,le){var he=HN(L);if(L&&(he+""=="200"||he===""))n=0,v[Fw](le,0);else{var xe=ge(he);xe&&xe.itemsReceived&&xe.itemsReceived>xe[Uw]&&!v[Jr][Rb]()?v[VN](le,xe):v[ya](le,H(L))}};function _(L){return v._sample.isSampledIn(L)}function D(L,le,he,xe,Le,et){var N=null;if(v._appId||(N=ge(et),N&&N.appId&&(v._appId=N.appId)),(L<200||L>=300)&&L!==0){if((L===301||L===307||L===308)&&!P(he)){v[ya](le,Le);return}!v[Jr][Rb]()&&Je(L)?(Ke(le),mt(v[lo](),2,40,". Response code "+L+". Will retry to send "+le[Pt]+" items.")):v[ya](le,Le)}else if(h&&!h.isOnline()){if(!v[Jr][Rb]()){var W=10;Ke(le,W),mt(v[lo](),2,40,". Offline - Response Code: ".concat(L,". Offline status: ").concat(!h.isOnline(),". Will retry to send ").concat(le.length," items."))}}else P(he),L===206?(N||(N=ge(et)),N&&!v[Jr][Rb]()?v[VN](le,N):v[ya](le,Le)):(n=0,v[Fw](le,xe))}function P(L){return c>=10?!1:!Ht(L)&&L!==""&&L!==v[Jr][Ef]()?(v[Jr][Ef]=function(){return L},++c,!0):!1}function M(L,le){m?m(L,!1):A(L,le)}function x(L){var le=ff(),he=v[pg],xe=v[Jr][Ef](),Le=v._buffer[cg](L),et=new Blob([Le],{type:"text/plain;charset=UTF-8"}),N=le.sendBeacon(xe,et);return N&&(he[Sf](L),v._onSuccess(L,L[Pt])),N}function A(L,le){if(rn(L)&&L[Pt]>0&&!x(L)){for(var he=[],xe=0;xe<L[Pt];xe++){var Le=L[xe];x([Le])||he[Ed](Le)}he[Pt]>0&&(f&&f(he,!0),mt(v[lo](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function j(L,le){var he=new XMLHttpRequest,xe=v[Jr][Ef]();try{he[lw]=!0}catch(et){}he.open("POST",xe,le),he[jN]("Content-type","application/json"),yw(xe)&&he[jN](mb[6],mb[7]),Si(pf(u),function(et){he[jN](et,u[et])}),he.onreadystatechange=function(){return v._xhrReadyStateChange(he,L,L[Pt])},he.onerror=function(et){return v[ya](L,vr(he),et)};var Le=v._buffer[cg](L);he.send(Le),v._buffer[Sf](L)}function re(L,le){if(rn(L)){for(var he=L[Pt],xe=0;xe<L[Pt];xe++)he+=L[xe][Pt];p+he<=Zde?Z(L,!1):Cb()?A(L,le):(f&&f(L,!0),mt(v[lo](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function R(L,le){Z(L,!0)}function Z(L,le){var he,xe=v[Jr][Ef](),Le=v._buffer[cg](L),et=new Blob([Le],{type:"application/json"}),N=new Headers,W=Le[Pt],pe=!1,_e=!1;yw(xe)&&N.append(mb[6],mb[7]),Si(pf(u),function(ze){N.append(ze,u[ze])});var Ae=(he={method:"POST",headers:N,body:et},he[lw]=!0,he);le||(Ae.keepalive=!0,pe=!0,p+=W);var Yt=new Request(xe,Ae);try{Yt[lw]=!0}catch(ze){}v._buffer[Sf](L);try{fetch(Yt).then(function(ze){le||(p-=W,W=0),_e||(_e=!0,ze.ok?ze.text().then(function(bt){D(ze.status,L,ze.url,L[Pt],ze.statusText,bt)}):v[ya](L,ze.statusText))}).catch(function(ze){le||(p-=W,W=0),_e||(_e=!0,v[ya](L,ze.message))})}catch(ze){_e||v[ya](L,qn(ze))}pe&&!_e&&(_e=!0,v._onSuccess(L,L[Pt]))}function ge(L){try{if(L&&L!==""){var le=os().parse(L);if(le&&le.itemsReceived&&le.itemsReceived>=le[Uw]&&le.itemsReceived-le.itemsAccepted===le.errors[Pt])return le}}catch(he){mt(v[lo](),1,43,"Cannot parse the response. "+ga(he),{response:L})}return null}function Ke(L,le){if(le===void 0&&(le=1),!(!L||L[Pt]===0)){var he=v[pg];he[ug](L),n++;for(var xe=0,Le=L;xe<Le.length;xe++){var et=Le[xe];he[lg](et)}Ce(le),ae()}}function Ce(L){var le=10,he;if(n<=1)he=le;else{var xe=(Math.pow(2,n)-1)/2,Le=Math.floor(Math.random()*xe*le)+1;Le=L*Le,he=Math.max(Math.min(Le,3600),le)}var et=Id()+he*1e3;i=et}function ae(){if(!a&&!s){var L=i?Math.max(0,i-Id()):0,le=Math.max(v[Jr][a2](),L);a=setTimeout(function(){a=null,v[dg](!0,null,1)},le)}}function Nt(){clearTimeout(a),a=null,i=null}function Je(L){return L===401||L===403||L===408||L===429||L===500||L===502||L===503||L===504}function vr(L,le){return L?"XMLHttpRequest,Status:"+L.status+",Response:"+HN(L)||L.response||"":le}function Xr(L,le){var he=v[pg],xe=Eb(),Le=new XDomainRequest;Le.onload=function(){return v._xdrOnLoad(Le,L)},Le.onerror=function(pe){return v[ya](L,H(Le),pe)};var et=xe&&xe.location&&xe.location.protocol||"";if(v[Jr][Ef]().lastIndexOf(et,0)!==0){mt(v[lo](),2,40,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),he[If]();return}var N=v[Jr][Ef]().replace(/^(https?:)/,"");Le.open("POST",N);var W=he[cg](L);Le.send(W),he[Sf](L)}function H(L,le){return L?"XDomainRequest,Response:"+HN(L)||"":le}function de(){var L="getNotifyMgr";return v.core[L]?v.core[L]():v.core._notificationManager}function Te(L,le){var he=de();if(he&&he[l2])try{he[l2](L,le)}catch(xe){mt(v[lo](),1,74,"send request notification failed: "+ga(xe),{exception:qn(xe)})}}function be(L){var le=Ht(L[c2])?!1:L[c2];if(le)return!0;var he="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",xe=new RegExp(he);return xe.test(L[Kw])}function we(){v[Tb]=null,v[pg]=null,v._appId=null,v._sample=null,u={},h=null,n=0,i=null,o=null,s=!1,a=null,l=null,c=0,p=0,f=null,m=null,g=null}}),t}return e.constructEnvelope=function(t,n,i,o){var s;n!==t.iKey&&!Ht(n)?s=xo(xo({},t),{iKey:n}):s=t;var a=epe[s.baseType]||d2;return a(i,s,o)},e}(e2)});var p2=ee(()=>{d();Mq()});var wl,as,Vw,xl,Wt,ks,Oc,JN,Ns,yt,gg,qr,qN,vg,yg,f2,jw,bg,Ab,Bw,wf,Rs,Mb,xf,Dl,Ob,Ig,As,ba,Df,Dd,m2,Pf,Pl,Hw,Jw,Pd,Sg,GN,Lb,Tl,h2,Oq,Lq,$n,qw,Kq,_g,Gw,Eg,kl,YN,$N,zN,QN,Mn=ee(()=>{d();wl="initialize",as="name",Vw="getNotifyMgr",xl="identifier",Wt="push",ks="isInitialized",Oc="config",JN="instrumentationKey",Ns="logger",yt="length",gg="time",qr="processNext",qN="getProcessTelContext",vg="addNotificationListener",yg="removeNotificationListener",f2="stopPollingInternalLogs",jw="onComplete",bg="getPlugin",Ab="flush",Bw="_extensions",wf="splice",Rs="teardown",Mb="messageId",xf="message",Dl="isAsync",Ob="_doTeardown",Ig="update",As="getNext",ba="diagLog",Df="setNextPlugin",Dd="createNew",m2="cookieCfg",Pf="indexOf",Pl="substring",Hw="userAgent",Jw="split",Pd="setEnabled",Sg="substr",GN="nodeType",Lb="apply",Tl="replace",h2="enableDebugExceptions",Oq="logInternalMessage",Lq="toLowerCase",$n="call",qw="type",Kq="handler",_g="listeners",Gw="isChildEvt",Eg="getCtx",kl="setCtx",YN="complete",$N="traceId",zN="spanId",QN="traceFlags"});var Tt,g2,hn,v2,Yw,Kb,Fq,ls,Ia,Fb,Tf,Ub,kf,XN,$w,Cg,Ei=ee(()=>{d();Tt="",g2="channels",hn="core",v2="createPerfMgr",Yw="disabled",Kb="extensionConfig",Fq="extensions",ls="processTelemetry",Ia="priority",Fb="eventsSent",Tf="eventsDiscarded",Ub="eventsSendRequest",kf="perfEvent",XN="errorToConsole",$w="warnToConsole",Cg="getPerfMgr"});function ppe(r){if(r){if(e0)return e0(r);var e=r[rpe]||r[Ft]||r[ZN];if(e)return e}return null}function E2(r,e){return typeof r===e}function On(r){return r===void 0||typeof r===Zt}function cr(r){return r===null||On(r)}function C2(r){return!cr(r)}function w2(r,e){return!!(r&&ar[$n](r,e))}function Td(r){return!!(r&&typeof r===pt)}function Dr(r){return!!(r&&typeof r===on)}function zw(r){var e=r;return e&&Nf(e)&&(e=e[Tl](cpe,function(t,n){return n.toUpperCase()}),e=e[Tl](upe,"_"),e=e[Tl](dpe,function(t,n){return"_"+n})),e}function kd(r,e){if(r)for(var t in r)ar[$n](r,t)&&e[$n](r,t,r[t])}function x2(r,e){var t=!1;return r&&e&&!(t=r===e)&&(t=ipe?r[Gq](e):fpe(r,e)),t}function fpe(r,e){var t=!1,n=e?e[yt]:0,i=r?r[yt]:0;if(n&&i&&i>=n&&!(t=r===e)){for(var o=i-1,s=n-1;s>=0;s--){if(r[o]!=e[s])return!1;o--}t=!0}return t}function Li(r,e){return r&&e?r[Pf](e)!==-1:!1}function D2(r){return!!(r&&_2[$n](r)==="[object Date]")}function mpe(r){return!!(r&&_2[$n](r)==="[object Array]")}function t0(r){return!!(r&&_2[$n](r)==="[object Error]")}function Nf(r){return typeof r=="string"}function P2(r){return typeof r=="number"}function Wb(r){return typeof r=="boolean"}function Hq(r){var e=!1;if(r&&typeof r=="object"){var t=e0?e0(r):ppe(r);t?(t[ZN]&&ar[$n](t,ZN)&&(t=t[ZN]),e=typeof t===on&&$q[$n](t)===lpe):e=!0}return e}function Vb(r){if(r)return spe?r[qq]():hpe(r)}function hpe(r){if(r&&r.getUTCFullYear){var e=function(t){var n=String(t);return n[yt]===1&&(n="0"+n),n};return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"."+String((r.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Ct(r,e,t){var n=r[yt];try{for(var i=0;i<n&&!(i in r&&e[$n](t||r,r[i],i,r)===-1);i++);}catch(o){}}function Sa(r,e,t){if(r){if(r[Uq])return r[Uq](e,t);var n=r[yt],i=t||0;try{for(var o=Math.max(i>=0?i:n-Math.abs(i),0);o<n;o++)if(o in r&&r[o]===e)return o}catch(s){}}return-1}function T2(r,e,t){var n;if(r){if(r[Wq])return r[Wq](e,t);var i=r[yt],o=t||r;n=new Array(i);try{for(var s=0;s<i;s++)s in r&&(n[s]=e[$n](o,r[s],r))}catch(a){}}return n}function k2(r,e,t){var n;if(r){if(r[Vq])return r[Vq](e,t);var i=r[yt],o=0;if(arguments[yt]>=3)n=arguments[2];else{for(;o<i&&!(o in r);)o++;n=r[o++]}for(;o<i;)o in r&&(n=e(n,r[o],o,r)),o++}return n}function Nl(r){return r&&(r=npe&&r[b2]?r[b2]():r[Tl]?r[Tl](/^\s+|(?=\s)\s+$/g,Tt):r),r}function jb(r){var e=typeof r;if(e!==on&&(e!==pt||r===null)&&aa("objKeys called on non-object"),!Jq&&Bq)return Bq(r);var t=[];for(var n in r)r&&ar[$n](r,n)&&t[Wt](n);if(Jq)for(var i=y2[yt],o=0;o<i;o++)r&&ar[$n](r,y2[o])&&t[Wt](y2[o]);return t}function Bb(r,e,t,n){if(jq)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),n&&(i.set=n),jq(r,e,i),!0}catch(o){}return!1}function gpe(r){return r}function N2(r){return I2&&kd(r,function(e,t){(cn(t)||Td(t))&&I2(t)}),Lc(r)}function Rl(){var r=Date;return r.now?r.now():new r().getTime()}function Qw(r){return t0(r)?r[as]:Tt}function _a(r,e,t,n,i){var o=t;return r&&(o=r[e],o!==t&&(!i||i(o))&&(!n||n(t))&&(o=t,r[e]=o)),o}function Hb(r,e,t){var n;return r?(n=r[e],!n&&cr(n)&&(n=On(t)?{}:t,r[e]=n)):n=On(t)?{}:t,n}function Ea(r,e){return cr(r)?e:r}function r0(r){return!!r}function ai(r){throw new Error(r)}function vpe(r,e){var t=null,n=null;return Dr(r)?t=r:n=r,function(){var i=arguments;if(t&&(n=t()),n)return n[e][Lb](n,i)}}function Jb(r,e,t,n,i){r&&e&&t&&(i!==!1||On(r[e]))&&(r[e]=vpe(t,n))}function Nd(r,e,t,n){return r&&e&&Td(r)&&cn(t)&&Ct(t,function(i){Nf(i)&&Jb(r,i,e,i,n)}),r}function qb(r,e,t,n,i,o){var s=arguments,a=s[0]||{},l=s[yt],c=!1,u=1;for(l>0&&Wb(a)&&(c=a,a=s[u]||{},u++),Td(a)||(a={});u<l;u++){var p=s[u],f=cn(p),m=Td(p);for(var h in p){var g=f&&h in p||m&&ar[$n](p,h);if(g){var v=p[h],S=void 0;if(c&&v&&((S=cn(v))||Hq(v))){var _=a[h];S?cn(_)||(_=[]):Hq(_)||(_={}),v=qb(c,_,v)}v!==void 0&&(a[h]=v)}}}return a}var qq,Gq,tpe,Uq,Wq,Vq,b2,Yq,rpe,ZN,jq,I2,b7e,Bq,S2,npe,ipe,I7e,ope,spe,ape,_2,$q,lpe,cpe,upe,dpe,e0,cn,Jq,y2,Lc,zn=ee(()=>{d();lr();Mn();Ei();qq="toISOString",Gq="endsWith",tpe="startsWith",Uq="indexOf",Wq="map",Vq="reduce",b2="trim",Yq="toString",rpe="__proto__",ZN="constructor",jq=Co,I2=wr.freeze,b7e=wr.seal,Bq=wr.keys,S2=String[Ft],npe=S2[b2],ipe=S2[Gq],I7e=S2[tpe],ope=Date[Ft],spe=ope[qq],ape=Array.isArray,_2=sa[Yq],$q=ar[Yq],lpe=$q[$n](wr),cpe=/-([a-z])/g,upe=/([^\w\d_$])/g,dpe=/^(\d+[\w\d_$])/,e0=Object.getPrototypeOf;cn=ape||mpe;Jq=!{toString:null}.propertyIsEnumerable("toString"),y2=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];Lc=I2||gpe});function R2(r){var e={};return kd(r,function(t,n){e[t]=n,e[n]=t}),N2(e)}var zq=ee(()=>{d();zn()});function Ms(r){var e=Bn();return e&&e[r]?e[r]:r===Qq&&Zq()?window:null}function Zq(){return!!(typeof window===pt&&window)}function e4(){return Zq()?window:Ms(Qq)}function Ppe(){return!!(typeof document===pt&&document)}function n0(){return Ppe()?document:Ms(ype)}function Tpe(){return!!(typeof navigator===pt&&navigator)}function O2(){return Tpe()?navigator:Ms(bpe)}function t4(r){if(r&&Dpe){var e=Ms("__mockLocation");if(e)return e}return typeof location===pt&&location?location:Ms(Ipe)}function r4(){return typeof console!==Zt?console:Ms(Spe)}function n4(){return Ms(_pe)}function i0(){return!!(typeof JSON===pt&&JSON||Ms(Xq)!==null)}function L2(){return i0()?JSON||Ms(Xq):null}function i4(){return Ms(Epe)}function o4(){return Ms(Cpe)}function wg(){var r=O2();if(r&&(r[Hw]!==M2||A2===null)){M2=r[Hw];var e=(M2||Tt)[Lq]();A2=Li(e,wpe)||Li(e,xpe)}return A2}function Ca(r){var e=Object[Ft].toString[$n](r),t=Tt;return e==="[object Error]"?t="{ stack: '"+r.stack+"', message: '"+r.message+"', name: '"+r[as]+"'":i0()&&(t=L2().stringify(r)),e+t}var Qq,ype,bpe,Ipe,Spe,_pe,Xq,Epe,Cpe,wpe,xpe,A2,M2,Dpe,Kc=ee(()=>{"use strict";d();lr();Mn();zn();Ei();Qq="window",ype="document",bpe="navigator",Ipe="location",Spe="console",_pe="performance",Xq="JSON",Epe="crypto",Cpe="msCrypto",wpe="msie",xpe="trident/",A2=null,M2=null,Dpe=!1});function kpe(r,e){return function(){var t=arguments,n=F2(e);if(n){var i=n.listener;i&&i[r]&&i[r][Lb](i,t)}}}function Npe(){var r=Ms("Microsoft");return r&&(s0=r.ApplicationInsights),s0}function F2(r){var e=s0;return!e&&r.disableDbgExt!==!0&&(e=s0||Npe()),e?e.ChromeDbgExt:null}function s4(r){if(!o0){o0={};for(var e=0;e<K2[yt];e++)o0[K2[e]]=kpe(K2[e],r)}return o0}var K2,s0,o0,U2=ee(()=>{d();Mn();Kc();K2=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],s0=null});function a4(r){return r?'"'+r[Tl](/\"/g,Tt)+'"':Tt}function l4(r,e){var t=r4();if(t){var n="log";t[r]&&(n=r),Dr(t[n])&&t[n](e)}}function c4(r,e){return(r||{})[Ns]||new Gb(e)}function u4(r){return r||new Gb}function Al(r,e,t,n,i,o){o===void 0&&(o=!1),u4(r).throwInternal(e,t,n,i,o)}function d4(r,e){u4(r)[$w](e)}var Rpe,Ape,Mpe,a0,Gb,xg=ee(()=>{"use strict";d();mr();Mn();U2();Kc();zn();Ei();Rpe="AI (Internal): ",Ape="AI: ",Mpe="AITR_";a0=function(){function r(e,t,n,i){n===void 0&&(n=!1);var o=this;o[Mb]=e,o[xf]=(n?Ape:Rpe)+e;var s=Tt;i0()&&(s=L2().stringify(i));var a=(t?" message:"+a4(t):Tt)+(i?" props:"+a4(s):Tt);o[xf]+=a}return r.dataType="MessageData",r}();Gb=function(){function r(e){this.identifier="DiagnosticLogger",this.queue=[];var t=0,n={},i,o,s,a;Be(r,this,function(l){u(e||{}),l.consoleLoggingLevel=function(){return i},l.telemetryLoggingLevel=function(){return o},l.maxInternalMessageLimit=function(){return s},l[h2]=function(){return a},l.throwInternal=function(m,h,g,v,S){S===void 0&&(S=!1);var _=new a0(h,g,S,v);if(a)throw Ca(_);var D=m===1?XN:$w;if(On(_[xf]))f("throw"+(m===1?"Critical":"Warning"),_);else{if(S){var P=+_[Mb];!n[P]&&i>=m&&(l[D](_[xf]),n[P]=!0)}else i>=m&&l[D](_[xf]);c(m,_)}},l[$w]=function(m){l4("warn",m),f("warning",m)},l[XN]=function(m){l4("error",m),f("error",m)},l.resetInternalMessageCount=function(){t=0,n={}},l[Oq]=c;function c(m,h){if(!p()){var g=!0,v=Mpe+h[Mb];if(n[v]?g=!1:n[v]=!0,g&&(m<=o&&(l.queue[Wt](h),t++,f(m===1?"error":"warn",h)),t===s)){var S="Internal events throttle limit per PageView reached for this app.",_=new a0(23,S,!1);l.queue[Wt](_),m===1?l[XN](S):l[$w](S)}}}function u(m){i=Ea(m.loggingLevelConsole,0),o=Ea(m.loggingLevelTelemetry,1),s=Ea(m.maxMessageLimit,25),a=Ea(m[h2],!1)}function p(){return t>=s}function f(m,h){var g=F2(e||{});g&&g[ba]&&g[ba](m,h)}})}return r.__ieDyn=1,r}()});function c0(r,e,t,n,i){if(r){var o=r;if(o[Cg]&&(o=o[Cg]()),o){var s=void 0,a=o[Eg](W2);try{if(s=o.create(e(),n,i),s){if(a&&s[kl]&&(s[kl](l0[V2],a),a[Eg]&&a[kl])){var l=a[Eg](l0[Xw]);l||(l=[],a[kl](l0[Xw],l)),l[Wt](s)}return o[kl](W2,s),t(s)}}catch(c){s&&s[kl]&&s[kl]("exception",c)}finally{s&&o.fire(s),o[kl](W2,a)}}}return t()}function f4(){return Ope}var Yb,V2,Xw,Ope,l0,p4,W2,u0=ee(()=>{d();mr();Mn();zn();Ei();Yb="ctx",V2="ParentContextKey",Xw="ChildrenContextKey",Ope=null,l0=function(){function r(e,t,n){var i=this,o=!1;if(i.start=Rl(),i[as]=e,i[Dl]=n,i[Gw]=function(){return!1},Dr(t)){var s;o=Bb(i,"payload",function(){return!s&&Dr(t)&&(s=t(),t=null),s})}i[Eg]=function(a){return a?a===r[V2]||a===r[Xw]?i[a]:(i[Yb]||{})[a]:null},i[kl]=function(a,l){if(a)if(a===r[V2])i[a]||(i[Gw]=function(){return!0}),i[a]=l;else if(a===r[Xw])i[a]=l;else{var c=i[Yb]=i[Yb]||{};c[a]=l}},i[YN]=function(){var a=0,l=i[Eg](r[Xw]);if(cn(l))for(var c=0;c<l[yt];c++){var u=l[c];u&&(a+=u[gg])}i[gg]=Rl()-i.start,i.exTime=i[gg]-a,i[YN]=function(){},!o&&Dr(t)&&(i.payload=t())}}return r.ParentContextKey="parent",r.ChildrenContextKey="childEvts",r}(),p4=function(){function r(e){this.ctx={},Be(r,this,function(t){t.create=function(n,i,o){return new l0(n,i,o)},t.fire=function(n){n&&(n[YN](),e&&Dr(e[kf])&&e[kf](n))},t[kl]=function(n,i){if(n){var o=t[Yb]=t[Yb]||{};o[n]=i}},t[Eg]=function(n){return(t[Yb]||{})[n]}})}return r.__ieDyn=1,r}(),W2="CoreUtils.doPerf"});function g4(r){r<0&&(r>>>=0),Zw=123456789+r&Rf,ex=987654321-r&Rf,h4=!0}function v4(){try{var r=Rl()&2147483647;g4((Math.random()*m4^r)+r)}catch(e){}}function y4(r){return r>0?Math.floor(Dg()/Rf*(r+1))>>>0:0}function Dg(r){var e=0,t=i4()||o4();return t&&t.getRandomValues&&(e=t.getRandomValues(new Uint32Array(1))[0]&Rf),e===0&&wg()&&(h4||v4(),e=j2()&Rf),e===0&&(e=Math.floor(m4*Math.random()|0)),r||(e>>>=0),e}function b4(r){r?g4(r):v4()}function j2(r){ex=36969*(ex&65535)+(ex>>16)&Rf,Zw=18e3*(Zw&65535)+(Zw>>16)&Rf;var e=(ex<<16)+(Zw&65535)>>>0&Rf|0;return r||(e>>>=0),e}function d0(r){r===void 0&&(r=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=Dg()>>>0,n=0,i=Tt;i[yt]<r;)n++,i+=e.charAt(t&63),t>>>=6,n===5&&(t=(Dg()<<2&4294967295|t&3)>>>0,n=0);return i}var m4,Rf,h4,Zw,ex,B2=ee(()=>{d();Mn();Kc();zn();Ei();m4=4294967296,Rf=4294967295,h4=!1,Zw=123456789,ex=987654321});function Fpe(r,e,t){if(I4)try{return I4(r,e,{value:t,enumerable:!1,configurable:!0}),!0}catch(n){}return!1}function _4(r){return r[GN]===1||r[GN]===9||!+r[GN]}function Upe(r,e){var t=e[r.id];if(!t){t={};try{_4(e)&&(Fpe(e,r.id,t)||(e[r.id]=t))}catch(n){}}return t}function $b(r,e){return e===void 0&&(e=!1),zw(r+Kpe+++(e?"."+S4:Tt)+Lpe)}function p0(r){var e={id:$b("_aiData-"+(r||Tt)+"."+S4),accept:function(t){return _4(t)},get:function(t,n,i,o){var s=t[e.id];return s?s[zw(n)]:(o&&(s=Upe(e,t),s[zw(n)]=i),i)},kill:function(t,n){if(t&&t[n])try{delete t[n]}catch(i){}}};return e}var I4,S4,Lpe,Kpe,f0=ee(()=>{d();lr();Mn();zn();Ei();B2();I4=Co,S4="2.8.11",Lpe="."+d0(6),Kpe=0});function A4(r,e){var t=tx[zb]||g0[zb];return t||(t=tx[zb]=tx(r,e),g0[zb]=t),t}function h0(r){return r?r.isEnabled():!0}function Wpe(r){var e=r[m2]=r[m2]||{};if(_a(e,"domain",r.cookieDomain,C2,cr),_a(e,"path",r.cookiePath||"/",null,cr),cr(e[q2])){var t=void 0;On(r[w4])||(t=!r[w4]),On(r[x4])||(t=!r[x4]),e[q2]=t}return e}function M4(r,e){return e&&r&&cn(r.ignoreCookies)?r.ignoreCookies[Pf](e)!==-1:!1}function Vpe(r,e){return e&&r&&cn(r.blockedCookies)&&r.blockedCookies[Pf](e)!==-1?!0:M4(r,e)}function tx(r,e){var t,n=Wpe(r||g0),i=n.path||"/",o=n.domain,s=n[q2]!==!1,a=(t={isEnabled:function(){var l=s&&T4(e),c=g0[zb];return l&&c&&a!==c&&(l=h0(c)),l}},t[Pd]=function(l){s=l!==!1},t.set=function(l,c,u,p,f){var m=!1;if(h0(a)&&!Vpe(n,l)){var h={},g=Nl(c||Tt),v=g[Pf](";");if(v!==-1&&(g=Nl(c[Pl](0,v)),h=O4(c[Pl](v+1))),_a(h,"domain",p||o,r0,On),!cr(u)){var S=wg();if(On(h[H2])){var _=Rl(),D=_+u*1e3;if(D>0){var P=new Date;P.setTime(D),_a(h,H2,k4(P,S?E4:C4)||k4(P,S?E4:C4)||Tt,r0)}}S||_a(h,"max-age",Tt+u,null,On)}var M=t4();M&&M.protocol==="https:"&&(_a(h,"secure",null,null,On),J2===null&&(J2=!Bpe((O2()||{})[Hw])),J2&&_a(h,"SameSite","None",null,On)),_a(h,"path",f||i,null,On);var x=n.setCookie||R4;x(l,N4(g,h)),m=!0}return m},t.get=function(l){var c=Tt;return h0(a)&&!M4(n,l)&&(c=(n.getCookie||jpe)(l)),c},t.del=function(l,c){var u=!1;return h0(a)&&(u=a.purge(l,c)),u},t.purge=function(l,c){var u,p=!1;if(T4(e)){var f=(u={},u.path=c||"/",u[H2]="Thu, 01 Jan 1970 00:00:01 GMT",u);wg()||(f["max-age"]="0");var m=n.delCookie||R4;m(l,N4(Tt,f)),p=!0}return p},t);return a[zb]=a,a}function T4(r){if(m0===null){m0=!1;try{var e=rx||{};m0=e[G2]!==void 0}catch(t){Al(r,2,68,"Cannot access document.cookie - "+Qw(t),{exception:Ca(t)})}}return m0}function O4(r){var e={};if(r&&r[yt]){var t=Nl(r)[Jw](";");Ct(t,function(n){if(n=Nl(n||Tt),n){var i=n[Pf]("=");i===-1?e[n]=null:e[Nl(n[Pl](0,i))]=Nl(n[Pl](i+1))}})}return e}function k4(r,e){return Dr(r[e])?r[e]():null}function N4(r,e){var t=r||Tt;return kd(e,function(n,i){t+="; "+n+(cr(i)?Tt:"="+i)}),t}function jpe(r){var e=Tt;if(rx){var t=rx[G2]||Tt;D4!==t&&(P4=O4(t),D4=t),e=Nl(P4[r]||Tt)}return e}function R4(r,e){rx&&(rx[G2]=r+"="+e)}function Bpe(r){return Nf(r)?!!(Li(r,"CPU iPhone OS 12")||Li(r,"iPad; CPU OS 12")||Li(r,"Macintosh; Intel Mac OS X 10_14")&&Li(r,"Version/")&&Li(r,"Safari")||Li(r,"Macintosh; Intel Mac OS X 10_14")&&x2(r,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Li(r,"Chrome/5")||Li(r,"Chrome/6")||Li(r,"UnrealEngine")&&!Li(r,"Chrome")||Li(r,"UCBrowser/12")||Li(r,"UCBrowser/11")):!1}var E4,C4,G2,H2,q2,w4,x4,zb,m0,J2,D4,rx,P4,g0,Y2=ee(()=>{d();Mn();xg();Kc();zn();Ei();E4="toGMTString",C4="toUTCString",G2="cookie",H2="expires",q2="enabled",w4="isCookieUseDisabled",x4="disableCookiesUsage",zb="_ckMgr",m0=null,J2=null,D4=null,rx=n0(),P4={},g0={}});function F4(r){return r&&r[Tl]?r[Tl](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Tt):r}function zpe(r,e){var t;if(e){var n=Tt;cn(e)?(n=Tt,Ct(e,function(o){o=F4(o),o&&(o[0]!=="."&&(o="."+o),n+=o)})):n=F4(e),n&&(n[0]!=="."&&(n="."+n),r=(r||Tt)+n)}var i=$pe.exec(r||Tt)||[];return t={},t[qw]=i[1],t.ns=(i[2]||Tt).replace(qpe,".").replace(Gpe,Tt)[Jw](".").sort().join("."),t}function Qpe(r,e,t){t===void 0&&(t=!0);var n=U4.get(r,Jpe,{},t),i=n[e];return i||(i=n[e]=[]),i}function Xpe(r,e,t,n){var i=!1;return r&&e&&e[qw]&&t&&(r[K4]?(r[K4](e[qw],t,n),i=!0):r[L4]&&(r[L4](Hpe+e[qw],t),i=!0)),i}function $2(r,e,t,n,i){var o;i===void 0&&(i=!1);var s=!1;if(r)try{var a=zpe(e,n);if(s=Xpe(r,a,t,i),s&&U4.accept(r)){var l=(o={guid:Ype++,evtName:a},o[Kq]=t,o.capture=i,o);Qpe(r,a.type)[Wt](l)}}catch(c){}return s}function W4(r,e,t){var n=!1,i=e4();i&&(n=$2(i,r,e,t),n=$2(i.body,r,e,t)||n);var o=n0();return o&&(n=$2(o,r,e,t)||n),n}var Hpe,L4,K4,Jpe,S8e,_8e,qpe,Gpe,Ype,U4,$pe,V4=ee(()=>{d();Mn();f0();Kc();zn();Ei();Hpe="on",L4="attachEvent",K4="addEventListener",Jpe="events",S8e=$b("aiEvtPageHide"),_8e=$b("aiEvtPageShow"),qpe=/\.[\.]+/g,Gpe=/[\.]+$/,Ype=1,U4=p0("events"),$pe=/^([^.]*)(?:\.(.+)|)/});function j4(){var r=z2();return r[Pl](0,8)+"-"+r[Pl](8,12)+"-"+r[Pl](12,16)+"-"+r[Pl](16,20)+"-"+r[Pl](20)}function B4(){var r=n4();return r&&r.now?r.now():Rl()}function z2(){for(var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=Tt,t,n=0;n<4;n++)t=Dg(),e+=r[t&15]+r[t>>4&15]+r[t>>8&15]+r[t>>12&15]+r[t>>16&15]+r[t>>20&15]+r[t>>24&15]+r[t>>28&15];var i=r[8+(Dg()&3)|0];return e[Sg](0,8)+e[Sg](9,4)+"4"+e[Sg](13,3)+i+e[Sg](16,3)+e[Sg](19,12)}function H4(r,e){var t=A4(r,e),n=ox._canUseCookies;return nx===null&&(nx=[],ix=n,Bb(ox,"_canUseCookies",function(){return ix},function(i){ix=i,Ct(nx,function(o){o[Pd](i)})})),Sa(nx,t)===-1&&nx[Wt](t),Wb(n)&&t[Pd](n),Wb(ix)&&t[Pd](ix),t}function J4(){H4()[Pd](!1)}var nx,ix,ox,q4=ee(()=>{"use strict";d();lr();Mn();Y2();Kc();V4();zn();Ei();B2();nx=null;ox={_canUseCookies:void 0,isTypeof:E2,isUndefined:On,isNullOrUndefined:cr,hasOwnProperty:w2,isFunction:Dr,isObject:Td,isDate:D2,isArray:cn,isError:t0,isString:Nf,isNumber:P2,isBoolean:Wb,toISOString:Vb,arrForEach:Ct,arrIndexOf:Sa,arrMap:T2,arrReduce:k2,strTrim:Nl,objCreate:wo,objKeys:jb,objDefineAccessors:Bb,addEventHandler:W4,dateNow:Rl,isIE:wg,disableCookies:J4,newGuid:j4,perfNow:B4,newId:d0,randomValue:y4,random32:Dg,mwcRandomSeed:b4,mwcRandom32:j2,generateW3CId:z2}});function G4(r,e,t){return r&&r[yt]===e&&r!==t?!!r.match(/^[\da-f]*$/):!1}function Y4(r){return G4(r,32,Zpe)}function $4(r){return G4(r,16,efe)}var Zpe,efe,z4=ee(()=>{d();Mn();Zpe="00000000000000000000000000000000",efe="0000000000000000"});function Rd(r){return tfe.get(r,"state",{},!0)}function v0(r,e){for(var t=[],n=null,i=r[As](),o;i;){var s=i[bg]();if(s){n&&Dr(n[Df])&&Dr(s[ls])&&n[Df](s);var a=!1;Dr(s[ks])?a=s[ks]():(o=Rd(s),a=o[ks]),a||t[Wt](s),n=s,i=i[As]()}}Ct(t,function(l){var c=r[hn]();l[wl](r.getCfg(),c,e,r[As]()),o=Rd(l),!l[hn]&&!o[hn]&&(o[hn]=c),o[ks]=!0,delete o[Rs]})}function y0(r){return r.sort(function(e,t){var n=0;if(t){var i=Dr(t[ls]);Dr(e[ls])?n=i?e[Ia]-t[Ia]:1:i&&(n=-1)}else n=e?1:-1;return n})}function Q4(r){var e={};return{getName:function(){return e[as]},setName:function(t){r&&r.setName(t),e[as]=t},getTraceId:function(){return e[$N]},setTraceId:function(t){r&&r.setTraceId(t),Y4(t)&&(e[$N]=t)},getSpanId:function(){return e[zN]},setSpanId:function(t){r&&r.setSpanId(t),$4(t)&&(e[zN]=t)},getTraceFlags:function(){return e[QN]},setTraceFlags:function(t){r&&r.setTraceFlags(t),e[QN]=t}}}var tfe,b0=ee(()=>{"use strict";d();Mn();f0();zn();Ei();z4();tfe=p0("plugin")});function nfe(r,e,t){for(;r;){if(r[bg]()===t)return r;r=r[As]()}return Fc([t],e[Oc]||{},e)}function Q2(r,e,t,n){var i=null,o=[];n!==null&&(i=n?nfe(r,t,n):r);var s={_next:l,ctx:{core:function(){return t},diagLog:function(){return c4(t,e)},getCfg:function(){return e},getExtCfg:c,getConfig:u,hasNext:function(){return!!i},getNext:function(){return i},setNext:function(f){i=f},iterate:p,onComplete:a}};function a(f,m){for(var h=[],g=2;g<arguments.length;g++)h[g-2]=arguments[g];f&&o[Wt]({func:f,self:On(m)?s.ctx:m,args:h})}function l(){var f=i;if(i=f?f[As]():null,!f){var m=o;m&&m[yt]>0&&(Ct(m,function(h){try{h.func[$n](h.self,h.args)}catch(g){Al(t[Ns],2,73,"Unexpected Exception during onComplete - "+Ca(g))}}),o=[])}return f}function c(f,m,h){m===void 0&&(m={}),h===void 0&&(h=0);var g;if(e){var v=e[Kb];v&&f&&(g=v[f])}if(!g)g=m;else if(Td(m)&&h!==0){var S=qb(!0,m,g);e&&h===2&&kd(m,function(_){if(cr(S[_])){var D=e[_];cr(D)||(S[_]=D)}}),g=S}return g}function u(f,m,h){h===void 0&&(h=!1);var g,v=c(f,null);return v&&!cr(v[m])?g=v[m]:e&&!cr(e[m])&&(g=e[m]),cr(g)?h:g}function p(f){for(var m;m=s._next();){var h=m[bg]();h&&f(h)}}return s}function Ml(r,e,t,n){var i=Q2(r,e,t,n),o=i.ctx;function s(l){var c=i._next();return c&&c[ls](l,o),!c}function a(l,c){return l===void 0&&(l=null),cn(l)&&(l=Fc(l,e,t,c)),Ml(l||o[As](),e,t,c)}return o[qr]=s,o[Dd]=a,o}function Qb(r,e,t){var n=e[Oc]||{},i=Q2(r,n,e,t),o=i.ctx;function s(l){var c=i._next();return c&&c.unload(o,l),!c}function a(l,c){return l===void 0&&(l=null),cn(l)&&(l=Fc(l,n,e,c)),Qb(l||o[As](),e,c)}return o[qr]=s,o[Dd]=a,o}function sx(r,e,t){var n=e[Oc]||{},i=Q2(r,n,e,t),o=i.ctx;function s(l){return o.iterate(function(c){Dr(c[Ig])&&c[Ig](o,l)})}function a(l,c){return l===void 0&&(l=null),cn(l)&&(l=Fc(l,n,e,c)),sx(l||o[As](),e,c)}return o[qr]=s,o[Dd]=a,o}function Fc(r,e,t,n){var i=null,o=!n;if(cn(r)&&r[yt]>0){var s=null;Ct(r,function(a){if(!o&&n===a&&(o=!0),o&&a&&Dr(a[ls])){var l=ife(a,e,t);i||(i=l),s&&s._setNext(l),s=l}})}return n&&!i?Fc([n],e,t):i}function ife(r,e,t){var n=null,i=Dr(r[ls]),o=Dr(r[Df]),s;r?s=r[xl]+"-"+r[Ia]+"-"+eG++:s="Unknown-0-"+eG++;var a={getPlugin:function(){return r},getNext:function(){return n},processTelemetry:u,unload:p,update:f,_id:s,_setNext:function(m){n=m}};function l(){var m;return r&&Dr(r[Z4])&&(m=r[Z4]()),m||(m=Ml(a,e,t)),m}function c(m,h,g,v,S){var _=!1,D=r?r[xl]:rfe,P=m[X4];return P||(P=m[X4]={}),m.setNext(n),r&&c0(m[hn](),function(){return D+":"+g},function(){P[s]=!0;try{var M=n?n._id:Tt;M&&(P[M]=!1),_=h(m)}catch(A){var x=n?P[n._id]:!0;x&&(_=!0),(!n||!x)&&Al(m[ba](),1,73,"Plugin ["+D+"] failed during "+g+" - "+Ca(A)+", run flags: "+Ca(P))}},v,S),_}function u(m,h){h=h||l();function g(v){if(!r||!i)return!1;var S=Rd(r);return S[Rs]||S[Yw]?!1:(o&&r[Df](n),r[ls](m,v),!0)}c(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[qr](m)}function p(m,h){function g(){var v=!1;if(r){var S=Rd(r),_=r[hn]||S[hn];r&&(!_||_===m.core())&&!S[Rs]&&(S[hn]=null,S[Rs]=!0,S[ks]=!1,r[Rs]&&r[Rs](m,h)===!0&&(v=!0))}return v}c(m,g,"unload",function(){},h[Dl])||m[qr](h)}function f(m,h){function g(){var v=!1;if(r){var S=Rd(r),_=r[hn]||S[hn];r&&(!_||_===m.core())&&!S[Rs]&&r[Ig]&&r[Ig](m,h)===!0&&(v=!0)}return v}c(m,g,"update",function(){},!1)||m[qr](h)}return Lc(a)}var rfe,X4,Z4,eG,t5e,I0=ee(()=>{"use strict";d();Mn();xg();Kc();zn();Ei();u0();b0();rfe="TelemetryPluginChain",X4="_hasRun",Z4="_getTelCtx",eG=0;t5e=function(){function r(e,t,n,i){var o=this,s=Ml(e,t,n,i);Nd(o,s,jb(s))}return r}()});function tG(r,e,t){e&&cn(e)&&e[yt]>0&&(e=e.sort(function(n,i){return n[Ia]-i[Ia]}),Ct(e,function(n){n[Ia]<ax&&ai(ofe+n[xl])}),r[Wt]({queue:Lc(e),chain:Fc(e,t[Oc],t)}))}function rG(r,e){function t(){return Ml(null,e[Oc],e,null)}function n(c,u,p,f){var m=c?c[yt]+1:1;function h(){m--,m===0&&(f&&f(),f=null)}m>0&&Ct(c,function(g){if(g&&g.queue[yt]>0){var v=g.chain,S=u[Dd](v);S[jw](h),p(S)}else m--}),h()}function i(c,u){var p=u||{reason:0};return n(r,c,function(f){f[qr](p)},function(){c[qr](p)}),!0}function o(c,u){var p=u||{reason:0,isAsync:!1};return n(r,c,function(f){f[qr](p)},function(){c[qr](p),a=!1}),!0}function s(c){var u=null;return r&&r[yt]>0&&Ct(r,function(p){if(p&&p.queue[yt]>0&&(Ct(p.queue,function(f){if(f[xl]===c)return u=f,-1}),u))return-1}),u}var a=!1,l={identifier:"ChannelControllerPlugin",priority:ax,initialize:function(c,u,p,f){a=!0,Ct(r,function(m){m&&m.queue[yt]>0&&v0(Ml(m.chain,c,u),p)})},isInitialized:function(){return a},processTelemetry:function(c,u){n(r,u||t(),function(p){p[qr](c)},function(){u[qr](c)})},update:i,pause:function(){n(r,t(),function(c){c.iterate(function(u){u.pause&&u.pause()})},null)},resume:function(){n(r,t(),function(c){c.iterate(function(u){u.resume&&u.resume()})},null)},teardown:o,getChannel:s,flush:function(c,u,p,f){var m=1,h=!1,g=null;f=f||5e3;function v(){m--,h&&m===0&&(g&&(clearTimeout(g),g=null),u&&u(h),u=null)}return n(r,t(),function(S){S.iterate(function(_){if(_[Ab]){m++;var D=!1;_[Ab](c,function(){D=!0,v()},p)||D||(c&&g==null?g=setTimeout(function(){g=null,v()},f):v())}})},function(){h=!0,v()}),!0},_setQueue:function(c){r=c}};return l}function nG(r,e,t){var n=[];if(r&&Ct(r,function(o){return tG(n,o,t)}),e){var i=[];Ct(e,function(o){o[Ia]>ax&&i[Wt](o)}),tG(n,i,t)}return n}var ax,ofe,iG=ee(()=>{d();Mn();zn();Ei();I0();b0();ax=500,ofe="Channel has invalid priority - "});function S0(){var r=[];function e(n){n&&r[Wt](n)}function t(n,i){Ct(r,function(o){try{o(n,i)}catch(s){Al(n[ba](),2,73,"Unexpected error calling unload handler - "+Ca(s))}}),r=[]}return{add:e,run:t}}var X2=ee(()=>{d();Mn();xg();Kc();zn()});var Af,oG,sG=ee(()=>{"use strict";d();mr();Mn();zn();Ei();I0();X2();Af="getPlugin",oG=function(){function r(){var e=this,t,n,i,o,s;c(),Be(r,e,function(u){u[wl]=function(p,f,m,h){l(p,f,h),t=!0},u[Rs]=function(p,f){var m,h=u[hn];if(!h||p&&h!==p[hn]())return;var g,v=!1,S=p||Qb(null,h,i&&i[Af]?i[Af]():i),_=f||(m={reason:0},m[Dl]=!1,m);function D(){if(!v){v=!0,o.run(S,f);var P=s;s=[],Ct(P,function(M){M.rm()}),g===!0&&S[qr](_),c()}}return!u[Ob]||u[Ob](S,_,D)!==!0?D():g=!0,g},u[Ig]=function(p,f){var m=u[hn];if(!m||p&&m!==p[hn]())return;var h,g=!1,v=p||sx(null,m,i&&i[Af]?i[Af]():i),S=f||{reason:0};function _(){g||(g=!0,l(v.getCfg(),v.core(),v[As]()))}return!u._doUpdate||u._doUpdate(v,S,_)!==!0?_():h=!0,h},u._addHook=function(p){p&&(cn(p)?s=s.concat(p):s[Wt](p))},Jb(u,"_addUnloadCb",function(){return o},"add")}),e[ba]=function(u){return a(u)[ba]()},e[ks]=function(){return t},e.setInitialized=function(u){t=u},e[Df]=function(u){i=u},e[qr]=function(u,p){p?p[qr](u):i&&Dr(i[ls])&&i[ls](u,null)},e._getTelCtx=a;function a(u){u===void 0&&(u=null);var p=u;if(!p){var f=n||Ml(null,{},e[hn]);i&&i[Af]?p=f[Dd](null,i[Af]):p=f[Dd](null,i)}return p}function l(u,p,f){u&&_a(u,Kb,[],null,cr),!f&&p&&(f=p[qN]()[As]());var m=i;i&&i[Af]&&(m=i[Af]()),e[hn]=p,n=Ml(f,u,p,m)}function c(){t=!1,e[hn]=null,n=null,i=null,s=[],o=S0()}}return r.__ieDyn=1,r}()});var aG,lG=ee(()=>{d();lr();mr();Mn();sG();xg();Kc();zn();Ei();aG=function(r){_n(e,r);function e(){var t=r.call(this)||this;t.identifier="TelemetryInitializerPlugin",t.priority=199;var n,i;o(),Be(e,t,function(s,a){s.addTelemetryInitializer=function(l){var c={id:n++,fn:l};i[Wt](c);var u={remove:function(){Ct(i,function(p,f){if(p.id===c.id)return i[wf](f,1),-1})}};return u},s[ls]=function(l,c){for(var u=!1,p=i[yt],f=0;f<p;++f){var m=i[f];if(m)try{if(m.fn[Lb](null,[l])===!1){u=!0;break}}catch(h){Al(c[ba](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Qw(h),{exception:Ca(h)},!0)}}u||s[qr](l,c)},s[Ob]=function(){o()}});function o(){n=0,i=[]}return t}return e.__ieDyn=1,e}(oG)});function lfe(r,e){return new p4(e)}function cfe(r,e,t){var n,i=[],o={};return Ct(t,function(s){(cr(s)||cr(s[wl]))&&ai(pG);var a=s[Ia],l=s[xl];s&&a&&(cr(o[a])?o[a]=l:d4(r,"Two extensions have same priority #"+a+" - "+o[a]+", "+l)),(!a||a<e)&&i[Wt](s)}),n={all:t},n[hn]=i,n}function dG(r,e){var t=!1;return Ct(e,function(n){if(n===r)return t=!0,-1}),t}function ufe(){var r;return wo((r={},r[vg]=function(e){},r[yg]=function(e){},r[Fb]=function(e){},r[Tf]=function(e,t){},r[Ub]=function(e,t){},r))}var pG,cG,uG,sfe,afe,fG,mG=ee(()=>{"use strict";d();lr();mr();lr();Mn();iG();Y2();f0();U2();xg();zn();Ei();u0();I0();b0();lG();X2();pG="Plugins must provide initialize method",cG="_notificationManager",uG="SDK is still unloading...",sfe="SDK is not initialized",afe={loggingLevelConsole:1};fG=function(){function r(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h,g,v,S,_,D,P,M=0;Be(r,this,function(x){A(),x[ks]=function(){return t},x[wl]=function(H,de,Te,be){h&&ai(uG),x[ks]()&&ai("Core should not be initialized more than once"),e=H||{},x[Oc]=e,cr(H[JN])&&ai("Please provide instrumentation key"),i=be,x[cG]=be,ae(),Nt(),Je(),Te&&(x[Ns]=Te);var we=Hb(e,Fq,[]);c=[],c[Wt].apply(c,qm(qm([],de,!1),we,!1)),f=Hb(e,g2,[]),re(null),(!m||m[yt]===0)&&ai("No "+g2+" available"),t=!0,x.releaseQueue()},x.getTransmissionControls=function(){var H=[];return m&&Ct(m,function(de){H[Wt](de.queue)}),Lc(H)},x.track=function(H){H.iKey=H.iKey||e[JN],H[gg]=H[gg]||Vb(new Date),H.ver=H.ver||"4.0",!h&&x[ks]()?j()[qr](H):n[Wt](H)},x[qN]=j,x[Vw]=function(){return i||(i=ufe(),x[cG]=i),i},x[vg]=function(H){i&&i[vg](H)},x[yg]=function(H){i&&i[yg](H)},x.getCookieMgr=function(){return a||(a=tx(e,x[Ns])),a},x.setCookieMgr=function(H){a=H},x[Cg]=function(){if(!o&&!s&&Ea(e.enablePerfMgr)){var H=Ea(e[v2]);Dr(H)&&(s=H(x,x[Vw]()))}return o||s||f4()},x.setPerfMgr=function(H){o=H},x.eventCnt=function(){return n[yt]},x.releaseQueue=function(){if(t&&n[yt]>0){var H=n;n=[],Ct(H,function(de){j()[qr](de)})}},x.pollInternalLogs=function(H){v=H||null;var de=Ea(e.diagnosticLogInterval);return(!de||!(de>0))&&(de=1e4),M&&clearInterval(M),M=setInterval(function(){Ke()},de),M},x[f2]=function(){M&&(clearInterval(M),M=0,Ke())},Nd(x,function(){return g},["addTelemetryInitializer"]),x.unload=function(H,de,Te){var be;H===void 0&&(H=!0),t||ai(sfe),h&&ai(uG);var we=(be={reason:50},be[Dl]=H,be.flushComplete=!1,be),L=Qb(Z(),x);L[jw](function(){A(),de&&de(we)},x);function le(he){we.flushComplete=he,h=!0,_.run(L,we),x[f2](),L[qr](we)}Ce(H,le,6,Te)||le(!1)},x[bg]=R,x.addPlugin=function(H,de,Te,be){if(!H){be&&be(!1),Xr(pG);return}var we=R(H[xl]);if(we&&!de){be&&be(!1),Xr("Plugin ["+H[xl]+"] is already loaded!");return}var L={reason:16};function le(Le){c[Wt](H),L.added=[H],re(L),be&&be(!0)}if(we){var he=[we.plugin],xe={reason:2,isAsync:!!Te};ge(he,xe,function(Le){Le?(L.removed=he,L.reason|=32,le(!0)):be&&be(!1)})}else le(!1)},x.evtNamespace=function(){return S},x[Ab]=Ce,x.getTraceCtx=function(H){return P||(P=Q4()),P},x.setTraceCtx=function(H){P=H||null},Jb(x,"addUnloadCb",function(){return _},"add");function A(){t=!1,e=qb(!0,{},afe),x[Oc]=e,x[Ns]=new Gb(e),x[Bw]=[],g=new aG,n=[],i=null,o=null,s=null,a=null,l=null,u=null,c=[],p=null,f=null,m=null,h=!1,v=null,S=$b("AIBaseCore",!0),_=S0(),P=null}function j(){return Ml(Z(),e,x)}function re(H){var de=cfe(x[Ns],ax,c);u=de[hn],l=null;var Te=de.all;if(m=Lc(nG(f,Te,x)),p){var be=Sa(Te,p);be!==-1&&Te[wf](be,1),be=Sa(u,p),be!==-1&&u[wf](be,1),p._setQueue(m)}else p=rG(m,x);Te[Wt](p),u[Wt](p),x[Bw]=y0(Te),p[wl](e,x,Te),v0(j(),Te),x[Bw]=Lc(y0(u||[])).slice(),H&&vr(H)}function R(H){var de,Te=null,be=null;return Ct(x[Bw],function(we){if(we[xl]===H&&we!==p&&we!==g)return be=we,-1}),!be&&p&&(be=p.getChannel(H)),be&&(Te=(de={plugin:be},de[Pd]=function(we){Rd(be)[Yw]=!we},de.isEnabled=function(){var we=Rd(be);return!we[Rs]&&!we[Yw]},de.remove=function(we,L){var le;we===void 0&&(we=!0);var he=[be],xe=(le={reason:1},le[Dl]=we,le);ge(he,xe,function(Le){Le&&re({reason:32,removed:he}),L&&L(Le)})},de)),Te}function Z(){if(!l){var H=(u||[]).slice();Sa(H,g)===-1&&H[Wt](g),l=Fc(y0(H),e,x)}return l}function ge(H,de,Te){if(H&&H[yt]>0){var be=Fc(H,e,x),we=Qb(be,x);we[jw](function(){var L=!1,le=[];Ct(c,function(xe,Le){dG(xe,H)?L=!0:le[Wt](xe)}),c=le;var he=[];f&&(Ct(f,function(xe,Le){var et=[];Ct(xe,function(N){dG(N,H)?L=!0:et[Wt](N)}),he[Wt](et)}),f=he),Te&&Te(L)}),we[qr](de)}else Te(!1)}function Ke(){var H=x[Ns]?x[Ns].queue:[];H&&(Ct(H,function(de){var Te,be=(Te={},Te[as]=v||"InternalMessageId: "+de[Mb],Te.iKey=Ea(e[JN]),Te.time=Vb(new Date),Te.baseType=a0.dataType,Te.baseData={message:de[xf]},Te);x.track(be)}),H[yt]=0)}function Ce(H,de,Te,be){return p?p[Ab](H,de,Te||6,be):(de&&de(!1),!0)}function ae(){var H=Ea(e.disableDbgExt);H===!0&&D&&(i[yg](D),D=null),i&&!D&&H!==!0&&(D=s4(e),i[vg](D))}function Nt(){var H=Ea(e.enablePerfMgr);!H&&s&&(s=null),H&&Hb(e,v2,lfe)}function Je(){var H=Hb(e,Kb,{});H.NotificationManager=i}function vr(H){var de=sx(Z(),x);(!x._updateHook||x._updateHook(de,H)!==!0)&&de[qr](H)}function Xr(H){var de=x[Ns];de?Al(de,2,73,H):ai(H)}})}return r.__ieDyn=1,r}()});function _0(r,e,t,n){Ct(r,function(i){if(i&&i[e])if(t)setTimeout(function(){return n(i)},0);else try{n(i)}catch(o){}})}var hG,gG=ee(()=>{d();mr();Mn();zn();Ei();hG=function(){function r(e){this.listeners=[];var t=!!(e||{}).perfEvtsSendAll;Be(r,this,function(n){n[vg]=function(i){n.listeners[Wt](i)},n[yg]=function(i){for(var o=Sa(n[_g],i);o>-1;)n.listeners[wf](o,1),o=Sa(n[_g],i)},n[Fb]=function(i){_0(n[_g],Fb,!0,function(o){o[Fb](i)})},n[Tf]=function(i,o){_0(n[_g],Tf,!0,function(s){s[Tf](i,o)})},n[Ub]=function(i,o){_0(n[_g],Ub,o,function(s){s[Ub](i,o)})},n[kf]=function(i){i&&(t||!i[Gw]())&&_0(n[_g],kf,!1,function(o){i[Dl]?setTimeout(function(){return o[kf](i)},0):o[kf](i)})}})}return r.__ieDyn=1,r}()});var lx,vG=ee(()=>{d();lr();mr();Mn();mG();xg();zn();Ei();gG();u0();lx=function(r){_n(e,r);function e(){var t=r.call(this)||this;return Be(e,t,function(n,i){n[wl]=function(a,l,c,u){i[wl](a,l,c||new Gb(a),u||new hG(a))},n.track=function(a){c0(n[Cg](),function(){return"AppInsightsCore:track"},function(){a===null&&(s(a),ai("Invalid telemetry item")),o(a),i.track(a)},function(){return{item:a}},!a.sync)};function o(a){cr(a[as])&&(s(a),ai("telemetry name required"))}function s(a){var l=n[Vw]();l&&l[Tf]([a],2)}}),t}return e.__ieDyn=1,e}(fG)});var Pe,Rr,Pg,Ol,yG,bG,E0,Z2,cx,C0,Xb,Ll,Mf,Ad,ux,IG,dfe,eW,SG=ee(()=>{d();zq();Rr="Failed",Pg=Rr+"MonitorAjax",Ol="Track",yG="Start",bG="Stop",E0="Event",Z2="AuthContext",cx="Exception",C0="Local",Xb="Session",Ll="Storage",Mf="Browser",Ad="Cannot",ux="Buffer",IG="InstrumentationKey",dfe=R2({CRITICAL:1,WARNING:2}),eW=R2((Pe={},Pe[Mf+"DoesNotSupport"+C0+Ll]=0,Pe[Mf+Ad+"Read"+C0+Ll]=1,Pe[Mf+Ad+"Read"+Xb+Ll]=2,Pe[Mf+Ad+"Write"+C0+Ll]=3,Pe[Mf+Ad+"Write"+Xb+Ll]=4,Pe[Mf+Rr+"RemovalFrom"+C0+Ll]=5,Pe[Mf+Rr+"RemovalFrom"+Xb+Ll]=6,Pe[Ad+"SendEmptyTelemetry"]=7,Pe.ClientPerformanceMathError=8,Pe["ErrorParsingAI"+Xb+"Cookie"]=9,Pe.ErrorPVCalc=10,Pe[cx+"WhileLoggingError"]=11,Pe[Rr+"AddingTelemetryTo"+ux]=12,Pe[Pg+"Abort"]=13,Pe[Pg+"Dur"]=14,Pe[Pg+"Open"]=15,Pe[Pg+"RSC"]=16,Pe[Pg+"Send"]=17,Pe[Pg+"GetCorrelationHeader"]=18,Pe[Rr+"ToAddHandlerForOnBeforeUnload"]=19,Pe[Rr+"ToSendQueuedTelemetry"]=20,Pe[Rr+"ToReportDataLoss"]=21,Pe["Flush"+Rr]=22,Pe.MessageLimitPerPVExceeded=23,Pe.MissingRequiredFieldSpecification=24,Pe.NavigationTimingNotSupported=25,Pe.OnError=26,Pe[Xb+"RenewalDateIsZero"]=27,Pe.SenderNotInitialized=28,Pe[yG+Ol+E0+Rr]=29,Pe[bG+Ol+E0+Rr]=30,Pe[yG+Ol+Rr]=31,Pe[bG+Ol+Rr]=32,Pe.TelemetrySampledAndNotSent=33,Pe[Ol+E0+Rr]=34,Pe[Ol+cx+Rr]=35,Pe[Ol+"Metric"+Rr]=36,Pe[Ol+"PV"+Rr]=37,Pe[Ol+"PV"+Rr+"Calc"]=38,Pe[Ol+"Trace"+Rr]=39,Pe["Transmission"+Rr]=40,Pe[Rr+"ToSet"+Ll+ux]=41,Pe[Rr+"ToRestore"+Ll+ux]=42,Pe.InvalidBackendResponse=43,Pe[Rr+"ToFixDepricatedValues"]=44,Pe.InvalidDurationValue=45,Pe.TelemetryEnvelopeInvalid=46,Pe.CreateEnvelopeError=47,Pe[Ad+"SerializeObject"]=48,Pe[Ad+"SerializeObjectNonSerializable"]=49,Pe.CircularReferenceDetected=50,Pe["Clear"+Z2+Rr]=51,Pe[cx+"Truncated"]=52,Pe.IllegalCharsInName=53,Pe.ItemNotInArray=54,Pe.MaxAjaxPerPVExceeded=55,Pe.MessageTruncated=56,Pe.NameTooLong=57,Pe.SampleRateOutOfRange=58,Pe["Set"+Z2+Rr]=59,Pe["Set"+Z2+Rr+"AccountName"]=60,Pe.StringValueTooLong=61,Pe.StartCalledMoreThanOnce=62,Pe.StopCalledWithoutStart=63,Pe["TelemetryInitializer"+Rr]=64,Pe.TrackArgumentsNotSpecified=65,Pe.UrlTooLong=66,Pe[Xb+Ll+ux+"Full"]=67,Pe[Ad+"AccessCookie"]=68,Pe.IdTooLong=69,Pe.InvalidEvent=70,Pe[Pg+"SetRequestHeader"]=71,Pe["Send"+Mf+"InfoOnUserInit"]=72,Pe["Plugin"+cx]=73,Pe["Notification"+cx]=74,Pe.SnippetScriptLoadFailure=99,Pe["Invalid"+IG]=100,Pe[Ad+"ParseAiBlobValue"]=101,Pe.InvalidContentBlob=102,Pe[Ol+"PageAction"+E0+Rr]=103,Pe[Rr+"AddingCustomDefinedRequestContext"]=104,Pe["InMemory"+Ll+ux+"Full"]=105,Pe[IG+"Deprecation"]=106,Pe))});var tW=ee(()=>{d();vG();q4();zn();SG()});var w0,x0,dx,_G=ee(()=>{d();w0="instrumentationKey",x0="connectionString",dx="diagnosticLogInterval"});var EG={};Um(EG,{AppInsightsCore:()=>lx,ApplicationInsights:()=>pfe,CoreUtils:()=>ox,Sender:()=>Ww,SeverityLevel:()=>fU,_InternalMessageId:()=>eW,arrForEach:()=>Ct,isNullOrUndefined:()=>cr,proxyFunctions:()=>Nd,throwError:()=>ai});var pfe,CG=ee(()=>{d();mr();p2();lf();tW();_G();tW();lf();p2();pfe=function(){function r(e){var t=new lx;(cr(e)||cr(e[w0])&&cr(e[x0]))&&ai("Invalid input configuration"),Be(r,this,function(n){if(e[x0]){var i=sU(e[x0]),o=i.ingestionendpoint;e.endpointUrl=o?o+pd:e.endpointUrl,e[w0]=i.instrumentationkey||e[w0]}n.config=e,s(),n.initialize=s,n.getSKUDefaults=function(){n.config[dx]=n.config[dx]&&n.config[dx]>0?n.config[dx]:1e4},n.getSKUDefaults(),Nd(n,t,["track","flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb"]);function s(){t.initialize(n.config,[new Ww]),t.pollInternalLogs()}})}return r.__ieDyn=1,r}()});var xG={};Um(xG,{default:()=>D0});function mfe(r){if(r.userAgentData){let e=r.userAgentData.brands[r.userAgentData.brands.length-1];return`${r.userAgentData.platform} - ${e==null?void 0:e.brand} v${e==null?void 0:e.version}}`}else return r.appVersion}var wG,ffe,D0,DG=ee(()=>{d();wG=$(require("vscode"));$6();z6();Q6();X6();ffe=async(r,e)=>{let t;try{let i=await Promise.resolve().then(()=>(CG(),EG));t=new i.ApplicationInsights({instrumentationKey:r,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0})}catch(i){return Promise.reject(i)}return{logEvent:(i,o)=>{let s={...o==null?void 0:o.properties,...o==null?void 0:o.measurements};e!=null&&e.length&&ab.applyReplacements(s,e),t==null||t.track({name:i,data:s})},flush:async()=>{t==null||t.flush()}}};D0=class extends Mk{constructor(e,t){let n=s=>ffe(s,t);ab.shouldUseOneDataSystemSDK(e)&&(n=s=>Y6(s,wG));let i={release:mfe(navigator),platform:"web",architecture:"web"},o=new Ak(e,n);if(e&&e.indexOf("AIF")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(o,wG,{additionalCommonProperties:ab.getAdditionalCommonProperties(i)})}}});var EW=z((ht,$G)=>{d();ht=$G.exports=er;var Pr;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?Pr=function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:Pr=function(){};ht.SEMVER_SPEC_VERSION="2.0.0";var px=256,M0=Number.MAX_SAFE_INTEGER||9007199254740991,oW=16,yge=px-6,fx=ht.re=[],Gr=ht.safeRe=[],Se=ht.src=[],zt=0,uW="[a-zA-Z0-9-]",sW=[["\\s",1],["\\d",px],[uW,yge]];function W0(r){for(var e=0;e<sW.length;e++){var t=sW[e][0],n=sW[e][1];r=r.split(t+"*").join(t+"{0,"+n+"}").split(t+"+").join(t+"{1,"+n+"}")}return r}var rI=zt++;Se[rI]="0|[1-9]\\d*";var nI=zt++;Se[nI]="\\d+";var dW=zt++;Se[dW]="\\d*[a-zA-Z-]"+uW+"*";var OG=zt++;Se[OG]="("+Se[rI]+")\\.("+Se[rI]+")\\.("+Se[rI]+")";var LG=zt++;Se[LG]="("+Se[nI]+")\\.("+Se[nI]+")\\.("+Se[nI]+")";var aW=zt++;Se[aW]="(?:"+Se[rI]+"|"+Se[dW]+")";var lW=zt++;Se[lW]="(?:"+Se[nI]+"|"+Se[dW]+")";var pW=zt++;Se[pW]="(?:-("+Se[aW]+"(?:\\."+Se[aW]+")*))";var fW=zt++;Se[fW]="(?:-?("+Se[lW]+"(?:\\."+Se[lW]+")*))";var cW=zt++;Se[cW]=uW+"+";var hx=zt++;Se[hx]="(?:\\+("+Se[cW]+"(?:\\."+Se[cW]+")*))";var mW=zt++,KG="v?"+Se[OG]+Se[pW]+"?"+Se[hx]+"?";Se[mW]="^"+KG+"$";var hW="[v=\\s]*"+Se[LG]+Se[fW]+"?"+Se[hx]+"?",gW=zt++;Se[gW]="^"+hW+"$";var lI=zt++;Se[lI]="((?:<|>)?=?)";var O0=zt++;Se[O0]=Se[nI]+"|x|X|\\*";var L0=zt++;Se[L0]=Se[rI]+"|x|X|\\*";var kg=zt++;Se[kg]="[v=\\s]*("+Se[L0]+")(?:\\.("+Se[L0]+")(?:\\.("+Se[L0]+")(?:"+Se[pW]+")?"+Se[hx]+"?)?)?";var oI=zt++;Se[oI]="[v=\\s]*("+Se[O0]+")(?:\\.("+Se[O0]+")(?:\\.("+Se[O0]+")(?:"+Se[fW]+")?"+Se[hx]+"?)?)?";var FG=zt++;Se[FG]="^"+Se[lI]+"\\s*"+Se[kg]+"$";var UG=zt++;Se[UG]="^"+Se[lI]+"\\s*"+Se[oI]+"$";var WG=zt++;Se[WG]="(?:^|[^\\d])(\\d{1,"+oW+"})(?:\\.(\\d{1,"+oW+"}))?(?:\\.(\\d{1,"+oW+"}))?(?:$|[^\\d])";var V0=zt++;Se[V0]="(?:~>?)";var sI=zt++;Se[sI]="(\\s*)"+Se[V0]+"\\s+";fx[sI]=new RegExp(Se[sI],"g");Gr[sI]=new RegExp(W0(Se[sI]),"g");var bge="$1~",VG=zt++;Se[VG]="^"+Se[V0]+Se[kg]+"$";var jG=zt++;Se[jG]="^"+Se[V0]+Se[oI]+"$";var j0=zt++;Se[j0]="(?:\\^)";var aI=zt++;Se[aI]="(\\s*)"+Se[j0]+"\\s+";fx[aI]=new RegExp(Se[aI],"g");Gr[aI]=new RegExp(W0(Se[aI]),"g");var Ige="$1^",BG=zt++;Se[BG]="^"+Se[j0]+Se[kg]+"$";var HG=zt++;Se[HG]="^"+Se[j0]+Se[oI]+"$";var vW=zt++;Se[vW]="^"+Se[lI]+"\\s*("+hW+")$|^$";var yW=zt++;Se[yW]="^"+Se[lI]+"\\s*("+KG+")$|^$";var Ng=zt++;Se[Ng]="(\\s*)"+Se[lI]+"\\s*("+hW+"|"+Se[kg]+")";fx[Ng]=new RegExp(Se[Ng],"g");Gr[Ng]=new RegExp(W0(Se[Ng]),"g");var Sge="$1$2$3",JG=zt++;Se[JG]="^\\s*("+Se[kg]+")\\s+-\\s+("+Se[kg]+")\\s*$";var qG=zt++;Se[qG]="^\\s*("+Se[oI]+")\\s+-\\s+("+Se[oI]+")\\s*$";var GG=zt++;Se[GG]="(<|>)?=?\\s*\\*";for(Wc=0;Wc<zt;Wc++)Pr(Wc,Se[Wc]),fx[Wc]||(fx[Wc]=new RegExp(Se[Wc]),Gr[Wc]=new RegExp(W0(Se[Wc])));var Wc;ht.parse=Rg;function Rg(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof er)return r;if(typeof r!="string"||r.length>px)return null;var t=e.loose?Gr[gW]:Gr[mW];if(!t.test(r))return null;try{return new er(r,e)}catch(n){return null}}ht.valid=_ge;function _ge(r,e){var t=Rg(r,e);return t?t.version:null}ht.clean=Ege;function Ege(r,e){var t=Rg(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null}ht.SemVer=er;function er(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof er){if(r.loose===e.loose)return r;r=r.version}else if(typeof r!="string")throw new TypeError("Invalid Version: "+r);if(r.length>px)throw new TypeError("version is longer than "+px+" characters");if(!(this instanceof er))return new er(r,e);Pr("SemVer",r,e),this.options=e,this.loose=!!e.loose;var t=r.trim().match(e.loose?Gr[gW]:Gr[mW]);if(!t)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>M0||this.major<0)throw new TypeError("Invalid major version");if(this.minor>M0||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>M0||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var i=+n;if(i>=0&&i<M0)return i}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}er.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};er.prototype.toString=function(){return this.version};er.prototype.compare=function(r){return Pr("SemVer.compare",this.version,this.options,r),r instanceof er||(r=new er(r,this.options)),this.compareMain(r)||this.comparePre(r)};er.prototype.compareMain=function(r){return r instanceof er||(r=new er(r,this.options)),iI(this.major,r.major)||iI(this.minor,r.minor)||iI(this.patch,r.patch)};er.prototype.comparePre=function(r){if(r instanceof er||(r=new er(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var t=this.prerelease[e],n=r.prerelease[e];if(Pr("prerelease compare",e,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return iI(t,n)}while(++e)};er.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)typeof this.prerelease[t]=="number"&&(this.prerelease[t]++,t=-2);t===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this};ht.inc=Cge;function Cge(r,e,t,n){typeof t=="string"&&(n=t,t=void 0);try{return new er(r,t).inc(e,n).version}catch(i){return null}}ht.diff=wge;function wge(r,e){if(bW(r,e))return null;var t=Rg(r),n=Rg(e),i="";if(t.prerelease.length||n.prerelease.length){i="pre";var o="prerelease"}for(var s in t)if((s==="major"||s==="minor"||s==="patch")&&t[s]!==n[s])return i+s;return o}ht.compareIdentifiers=iI;var MG=/^[0-9]+$/;function iI(r,e){var t=MG.test(r),n=MG.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1}ht.rcompareIdentifiers=xge;function xge(r,e){return iI(e,r)}ht.major=Dge;function Dge(r,e){return new er(r,e).major}ht.minor=Pge;function Pge(r,e){return new er(r,e).minor}ht.patch=Tge;function Tge(r,e){return new er(r,e).patch}ht.compare=Od;function Od(r,e,t){return new er(r,t).compare(new er(e,t))}ht.compareLoose=kge;function kge(r,e){return Od(r,e,!0)}ht.rcompare=Nge;function Nge(r,e,t){return Od(e,r,t)}ht.sort=Rge;function Rge(r,e){return r.sort(function(t,n){return ht.compare(t,n,e)})}ht.rsort=Age;function Age(r,e){return r.sort(function(t,n){return ht.rcompare(t,n,e)})}ht.gt=mx;function mx(r,e,t){return Od(r,e,t)>0}ht.lt=K0;function K0(r,e,t){return Od(r,e,t)<0}ht.eq=bW;function bW(r,e,t){return Od(r,e,t)===0}ht.neq=YG;function YG(r,e,t){return Od(r,e,t)!==0}ht.gte=IW;function IW(r,e,t){return Od(r,e,t)>=0}ht.lte=SW;function SW(r,e,t){return Od(r,e,t)<=0}ht.cmp=F0;function F0(r,e,t,n){switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return bW(r,t,n);case"!=":return YG(r,t,n);case">":return mx(r,t,n);case">=":return IW(r,t,n);case"<":return K0(r,t,n);case"<=":return SW(r,t,n);default:throw new TypeError("Invalid operator: "+e)}}ht.Comparator=wa;function wa(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof wa){if(r.loose===!!e.loose)return r;r=r.value}if(!(this instanceof wa))return new wa(r,e);r=r.trim().split(/\s+/).join(" "),Pr("comparator",r,e),this.options=e,this.loose=!!e.loose,this.parse(r),this.semver===gx?this.value="":this.value=this.operator+this.semver.version,Pr("comp",this)}var gx={};wa.prototype.parse=function(r){var e=this.options.loose?Gr[vW]:Gr[yW],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],this.operator==="="&&(this.operator=""),t[2]?this.semver=new er(t[2],this.options.loose):this.semver=gx};wa.prototype.toString=function(){return this.value};wa.prototype.test=function(r){return Pr("Comparator.test",r,this.options.loose),this.semver===gx?!0:(typeof r=="string"&&(r=new er(r,this.options)),F0(r,this.operator,this.semver,this.options))};wa.prototype.intersects=function(r,e){if(!(r instanceof wa))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var t;if(this.operator==="")return t=new gn(r.value,e),U0(this.value,t,e);if(r.operator==="")return t=new gn(this.value,e),U0(r.semver,t,e);var n=(this.operator===">="||this.operator===">")&&(r.operator===">="||r.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(r.operator==="<="||r.operator==="<"),o=this.semver.version===r.semver.version,s=(this.operator===">="||this.operator==="<=")&&(r.operator===">="||r.operator==="<="),a=F0(this.semver,"<",r.semver,e)&&(this.operator===">="||this.operator===">")&&(r.operator==="<="||r.operator==="<"),l=F0(this.semver,">",r.semver,e)&&(this.operator==="<="||this.operator==="<")&&(r.operator===">="||r.operator===">");return n||i||o&&s||a||l};ht.Range=gn;function gn(r,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),r instanceof gn)return r.loose===!!e.loose&&r.includePrerelease===!!e.includePrerelease?r:new gn(r.raw,e);if(r instanceof wa)return new gn(r.value,e);if(!(this instanceof gn))return new gn(r,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=r.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}gn.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range};gn.prototype.toString=function(){return this.range};gn.prototype.parseRange=function(r){var e=this.options.loose,t=e?Gr[qG]:Gr[JG];r=r.replace(t,Bge),Pr("hyphen replace",r),r=r.replace(Gr[Ng],Sge),Pr("comparator trim",r,Gr[Ng]),r=r.replace(Gr[sI],bge),r=r.replace(Gr[aI],Ige);var n=e?Gr[vW]:Gr[yW],i=r.split(" ").map(function(o){return Oge(o,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(i=i.filter(function(o){return!!o.match(n)})),i=i.map(function(o){return new wa(o,this.options)},this),i};gn.prototype.intersects=function(r,e){if(!(r instanceof gn))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(n){return r.set.some(function(i){return i.every(function(o){return n.intersects(o,e)})})})})};ht.toComparators=Mge;function Mge(r,e){return new gn(r,e).set.map(function(t){return t.map(function(n){return n.value}).join(" ").trim().split(" ")})}function Oge(r,e){return Pr("comp",r,e),r=Fge(r,e),Pr("caret",r),r=Lge(r,e),Pr("tildes",r),r=Wge(r,e),Pr("xrange",r),r=jge(r,e),Pr("stars",r),r}function Ao(r){return!r||r.toLowerCase()==="x"||r==="*"}function Lge(r,e){return r.trim().split(/\s+/).map(function(t){return Kge(t,e)}).join(" ")}function Kge(r,e){var t=e.loose?Gr[jG]:Gr[VG];return r.replace(t,function(n,i,o,s,a){Pr("tilde",r,n,i,o,s,a);var l;return Ao(i)?l="":Ao(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ao(s)?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":a?(Pr("replaceTilde pr",a),l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0"):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0",Pr("tilde return",l),l})}function Fge(r,e){return r.trim().split(/\s+/).map(function(t){return Uge(t,e)}).join(" ")}function Uge(r,e){Pr("caret",r,e);var t=e.loose?Gr[HG]:Gr[BG];return r.replace(t,function(n,i,o,s,a){Pr("caret",r,n,i,o,s,a);var l;return Ao(i)?l="":Ao(o)?l=">="+i+".0.0 <"+(+i+1)+".0.0":Ao(s)?i==="0"?l=">="+i+"."+o+".0 <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+".0 <"+(+i+1)+".0.0":a?(Pr("replaceCaret pr",a),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+"-"+a+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+"-"+a+" <"+(+i+1)+".0.0"):(Pr("no pr"),i==="0"?o==="0"?l=">="+i+"."+o+"."+s+" <"+i+"."+o+"."+(+s+1):l=">="+i+"."+o+"."+s+" <"+i+"."+(+o+1)+".0":l=">="+i+"."+o+"."+s+" <"+(+i+1)+".0.0"),Pr("caret return",l),l})}function Wge(r,e){return Pr("replaceXRanges",r,e),r.split(/\s+/).map(function(t){return Vge(t,e)}).join(" ")}function Vge(r,e){r=r.trim();var t=e.loose?Gr[UG]:Gr[FG];return r.replace(t,function(n,i,o,s,a,l){Pr("xRange",r,n,i,o,s,a,l);var c=Ao(o),u=c||Ao(s),p=u||Ao(a),f=p;return i==="="&&f&&(i=""),c?i===">"||i==="<"?n="<0.0.0":n="*":i&&f?(u&&(s=0),a=0,i===">"?(i=">=",u?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",u?o=+o+1:s=+s+1),n=i+o+"."+s+"."+a):u?n=">="+o+".0.0 <"+(+o+1)+".0.0":p&&(n=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0"),Pr("xRange return",n),n})}function jge(r,e){return Pr("replaceStars",r,e),r.trim().replace(Gr[GG],"")}function Bge(r,e,t,n,i,o,s,a,l,c,u,p,f){return Ao(t)?e="":Ao(n)?e=">="+t+".0.0":Ao(i)?e=">="+t+"."+n+".0":e=">="+e,Ao(l)?a="":Ao(c)?a="<"+(+l+1)+".0.0":Ao(u)?a="<"+l+"."+(+c+1)+".0":p?a="<="+l+"."+c+"."+u+"-"+p:a="<="+a,(e+" "+a).trim()}gn.prototype.test=function(r){if(!r)return!1;typeof r=="string"&&(r=new er(r,this.options));for(var e=0;e<this.set.length;e++)if(Hge(this.set[e],r,this.options))return!0;return!1};function Hge(r,e,t){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(n=0;n<r.length;n++)if(Pr(r[n].semver),r[n].semver!==gx&&r[n].semver.prerelease.length>0){var i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}ht.satisfies=U0;function U0(r,e,t){try{e=new gn(e,t)}catch(n){return!1}return e.test(r)}ht.maxSatisfying=Jge;function Jge(r,e,t){var n=null,i=null;try{var o=new gn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===-1)&&(n=s,i=new er(n,t))}),n}ht.minSatisfying=qge;function qge(r,e,t){var n=null,i=null;try{var o=new gn(e,t)}catch(s){return null}return r.forEach(function(s){o.test(s)&&(!n||i.compare(s)===1)&&(n=s,i=new er(n,t))}),n}ht.minVersion=Gge;function Gge(r,e){r=new gn(r,e);var t=new er("0.0.0");if(r.test(t)||(t=new er("0.0.0-0"),r.test(t)))return t;t=null;for(var n=0;n<r.set.length;++n){var i=r.set[n];i.forEach(function(o){var s=new er(o.semver.version);switch(o.operator){case">":s.prerelease.length===0?s.patch++:s.prerelease.push(0),s.raw=s.format();case"":case">=":(!t||mx(t,s))&&(t=s);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+o.operator)}})}return t&&r.test(t)?t:null}ht.validRange=Yge;function Yge(r,e){try{return new gn(r,e).range||"*"}catch(t){return null}}ht.ltr=$ge;function $ge(r,e,t){return _W(r,e,"<",t)}ht.gtr=zge;function zge(r,e,t){return _W(r,e,">",t)}ht.outside=_W;function _W(r,e,t,n){r=new er(r,n),e=new gn(e,n);var i,o,s,a,l;switch(t){case">":i=mx,o=SW,s=K0,a=">",l=">=";break;case"<":i=K0,o=IW,s=mx,a="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(U0(r,e,n))return!1;for(var c=0;c<e.set.length;++c){var u=e.set[c],p=null,f=null;if(u.forEach(function(m){m.semver===gx&&(m=new wa(">=0.0.0")),p=p||m,f=f||m,i(m.semver,p.semver,n)?p=m:s(m.semver,f.semver,n)&&(f=m)}),p.operator===a||p.operator===l||(!f.operator||f.operator===a)&&o(r,f.semver))return!1;if(f.operator===l&&s(r,f.semver))return!1}return!0}ht.prerelease=Qge;function Qge(r,e){var t=Rg(r,e);return t&&t.prerelease.length?t.prerelease:null}ht.intersects=Xge;function Xge(r,e,t){return r=new gn(r,t),e=new gn(e,t),r.intersects(e)}ht.coerce=Zge;function Zge(r){if(r instanceof er)return r;if(typeof r!="string")return null;var e=r.match(Gr[WG]);return e==null?null:Rg(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var Ug=z((Q0,mY)=>{d();(function(r,e){typeof Q0=="object"&&typeof mY!="undefined"?e(Q0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_algorithm={}))})(Q0,function(r){"use strict";r.ArrayExt=void 0,function(N){function W(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var Ne;U<K?Ne=U+1+(ne-K):Ne=U-K+1;for(var Oe=0;Oe<Ne;++Oe){var Kt=(K+Oe)%ne;if(q[Kt]===se)return Kt}return-1}N.firstIndexOf=W;function pe(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var Ne;K<U?Ne=K+1+(ne-U):Ne=K-U+1;for(var Oe=0;Oe<Ne;++Oe){var Kt=(K-Oe+ne)%ne;if(q[Kt]===se)return Kt}return-1}N.lastIndexOf=pe;function _e(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var Ne;U<K?Ne=U+1+(ne-K):Ne=U-K+1;for(var Oe=0;Oe<Ne;++Oe){var Kt=(K+Oe)%ne;if(se(q[Kt],Kt))return Kt}return-1}N.findFirstIndex=_e;function Ae(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=q.length;if(ne===0)return-1;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var Ne;K<U?Ne=K+1+(ne-U):Ne=K-U+1;for(var Oe=0;Oe<Ne;++Oe){var Kt=(K-Oe+ne)%ne;if(se(q[Kt],Kt))return Kt}return-1}N.findLastIndex=Ae;function Yt(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=_e(q,se,K,U);return ne!==-1?q[ne]:void 0}N.findFirstValue=Yt;function ze(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=Ae(q,se,K,U);return ne!==-1?q[ne]:void 0}N.findLastValue=ze;function bt(q,se,K,U,ne){U===void 0&&(U=0),ne===void 0&&(ne=-1);var Ne=q.length;if(Ne===0)return 0;U<0?U=Math.max(0,U+Ne):U=Math.min(U,Ne-1),ne<0?ne=Math.max(0,ne+Ne):ne=Math.min(ne,Ne-1);for(var Oe=U,Kt=ne-U+1;Kt>0;){var mi=Kt>>1,Lu=Oe+mi;K(q[Lu],se)<0?(Oe=Lu+1,Kt-=mi+1):Kt=mi}return Oe}N.lowerBound=bt;function Xt(q,se,K,U,ne){U===void 0&&(U=0),ne===void 0&&(ne=-1);var Ne=q.length;if(Ne===0)return 0;U<0?U=Math.max(0,U+Ne):U=Math.min(U,Ne-1),ne<0?ne=Math.max(0,ne+Ne):ne=Math.min(ne,Ne-1);for(var Oe=U,Kt=ne-U+1;Kt>0;){var mi=Kt>>1,Lu=Oe+mi;K(q[Lu],se)>0?Kt=mi:(Oe=Lu+1,Kt-=mi+1)}return Oe}N.upperBound=Xt;function Lt(q,se,K){if(q===se)return!0;if(q.length!==se.length)return!1;for(var U=0,ne=q.length;U<ne;++U)if(K?!K(q[U],se[U]):q[U]!==se[U])return!1;return!0}N.shallowEqual=Lt;function Tr(q,se){se===void 0&&(se={});var K=se.start,U=se.stop,ne=se.step;if(ne===void 0&&(ne=1),ne===0)throw new Error("Slice `step` cannot be zero.");var Ne=q.length;K===void 0?K=ne<0?Ne-1:0:K<0?K=Math.max(K+Ne,ne<0?-1:0):K>=Ne&&(K=ne<0?Ne-1:Ne),U===void 0?U=ne<0?-1:Ne:U<0?U=Math.max(U+Ne,ne<0?-1:0):U>=Ne&&(U=ne<0?Ne-1:Ne);var Oe;ne<0&&U>=K||ne>0&&K>=U?Oe=0:ne<0?Oe=Math.floor((U-K+1)/ne+1):Oe=Math.floor((U-K-1)/ne+1);for(var Kt=[],mi=0;mi<Oe;++mi)Kt[mi]=q[K+mi*ne];return Kt}N.slice=Tr;function F(q,se,K){var U=q.length;if(!(U<=1)&&(se<0?se=Math.max(0,se+U):se=Math.min(se,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1),se!==K)){for(var ne=q[se],Ne=se<K?1:-1,Oe=se;Oe!==K;Oe+=Ne)q[Oe]=q[Oe+Ne];q[K]=ne}}N.move=F;function ue(q,se,K){se===void 0&&(se=0),K===void 0&&(K=-1);var U=q.length;if(!(U<=1))for(se<0?se=Math.max(0,se+U):se=Math.min(se,U-1),K<0?K=Math.max(0,K+U):K=Math.min(K,U-1);se<K;){var ne=q[se],Ne=q[K];q[se++]=Ne,q[K--]=ne}}N.reverse=ue;function k(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(!(ne<=1)&&(K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1),!(K>=U))){var Ne=U-K+1;if(se>0?se=se%Ne:se<0&&(se=(se%Ne+Ne)%Ne),se!==0){var Oe=K+se;ue(q,K,Oe-1),ue(q,Oe,U),ue(q,K,U)}}}N.rotate=k;function O(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne!==0){K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);var Ne;U<K?Ne=U+1+(ne-K):Ne=U-K+1;for(var Oe=0;Oe<Ne;++Oe)q[(K+Oe)%ne]=se}}N.fill=O;function X(q,se,K){var U=q.length;se<0?se=Math.max(0,se+U):se=Math.min(se,U);for(var ne=U;ne>se;--ne)q[ne]=q[ne-1];q[se]=K}N.insert=X;function ce(q,se){var K=q.length;if(se<0&&(se+=K),!(se<0||se>=K)){for(var U=q[se],ne=se+1;ne<K;++ne)q[ne-1]=q[ne];return q.length=K-1,U}}N.removeAt=ce;function ve(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=W(q,se,K,U);return ne!==-1&&ce(q,ne),ne}N.removeFirstOf=ve;function V(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne=pe(q,se,K,U);return ne!==-1&&ce(q,ne),ne}N.removeLastOf=V;function G(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return 0;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);for(var Ne=0,Oe=0;Oe<ne;++Oe)K<=U&&Oe>=K&&Oe<=U&&q[Oe]===se||U<K&&(Oe<=U||Oe>=K)&&q[Oe]===se?Ne++:Ne>0&&(q[Oe-Ne]=q[Oe]);return Ne>0&&(q.length=ne-Ne),Ne}N.removeAllOf=G;function Y(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne,Ne=_e(q,se,K,U);return Ne!==-1&&(ne=ce(q,Ne)),{index:Ne,value:ne}}N.removeFirstWhere=Y;function oe(q,se,K,U){K===void 0&&(K=-1),U===void 0&&(U=0);var ne,Ne=Ae(q,se,K,U);return Ne!==-1&&(ne=ce(q,Ne)),{index:Ne,value:ne}}N.removeLastWhere=oe;function Ie(q,se,K,U){K===void 0&&(K=0),U===void 0&&(U=-1);var ne=q.length;if(ne===0)return 0;K<0?K=Math.max(0,K+ne):K=Math.min(K,ne-1),U<0?U=Math.max(0,U+ne):U=Math.min(U,ne-1);for(var Ne=0,Oe=0;Oe<ne;++Oe)K<=U&&Oe>=K&&Oe<=U&&se(q[Oe],Oe)||U<K&&(Oe<=U||Oe>=K)&&se(q[Oe],Oe)?Ne++:Ne>0&&(q[Oe-Ne]=q[Oe]);return Ne>0&&(q.length=ne-Ne),Ne}N.removeAllWhere=Ie}(r.ArrayExt||(r.ArrayExt={}));function e(N){var W;return typeof N.iter=="function"?W=N.iter():W=new p(N),W}function t(N){return new f(N)}function n(N){return new m(N)}function i(N){return new h(N)}function o(N){return new g(N)}function s(N,W){for(var pe=0,_e=e(N),Ae;(Ae=_e.next())!==void 0;)if(W(Ae,pe++)===!1)return}function a(N,W){for(var pe=0,_e=e(N),Ae;(Ae=_e.next())!==void 0;)if(!W(Ae,pe++))return!1;return!0}function l(N,W){for(var pe=0,_e=e(N),Ae;(Ae=_e.next())!==void 0;)if(W(Ae,pe++))return!0;return!1}function c(N){for(var W=0,pe=[],_e=e(N),Ae;(Ae=_e.next())!==void 0;)pe[W++]=Ae;return pe}function u(N){for(var W=e(N),pe,_e={};(pe=W.next())!==void 0;)_e[pe[0]]=pe[1];return _e}var p=function(){function N(W){this._index=0,this._source=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._source.length))return this._source[this._index++]},N}(),f=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?W:this.next()}},N}(),m=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?this._source[W]:this.next()}},N}(),h=function(){function N(W,pe){pe===void 0&&(pe=Object.keys(W)),this._index=0,this._source=W,this._keys=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source,this._keys);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._keys.length)){var W=this._keys[this._index++];return W in this._source?[W,this._source[W]]:this.next()}},N}(),g=function(){function N(W){this._fn=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){throw new Error("An `FnIterator` cannot be cloned.")},N.prototype.next=function(){return this._fn.call(void 0)},N}();function v(){for(var N=[],W=0;W<arguments.length;W++)N[W]=arguments[W];return new S(e(N.map(e)))}var S=function(){function N(W){this._cloned=!1,this._source=W,this._active=void 0}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone());return W._active=this._active&&this._active.clone(),W._cloned=!0,this._cloned=!0,W},N.prototype.next=function(){if(this._active===void 0){var W=this._source.next();if(W===void 0)return;this._active=this._cloned?W.clone():W}var pe=this._active.next();return pe!==void 0?pe:(this._active=void 0,this.next())},N}();function _(){return new D}var D=function(){function N(){}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N},N.prototype.next=function(){},N}();function P(N,W){return W===void 0&&(W=0),new M(e(N),W)}var M=function(){function N(W,pe){this._source=W,this._index=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._index)},N.prototype.next=function(){var W=this._source.next();if(W!==void 0)return[this._index++,W]},N}();function x(N,W){return new A(e(N),W)}var A=function(){function N(W,pe){this._index=0,this._source=W,this._fn=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone(),this._fn);return W._index=this._index,W},N.prototype.next=function(){for(var W=this._fn,pe=this._source,_e;(_e=pe.next())!==void 0;)if(W(_e,this._index++))return _e},N}();function j(N,W){for(var pe=0,_e=e(N),Ae;(Ae=_e.next())!==void 0;)if(W(Ae,pe++))return Ae}function re(N,W){for(var pe=0,_e=e(N),Ae;(Ae=_e.next())!==void 0;)if(W(Ae,pe++))return pe-1;return-1}function R(N,W){var pe=e(N),_e=pe.next();if(_e!==void 0){for(var Ae=_e;(_e=pe.next())!==void 0;)W(_e,Ae)<0&&(Ae=_e);return Ae}}function Z(N,W){var pe=e(N),_e=pe.next();if(_e!==void 0){for(var Ae=_e;(_e=pe.next())!==void 0;)W(_e,Ae)>0&&(Ae=_e);return Ae}}function ge(N,W){var pe=e(N),_e=pe.next();if(_e!==void 0){for(var Ae=_e,Yt=_e;(_e=pe.next())!==void 0;)W(_e,Ae)<0?Ae=_e:W(_e,Yt)>0&&(Yt=_e);return[Ae,Yt]}}function Ke(N,W){return new Ce(e(N),W)}var Ce=function(){function N(W,pe){this._index=0,this._source=W,this._fn=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source.clone(),this._fn);return W._index=this._index,W},N.prototype.next=function(){var W=this._source.next();if(W!==void 0)return this._fn.call(void 0,W,this._index++)},N}();function ae(N,W,pe){return W===void 0?new Nt(0,N,1):pe===void 0?new Nt(N,W,1):new Nt(N,W,pe)}var Nt=function(){function N(W,pe,_e){this._index=0,this._start=W,this._stop=pe,this._step=_e,this._length=Je.rangeLength(W,pe,_e)}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._start,this._stop,this._step);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index>=this._length))return this._start+this._step*this._index++},N}(),Je;(function(N){function W(pe,_e,Ae){return Ae===0?1/0:pe>_e&&Ae>0||pe<_e&&Ae<0?0:Math.ceil((_e-pe)/Ae)}N.rangeLength=W})(Je||(Je={}));function vr(N,W,pe){var _e=0,Ae=e(N),Yt=Ae.next();if(Yt===void 0&&pe===void 0)throw new TypeError("Reduce of empty iterable with no initial value.");if(Yt===void 0)return pe;var ze=Ae.next();if(ze===void 0&&pe===void 0)return Yt;if(ze===void 0)return W(pe,Yt,_e++);var bt;pe===void 0?bt=W(Yt,ze,_e++):bt=W(W(pe,Yt,_e++),ze,_e++);for(var Xt;(Xt=Ae.next())!==void 0;)bt=W(bt,Xt,_e++);return bt}function Xr(N,W){return new de(N,W)}function H(N){return new de(N,1)}var de=function(){function N(W,pe){this._value=W,this._count=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._value,this._count)},N.prototype.next=function(){if(!(this._count<=0))return this._count--,this._value},N}();function Te(N){var W;return typeof N.retro=="function"?W=N.retro():W=new be(N),W}var be=function(){function N(W){this._source=W,this._index=W.length-1}return N.prototype.iter=function(){return this},N.prototype.clone=function(){var W=new N(this._source);return W._index=this._index,W},N.prototype.next=function(){if(!(this._index<0||this._index>=this._source.length))return this._source[this._index--]},N}();function we(N){var W=[],pe=new Set,_e=new Map;return s(N,Ae),_e.forEach(function(ze,bt){Yt(bt)}),W;function Ae(ze){var bt=ze[0],Xt=ze[1],Lt=_e.get(Xt);Lt?Lt.push(bt):_e.set(Xt,[bt])}function Yt(ze){if(!pe.has(ze)){pe.add(ze);var bt=_e.get(ze);bt&&bt.forEach(Yt),W.push(ze)}}}function L(N,W){return new le(e(N),W)}var le=function(){function N(W,pe){this._source=W,this._step=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._step)},N.prototype.next=function(){for(var W=this._source.next(),pe=this._step-1;pe>0;--pe)this._source.next();return W},N}();r.StringExt=void 0,function(N){function W(ze,bt,Xt){Xt===void 0&&(Xt=0);for(var Lt=new Array(bt.length),Tr=0,F=Xt,ue=bt.length;Tr<ue;++Tr,++F){if(F=ze.indexOf(bt[Tr],F),F===-1)return null;Lt[Tr]=F}return Lt}N.findIndices=W;function pe(ze,bt,Xt){Xt===void 0&&(Xt=0);var Lt=W(ze,bt,Xt);if(!Lt)return null;for(var Tr=0,F=0,ue=Lt.length;F<ue;++F){var k=Lt[F]-Xt;Tr+=k*k}return{score:Tr,indices:Lt}}N.matchSumOfSquares=pe;function _e(ze,bt,Xt){Xt===void 0&&(Xt=0);var Lt=W(ze,bt,Xt);if(!Lt)return null;for(var Tr=0,F=Xt-1,ue=0,k=Lt.length;ue<k;++ue){var O=Lt[ue];Tr+=O-F-1,F=O}return{score:Tr,indices:Lt}}N.matchSumOfDeltas=_e;function Ae(ze,bt,Xt){for(var Lt=[],Tr=0,F=0,ue=bt.length;Tr<ue;){for(var k=bt[Tr],O=bt[Tr];++Tr<ue&&bt[Tr]===O+1;)O++;F<k&&Lt.push(ze.slice(F,k)),k<O+1&&Lt.push(Xt(ze.slice(k,O+1))),F=O+1}return F<ze.length&&Lt.push(ze.slice(F)),Lt}N.highlight=Ae;function Yt(ze,bt){return ze<bt?-1:ze>bt?1:0}N.cmp=Yt}(r.StringExt||(r.StringExt={}));function he(N,W){return new xe(e(N),W)}var xe=function(){function N(W,pe){this._source=W,this._count=pe}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.clone(),this._count)},N.prototype.next=function(){if(!(this._count<=0)){var W=this._source.next();if(W!==void 0)return this._count--,W}},N}();function Le(){for(var N=[],W=0;W<arguments.length;W++)N[W]=arguments[W];return new et(N.map(e))}var et=function(){function N(W){this._source=W}return N.prototype.iter=function(){return this},N.prototype.clone=function(){return new N(this._source.map(function(W){return W.clone()}))},N.prototype.next=function(){for(var W=new Array(this._source.length),pe=0,_e=this._source.length;pe<_e;++pe){var Ae=this._source[pe].next();if(Ae===void 0)return;W[pe]=Ae}return W},N}();r.ArrayIterator=p,r.ChainIterator=S,r.EmptyIterator=D,r.EnumerateIterator=M,r.FilterIterator=A,r.FnIterator=g,r.ItemIterator=h,r.KeyIterator=f,r.MapIterator=Ce,r.RangeIterator=Nt,r.RepeatIterator=de,r.RetroArrayIterator=be,r.StrideIterator=le,r.TakeIterator=xe,r.ValueIterator=m,r.ZipIterator=et,r.chain=v,r.each=s,r.empty=_,r.enumerate=P,r.every=a,r.filter=x,r.find=j,r.findIndex=re,r.iter=e,r.iterFn=o,r.iterItems=i,r.iterKeys=t,r.iterValues=n,r.map=Ke,r.max=Z,r.min=R,r.minmax=ge,r.once=H,r.range=ae,r.reduce=vr,r.repeat=Xr,r.retro=Te,r.some=l,r.stride=L,r.take=he,r.toArray=c,r.toObject=u,r.topologicSort=we,r.zip=Le,Object.defineProperty(r,"__esModule",{value:!0})})});var TW=z((X0,hY)=>{d();(function(r,e){typeof X0=="object"&&typeof hY!="undefined"?e(X0):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_properties={}))})(X0,function(r){"use strict";r.AttachedProperty=function(){function t(n){this._pid=e.nextPID(),this.name=n.name,this._create=n.create,this._coerce=n.coerce||null,this._compare=n.compare||null,this._changed=n.changed||null}return t.prototype.get=function(n){var i,o=e.ensureMap(n);return this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n),i},t.prototype.set=function(n,i){var o,s=e.ensureMap(n);this._pid in s?o=s[this._pid]:o=s[this._pid]=this._createValue(n);var a=this._coerceValue(n,i);this._maybeNotify(n,o,s[this._pid]=a)},t.prototype.coerce=function(n){var i,o=e.ensureMap(n);this._pid in o?i=o[this._pid]:i=o[this._pid]=this._createValue(n);var s=this._coerceValue(n,i);this._maybeNotify(n,i,o[this._pid]=s)},t.prototype._createValue=function(n){var i=this._create;return i(n)},t.prototype._coerceValue=function(n,i){var o=this._coerce;return o?o(n,i):i},t.prototype._compareValue=function(n,i){var o=this._compare;return o?o(n,i):n===i},t.prototype._maybeNotify=function(n,i,o){var s=this._changed;s&&!this._compareValue(i,o)&&s(n,i,o)},t}(),function(t){function n(i){e.ownerData.delete(i)}t.clearData=n}(r.AttachedProperty||(r.AttachedProperty={}));var e;(function(t){t.ownerData=new WeakMap,t.nextPID=function(){var i=0;return function(){var o=Math.random(),s=(""+o).slice(2);return"pid-"+s+"-"+i++}}();function n(i){var o=t.ownerData.get(i);return o||(o=Object.create(null),t.ownerData.set(i,o),o)}t.ensureMap=n})(e||(e={})),Object.defineProperty(r,"__esModule",{value:!0})})});var Ki=z((Z0,gY)=>{d();(function(r,e){typeof Z0=="object"&&typeof gY!="undefined"?e(Z0,Ug(),TW()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/properties"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_signaling={},r.lumino_algorithm,r.lumino_properties))})(Z0,function(r,e,t){"use strict";r.Signal=function(){function i(o){this._blockedCount=0,this.sender=o}return i.prototype.block=function(o){this._blockedCount++;try{o()}finally{this._blockedCount--}},i.prototype.connect=function(o,s){return n.connect(this,o,s)},i.prototype.disconnect=function(o,s){return n.disconnect(this,o,s)},i.prototype.emit=function(o){this._blockedCount||n.emit(this,o)},i}(),function(i){function o(m,h){var g=n.blockedProperty;g.set(m,g.get(m)+1);try{h()}finally{g.set(m,g.get(m)-1)}}i.blockAll=o;function s(m,h){n.disconnectBetween(m,h)}i.disconnectBetween=s;function a(m){n.disconnectSender(m)}i.disconnectSender=a;function l(m){n.disconnectReceiver(m)}i.disconnectReceiver=l;function c(m){n.disconnectAll(m)}i.disconnectAll=c;function u(m){n.disconnectAll(m)}i.clearData=u;function p(){return n.exceptionHandler}i.getExceptionHandler=p;function f(m){var h=n.exceptionHandler;return n.exceptionHandler=m,h}i.setExceptionHandler=f}(r.Signal||(r.Signal={}));var n;(function(i){i.exceptionHandler=function(x){console.error(x)};function o(x,A,j){j=j||void 0;var re=f.get(x.sender);if(re||(re=[],f.set(x.sender,re)),v(re,x,A,j))return!1;var R=j||A,Z=m.get(R);Z||(Z=[],m.set(R,Z));var ge={signal:x,slot:A,thisArg:j};return re.push(ge),Z.push(ge),!0}i.connect=o;function s(x,A,j){j=j||void 0;var re=f.get(x.sender);if(!re||re.length===0)return!1;var R=v(re,x,A,j);if(!R)return!1;var Z=j||A,ge=m.get(Z);return R.signal=null,_(re),_(ge),!0}i.disconnect=s;function a(x,A){var j=f.get(x);if(!(!j||j.length===0)){var re=m.get(A);!re||re.length===0||(e.each(re,function(R){R.signal&&R.signal.sender===x&&(R.signal=null)}),_(j),_(re))}}i.disconnectBetween=a;function l(x){var A=f.get(x);!A||A.length===0||(e.each(A,function(j){if(j.signal){var re=j.thisArg||j.slot;j.signal=null,_(m.get(re))}}),_(A))}i.disconnectSender=l;function c(x){var A=m.get(x);!A||A.length===0||(e.each(A,function(j){if(j.signal){var re=j.signal.sender;j.signal=null,_(f.get(re))}}),_(A))}i.disconnectReceiver=c;function u(x){l(x),c(x)}i.disconnectAll=u;function p(x,A){if(!(i.blockedProperty.get(x.sender)>0)){var j=f.get(x.sender);if(!(!j||j.length===0))for(var re=0,R=j.length;re<R;++re){var Z=j[re];Z.signal===x&&S(Z,A)}}}i.emit=p;var f=new WeakMap,m=new WeakMap,h=new Set,g=function(){var x=typeof requestAnimationFrame=="function";return x?requestAnimationFrame:setImmediate}();function v(x,A,j,re){return e.find(x,function(R){return R.signal===A&&R.slot===j&&R.thisArg===re})}function S(x,A){var j=x.signal,re=x.slot,R=x.thisArg;try{re.call(R,j.sender,A)}catch(Z){i.exceptionHandler(Z)}}function _(x){h.size===0&&g(D),h.add(x)}function D(){h.forEach(P),h.clear()}function P(x){e.ArrayExt.removeAllWhere(x,M)}function M(x){return x.signal===null}i.blockedProperty=new t.AttachedProperty({name:"blocked",create:function(){return 0}})})(n||(n={})),Object.defineProperty(r,"__esModule",{value:!0})})});var yY=z(eR=>{"use strict";d();Object.defineProperty(eR,"__esModule",{value:!0});eR.ActivityMonitor=void 0;var vY=Ki(),kW=class{constructor(e){this._timer=-1,this._timeout=-1,this._isDisposed=!1,this._activityStopped=new vY.Signal(this),e.signal.connect(this._onSignalFired,this),this._timeout=e.timeout||1e3}get activityStopped(){return this._activityStopped}get timeout(){return this._timeout}set timeout(e){this._timeout=e}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,vY.Signal.clearData(this))}_onSignalFired(e,t){clearTimeout(this._timer),this._sender=e,this._args=t,this._timer=setTimeout(()=>{this._activityStopped.emit({sender:this._sender,args:this._args})},this._timeout)}};eR.ActivityMonitor=kW});var IY=z(bY=>{"use strict";d();Object.defineProperty(bY,"__esModule",{value:!0})});var SY=z(Sx=>{"use strict";d();Object.defineProperty(Sx,"__esModule",{value:!0});Sx.MarkdownCodeBlocks=void 0;var fve;(function(r){r.CODE_BLOCK_MARKER="```";let e=[".markdown",".mdown",".mkdn",".md",".mkd",".mdwn",".mdtxt",".mdtext",".text",".txt",".Rmd"];class t{constructor(s){this.startLine=s,this.code="",this.endLine=-1}}r.MarkdownCodeBlock=t;function n(o){return e.indexOf(o)>-1}r.isMarkdown=n;function i(o){if(!o||o==="")return[];let s=o.split(`
`),a=[],l=null;for(let c=0;c<s.length;c++){let u=s[c],p=u.indexOf(r.CODE_BLOCK_MARKER)===0,f=l!=null;if(!(!p&&!f))if(f)l&&(p?(l.endLine=c-1,a.push(l),l=null):l.code+=u+`
`);else{l=new t(c);let m=u.indexOf(r.CODE_BLOCK_MARKER),h=u.lastIndexOf(r.CODE_BLOCK_MARKER);m!==h&&(l.code=u.substring(m+r.CODE_BLOCK_MARKER.length,h),l.endLine=c,a.push(l),l=null)}}return a}r.findMarkdownCodeBlocks=i})(fve=Sx.MarkdownCodeBlocks||(Sx.MarkdownCodeBlocks={}))});var Fl=z((tR,_Y)=>{d();(function(r,e){typeof tR=="object"&&typeof _Y!="undefined"?e(tR):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_coreutils={}))})(tR,function(r){"use strict";r.JSONExt=void 0,function(s){s.emptyObject=Object.freeze({}),s.emptyArray=Object.freeze([]);function a(v){return v===null||typeof v=="boolean"||typeof v=="number"||typeof v=="string"}s.isPrimitive=a;function l(v){return Array.isArray(v)}s.isArray=l;function c(v){return!a(v)&&!l(v)}s.isObject=c;function u(v,S){if(v===S)return!0;if(a(v)||a(S))return!1;var _=l(v),D=l(S);return _!==D?!1:_&&D?f(v,S):m(v,S)}s.deepEqual=u;function p(v){return a(v)?v:l(v)?h(v):g(v)}s.deepCopy=p;function f(v,S){if(v===S)return!0;if(v.length!==S.length)return!1;for(var _=0,D=v.length;_<D;++_)if(!u(v[_],S[_]))return!1;return!0}function m(v,S){if(v===S)return!0;for(var _ in v)if(v[_]!==void 0&&!(_ in S))return!1;for(var _ in S)if(S[_]!==void 0&&!(_ in v))return!1;for(var _ in v){var D=v[_],P=S[_];if(!(D===void 0&&P===void 0)&&(D===void 0||P===void 0||!u(D,P)))return!1}return!0}function h(v){for(var S=new Array(v.length),_=0,D=v.length;_<D;++_)S[_]=p(v[_]);return S}function g(v){var S={};for(var _ in v){var D=v[_];D!==void 0&&(S[_]=p(D))}return S}}(r.JSONExt||(r.JSONExt={}));var e=function(){function s(){this._types=[],this._values=[]}return s.prototype.types=function(){return this._types.slice()},s.prototype.hasData=function(a){return this._types.indexOf(a)!==-1},s.prototype.getData=function(a){var l=this._types.indexOf(a);return l!==-1?this._values[l]:void 0},s.prototype.setData=function(a,l){this.clearData(a),this._types.push(a),this._values.push(l)},s.prototype.clearData=function(a){var l=this._types.indexOf(a);l!==-1&&(this._types.splice(l,1),this._values.splice(l,1))},s.prototype.clear=function(){this._types.length=0,this._values.length=0},s}(),t=function(){function s(){var a=this;this.promise=new Promise(function(l,c){a._resolve=l,a._reject=c})}return s.prototype.resolve=function(a){var l=this._resolve;l(a)},s.prototype.reject=function(a){var l=this._reject;l(a)},s}(),n=function(){function s(a){this.name=a,this._tokenStructuralPropertyT=null}return s}();function i(s){for(var a=0,l=0,c=s.length;l<c;++l)l%4===0&&(a=Math.random()*4294967295>>>0),s[l]=a&255,a>>>=8}r.Random=void 0,function(s){s.getRandomValues=function(){var a=typeof window!="undefined"&&(window.crypto||window.msCrypto)||null;return a&&typeof a.getRandomValues=="function"?function(c){return a.getRandomValues(c)}:i}()}(r.Random||(r.Random={}));function o(s){for(var a=new Uint8Array(16),l=new Array(256),c=0;c<16;++c)l[c]="0"+c.toString(16);for(var c=16;c<256;++c)l[c]=c.toString(16);return function(){return s(a),a[6]=64|a[6]&15,a[8]=128|a[8]&63,l[a[0]]+l[a[1]]+l[a[2]]+l[a[3]]+"-"+l[a[4]]+l[a[5]]+"-"+l[a[6]]+l[a[7]]+"-"+l[a[8]]+l[a[9]]+"-"+l[a[10]]+l[a[11]]+l[a[12]]+l[a[13]]+l[a[14]]+l[a[15]]}}r.UUID=void 0,function(s){s.uuid4=o(r.Random.getRandomValues)}(r.UUID||(r.UUID={})),r.MimeData=e,r.PromiseDelegate=t,r.Token=n,Object.defineProperty(r,"__esModule",{value:!0})})});var xY=z((fqe,wY)=>{"use strict";d();function mve(r,e){var t=r;e.slice(0,-1).forEach(function(i){t=t[i]||{}});var n=e[e.length-1];return n in t}function EY(r){return typeof r=="number"||/^0x[0-9a-f]+$/i.test(r)?!0:/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)(e[-+]?\d+)?$/.test(r)}function CY(r,e){return e==="constructor"&&typeof r[e]=="function"||e==="__proto__"}wY.exports=function(r,e){e||(e={});var t={bools:{},strings:{},unknownFn:null};typeof e.unknown=="function"&&(t.unknownFn=e.unknown),typeof e.boolean=="boolean"&&e.boolean?t.allBools=!0:[].concat(e.boolean).filter(Boolean).forEach(function(P){t.bools[P]=!0});var n={};function i(P){return n[P].some(function(M){return t.bools[M]})}Object.keys(e.alias||{}).forEach(function(P){n[P]=[].concat(e.alias[P]),n[P].forEach(function(M){n[M]=[P].concat(n[P].filter(function(x){return M!==x}))})}),[].concat(e.string).filter(Boolean).forEach(function(P){t.strings[P]=!0,n[P]&&[].concat(n[P]).forEach(function(M){t.strings[M]=!0})});var o=e.default||{},s={_:[]};function a(P,M){return t.allBools&&/^--[^=]+$/.test(M)||t.strings[P]||t.bools[P]||n[P]}function l(P,M,x){for(var A=P,j=0;j<M.length-1;j++){var re=M[j];if(CY(A,re))return;A[re]===void 0&&(A[re]={}),(A[re]===Object.prototype||A[re]===Number.prototype||A[re]===String.prototype)&&(A[re]={}),A[re]===Array.prototype&&(A[re]=[]),A=A[re]}var R=M[M.length-1];CY(A,R)||((A===Object.prototype||A===Number.prototype||A===String.prototype)&&(A={}),A===Array.prototype&&(A=[]),A[R]===void 0||t.bools[R]||typeof A[R]=="boolean"?A[R]=x:Array.isArray(A[R])?A[R].push(x):A[R]=[A[R],x])}function c(P,M,x){if(!(x&&t.unknownFn&&!a(P,x)&&t.unknownFn(x)===!1)){var A=!t.strings[P]&&EY(M)?Number(M):M;l(s,P.split("."),A),(n[P]||[]).forEach(function(j){l(s,j.split("."),A)})}}Object.keys(t.bools).forEach(function(P){c(P,o[P]===void 0?!1:o[P])});var u=[];r.indexOf("--")!==-1&&(u=r.slice(r.indexOf("--")+1),r=r.slice(0,r.indexOf("--")));for(var p=0;p<r.length;p++){var f=r[p],m,h;if(/^--.+=/.test(f)){var g=f.match(/^--([^=]+)=([\s\S]*)$/);m=g[1];var v=g[2];t.bools[m]&&(v=v!=="false"),c(m,v,f)}else if(/^--no-.+/.test(f))m=f.match(/^--no-(.+)/)[1],c(m,!1,f);else if(/^--.+/.test(f))m=f.match(/^--(.+)/)[1],h=r[p+1],h!==void 0&&!/^(-|--)[^-]/.test(h)&&!t.bools[m]&&!t.allBools&&(!n[m]||!i(m))?(c(m,h,f),p+=1):/^(true|false)$/.test(h)?(c(m,h==="true",f),p+=1):c(m,t.strings[m]?"":!0,f);else if(/^-[^-]+/.test(f)){for(var S=f.slice(1,-1).split(""),_=!1,D=0;D<S.length;D++){if(h=f.slice(D+2),h==="-"){c(S[D],h,f);continue}if(/[A-Za-z]/.test(S[D])&&h[0]==="="){c(S[D],h.slice(1),f),_=!0;break}if(/[A-Za-z]/.test(S[D])&&/-?\d+(\.\d*)?(e-?\d+)?$/.test(h)){c(S[D],h,f),_=!0;break}if(S[D+1]&&S[D+1].match(/\W/)){c(S[D],f.slice(D+2),f),_=!0;break}else c(S[D],t.strings[S[D]]?"":!0,f)}m=f.slice(-1)[0],!_&&m!=="-"&&(r[p+1]&&!/^(-|--)[^-]/.test(r[p+1])&&!t.bools[m]&&(!n[m]||!i(m))?(c(m,r[p+1],f),p+=1):r[p+1]&&/^(true|false)$/.test(r[p+1])?(c(m,r[p+1]==="true",f),p+=1):c(m,t.strings[m]?"":!0,f))}else if((!t.unknownFn||t.unknownFn(f)!==!1)&&s._.push(t.strings._||!EY(f)?f:Number(f)),e.stopEarly){s._.push.apply(s._,r.slice(p+1));break}}return Object.keys(o).forEach(function(P){mve(s,P.split("."))||(l(s,P.split("."),o[P]),(n[P]||[]).forEach(function(M){l(s,M.split("."),o[P])}))}),e["--"]?s["--"]=u.slice():u.forEach(function(P){s._.push(P)}),s}});var rR=z((hqe,PY)=>{"use strict";d();function Hc(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function DY(r,e){for(var t="",n=0,i=-1,o=0,s,a=0;a<=r.length;++a){if(a<r.length)s=r.charCodeAt(a);else{if(s===47)break;s=47}if(s===47){if(!(i===a-1||o===1))if(i!==a-1&&o===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var l=t.lastIndexOf("/");if(l!==t.length-1){l===-1?(t="",n=0):(t=t.slice(0,l),n=t.length-1-t.lastIndexOf("/")),i=a,o=0;continue}}else if(t.length===2||t.length===1){t="",n=0,i=a,o=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(i+1,a):t=r.slice(i+1,a),n=a-i-1;i=a,o=0}else s===46&&o!==-1?++o:o=-1}return t}function hve(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var hI={resolve:function(){for(var e="",t=!1,n,i=arguments.length-1;i>=-1&&!t;i--){var o;i>=0?o=arguments[i]:(n===void 0&&(n=process.cwd()),o=n),Hc(o),o.length!==0&&(e=o+"/"+e,t=o.charCodeAt(0)===47)}return e=DY(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Hc(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=DY(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return Hc(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];Hc(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":hI.normalize(e)},relative:function(e,t){if(Hc(e),Hc(t),e===t||(e=hI.resolve(e),t=hI.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,o=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var a=t.length,l=a-s,c=o<l?o:l,u=-1,p=0;p<=c;++p){if(p===c){if(l>c){if(t.charCodeAt(s+p)===47)return t.slice(s+p+1);if(p===0)return t.slice(s+p)}else o>c&&(e.charCodeAt(n+p)===47?u=p:p===0&&(u=0));break}var f=e.charCodeAt(n+p),m=t.charCodeAt(s+p);if(f!==m)break;f===47&&(u=p)}var h="";for(p=n+u+1;p<=i;++p)(p===i||e.charCodeAt(p)===47)&&(h.length===0?h+="..":h+="/..");return h.length>0?h+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(Hc(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,i=-1,o=!0,s=e.length-1;s>=1;--s)if(t=e.charCodeAt(s),t===47){if(!o){i=s;break}}else o=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Hc(e);var n=0,i=-1,o=!0,s;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var a=t.length-1,l=-1;for(s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!o){n=s+1;break}}else l===-1&&(o=!1,l=s+1),a>=0&&(c===t.charCodeAt(a)?--a===-1&&(i=s):(a=-1,i=l))}return n===i?i=l:i===-1&&(i=e.length),e.slice(n,i)}else{for(s=e.length-1;s>=0;--s)if(e.charCodeAt(s)===47){if(!o){n=s+1;break}}else i===-1&&(o=!1,i=s+1);return i===-1?"":e.slice(n,i)}},extname:function(e){Hc(e);for(var t=-1,n=0,i=-1,o=!0,s=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===46?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return hve("/",e)},parse:function(e){Hc(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,o;i?(t.root="/",o=1):o=0;for(var s=-1,a=0,l=-1,c=!0,u=e.length-1,p=0;u>=o;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?s===-1?s=u:p!==1&&(p=1):s!==-1&&(p=-1)}return s===-1||l===-1||p===0||p===1&&s===l-1&&s===a+1?l!==-1&&(a===0&&i?t.base=t.name=e.slice(1,l):t.base=t.name=e.slice(a,l)):(a===0&&i?(t.name=e.slice(1,s),t.base=e.slice(1,l)):(t.name=e.slice(a,s),t.base=e.slice(a,l)),t.ext=e.slice(s,l)),a>0?t.dir=e.slice(0,a-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};hI.posix=hI;PY.exports=hI});var kY=z((vqe,TY)=>{"use strict";d();TY.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return e!==80;case"https":case"wss":return e!==443;case"ftp":return e!==21;case"gopher":return e!==70;case"file":return!1}return e!==0}});var AY=z(NW=>{"use strict";d();var gve=Object.prototype.hasOwnProperty,vve;function NY(r){try{return decodeURIComponent(r.replace(/\+/g," "))}catch(e){return null}}function RY(r){try{return encodeURIComponent(r)}catch(e){return null}}function yve(r){for(var e=/([^=?#&]+)=?([^&]*)/g,t={},n;n=e.exec(r);){var i=NY(n[1]),o=NY(n[2]);i===null||o===null||i in t||(t[i]=o)}return t}function bve(r,e){e=e||"";var t=[],n,i;typeof e!="string"&&(e="?");for(i in r)if(gve.call(r,i)){if(n=r[i],!n&&(n===null||n===vve||isNaN(n))&&(n=""),i=RY(i),n=RY(n),i===null||n===null)continue;t.push(i+"="+n)}return t.length?e+t.join("&"):""}NW.stringify=bve;NW.parse=yve});var MW=z((Sqe,WY)=>{"use strict";d();var OY=kY(),nR=AY(),Ive=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,LY=/[\n\r\t]/g,Sve=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,KY=/:\d+$/,_ve=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,Eve=/^[a-zA-Z]:/;function AW(r){return(r||"").toString().replace(Ive,"")}var RW=[["#","hash"],["?","query"],function(e,t){return Jc(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],MY={hash:1,query:1};function FY(r){var e;typeof window!="undefined"?e=window:typeof this!="undefined"?e=this:typeof self!="undefined"?e=self:e={};var t=e.location||{};r=r||t;var n={},i=typeof r,o;if(r.protocol==="blob:")n=new qc(unescape(r.pathname),{});else if(i==="string"){n=new qc(r,{});for(o in MY)delete n[o]}else if(i==="object"){for(o in r)o in MY||(n[o]=r[o]);n.slashes===void 0&&(n.slashes=Sve.test(r.href))}return n}function Jc(r){return r==="file:"||r==="ftp:"||r==="http:"||r==="https:"||r==="ws:"||r==="wss:"}function UY(r,e){r=AW(r),r=r.replace(LY,""),e=e||{};var t=_ve.exec(r),n=t[1]?t[1].toLowerCase():"",i=!!t[2],o=!!t[3],s=0,a;return i?o?(a=t[2]+t[3]+t[4],s=t[2].length+t[3].length):(a=t[2]+t[4],s=t[2].length):o?(a=t[3]+t[4],s=t[3].length):a=t[4],n==="file:"?s>=2&&(a=a.slice(2)):Jc(n)?a=t[4]:n?i&&(a=a.slice(2)):s>=2&&Jc(e.protocol)&&(a=t[4]),{protocol:n,slashes:i||Jc(n),slashesCount:s,rest:a}}function Cve(r,e){if(r==="")return e;for(var t=(e||"/").split("/").slice(0,-1).concat(r.split("/")),n=t.length,i=t[n-1],o=!1,s=0;n--;)t[n]==="."?t.splice(n,1):t[n]===".."?(t.splice(n,1),s++):s&&(n===0&&(o=!0),t.splice(n,1),s--);return o&&t.unshift(""),(i==="."||i==="..")&&t.push(""),t.join("/")}function qc(r,e,t){if(r=AW(r),r=r.replace(LY,""),!(this instanceof qc))return new qc(r,e,t);var n,i,o,s,a,l,c=RW.slice(),u=typeof e,p=this,f=0;for(u!=="object"&&u!=="string"&&(t=e,e=null),t&&typeof t!="function"&&(t=nR.parse),e=FY(e),i=UY(r||"",e),n=!i.protocol&&!i.slashes,p.slashes=i.slashes||n&&e.slashes,p.protocol=i.protocol||e.protocol||"",r=i.rest,(i.protocol==="file:"&&(i.slashesCount!==2||Eve.test(r))||!i.slashes&&(i.protocol||i.slashesCount<2||!Jc(p.protocol)))&&(c[3]=[/(.*)/,"pathname"]);f<c.length;f++){if(s=c[f],typeof s=="function"){r=s(r,p);continue}o=s[0],l=s[1],o!==o?p[l]=r:typeof o=="string"?(a=o==="@"?r.lastIndexOf(o):r.indexOf(o),~a&&(typeof s[2]=="number"?(p[l]=r.slice(0,a),r=r.slice(a+s[2])):(p[l]=r.slice(a),r=r.slice(0,a)))):(a=o.exec(r))&&(p[l]=a[1],r=r.slice(0,a.index)),p[l]=p[l]||n&&s[3]&&e[l]||"",s[4]&&(p[l]=p[l].toLowerCase())}t&&(p.query=t(p.query)),n&&e.slashes&&p.pathname.charAt(0)!=="/"&&(p.pathname!==""||e.pathname!=="")&&(p.pathname=Cve(p.pathname,e.pathname)),p.pathname.charAt(0)!=="/"&&Jc(p.protocol)&&(p.pathname="/"+p.pathname),OY(p.port,p.protocol)||(p.host=p.hostname,p.port=""),p.username=p.password="",p.auth&&(a=p.auth.indexOf(":"),~a?(p.username=p.auth.slice(0,a),p.username=encodeURIComponent(decodeURIComponent(p.username)),p.password=p.auth.slice(a+1),p.password=encodeURIComponent(decodeURIComponent(p.password))):p.username=encodeURIComponent(decodeURIComponent(p.auth)),p.auth=p.password?p.username+":"+p.password:p.username),p.origin=p.protocol!=="file:"&&Jc(p.protocol)&&p.host?p.protocol+"//"+p.host:"null",p.href=p.toString()}function wve(r,e,t){var n=this;switch(r){case"query":typeof e=="string"&&e.length&&(e=(t||nR.parse)(e)),n[r]=e;break;case"port":n[r]=e,OY(e,n.protocol)?e&&(n.host=n.hostname+":"+e):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=e,n.port&&(e+=":"+n.port),n.host=e;break;case"host":n[r]=e,KY.test(e)?(e=e.split(":"),n.port=e.pop(),n.hostname=e.join(":")):(n.hostname=e,n.port="");break;case"protocol":n.protocol=e.toLowerCase(),n.slashes=!t;break;case"pathname":case"hash":if(e){var i=r==="pathname"?"/":"#";n[r]=e.charAt(0)!==i?i+e:e}else n[r]=e;break;case"username":case"password":n[r]=encodeURIComponent(e);break;case"auth":var o=e.indexOf(":");~o?(n.username=e.slice(0,o),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=e.slice(o+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(e))}for(var s=0;s<RW.length;s++){var a=RW[s];a[4]&&(n[a[1]]=n[a[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&Jc(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function xve(r){(!r||typeof r!="function")&&(r=nR.stringify);var e,t=this,n=t.host,i=t.protocol;i&&i.charAt(i.length-1)!==":"&&(i+=":");var o=i+(t.protocol&&t.slashes||Jc(t.protocol)?"//":"");return t.username?(o+=t.username,t.password&&(o+=":"+t.password),o+="@"):t.password?(o+=":"+t.password,o+="@"):t.protocol!=="file:"&&Jc(t.protocol)&&!n&&t.pathname!=="/"&&(o+="@"),(n[n.length-1]===":"||KY.test(t.hostname)&&!t.port)&&(n+=":"),o+=n+t.pathname,e=typeof t.query=="object"?r(t.query):t.query,e&&(o+=e.charAt(0)!=="?"?"?"+e:e),t.hash&&(o+=t.hash),o}qc.prototype={set:wve,toString:xve};qc.extractProtocol=UY;qc.location=FY;qc.trimLeft=AW;qc.qs=nR;WY.exports=qc});var LW=z(Wg=>{"use strict";d();var Dve=Wg&&Wg.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Wg,"__esModule",{value:!0});Wg.URLExt=void 0;var Pve=rR(),OW=Dve(MW()),Tve;(function(r){function e(c){if(typeof document!="undefined"&&document){let u=document.createElement("a");return u.href=c,u}return OW.default(c)}r.parse=e;function t(c){return OW.default(c).hostname}r.getHostName=t;function n(c){return c&&e(c).toString()}r.normalize=n;function i(...c){let u=OW.default(c[0],{}),p=`${u.protocol}${u.slashes?"//":""}${u.auth}${u.auth?"@":""}${u.host}`,f=Pve.posix.join(`${p&&u.pathname[0]!=="/"?"/":""}${u.pathname}`,...c.slice(1));return`${p}${f==="."?"":f}`}r.join=i;function o(c){return i(...c.split("/").map(encodeURIComponent))}r.encodeParts=o;function s(c){let u=Object.keys(c).filter(p=>p.length>0);return u.length?"?"+u.map(p=>{let f=encodeURIComponent(String(c[p]));return p+(f?"="+f:"")}).join("&"):""}r.objectToQueryString=s;function a(c){return c.replace(/^\?/,"").split("&").reduce((u,p)=>{let[f,m]=p.split("=");return f.length>0&&(u[f]=decodeURIComponent(m||"")),u},{})}r.queryStringToObject=a;function l(c){let{protocol:u}=e(c);return(!u||c.toLowerCase().indexOf(u)!==0)&&c.indexOf("/")!==0}r.isLocal=l})(Tve=Wg.URLExt||(Wg.URLExt={}))});var VY=z((exports,module)=>{"use strict";d();var __importDefault=exports&&exports.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(exports,"__esModule",{value:!0});exports.PageConfig=void 0;var coreutils_1=Fl(),minimist_1=__importDefault(xY()),url_1=LW(),PageConfig;(function(PageConfig){function getOption(name){if(configData)return configData[name]||getBodyData(name);configData=Object.create(null);let found=!1;if(typeof document!="undefined"&&document){let r=document.getElementById("jupyter-config-data");r&&(configData=JSON.parse(r.textContent||""),found=!0)}if(!found&&typeof process!="undefined"&&process.argv)try{let cli=minimist_1.default(process.argv.slice(2)),path=rR(),fullPath="";"jupyter-config-data"in cli?fullPath=path.resolve(cli["jupyter-config-data"]):"JUPYTER_CONFIG_DATA"in process.env&&(fullPath=path.resolve(process.env.JUPYTER_CONFIG_DATA)),fullPath&&(configData=eval("require")(fullPath))}catch(r){console.error(r)}if(!coreutils_1.JSONExt.isObject(configData))configData=Object.create(null);else for(let r in configData)typeof configData[r]!="string"&&(configData[r]=JSON.stringify(configData[r]));return configData[name]||getBodyData(name)}PageConfig.getOption=getOption;function setOption(r,e){let t=getOption(r);return configData[r]=e,t}PageConfig.setOption=setOption;function getBaseUrl(){return url_1.URLExt.normalize(getOption("baseUrl")||"/")}PageConfig.getBaseUrl=getBaseUrl;function getTreeUrl(){return url_1.URLExt.join(getBaseUrl(),getOption("treeUrl"))}PageConfig.getTreeUrl=getTreeUrl;function getShareUrl(){return url_1.URLExt.normalize(getOption("shareUrl")||getBaseUrl())}PageConfig.getShareUrl=getShareUrl;function getTreeShareUrl(){return url_1.URLExt.normalize(url_1.URLExt.join(getShareUrl(),getOption("treeUrl")))}PageConfig.getTreeShareUrl=getTreeShareUrl;function getUrl(r){var e,t,n;let i=getOption("baseUrl")||"/",o=(e=r.mode)!==null&&e!==void 0?e:getOption("mode"),s=(t=r.workspace)!==null&&t!==void 0?t:getOption("workspace"),a=o==="multiple-document"?"lab":"doc";i=url_1.URLExt.join(i,a),s!==PageConfig.defaultWorkspace&&(i=url_1.URLExt.join(i,"workspaces",encodeURIComponent(getOption("workspace"))));let l=(n=r.treePath)!==null&&n!==void 0?n:getOption("treePath");return l&&(i=url_1.URLExt.join(i,"tree",url_1.URLExt.encodeParts(l))),i}PageConfig.getUrl=getUrl,PageConfig.defaultWorkspace="default";function getWsUrl(r){let e=getOption("wsUrl");if(!e){if(r=r?url_1.URLExt.normalize(r):getBaseUrl(),r.indexOf("http")!==0)return"";e="ws"+r.slice(4)}return url_1.URLExt.normalize(e)}PageConfig.getWsUrl=getWsUrl;function getNBConvertURL({path:r,format:e,download:t}){let n=url_1.URLExt.encodeParts(r),i=url_1.URLExt.join(getBaseUrl(),"nbconvert",e,n);return t?i+"?download=true":i}PageConfig.getNBConvertURL=getNBConvertURL;function getToken(){return getOption("token")||getBodyData("jupyterApiToken")}PageConfig.getToken=getToken;function getNotebookVersion(){let r=getOption("notebookVersion");return r===""?[0,0,0]:JSON.parse(r)}PageConfig.getNotebookVersion=getNotebookVersion;let configData=null;function getBodyData(r){if(typeof document=="undefined"||!document.body)return"";let e=document.body.dataset[r];return typeof e=="undefined"?"":decodeURIComponent(e)}let Extension;(function(r){function e(i){try{let o=getOption(i);if(o)return JSON.parse(o)}catch(o){console.warn(`Unable to parse ${i}.`,o)}return[]}r.deferred=e("deferredExtensions"),r.disabled=e("disabledExtensions");function t(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.deferred.some(a=>a===i||s&&a===s)}r.isDeferred=t;function n(i){let o=i.indexOf(":"),s="";return o!==-1&&(s=i.slice(0,o)),r.disabled.some(a=>a===i||s&&a===s)}r.isDisabled=n})(Extension=PageConfig.Extension||(PageConfig.Extension={}))})(PageConfig=exports.PageConfig||(exports.PageConfig={}))});var jY=z(_x=>{"use strict";d();Object.defineProperty(_x,"__esModule",{value:!0});_x.PathExt=void 0;var Vg=rR(),kve;(function(r){function e(...u){let p=Vg.posix.join(...u);return p==="."?"":c(p)}r.join=e;function t(u,p){return Vg.posix.basename(u,p)}r.basename=t;function n(u){let p=c(Vg.posix.dirname(u));return p==="."?"":p}r.dirname=n;function i(u){return Vg.posix.extname(u)}r.extname=i;function o(u){return u===""?"":c(Vg.posix.normalize(u))}r.normalize=o;function s(...u){return c(Vg.posix.resolve(...u))}r.resolve=s;function a(u,p){return c(Vg.posix.relative(u,p))}r.relative=a;function l(u){return u.length>0&&u.indexOf(".")!==0&&(u=`.${u}`),u}r.normalizeExtension=l;function c(u){return u.indexOf("/")===0&&(u=u.slice(1)),u}r.removeSlash=c})(kve=_x.PathExt||(_x.PathExt={}))});var BY=z(Ex=>{"use strict";d();Object.defineProperty(Ex,"__esModule",{value:!0});Ex.Text=void 0;var Nve;(function(r){let e=2>1;function t(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<s;c++){let u=a.charCodeAt(c);if(u>=55296&&u<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l--,c++)}}return l}r.jsIndexToCharIndex=t;function n(s,a){if(e)return s;let l=s;for(let c=0;c+1<a.length&&c<l;c++){let u=a.charCodeAt(c);if(u>=55296&&u<=56319){let p=a.charCodeAt(c+1);p>=56320&&p<=57343&&(l++,c++)}}return l}r.charIndexToJsIndex=n;function i(s,a=!1){return s.replace(/^(\w)|[\s-_:]+(\w)/g,function(l,c,u){return u?u.toUpperCase():a?c.toUpperCase():c.toLowerCase()})}r.camelCase=i;function o(s){return(s||"").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}r.titleCase=o})(Nve=Ex.Text||(Ex.Text={}))});var HY={};Um(HY,{default:()=>Rve});function Rve(r){return{formatNow:()=>{try{return r.toLocaleString()}catch(e){return`${r}`}},format:()=>{try{return r.toLocaleTimeString()}catch(e){return`${r}`}}}}var JY=ee(()=>{"use strict";d()});var qY=z(jg=>{"use strict";d();var Ave=jg&&jg.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(jg,"__esModule",{value:!0});jg.Time=void 0;var KW=Ave((JY(),sP(HY))),Mve;(function(r){function e(n){KW.default.locale(document.documentElement.lang);let i=KW.default(n).fromNow();return i=i==="a few seconds ago"?"seconds ago":i,i}r.formatHuman=e;function t(n,i="YYYY-MM-DD HH:mm"){return KW.default(n).format(i)}r.format=t})(Mve=jg.Time||(jg.Time={}))});var ds=z(us=>{"use strict";d();var Ove=us&&us.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Ff=us&&us.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ove(e,r,t)};Object.defineProperty(us,"__esModule",{value:!0});Ff(yY(),us);Ff(IY(),us);Ff(SY(),us);Ff(VY(),us);Ff(jY(),us);Ff(BY(),us);Ff(qY(),us);Ff(LW(),us)});var GY=z(Bg=>{"use strict";d();Object.defineProperty(Bg,"__esModule",{value:!0});Bg.ConfigWithDefaults=Bg.ConfigSection=void 0;var Lve=ds(),Cx=li(),Kve="api/config",Fve;(function(r){function e(t){let n=new FW(t);return n.load().then(()=>n)}r.create=e})(Fve=Bg.ConfigSection||(Bg.ConfigSection={}));var FW=class{constructor(e){var t;this._url="unknown";let n=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Cx.ServerConnection.makeSettings();this._url=Lve.URLExt.join(n.baseUrl,Kve,encodeURIComponent(e.name))}get data(){return this._data}async load(){let e=await Cx.ServerConnection.makeRequest(this._url,{},this.serverSettings);if(e.status!==200)throw await Cx.ServerConnection.ResponseError.create(e);this._data=await e.json()}async update(e){this._data=Object.assign(Object.assign({},this._data),e);let t={method:"PATCH",body:JSON.stringify(e)},n=await Cx.ServerConnection.makeRequest(this._url,t,this.serverSettings);if(n.status!==200)throw await Cx.ServerConnection.ResponseError.create(n);return this._data=await n.json(),this._data}},UW=class{constructor(e){var t,n;this._className="",this._section=e.section,this._defaults=(t=e.defaults)!==null&&t!==void 0?t:{},this._className=(n=e.className)!==null&&n!==void 0?n:""}get(e){let t=this._classData();return e in t?t[e]:this._defaults[e]}set(e,t){let n={};if(n[e]=t,this._className){let i={};return i[this._className]=n,this._section.update(i)}else return this._section.update(n)}_classData(){let e=this._section.data;return this._className&&this._className in e?e[this._className]:e}};Bg.ConfigWithDefaults=UW});var wx=z(iR=>{"use strict";d();Object.defineProperty(iR,"__esModule",{value:!0});iR.validateProperty=void 0;function Uve(r,e,t,n=[]){if(!r.hasOwnProperty(e))throw Error(`Missing property '${e}'`);let i=r[e];if(t!==void 0){let o=!0;switch(t){case"array":o=Array.isArray(i);break;case"object":o=typeof i!="undefined";break;default:o=typeof i===t}if(!o)throw new Error(`Property '${e}' is not of type '${t}'`);if(n.length>0){let s=!0;switch(t){case"string":case"number":case"boolean":s=n.includes(i);break;default:s=n.findIndex(a=>a===i)>=0;break}if(!s)throw new Error(`Property '${e}' is not one of the valid values ${JSON.stringify(n)}`)}}}iR.validateProperty=Uve});var YY=z(gI=>{"use strict";d();Object.defineProperty(gI,"__esModule",{value:!0});gI.validateCheckpointModel=gI.validateContentsModel=void 0;var Gc=wx();function Wve(r){Gc.validateProperty(r,"name","string"),Gc.validateProperty(r,"path","string"),Gc.validateProperty(r,"type","string"),Gc.validateProperty(r,"created","string"),Gc.validateProperty(r,"last_modified","string"),Gc.validateProperty(r,"mimetype","object"),Gc.validateProperty(r,"content","object"),Gc.validateProperty(r,"format","object")}gI.validateContentsModel=Wve;function Vve(r){Gc.validateProperty(r,"id","string"),Gc.validateProperty(r,"last_modified","string")}gI.validateCheckpointModel=Vve});var jW=z(Mo=>{"use strict";d();var jve=Mo&&Mo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Bve=Mo&&Mo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Hve=Mo&&Mo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&jve(e,r,t);return Bve(e,r),e};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.Drive=Mo.ContentsManager=Mo.Contents=void 0;var Os=ds(),Jve=Ug(),oR=Ki(),Cn=li(),Ld=Hve(YY()),qve="api/contents",Gve="files",Yve;(function(r){function e(n){Ld.validateContentsModel(n)}r.validateContentsModel=e;function t(n){Ld.validateCheckpointModel(n)}r.validateCheckpointModel=t})(Yve=Mo.Contents||(Mo.Contents={}));var WW=class{constructor(e={}){var t,n;this._isDisposed=!1,this._additionalDrives=new Map,this._fileChanged=new oR.Signal(this);let i=this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Cn.ServerConnection.makeSettings();this._defaultDrive=(n=e.defaultDrive)!==null&&n!==void 0?n:new sR({serverSettings:i}),this._defaultDrive.fileChanged.connect(this._onFileChanged,this)}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,oR.Signal.clearData(this))}addDrive(e){this._additionalDrives.set(e.name,e),e.fileChanged.connect(this._onFileChanged,this)}getModelDBFactory(e){var t;let[n]=this._driveForPath(e);return(t=n==null?void 0:n.modelDBFactory)!==null&&t!==void 0?t:null}localPath(e){let t=e.split("/"),n=t[0].split(":");return n.length===1||!this._additionalDrives.has(n[0])?Os.PathExt.removeSlash(e):Os.PathExt.join(n.slice(1).join(":"),...t.slice(1))}normalize(e){let t=e.split(":");return t.length===1?Os.PathExt.normalize(e):`${t[0]}:${Os.PathExt.normalize(t.slice(1).join(":"))}`}resolvePath(e,t){let n=this.driveName(e),i=this.localPath(e),o=Os.PathExt.resolve("/",i,t);return n?`${n}:${o}`:o}driveName(e){let n=e.split("/")[0].split(":");return n.length===1?"":this._additionalDrives.has(n[0])?n[0]:""}get(e,t){let[n,i]=this._driveForPath(e);return n.get(i,t).then(o=>{let s=[];return o.type==="directory"&&o.content?(Jve.each(o.content,a=>{s.push(Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}))}),Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i),content:s})):Object.assign(Object.assign({},o),{path:this._toGlobalPath(n,i)})})}getDownloadUrl(e){let[t,n]=this._driveForPath(e);return t.getDownloadUrl(n)}newUntitled(e={}){if(e.path){let t=this.normalize(e.path),[n,i]=this._driveForPath(t);return n.newUntitled(Object.assign(Object.assign({},e),{path:i})).then(o=>Object.assign(Object.assign({},o),{path:Os.PathExt.join(t,o.name)}))}else return this._defaultDrive.newUntitled(e)}delete(e){let[t,n]=this._driveForPath(e);return t.delete(n)}rename(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n!==o)throw Error("ContentsManager: renaming files must occur within a Drive");return n.rename(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,s)}))}save(e,t={}){let n=this.normalize(e),[i,o]=this._driveForPath(e);return i.save(o,Object.assign(Object.assign({},t),{path:o})).then(s=>Object.assign(Object.assign({},s),{path:n}))}copy(e,t){let[n,i]=this._driveForPath(e),[o,s]=this._driveForPath(t);if(n===o)return n.copy(i,s).then(a=>Object.assign(Object.assign({},a),{path:this._toGlobalPath(n,a.path)}));throw Error("Copying files between drives is not currently implemented")}createCheckpoint(e){let[t,n]=this._driveForPath(e);return t.createCheckpoint(n)}listCheckpoints(e){let[t,n]=this._driveForPath(e);return t.listCheckpoints(n)}restoreCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.restoreCheckpoint(i,t)}deleteCheckpoint(e,t){let[n,i]=this._driveForPath(e);return n.deleteCheckpoint(i,t)}_toGlobalPath(e,t){return e===this._defaultDrive?Os.PathExt.removeSlash(t):`${e.name}:${Os.PathExt.removeSlash(t)}`}_driveForPath(e){let t=this.driveName(e),n=this.localPath(e);return t?[this._additionalDrives.get(t),n]:[this._defaultDrive,n]}_onFileChanged(e,t){var n,i;if(e===this._defaultDrive)this._fileChanged.emit(t);else{let o=null,s=null;!((n=t.newValue)===null||n===void 0)&&n.path&&(o=Object.assign(Object.assign({},t.newValue),{path:this._toGlobalPath(e,t.newValue.path)})),!((i=t.oldValue)===null||i===void 0)&&i.path&&(s=Object.assign(Object.assign({},t.oldValue),{path:this._toGlobalPath(e,t.oldValue.path)})),this._fileChanged.emit({type:t.type,newValue:o,oldValue:s})}}};Mo.ContentsManager=WW;var sR=class{constructor(e={}){var t,n,i;this._isDisposed=!1,this._fileChanged=new oR.Signal(this),this.name=(t=e.name)!==null&&t!==void 0?t:"Default",this._apiEndpoint=(n=e.apiEndpoint)!==null&&n!==void 0?n:qve,this.serverSettings=(i=e.serverSettings)!==null&&i!==void 0?i:Cn.ServerConnection.makeSettings()}get fileChanged(){return this._fileChanged}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,oR.Signal.clearData(this))}async get(e,t){let n=this._getUrl(e);if(t){t.type==="notebook"&&delete t.format;let a=t.content?"1":"0",l=Object.assign(Object.assign({},t),{content:a});n+=Os.URLExt.objectToQueryString(l)}let i=this.serverSettings,o=await Cn.ServerConnection.makeRequest(n,{},i);if(o.status!==200)throw await Cn.ServerConnection.ResponseError.create(o);let s=await o.json();return Ld.validateContentsModel(s),s}getDownloadUrl(e){let t=this.serverSettings.baseUrl,n=Os.URLExt.join(t,Gve,Os.URLExt.encodeParts(e)),i=document.cookie.match("\\b_xsrf=([^;]*)\\b");if(i){let o=new URL(n);o.searchParams.append("_xsrf",i[1]),n=o.toString()}return Promise.resolve(n)}async newUntitled(e={}){var t;let n="{}";e&&(e.ext&&(e.ext=VW.normalizeExtension(e.ext)),n=JSON.stringify(e));let i=this.serverSettings,o=this._getUrl((t=e.path)!==null&&t!==void 0?t:""),s={method:"POST",body:n},a=await Cn.ServerConnection.makeRequest(o,s,i);if(a.status!==201)throw await Cn.ServerConnection.ResponseError.create(a);let l=await a.json();return Ld.validateContentsModel(l),this._fileChanged.emit({type:"new",oldValue:null,newValue:l}),l}async delete(e){let t=this._getUrl(e),n=this.serverSettings,i={method:"DELETE"},o=await Cn.ServerConnection.makeRequest(t,i,n);if(o.status!==204)throw await Cn.ServerConnection.ResponseError.create(o);this._fileChanged.emit({type:"delete",oldValue:{path:e},newValue:null})}async rename(e,t){let n=this.serverSettings,i=this._getUrl(e),o={method:"PATCH",body:JSON.stringify({path:t})},s=await Cn.ServerConnection.makeRequest(i,o,n);if(s.status!==200)throw await Cn.ServerConnection.ResponseError.create(s);let a=await s.json();return Ld.validateContentsModel(a),this._fileChanged.emit({type:"rename",oldValue:{path:e},newValue:a}),a}async save(e,t={}){let n=this.serverSettings,i=this._getUrl(e),o={method:"PUT",body:JSON.stringify(t)},s=await Cn.ServerConnection.makeRequest(i,o,n);if(s.status!==200&&s.status!==201)throw await Cn.ServerConnection.ResponseError.create(s);let a=await s.json();return Ld.validateContentsModel(a),this._fileChanged.emit({type:"save",oldValue:null,newValue:a}),a}async copy(e,t){let n=this.serverSettings,i=this._getUrl(t),o={method:"POST",body:JSON.stringify({copy_from:e})},s=await Cn.ServerConnection.makeRequest(i,o,n);if(s.status!==201)throw await Cn.ServerConnection.ResponseError.create(s);let a=await s.json();return Ld.validateContentsModel(a),this._fileChanged.emit({type:"new",oldValue:null,newValue:a}),a}async createCheckpoint(e){let t=this._getUrl(e,"checkpoints"),n={method:"POST"},i=await Cn.ServerConnection.makeRequest(t,n,this.serverSettings);if(i.status!==201)throw await Cn.ServerConnection.ResponseError.create(i);let o=await i.json();return Ld.validateCheckpointModel(o),o}async listCheckpoints(e){let t=this._getUrl(e,"checkpoints"),n=await Cn.ServerConnection.makeRequest(t,{},this.serverSettings);if(n.status!==200)throw await Cn.ServerConnection.ResponseError.create(n);let i=await n.json();if(!Array.isArray(i))throw new Error("Invalid Checkpoint list");for(let o=0;o<i.length;o++)Ld.validateCheckpointModel(i[o]);return i}async restoreCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"POST"},o=await Cn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await Cn.ServerConnection.ResponseError.create(o)}async deleteCheckpoint(e,t){let n=this._getUrl(e,"checkpoints",t),i={method:"DELETE"},o=await Cn.ServerConnection.makeRequest(n,i,this.serverSettings);if(o.status!==204)throw await Cn.ServerConnection.ResponseError.create(o)}_getUrl(...e){let t=e.map(i=>Os.URLExt.encodeParts(i)),n=this.serverSettings.baseUrl;return Os.URLExt.join(n,this._apiEndpoint,...t)}};Mo.Drive=sR;var VW;(function(r){function e(t){return t.length>0&&t.indexOf(".")!==0&&(t=`.${t}`),t}r.normalizeExtension=e})(VW||(VW={}))});var zY=z($Y=>{"use strict";d();Object.defineProperty($Y,"__esModule",{value:!0})});var xx=z(Mt=>{"use strict";d();Object.defineProperty(Mt,"__esModule",{value:!0});Mt.isInputReplyMsg=Mt.isInputRequestMsg=Mt.isDebugReplyMsg=Mt.isDebugRequestMsg=Mt.isExecuteReplyMsg=Mt.isInfoRequestMsg=Mt.isCommMsgMsg=Mt.isCommCloseMsg=Mt.isCommOpenMsg=Mt.isDebugEventMsg=Mt.isClearOutputMsg=Mt.isStatusMsg=Mt.isErrorMsg=Mt.isExecuteResultMsg=Mt.isExecuteInputMsg=Mt.isUpdateDisplayDataMsg=Mt.isDisplayDataMsg=Mt.isStreamMsg=Mt.createMessage=void 0;var $ve=Fl();function zve(r){var e,t,n,i,o;return{buffers:(e=r.buffers)!==null&&e!==void 0?e:[],channel:r.channel,content:r.content,header:{date:new Date().toISOString(),msg_id:(t=r.msgId)!==null&&t!==void 0?t:$ve.UUID.uuid4(),msg_type:r.msgType,session:r.session,username:(n=r.username)!==null&&n!==void 0?n:"",version:"5.2"},metadata:(i=r.metadata)!==null&&i!==void 0?i:{},parent_header:(o=r.parentHeader)!==null&&o!==void 0?o:{}}}Mt.createMessage=zve;function Qve(r){return r.header.msg_type==="stream"}Mt.isStreamMsg=Qve;function Xve(r){return r.header.msg_type==="display_data"}Mt.isDisplayDataMsg=Xve;function Zve(r){return r.header.msg_type==="update_display_data"}Mt.isUpdateDisplayDataMsg=Zve;function eye(r){return r.header.msg_type==="execute_input"}Mt.isExecuteInputMsg=eye;function tye(r){return r.header.msg_type==="execute_result"}Mt.isExecuteResultMsg=tye;function rye(r){return r.header.msg_type==="error"}Mt.isErrorMsg=rye;function nye(r){return r.header.msg_type==="status"}Mt.isStatusMsg=nye;function iye(r){return r.header.msg_type==="clear_output"}Mt.isClearOutputMsg=iye;function oye(r){return r.header.msg_type==="debug_event"}Mt.isDebugEventMsg=oye;function sye(r){return r.header.msg_type==="comm_open"}Mt.isCommOpenMsg=sye;function aye(r){return r.header.msg_type==="comm_close"}Mt.isCommCloseMsg=aye;function lye(r){return r.header.msg_type==="comm_msg"}Mt.isCommMsgMsg=lye;function cye(r){return r.header.msg_type==="kernel_info_request"}Mt.isInfoRequestMsg=cye;function uye(r){return r.header.msg_type==="execute_reply"}Mt.isExecuteReplyMsg=uye;function dye(r){return r.header.msg_type==="debug_request"}Mt.isDebugRequestMsg=dye;function pye(r){return r.header.msg_type==="debug_reply"}Mt.isDebugReplyMsg=pye;function fye(r){return r.header.msg_type==="input_request"}Mt.isInputRequestMsg=fye;function mye(r){return r.header.msg_type==="input_reply"}Mt.isInputReplyMsg=mye});var QY=z(()=>{d()});var XY=z(BW=>{"use strict";d();Object.defineProperty(BW,"__esModule",{value:!0});BW.default=WebSocket});var Ls=z(Uf=>{"use strict";d();var HW,JW,qW;Object.defineProperty(Uf,"__esModule",{value:!0});Uf.ServerConnection=void 0;var Hg=ds(),GW,YW,$W,zW;if(typeof window=="undefined"){let r=QY();GW=(HW=Uf.fetch)!==null&&HW!==void 0?HW:r,$W=(JW=Uf.Request)!==null&&JW!==void 0?JW:r.Request,YW=(qW=Uf.Headers)!==null&&qW!==void 0?qW:r.Headers,zW=XY()}else GW=fetch,$W=Request,YW=Headers,zW=WebSocket;var ZY;(function(r){function e(o){return aR.makeSettings(o)}r.makeSettings=e;function t(o,s,a){return aR.handleRequest(o,s,a)}r.makeRequest=t;class n extends Error{constructor(s,a=`Invalid response: ${s.status} ${s.statusText}`,l=""){super(a),this.response=s,this.traceback=l}static async create(s){try{let a=await s.json();return a.traceback&&console.error(a.traceback),a.message?new n(s,a.message):new n(s)}catch(a){return console.debug(a),new n(s)}}}r.ResponseError=n;class i extends TypeError{constructor(s){super(s.message),this.stack=s.stack}}r.NetworkError=i})(ZY=Uf.ServerConnection||(Uf.ServerConnection={}));var aR;(function(r){function e(i={}){let o=Hg.PageConfig.getBaseUrl(),s=Hg.PageConfig.getWsUrl(),a=Hg.URLExt.normalize(i.baseUrl)||o,l=i.wsUrl;return!l&&a===o&&(l=s),!l&&a.indexOf("http")===0&&(l="ws"+a.slice(4)),l=l!=null?l:s,Object.assign(Object.assign({init:{cache:"no-store",credentials:"same-origin"},fetch:GW,Headers:YW,Request:$W,WebSocket:zW,token:Hg.PageConfig.getToken(),appUrl:Hg.PageConfig.getOption("appUrl"),appendToken:typeof window=="undefined"||process.env.JEST_WORKER_ID!==void 0||Hg.URLExt.getHostName(o)!==Hg.URLExt.getHostName(l)},i),{baseUrl:a,wsUrl:l})}r.makeSettings=e;function t(i,o,s){var a;if(i.indexOf(s.baseUrl)!==0)throw new Error("Can only be used for notebook server requests");((a=o.cache)!==null&&a!==void 0?a:s.init.cache)==="no-store"&&(i+=(/\?/.test(i)?"&":"?")+new Date().getTime());let c=new s.Request(i,Object.assign(Object.assign({},s.init),o)),u=!1;if(s.token&&(u=!0,c.headers.append("Authorization",`token ${s.token}`)),typeof document!="undefined"&&(document!=null&&document.cookie)){let p=n("_xsrf");p!==void 0&&(u=!0,c.headers.append("X-XSRFToken",p))}return!c.headers.has("Content-Type")&&u&&c.headers.set("Content-Type","application/json"),s.fetch.call(null,c).catch(p=>{throw new ZY.NetworkError(p)})}r.handleRequest=t;function n(i){let o=document.cookie.match("\\b"+i+"=([^;]*)\\b");return o==null?void 0:o[1]}})(aR||(aR={}))});var lR=z(Wf=>{"use strict";d();Object.defineProperty(Wf,"__esModule",{value:!0});Wf.validateModels=Wf.validateModel=Wf.validateMessage=void 0;var Jg=wx(),e$=["username","version","session","msg_id","msg_type"],hye={stream:{name:"string",text:"string"},display_data:{data:"object",metadata:"object"},execute_input:{code:"string",execution_count:"number"},execute_result:{execution_count:"number",data:"object",metadata:"object"},error:{ename:"string",evalue:"string",traceback:"object"},status:{execution_state:["string",["starting","idle","busy","restarting","dead"]]},clear_output:{wait:"boolean"},comm_open:{comm_id:"string",target_name:"string",data:"object"},comm_msg:{comm_id:"string",data:"object"},comm_close:{comm_id:"string"},shutdown_reply:{restart:"boolean"}};function gye(r){for(let e=0;e<e$.length;e++)Jg.validateProperty(r,e$[e],"string")}function vye(r){Jg.validateProperty(r,"metadata","object"),Jg.validateProperty(r,"content","object"),Jg.validateProperty(r,"channel","string"),gye(r.header),r.channel==="iopub"&&yye(r)}Wf.validateMessage=vye;function yye(r){if(r.channel==="iopub"){let e=hye[r.header.msg_type];if(e===void 0)return;let t=Object.keys(e),n=r.content;for(let i=0;i<t.length;i++){let o=e[t[i]];Array.isArray(o)||(o=[o]),Jg.validateProperty(n,t[i],...o)}}}function t$(r){Jg.validateProperty(r,"name","string"),Jg.validateProperty(r,"id","string")}Wf.validateModel=t$;function bye(r){if(!Array.isArray(r))throw new Error("Invalid kernel list");r.forEach(e=>t$(e))}Wf.validateModels=bye});var uR=z(wn=>{"use strict";d();Object.defineProperty(wn,"__esModule",{value:!0});wn.getKernelModel=wn.shutdownKernel=wn.interruptKernel=wn.restartKernel=wn.startNew=wn.listRunning=wn.KERNEL_SERVICE_URL=void 0;var Ci=Ls(),vI=ds(),cR=lR();wn.KERNEL_SERVICE_URL="api/kernels";async function Iye(r=Ci.ServerConnection.makeSettings()){let e=vI.URLExt.join(r.baseUrl,wn.KERNEL_SERVICE_URL),t=await Ci.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Ci.ServerConnection.ResponseError.create(t);let n=await t.json();return cR.validateModels(n),n}wn.listRunning=Iye;async function Sye(r={},e=Ci.ServerConnection.makeSettings()){let t=vI.URLExt.join(e.baseUrl,wn.KERNEL_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await Ci.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await Ci.ServerConnection.ResponseError.create(i);let o=await i.json();return cR.validateModel(o),o}wn.startNew=Sye;async function _ye(r,e=Ci.ServerConnection.makeSettings()){let t=vI.URLExt.join(e.baseUrl,wn.KERNEL_SERVICE_URL,encodeURIComponent(r),"restart"),n={method:"POST"},i=await Ci.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await Ci.ServerConnection.ResponseError.create(i);let o=await i.json();cR.validateModel(o)}wn.restartKernel=_ye;async function Eye(r,e=Ci.ServerConnection.makeSettings()){let t=vI.URLExt.join(e.baseUrl,wn.KERNEL_SERVICE_URL,encodeURIComponent(r),"interrupt"),n={method:"POST"},i=await Ci.ServerConnection.makeRequest(t,n,e);if(i.status!==204)throw await Ci.ServerConnection.ResponseError.create(i)}wn.interruptKernel=Eye;async function Cye(r,e=Ci.ServerConnection.makeSettings()){let t=vI.URLExt.join(e.baseUrl,wn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n={method:"DELETE"},i=await Ci.ServerConnection.makeRequest(t,n,e);if(i.status===404){let o=`The kernel "${r}" does not exist on the server`;console.warn(o)}else if(i.status!==204)throw await Ci.ServerConnection.ResponseError.create(i)}wn.shutdownKernel=Cye;async function wye(r,e=Ci.ServerConnection.makeSettings()){let t=vI.URLExt.join(e.baseUrl,wn.KERNEL_SERVICE_URL,encodeURIComponent(r)),n=await Ci.ServerConnection.makeRequest(t,{},e);if(n.status===404)return;if(n.status!==200)throw await Ci.ServerConnection.ResponseError.create(n);let i=await n.json();return cR.validateModel(i),i}wn.getKernelModel=wye});var Dx=z((dR,r$)=>{d();(function(r,e){typeof dR=="object"&&typeof r$!="undefined"?e(dR,Fl(),Ki()):typeof define=="function"&&define.amd?define(["exports","@lumino/coreutils","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_polling={},r.lumino_coreutils,r.lumino_signaling))})(dR,function(r,e,t){"use strict";var n=function(h,g){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,S){v.__proto__=S}||function(v,S){for(var _ in S)Object.prototype.hasOwnProperty.call(S,_)&&(v[_]=S[_])},n(h,g)};function i(h,g){if(typeof g!="function"&&g!==null)throw new TypeError("Class extends value "+String(g)+" is not a constructor or null");n(h,g);function v(){this.constructor=h}h.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}var o=function(){return o=Object.assign||function(g){for(var v,S=1,_=arguments.length;S<_;S++){v=arguments[S];for(var D in v)Object.prototype.hasOwnProperty.call(v,D)&&(g[D]=v[D])}return g},o.apply(this,arguments)};function s(h,g,v,S){function _(D){return D instanceof v?D:new v(function(P){P(D)})}return new(v||(v=Promise))(function(D,P){function M(j){try{A(S.next(j))}catch(re){P(re)}}function x(j){try{A(S.throw(j))}catch(re){P(re)}}function A(j){j.done?D(j.value):_(j.value).then(M,x)}A((S=S.apply(h,g||[])).next())})}function a(h,g){var v={label:0,sent:function(){if(D[0]&1)throw D[1];return D[1]},trys:[],ops:[]},S,_,D,P;return P={next:M(0),throw:M(1),return:M(2)},typeof Symbol=="function"&&(P[Symbol.iterator]=function(){return this}),P;function M(A){return function(j){return x([A,j])}}function x(A){if(S)throw new TypeError("Generator is already executing.");for(;v;)try{if(S=1,_&&(D=A[0]&2?_.return:A[0]?_.throw||((D=_.return)&&D.call(_),0):_.next)&&!(D=D.call(_,A[1])).done)return D;switch(_=0,D&&(A=[A[0]&2,D.value]),A[0]){case 0:case 1:D=A;break;case 4:return v.label++,{value:A[1],done:!1};case 5:v.label++,_=A[1],A=[0];continue;case 7:A=v.ops.pop(),v.trys.pop();continue;default:if(D=v.trys,!(D=D.length>0&&D[D.length-1])&&(A[0]===6||A[0]===2)){v=0;continue}if(A[0]===3&&(!D||A[1]>D[0]&&A[1]<D[3])){v.label=A[1];break}if(A[0]===6&&v.label<D[1]){v.label=D[1],D=A;break}if(D&&v.label<D[2]){v.label=D[2],v.ops.push(A);break}D[2]&&v.ops.pop(),v.trys.pop();continue}A=g.call(h,v)}catch(j){A=[6,j],_=0}finally{S=D=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}var l=typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate,c=typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearImmediate;r.Poll=function(){function h(g){var v=this;this._disposed=new t.Signal(this),this._tick=new e.PromiseDelegate,this._ticked=new t.Signal(this),this._timeout=-1,this._factory=g.factory,this._standby=g.standby||u.DEFAULT_STANDBY,this._state=o(o({},u.DEFAULT_STATE),{timestamp:new Date().getTime()});var S=g.frequency||{},_=Math.max(S.interval||0,S.max||0,u.DEFAULT_FREQUENCY.max);this.frequency=o(o(o({},u.DEFAULT_FREQUENCY),S),{max:_}),this.name=g.name||u.DEFAULT_NAME,(!("auto"in g)||g.auto)&&l(function(){return void v.start()})}return Object.defineProperty(h.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"frequency",{get:function(){return this._frequency},set:function(g){if(!(this.isDisposed||e.JSONExt.deepEqual(g,this.frequency||{}))){var v=g.backoff,S=g.interval,_=g.max;if(S=Math.round(S),_=Math.round(_),typeof v=="number"&&v<1)throw new Error("Poll backoff growth factor must be at least 1");if((S<0||S>_)&&S!==h.NEVER)throw new Error("Poll interval must be between 0 and max");if(_>h.MAX_INTERVAL&&_!==h.NEVER)throw new Error("Max interval must be less than "+h.MAX_INTERVAL);this._frequency={backoff:v,interval:S,max:_}}},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isDisposed",{get:function(){return this.state.phase==="disposed"},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"standby",{get:function(){return this._standby},set:function(g){this.isDisposed||this.standby===g||(this._standby=g)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"tick",{get:function(){return this._tick.promise},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"ticked",{get:function(){return this._ticked},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this.isDisposed||(this._state=o(o({},u.DISPOSED_STATE),{timestamp:new Date().getTime()}),this._tick.promise.catch(function(g){}),this._tick.reject(new Error("Poll ("+this.name+") is disposed.")),this._disposed.emit(void 0),t.Signal.clearData(this))},h.prototype.refresh=function(){return this.schedule({cancel:function(g){var v=g.phase;return v==="refreshed"},interval:h.IMMEDIATE,phase:"refreshed"})},h.prototype.schedule=function(g){return g===void 0&&(g={}),s(this,void 0,void 0,function(){var v,S,_,D,P,M=this;return a(this,function(x){switch(x.label){case 0:return this.isDisposed?[2]:g.cancel&&g.cancel(this.state)?[2]:(v=this.state,S=this._tick,_=new e.PromiseDelegate,D=o({interval:this.frequency.interval,payload:null,phase:"standby",timestamp:new Date().getTime()},g),this._state=D,this._tick=_,v.interval===h.IMMEDIATE?c(this._timeout):clearTimeout(this._timeout),this._ticked.emit(this.state),S.resolve(this),[4,S.promise]);case 1:return x.sent(),P=function(){M.isDisposed||M.tick!==_.promise||M._execute()},this._timeout=D.interval===h.IMMEDIATE?l(P):D.interval===h.NEVER?-1:setTimeout(P,D.interval),[2]}})})},h.prototype.start=function(){return this.schedule({cancel:function(g){var v=g.phase;return v!=="constructed"&&v!=="standby"&&v!=="stopped"},interval:h.IMMEDIATE,phase:"started"})},h.prototype.stop=function(){return this.schedule({cancel:function(g){var v=g.phase;return v==="stopped"},interval:h.NEVER,phase:"stopped"})},h.prototype._execute=function(){var g=this,v=typeof this.standby=="function"?this.standby():this.standby;if(v=v==="never"?!1:v==="when-hidden"?!!(typeof document!="undefined"&&document&&document.hidden):v,v){this.schedule();return}var S=this.tick;this._factory(this.state).then(function(_){g.isDisposed||g.tick!==S||g.schedule({payload:_,phase:g.state.phase==="rejected"?"reconnected":"resolved"})}).catch(function(_){g.isDisposed||g.tick!==S||g.schedule({interval:u.sleep(g.frequency,g.state),payload:_,phase:"rejected"})})},h}(),function(h){h.IMMEDIATE=0,h.MAX_INTERVAL=2147483647,h.NEVER=1/0}(r.Poll||(r.Poll={}));var u;(function(h){h.DEFAULT_BACKOFF=3,h.DEFAULT_FREQUENCY={backoff:!0,interval:1e3,max:30*1e3},h.DEFAULT_NAME="unknown",h.DEFAULT_STANDBY="when-hidden",h.DEFAULT_STATE={interval:r.Poll.NEVER,payload:null,phase:"constructed",timestamp:new Date(0).getTime()},h.DISPOSED_STATE={interval:r.Poll.NEVER,payload:null,phase:"disposed",timestamp:new Date(0).getTime()};function g(S,_){return S=Math.ceil(S),_=Math.floor(_),Math.floor(Math.random()*(_-S+1))+S}function v(S,_){var D=S.backoff,P=S.interval,M=S.max;if(P===r.Poll.NEVER)return P;var x=D===!0?h.DEFAULT_BACKOFF:D===!1?1:D,A=g(P,_.interval*x);return Math.min(M,A)}h.sleep=v})(u||(u={}));var p=function(){function h(g,v){var S=this;v===void 0&&(v=500),this.payload=null,this.limit=v,this.poll=new r.Poll({auto:!1,factory:function(){return s(S,void 0,void 0,function(){return a(this,function(_){switch(_.label){case 0:return[4,g()];case 1:return[2,_.sent()]}})})},frequency:{backoff:!1,interval:r.Poll.NEVER,max:r.Poll.NEVER},standby:"never"}),this.payload=new e.PromiseDelegate,this.poll.ticked.connect(function(_,D){var P=S.payload;if(D.phase==="resolved"){S.payload=new e.PromiseDelegate,P.resolve(D.payload);return}if(D.phase==="rejected"||D.phase==="stopped"){S.payload=new e.PromiseDelegate,P.promise.catch(function(M){}),P.reject(D.payload);return}},this)}return Object.defineProperty(h.prototype,"isDisposed",{get:function(){return this.payload===null},enumerable:!0,configurable:!0}),h.prototype.dispose=function(){this.isDisposed||(this.payload=null,this.poll.dispose())},h.prototype.stop=function(){return s(this,void 0,void 0,function(){return a(this,function(g){return[2,this.poll.stop()]})})},h}(),f=function(h){i(g,h);function g(){return h!==null&&h.apply(this,arguments)||this}return g.prototype.invoke=function(){return this.poll.schedule({interval:this.limit,phase:"invoked"}),this.payload.promise},g}(p),m=function(h){i(g,h);function g(v,S){var _=h.call(this,v,typeof S=="number"?S:S&&S.limit)||this,D="leading";return typeof S!="number"&&(S=S||{},D="edge"in S?S.edge:D),_._interval=D==="trailing"?_.limit:r.Poll.IMMEDIATE,_}return g.prototype.invoke=function(){return this.poll.state.phase!=="invoked"&&this.poll.schedule({interval:this._interval,phase:"invoked"}),this.payload.promise},g}(p);r.Debouncer=f,r.RateLimiter=p,r.Throttler=m,Object.defineProperty(r,"__esModule",{value:!0})})});var Px=z(pR=>{"use strict";d();Object.defineProperty(pR,"__esModule",{value:!0});pR.BaseManager=void 0;var n$=Ki(),xye=Ls(),QW=class{constructor(e){var t;this._isDisposed=!1,this._disposed=new n$.Signal(this),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:xye.ServerConnection.makeSettings()}get disposed(){return this._disposed}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._disposed.emit(void 0),n$.Signal.clearData(this))}};pR.BaseManager=QW});var XW=z((fR,i$)=>{d();(function(r,e){typeof fR=="object"&&typeof i$!="undefined"?e(fR,Ug(),Ki()):typeof define=="function"&&define.amd?define(["exports","@lumino/algorithm","@lumino/signaling"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.lumino_disposable={},r.lumino_algorithm,r.lumino_signaling))})(fR,function(r,e,t){"use strict";var n=function(a,l){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,u){c.__proto__=u}||function(c,u){for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&(c[p]=u[p])},n(a,l)};function i(a,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");n(a,l);function c(){this.constructor=a}a.prototype=l===null?Object.create(l):(c.prototype=l.prototype,new c)}var o=function(){function a(l){this._fn=l}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return!this._fn},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){if(this._fn){var l=this._fn;this._fn=null,l()}},a}(),s=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(o);r.DisposableSet=function(){function a(){this._isDisposed=!1,this._items=new Set}return Object.defineProperty(a.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!0,configurable:!0}),a.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this._items.forEach(function(l){l.dispose()}),this._items.clear())},a.prototype.contains=function(l){return this._items.has(l)},a.prototype.add=function(l){this._items.add(l)},a.prototype.remove=function(l){this._items.delete(l)},a.prototype.clear=function(){this._items.clear()},a}(),function(a){function l(c){var u=new a;return e.each(c,function(p){u.add(p)}),u}a.from=l}(r.DisposableSet||(r.DisposableSet={})),r.ObservableDisposableSet=function(a){i(l,a);function l(){var c=a!==null&&a.apply(this,arguments)||this;return c._disposed=new t.Signal(c),c}return Object.defineProperty(l.prototype,"disposed",{get:function(){return this._disposed},enumerable:!0,configurable:!0}),l.prototype.dispose=function(){this.isDisposed||(a.prototype.dispose.call(this),this._disposed.emit(void 0),t.Signal.clearData(this))},l}(r.DisposableSet),function(a){function l(c){var u=new a;return e.each(c,function(p){u.add(p)}),u}a.from=l}(r.ObservableDisposableSet||(r.ObservableDisposableSet={})),r.DisposableDelegate=o,r.ObservableDisposableDelegate=s,Object.defineProperty(r,"__esModule",{value:!0})})});var o$=z(Yc=>{"use strict";d();var Dye=Yc&&Yc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Pye=Yc&&Yc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Tye=Yc&&Yc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Dye(e,r,t);return Pye(e,r),e};Object.defineProperty(Yc,"__esModule",{value:!0});Yc.CommHandler=void 0;var kye=XW(),mR=Tye(xx()),ZW=class extends kye.DisposableDelegate{constructor(e,t,n,i){super(i),this._target="",this._id="",this._id=t,this._target=e,this._kernel=n}get commId(){return this._id}get targetName(){return this._target}get onClose(){return this._onClose}set onClose(e){this._onClose=e}get onMsg(){return this._onMsg}set onMsg(e){this._onMsg=e}open(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot open");let i=mR.createMessage({msgType:"comm_open",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,target_name:this._target,data:e!=null?e:{}},metadata:t,buffers:n});return this._kernel.sendShellMessage(i,!1,!0)}send(e,t,n=[],i=!0){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot send");let o=mR.createMessage({msgType:"comm_msg",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e},metadata:t,buffers:n});return this._kernel.sendShellMessage(o,!1,i)}close(e,t,n=[]){if(this.isDisposed||this._kernel.isDisposed)throw new Error("Cannot close");let i=mR.createMessage({msgType:"comm_close",channel:"shell",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n}),o=this._kernel.sendShellMessage(i,!1,!0),s=this._onClose;if(s){let a=mR.createMessage({msgType:"comm_close",channel:"iopub",username:this._kernel.username,session:this._kernel.clientId,content:{comm_id:this._id,data:e!=null?e:{}},metadata:t,buffers:n});s(a)}return this.dispose(),o}};Yc.CommHandler=ZW});var a$=z(ps=>{"use strict";d();var Nye=ps&&ps.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rye=ps&&ps.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Aye=ps&&ps.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Nye(e,r,t);return Rye(e,r),e};Object.defineProperty(ps,"__esModule",{value:!0});ps.KernelShellFutureHandler=ps.KernelControlFutureHandler=ps.KernelFutureHandler=void 0;var s$=Fl(),Mye=XW(),Oye=Aye(xx()),Tx=class extends Mye.DisposableDelegate{constructor(e,t,n,i,o){super(e),this._status=0,this._stdin=Fi.noOp,this._iopub=Fi.noOp,this._reply=Fi.noOp,this._done=new s$.PromiseDelegate,this._hooks=new Fi.HookList,this._disposeOnDone=!0,this._msg=t,n||this._setFlag(Fi.KernelFutureFlag.GotReply),this._disposeOnDone=i,this._kernel=o}get msg(){return this._msg}get done(){return this._done.promise}get onReply(){return this._reply}set onReply(e){this._reply=e}get onIOPub(){return this._iopub}set onIOPub(e){this._iopub=e}get onStdin(){return this._stdin}set onStdin(e){this._stdin=e}registerMessageHook(e){if(this.isDisposed)throw new Error("Kernel future is disposed");this._hooks.add(e)}removeMessageHook(e){this.isDisposed||this._hooks.remove(e)}sendInputReply(e){this._kernel.sendInputReply(e)}dispose(){this._stdin=Fi.noOp,this._iopub=Fi.noOp,this._reply=Fi.noOp,this._hooks=null,this._testFlag(Fi.KernelFutureFlag.IsDone)||(this._done.promise.catch(()=>{}),this._done.reject(new Error(`Canceled future for ${this.msg.header.msg_type} message before replies were done`))),super.dispose()}async handleMsg(e){switch(e.channel){case"control":case"shell":e.channel===this.msg.channel&&e.parent_header.msg_id===this.msg.header.msg_id&&await this._handleReply(e);break;case"stdin":await this._handleStdin(e);break;case"iopub":await this._handleIOPub(e);break;default:break}}async _handleReply(e){let t=this._reply;t&&await t(e),this._replyMsg=e,this._setFlag(Fi.KernelFutureFlag.GotReply),this._testFlag(Fi.KernelFutureFlag.GotIdle)&&this._handleDone()}async _handleStdin(e){let t=this._stdin;t&&await t(e)}async _handleIOPub(e){let t=await this._hooks.process(e),n=this._iopub;t&&n&&await n(e),Oye.isStatusMsg(e)&&e.content.execution_state==="idle"&&(this._setFlag(Fi.KernelFutureFlag.GotIdle),this._testFlag(Fi.KernelFutureFlag.GotReply)&&this._handleDone())}_handleDone(){this._testFlag(Fi.KernelFutureFlag.IsDone)||(this._setFlag(Fi.KernelFutureFlag.IsDone),this._done.resolve(this._replyMsg),this._disposeOnDone&&this.dispose())}_testFlag(e){return(this._status&e)!==0}_setFlag(e){this._status|=e}};ps.KernelFutureHandler=Tx;var eV=class extends Tx{};ps.KernelControlFutureHandler=eV;var tV=class extends Tx{};ps.KernelShellFutureHandler=tV;var Fi;(function(r){r.noOp=()=>{};let e=(()=>typeof requestAnimationFrame=="function"?requestAnimationFrame:setImmediate)();class t{constructor(){this._hooks=[]}add(o){this.remove(o),this._hooks.push(o)}remove(o){let s=this._hooks.indexOf(o);s>=0&&(this._hooks[s]=null,this._scheduleCompact())}async process(o){await this._processing;let s=new s$.PromiseDelegate;this._processing=s.promise;let a;for(let l=this._hooks.length-1;l>=0;l--){let c=this._hooks[l];if(c!==null){try{a=await c(o)}catch(u){a=!0,console.error(u)}if(a===!1)return s.resolve(void 0),!1}}return s.resolve(void 0),!0}_scheduleCompact(){this._compactScheduled||(this._compactScheduled=!0,e(()=>{this._processing=this._processing.then(()=>{this._compactScheduled=!1,this._compact()})}))}_compact(){let o=0;for(let s=0,a=this._hooks.length;s<a;s++){let l=this._hooks[s];this._hooks[s]===null?o++:this._hooks[s-o]=l}this._hooks.length-=o}}r.HookList=t;let n;(function(i){i[i.GotReply=1]="GotReply",i[i.GotIdle=2]="GotIdle",i[i.IsDone=4]="IsDone",i[i.DisposeOnDone=8]="DisposeOnDone"})(n=r.KernelFutureFlag||(r.KernelFutureFlag={}))})(Fi||(Fi={}))});var rV=z(yI=>{"use strict";d();Object.defineProperty(yI,"__esModule",{value:!0});yI.serialize=yI.deserialize=void 0;function Lye(r){let e;return typeof r=="string"?e=JSON.parse(r):e=Fye(r),e}yI.deserialize=Lye;function Kye(r){var e;let t;return!((e=r.buffers)===null||e===void 0)&&e.length?t=Uye(r):t=JSON.stringify(r),t}yI.serialize=Kye;function Fye(r){let e=new DataView(r),t=e.getUint32(0),n=[];if(t<2)throw new Error("Invalid incoming Kernel Message");for(let s=1;s<=t;s++)n.push(e.getUint32(s*4));let i=new Uint8Array(r.slice(n[0],n[1])),o=JSON.parse(new TextDecoder("utf8").decode(i));o.buffers=[];for(let s=1;s<t;s++){let a=n[s],l=n[s+1]||r.byteLength;o.buffers.push(new DataView(r.slice(a,l)))}return o}function Uye(r){let e=[],t=[],n=new TextEncoder,i=[];r.buffers!==void 0&&(i=r.buffers,delete r.buffers);let o=n.encode(JSON.stringify(r));t.push(o.buffer);for(let c=0;c<i.length;c++){let u=i[c];t.push(ArrayBuffer.isView(u)?u.buffer:u)}let s=t.length;e.push(4*(s+1));for(let c=0;c+1<t.length;c++)e.push(e[e.length-1]+t[c].byteLength);let a=new Uint8Array(e[e.length-1]+t[t.length-1].byteLength),l=new DataView(a.buffer);l.setUint32(0,s);for(let c=0;c<e.length;c++)l.setUint32(4*(c+1),e[c]);for(let c=0;c<t.length;c++)a.set(new Uint8Array(t[c]),e[c]);return a.buffer}});var c$=z(l$=>{"use strict";d();Object.defineProperty(l$,"__esModule",{value:!0})});var d$=z(bI=>{"use strict";d();Object.defineProperty(bI,"__esModule",{value:!0});bI.validateSpecModels=bI.validateSpecModel=void 0;var qg=wx();function u$(r){let e=r.spec;if(!e)throw new Error("Invalid kernel spec");qg.validateProperty(r,"name","string"),qg.validateProperty(r,"resources","object"),qg.validateProperty(e,"language","string"),qg.validateProperty(e,"display_name","string"),qg.validateProperty(e,"argv","array");let t=null;e.hasOwnProperty("metadata")&&(qg.validateProperty(e,"metadata","object"),t=e.metadata);let n=null;return e.hasOwnProperty("env")&&(qg.validateProperty(e,"env","object"),n=e.env),{name:r.name,resources:r.resources,language:e.language,display_name:e.display_name,argv:e.argv,metadata:t,env:n}}bI.validateSpecModel=u$;function Wye(r){if(!r.hasOwnProperty("kernelspecs"))throw new Error("No kernelspecs found");let e=Object.keys(r.kernelspecs),t=Object.create(null),n=r.default;for(let i=0;i<e.length;i++){let o=r.kernelspecs[e[i]];try{t[e[i]]=u$(o)}catch(s){console.warn(`Removing errant kernel spec: ${e[i]}`)}}if(e=Object.keys(t),!e.length)throw new Error("No valid kernelspecs found");return(!n||typeof n!="string"||!(n in t))&&(n=e[0],console.warn(`Default kernel not found, using '${e[0]}'`)),{default:n,kernelspecs:t}}bI.validateSpecModels=Wye});var iV=z(hR=>{"use strict";d();Object.defineProperty(hR,"__esModule",{value:!0});hR.getSpecs=void 0;var nV=Ls(),Vye=d$(),jye=ds(),Bye="api/kernelspecs";async function Hye(r=nV.ServerConnection.makeSettings()){let e=jye.URLExt.join(r.baseUrl,Bye),t=await nV.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await nV.ServerConnection.ResponseError.create(t);let n=await t.json();return Vye.validateSpecModels(n)}hR.getSpecs=Hye});var f$=z($c=>{"use strict";d();var Jye=$c&&$c.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),qye=$c&&$c.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Gye=$c&&$c.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jye(e,r,t);return qye(e,r),e};Object.defineProperty($c,"__esModule",{value:!0});$c.KernelSpecManager=void 0;var Yye=Fl(),$ye=Dx(),p$=Ki(),zye=Gye(iV()),Qye=Px(),oV=class extends Qye.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._connectionFailure=new p$.Signal(this),this._specs=null,this._specsChanged=new p$.Signal(this),this._ready=Promise.all([this.requestSpecs()]).then(n=>{}).catch(n=>{}).then(()=>{this.isDisposed||(this._isReady=!0)}),this._pollSpecs=new $ye.Poll({auto:!1,factory:()=>this.requestSpecs(),frequency:{interval:61*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelSpecManager#specs",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this.ready.then(()=>{this._pollSpecs.start()})}get isReady(){return this._isReady}get ready(){return this._ready}get specs(){return this._specs}get specsChanged(){return this._specsChanged}get connectionFailure(){return this._connectionFailure}dispose(){this._pollSpecs.dispose(),super.dispose()}async refreshSpecs(){await this._pollSpecs.refresh(),await this._pollSpecs.tick}async requestSpecs(){let e=await zye.getSpecs(this.serverSettings);this.isDisposed||Yye.JSONExt.deepEqual(e,this._specs)||(this._specs=e,this._specsChanged.emit(e))}};$c.KernelSpecManager=oV});var gR=z(Oo=>{"use strict";d();var m$=Oo&&Oo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Xye=Oo&&Oo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),h$=Oo&&Oo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&m$(e,r,t);return Xye(e,r),e},Zye=Oo&&Oo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&m$(e,r,t)};Object.defineProperty(Oo,"__esModule",{value:!0});Oo.KernelSpecAPI=Oo.KernelSpec=void 0;var ebe=h$(c$());Oo.KernelSpec=ebe;var tbe=h$(iV());Oo.KernelSpecAPI=tbe;Zye(f$(),Oo)});var b$=z(zc=>{"use strict";d();var rbe=zc&&zc.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nbe=zc&&zc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yR=zc&&zc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rbe(e,r,t);return nbe(e,r),e};Object.defineProperty(zc,"__esModule",{value:!0});zc.KernelConnection=void 0;var g$=ds(),Vf=Fl(),Gg=Ki(),ibe=li(),v$=o$(),Ks=yR(xx()),y$=a$(),sV=yR(rV()),obe=yR(lR()),sbe=gR(),vR=yR(uR()),abe=3e3,II="_RESTARTING_",lbe="",aV=class r{constructor(e){var t,n,i,o;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let s=this.serverSettings,a=g$.URLExt.join(s.wsUrl,vR.KERNEL_SERVICE_URL,encodeURIComponent(this._id)),l=a.replace(/^((?:\w+:)?\/\/)(?:[^@\/]+@)/,"$1"),c=g$.URLExt.join(a,"channels?session_id="+encodeURIComponent(this._clientId)),u=s.token;s.appendToken&&u!==""&&(c=c+`&token=${encodeURIComponent(u)}`),this._ws=new s.WebSocket(c),this._ws.binaryType="arraybuffer",this._ws.onmessage=this._onWSMessage,this._ws.onopen=this._onWSOpen,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSOpen=s=>{this._updateConnectionStatus("connected")},this._onWSMessage=s=>{let a;try{a=sV.deserialize(s.data),obe.validateMessage(a)}catch(l){throw l.message=`Kernel message validation error: ${l.message}`,l}this._kernelSession=a.header.session,this._msgChain=this._msgChain.then(()=>this._handleMessage(a)).catch(l=>{l.message.startsWith("Canceled future for ")&&console.error(l)}),this._anyMessage.emit({msg:a,direction:"recv"})},this._onWSClose=s=>{this.isDisposed||this._reconnect()},this._id="",this._name="",this._status="unknown",this._connectionStatus="connecting",this._kernelSession="",this._isDisposed=!1,this._ws=null,this._username="",this._reconnectLimit=7,this._reconnectAttempt=0,this._reconnectTimeout=null,this._futures=new Map,this._comms=new Map,this._targetRegistry=Object.create(null),this._info=new Vf.PromiseDelegate,this._pendingMessages=[],this._statusChanged=new Gg.Signal(this),this._connectionStatusChanged=new Gg.Signal(this),this._disposed=new Gg.Signal(this),this._iopubMessage=new Gg.Signal(this),this._anyMessage=new Gg.Signal(this),this._unhandledMessage=new Gg.Signal(this),this._displayIdToParentIds=new Map,this._msgIdToDisplayIds=new Map,this._msgChain=Promise.resolve(),this._noOp=()=>{},this._name=e.model.name,this._id=e.model.id,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:ibe.ServerConnection.makeSettings(),this._clientId=(n=e.clientId)!==null&&n!==void 0?n:Vf.UUID.uuid4(),this._username=(i=e.username)!==null&&i!==void 0?i:"",this.handleComms=(o=e.handleComms)!==null&&o!==void 0?o:!0,this._createSocket()}get disposed(){return this._disposed}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get model(){return{id:this.id,name:this.name}}get anyMessage(){return this._anyMessage}get id(){return this._id}get name(){return this._name}get username(){return this._username}get clientId(){return this._clientId}get status(){return this._status}get connectionStatus(){return this._connectionStatus}get isDisposed(){return this._isDisposed}get info(){return this._info.promise}get spec(){return this._specPromise?this._specPromise:(this._specPromise=sbe.KernelSpecAPI.getSpecs(this.serverSettings).then(e=>e.kernelspecs[this._name]),this._specPromise)}clone(e={}){return new r(Object.assign({model:this.model,username:this.username,serverSettings:this.serverSettings,handleComms:!1},e))}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearKernelState(),this._pendingMessages=[],this._clearSocket(),Gg.Signal.clearData(this))}sendShellMessage(e,t=!1,n=!0){return this._sendKernelShellControl(y$.KernelShellFutureHandler,e,t,n)}sendControlMessage(e,t=!1,n=!0){return this._sendKernelShellControl(y$.KernelControlFutureHandler,e,t,n)}_sendKernelShellControl(e,t,n=!1,i=!0){this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"});let o=new e(()=>{let s=t.header.msg_id;this._futures.delete(s);let a=this._msgIdToDisplayIds.get(s);a&&(a.forEach(l=>{let c=this._displayIdToParentIds.get(l);if(c){let u=c.indexOf(s);if(u===-1)return;c.length===1?this._displayIdToParentIds.delete(l):(c.splice(u,1),this._displayIdToParentIds.set(l,c))}}),this._msgIdToDisplayIds.delete(s))},t,n,i,this);return this._futures.set(t.header.msg_id,o),o}_sendMessage(e,t=!0){if(this.status==="dead")throw new Error("Kernel is dead");if((this._kernelSession===lbe||this._kernelSession===II)&&Ks.isInfoRequestMsg(e))if(this.connectionStatus==="connected"){this._ws.send(sV.serialize(e));return}else throw new Error("Could not send message: status is not connected");if(t&&this._pendingMessages.length>0){this._pendingMessages.push(e);return}if(this.connectionStatus==="connected"&&this._kernelSession!==II)this._ws.send(sV.serialize(e));else if(t)this._pendingMessages.push(e);else throw new Error("Could not send message")}async interrupt(){if(this.status==="dead")throw new Error("Kernel is dead");return vR.interruptKernel(this.id,this.serverSettings)}async restart(){if(this.status==="dead")throw new Error("Kernel is dead");this._updateStatus("restarting"),this._clearKernelState(),this._kernelSession=II,await vR.restartKernel(this.id,this.serverSettings),await this.reconnect()}reconnect(){this._errorIfDisposed();let e=new Vf.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Kernel connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}async shutdown(){this.status!=="dead"&&await vR.shutdownKernel(this.id,this.serverSettings),this.handleShutdown()}handleShutdown(){this._updateStatus("dead"),this.dispose()}async requestKernelInfo(){let e=Ks.createMessage({msgType:"kernel_info_request",channel:"shell",username:this._username,session:this._clientId,content:{}}),t;try{t=await Ul.handleShellMessage(this,e)}catch(n){if(this.isDisposed)return;throw n}if(this._errorIfDisposed(),!!t)return t.content.status===void 0&&(t.content.status="ok"),t.content.status!=="ok"?(this._info.reject("Kernel info reply errored"),t):(this._info.resolve(t.content),this._kernelSession=t.header.session,t)}requestComplete(e){let t=Ks.createMessage({msgType:"complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ul.handleShellMessage(this,t)}requestInspect(e){let t=Ks.createMessage({msgType:"inspect_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ul.handleShellMessage(this,t)}requestHistory(e){let t=Ks.createMessage({msgType:"history_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ul.handleShellMessage(this,t)}requestExecute(e,t=!0,n){let i={silent:!1,store_history:!0,user_expressions:{},allow_stdin:!0,stop_on_error:!1},o=Ks.createMessage({msgType:"execute_request",channel:"shell",username:this._username,session:this._clientId,content:Object.assign(Object.assign({},i),e),metadata:n});return this.sendShellMessage(o,!0,t)}requestDebug(e,t=!0){let n=Ks.createMessage({msgType:"debug_request",channel:"control",username:this._username,session:this._clientId,content:e});return this.sendControlMessage(n,!0,t)}requestIsComplete(e){let t=Ks.createMessage({msgType:"is_complete_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ul.handleShellMessage(this,t)}requestCommInfo(e){let t=Ks.createMessage({msgType:"comm_info_request",channel:"shell",username:this._username,session:this._clientId,content:e});return Ul.handleShellMessage(this,t)}sendInputReply(e){let t=Ks.createMessage({msgType:"input_reply",channel:"stdin",username:this._username,session:this._clientId,content:e});this._sendMessage(t),this._anyMessage.emit({msg:t,direction:"send"})}createComm(e,t=Vf.UUID.uuid4()){if(!this.handleComms)throw new Error("Comms are disabled on this kernel connection");if(this._comms.has(t))throw new Error("Comm is already created");let n=new v$.CommHandler(e,t,this,()=>{this._unregisterComm(t)});return this._comms.set(t,n),n}hasComm(e){return this._comms.has(e)}registerCommTarget(e,t){this.handleComms&&(this._targetRegistry[e]=t)}removeCommTarget(e,t){this.handleComms&&!this.isDisposed&&this._targetRegistry[e]===t&&delete this._targetRegistry[e]}registerMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.registerMessageHook(t)}removeMessageHook(e,t){var n;let i=(n=this._futures)===null||n===void 0?void 0:n.get(e);i&&i.removeMessageHook(t)}async _handleDisplayId(e,t){var n,i;let o=t.parent_header.msg_id,s=this._displayIdToParentIds.get(e);if(s){let l={header:Vf.JSONExt.deepCopy(t.header),parent_header:Vf.JSONExt.deepCopy(t.parent_header),metadata:Vf.JSONExt.deepCopy(t.metadata),content:Vf.JSONExt.deepCopy(t.content),channel:t.channel,buffers:t.buffers?t.buffers.slice():[]};l.header.msg_type="update_display_data",await Promise.all(s.map(async c=>{let u=this._futures&&this._futures.get(c);u&&await u.handleMsg(l)}))}if(t.header.msg_type==="update_display_data")return!0;s=(n=this._displayIdToParentIds.get(e))!==null&&n!==void 0?n:[],s.indexOf(o)===-1&&s.push(o),this._displayIdToParentIds.set(e,s);let a=(i=this._msgIdToDisplayIds.get(o))!==null&&i!==void 0?i:[];return a.indexOf(o)===-1&&a.push(o),this._msgIdToDisplayIds.set(o,a),!1}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}_updateStatus(e){this._status===e||this._status==="dead"||(this._status=e,Ul.logKernelStatus(this),this._statusChanged.emit(e),e==="dead"&&this.dispose())}_sendPending(){for(;this.connectionStatus==="connected"&&this._kernelSession!==II&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}_clearKernelState(){this._kernelSession="",this._pendingMessages=[],this._futures.forEach(e=>{e.dispose()}),this._comms.forEach(e=>{e.dispose()}),this._msgChain=Promise.resolve(),this._futures=new Map,this._comms=new Map,this._displayIdToParentIds.clear(),this._msgIdToDisplayIds.clear()}_assertCurrentMessage(e){if(this._errorIfDisposed(),e.header.session!==this._kernelSession)throw new Error(`Canceling handling of old message: ${e.header.msg_type}`)}async _handleCommOpen(e){this._assertCurrentMessage(e);let t=e.content,n=new v$.CommHandler(t.target_name,t.comm_id,this,()=>{this._unregisterComm(t.comm_id)});this._comms.set(t.comm_id,n);try{await(await Ul.loadObject(t.target_name,t.target_module,this._targetRegistry))(n,e)}catch(i){throw n.close(),console.error("Exception opening new comm"),i}}async _handleCommClose(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n){console.error("Comm not found for comm id "+t.comm_id);return}this._unregisterComm(n.commId);let i=n.onClose;i&&await i(e),n.dispose()}async _handleCommMsg(e){this._assertCurrentMessage(e);let t=e.content,n=this._comms.get(t.comm_id);if(!n)return;let i=n.onMsg;i&&await i(e)}_unregisterComm(e){this._comms.delete(e)}_updateConnectionStatus(e){if(this._connectionStatus!==e){if(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),this.status!=="dead")if(e==="connected"){let t=this._kernelSession===II,n=this.requestKernelInfo(),i=!1,o=()=>{i||(i=!0,t&&this._kernelSession===II&&(this._kernelSession=""),clearTimeout(s),this._pendingMessages.length>0&&this._sendPending())};n.then(o);let s=setTimeout(o,abe)}else this._updateStatus("unknown");this._connectionStatusChanged.emit(e)}}async _handleMessage(e){var t,n;let i=!1;if(e.parent_header&&e.channel==="iopub"&&(Ks.isDisplayDataMsg(e)||Ks.isUpdateDisplayDataMsg(e)||Ks.isExecuteResultMsg(e))){let s=((t=e.content.transient)!==null&&t!==void 0?t:{}).display_id;s&&(i=await this._handleDisplayId(s,e),this._assertCurrentMessage(e))}if(!i&&e.parent_header){let o=e.parent_header,s=(n=this._futures)===null||n===void 0?void 0:n.get(o.msg_id);if(s)await s.handleMsg(e),this._assertCurrentMessage(e);else{let a=o.session===this.clientId;e.channel!=="iopub"&&a&&this._unhandledMessage.emit(e)}}if(e.channel==="iopub"){switch(e.header.msg_type){case"status":{let o=e.content.execution_state;o==="restarting"&&Promise.resolve().then(async()=>{this._updateStatus("autorestarting"),this._clearKernelState(),await this.reconnect()}),this._updateStatus(o);break}case"comm_open":this.handleComms&&await this._handleCommOpen(e);break;case"comm_msg":this.handleComms&&await this._handleCommMsg(e);break;case"comm_close":this.handleComms&&await this._handleCommClose(e);break;default:break}this.isDisposed||(this._assertCurrentMessage(e),this._iopubMessage.emit(e))}}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=Ul.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.warn(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_errorIfDisposed(){if(this.isDisposed)throw new Error("Kernel connection is disposed")}};zc.KernelConnection=aV;var Ul;(function(r){function e(o){switch(o.status){case"idle":case"busy":case"unknown":return;default:console.debug(`Kernel: ${o.status} (${o.id})`);break}}r.logKernelStatus=e;async function t(o,s){return o.sendShellMessage(s,!0).done}r.handleShellMessage=t;function n(o,s,a){return new Promise((l,c)=>{if(s){if(typeof requirejs=="undefined")throw new Error("requirejs not found");requirejs([s],u=>{if(u[o]===void 0){let p=`Object '${o}' not found in module '${s}'`;c(new Error(p))}else l(u[o])},c)}else a!=null&&a[o]?l(a[o]):c(new Error(`Object '${o}' not found in registry`))})}r.loadObject=n;function i(o,s){return o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o}r.getRandomIntInclusive=i})(Ul||(Ul={}))});var _$=z(IR=>{"use strict";d();Object.defineProperty(IR,"__esModule",{value:!0});IR.KernelManager=void 0;var I$=Ug(),cbe=Dx(),S$=Ki(),ube=li(),dbe=Px(),bR=uR(),pbe=b$(),lV=class extends dbe.BaseManager{constructor(e={}){var t;super(e),this._isReady=!1,this._kernelConnections=new Set,this._models=new Map,this._runningChanged=new S$.Signal(this),this._connectionFailure=new S$.Signal(this),this._pollModels=new cbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:KernelManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._kernelConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){var t;let{id:n}=e.model,i=(t=e.handleComms)!==null&&t!==void 0?t:!0;if(e.handleComms===void 0){for(let s of this._kernelConnections)if(s.id===n&&s.handleComms){i=!1;break}}let o=new pbe.KernelConnection(Object.assign(Object.assign({handleComms:i},e),{serverSettings:this.serverSettings}));return this._onStarted(o),this._models.has(n)||this.refreshRunning().catch(()=>{}),o}running(){return I$.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e={},t={}){let n=await bR.startNew(e,this.serverSettings);return this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await bR.shutdownKernel(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>bR.shutdownKernel(e,this.serverSettings))),await this.refreshRunning()}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async requestRunning(){var e,t;let n;try{n=await bR.listRunning(this.serverSettings)}catch(i){throw(i instanceof ube.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&I$.every(n,i=>{let o=this._models.get(i.id);return o?o.name===i.name:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._kernelConnections.forEach(i=>{this._models.has(i.id)||i.handleShutdown()}),this._runningChanged.emit(n))}_onStarted(e){this._kernelConnections.add(e),e.statusChanged.connect(this._onStatusChanged,this),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._kernelConnections.delete(e),this.refreshRunning().catch(()=>{})}_onStatusChanged(e,t){t==="dead"&&this.refreshRunning().catch(()=>{})}};IR.KernelManager=lV});var uV=z(Ui=>{"use strict";d();var E$=Ui&&Ui.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fbe=Ui&&Ui.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),cV=Ui&&Ui.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&E$(e,r,t);return fbe(e,r),e},mbe=Ui&&Ui.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&E$(e,r,t)};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.KernelAPI=Ui.KernelMessage=Ui.Kernel=void 0;var hbe=cV(zY());Ui.Kernel=hbe;var gbe=cV(xx());Ui.KernelMessage=gbe;var vbe=cV(uR());Ui.KernelAPI=vbe;mbe(_$(),Ui)});var C$=z(SR=>{"use strict";d();Object.defineProperty(SR,"__esModule",{value:!0});SR.BuildManager=void 0;var dV=ds(),jf=Ls(),ybe="api/build",pV=class{constructor(e={}){var t;this._url="",this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:jf.ServerConnection.makeSettings();let{baseUrl:n,appUrl:i}=this.serverSettings;this._url=dV.URLExt.join(n,i,ybe)}get isAvailable(){return dV.PageConfig.getOption("buildAvailable").toLowerCase()==="true"}get shouldCheck(){return dV.PageConfig.getOption("buildCheck").toLowerCase()==="true"}getStatus(){let{_url:e,serverSettings:t}=this;return jf.ServerConnection.makeRequest(e,{},t).then(i=>{if(i.status!==200)throw new jf.ServerConnection.ResponseError(i);return i.json()}).then(i=>{if(typeof i.status!="string")throw new Error("Invalid data");if(typeof i.message!="string")throw new Error("Invalid data");return i})}build(){let{_url:e,serverSettings:t}=this,n={method:"POST"};return jf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status===400)throw new jf.ServerConnection.ResponseError(o,"Build aborted");if(o.status!==200){let s=`Build failed with ${o.status}, please run 'jupyter lab build' on the server for full output`;throw new jf.ServerConnection.ResponseError(o,s)}})}cancel(){let{_url:e,serverSettings:t}=this,n={method:"DELETE"};return jf.ServerConnection.makeRequest(e,n,t).then(o=>{if(o.status!==204)throw new jf.ServerConnection.ResponseError(o)})}};SR.BuildManager=pV});var hV=z(_R=>{"use strict";d();Object.defineProperty(_R,"__esModule",{value:!0});_R.NbConvertManager=void 0;var bbe=ds(),fV=Ls(),Ibe="api/nbconvert",mV=class{constructor(e={}){var t;this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:fV.ServerConnection.makeSettings()}async getExportFormats(){let e=this.serverSettings.baseUrl,t=bbe.URLExt.join(e,Ibe),{serverSettings:n}=this,i=await fV.ServerConnection.makeRequest(t,{},n);if(i.status!==200)throw await fV.ServerConnection.ResponseError.create(i);let o=await i.json(),s={};return Object.keys(o).forEach(function(l){let c=o[l].output_mimetype;s[l]={output_mimetype:c}}),s}};_R.NbConvertManager=mV});var x$=z(w$=>{"use strict";d();Object.defineProperty(w$,"__esModule",{value:!0})});var P$=z(Bf=>{"use strict";d();Object.defineProperty(Bf,"__esModule",{value:!0});Bf.validateModels=Bf.updateLegacySessionModel=Bf.validateModel=void 0;var Sbe=lR(),kx=wx();function D$(r){kx.validateProperty(r,"id","string"),kx.validateProperty(r,"type","string"),kx.validateProperty(r,"name","string"),kx.validateProperty(r,"path","string"),kx.validateProperty(r,"kernel","object"),Sbe.validateModel(r.kernel)}Bf.validateModel=D$;function _be(r){r.path===void 0&&r.notebook!==void 0&&(r.path=r.notebook.path,r.type="notebook",r.name="")}Bf.updateLegacySessionModel=_be;function Ebe(r){if(!Array.isArray(r))throw new Error("Invalid session list");r.forEach(e=>D$(e))}Bf.validateModels=Ebe});var CR=z(ci=>{"use strict";d();Object.defineProperty(ci,"__esModule",{value:!0});ci.updateSession=ci.startSession=ci.getSessionModel=ci.shutdownSession=ci.getSessionUrl=ci.listRunning=ci.SESSION_SERVICE_URL=void 0;var uo=Ls(),gV=ds(),Hf=P$();ci.SESSION_SERVICE_URL="api/sessions";async function Cbe(r=uo.ServerConnection.makeSettings()){let e=gV.URLExt.join(r.baseUrl,ci.SESSION_SERVICE_URL),t=await uo.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await uo.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid Session list");return n.forEach(i=>{Hf.updateLegacySessionModel(i),Hf.validateModel(i)}),n}ci.listRunning=Cbe;function ER(r,e){return gV.URLExt.join(r,ci.SESSION_SERVICE_URL,e)}ci.getSessionUrl=ER;async function wbe(r,e=uo.ServerConnection.makeSettings()){var t;let n=ER(e.baseUrl,r),i={method:"DELETE"},o=await uo.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The session "${r}"" does not exist on the server`;console.warn(a)}else{if(o.status===410)throw new uo.ServerConnection.ResponseError(o,"The kernel was deleted but the session was not");if(o.status!==204)throw await uo.ServerConnection.ResponseError.create(o)}}ci.shutdownSession=wbe;async function xbe(r,e=uo.ServerConnection.makeSettings()){let t=ER(e.baseUrl,r),n=await uo.ServerConnection.makeRequest(t,{},e);if(n.status!==200)throw await uo.ServerConnection.ResponseError.create(n);let i=await n.json();return Hf.updateLegacySessionModel(i),Hf.validateModel(i),i}ci.getSessionModel=xbe;async function Dbe(r,e=uo.ServerConnection.makeSettings()){let t=gV.URLExt.join(e.baseUrl,ci.SESSION_SERVICE_URL),n={method:"POST",body:JSON.stringify(r)},i=await uo.ServerConnection.makeRequest(t,n,e);if(i.status!==201)throw await uo.ServerConnection.ResponseError.create(i);let o=await i.json();return Hf.updateLegacySessionModel(o),Hf.validateModel(o),o}ci.startSession=Dbe;async function Pbe(r,e=uo.ServerConnection.makeSettings()){let t=ER(e.baseUrl,r.id),n={method:"PATCH",body:JSON.stringify(r)},i=await uo.ServerConnection.makeRequest(t,n,e);if(i.status!==200)throw await uo.ServerConnection.ResponseError.create(i);let o=await i.json();return Hf.updateLegacySessionModel(o),Hf.validateModel(o),o}ci.updateSession=Pbe});var k$=z(wR=>{"use strict";d();Object.defineProperty(wR,"__esModule",{value:!0});wR.SessionConnection=void 0;var Kd=Ki(),Tbe=li(),T$=CR(),kbe=Fl(),vV=class{constructor(e){var t,n,i,o;this._id="",this._path="",this._name="",this._type="",this._kernel=null,this._isDisposed=!1,this._disposed=new Kd.Signal(this),this._kernelChanged=new Kd.Signal(this),this._statusChanged=new Kd.Signal(this),this._connectionStatusChanged=new Kd.Signal(this),this._iopubMessage=new Kd.Signal(this),this._unhandledMessage=new Kd.Signal(this),this._anyMessage=new Kd.Signal(this),this._propertyChanged=new Kd.Signal(this),this._id=e.model.id,this._name=e.model.name,this._path=e.model.path,this._type=e.model.type,this._username=(t=e.username)!==null&&t!==void 0?t:"",this._clientId=(n=e.clientId)!==null&&n!==void 0?n:kbe.UUID.uuid4(),this._connectToKernel=e.connectToKernel,this._kernelConnectionOptions=(i=e.kernelConnectionOptions)!==null&&i!==void 0?i:{},this.serverSettings=(o=e.serverSettings)!==null&&o!==void 0?o:Tbe.ServerConnection.makeSettings(),this.setupKernel(e.model.kernel)}get disposed(){return this._disposed}get kernelChanged(){return this._kernelChanged}get statusChanged(){return this._statusChanged}get connectionStatusChanged(){return this._connectionStatusChanged}get iopubMessage(){return this._iopubMessage}get unhandledMessage(){return this._unhandledMessage}get anyMessage(){return this._anyMessage}get propertyChanged(){return this._propertyChanged}get id(){return this._id}get kernel(){return this._kernel}get path(){return this._path}get type(){return this._type}get name(){return this._name}get model(){return{id:this.id,kernel:this.kernel&&{id:this.kernel.id,name:this.kernel.name},path:this._path,type:this._type,name:this._name}}get isDisposed(){return this._isDisposed}update(e){let t=this.model;if(this._path=e.path,this._name=e.name,this._type=e.type,this._kernel===null&&e.kernel!==null||this._kernel!==null&&e.kernel===null||this._kernel!==null&&e.kernel!==null&&this._kernel.id!==e.kernel.id){this._kernel!==null&&this._kernel.dispose();let n=this._kernel||null;this.setupKernel(e.kernel);let i=this._kernel||null;this._kernelChanged.emit({name:"kernel",oldValue:n,newValue:i})}this._handleModelChange(t)}dispose(){if(!this.isDisposed){if(this._isDisposed=!0,this._disposed.emit(),this._kernel){this._kernel.dispose();let e=this._kernel;this._kernel=null;let t=this._kernel;this._kernelChanged.emit({name:"kernel",oldValue:e,newValue:t})}Kd.Signal.clearData(this)}}async setPath(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({path:e})}async setName(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({name:e})}async setType(e){if(this.isDisposed)throw new Error("Session is disposed");await this._patch({type:e})}async changeKernel(e){if(this.isDisposed)throw new Error("Session is disposed");return await this._patch({kernel:e}),this.kernel}async shutdown(){if(this.isDisposed)throw new Error("Session is disposed");await T$.shutdownSession(this.id,this.serverSettings),this.dispose()}setupKernel(e){if(e===null){this._kernel=null;return}let t=this._connectToKernel(Object.assign(Object.assign({},this._kernelConnectionOptions),{model:e,username:this._username,clientId:this._clientId,serverSettings:this.serverSettings}));this._kernel=t,t.statusChanged.connect(this.onKernelStatus,this),t.connectionStatusChanged.connect(this.onKernelConnectionStatus,this),t.unhandledMessage.connect(this.onUnhandledMessage,this),t.iopubMessage.connect(this.onIOPubMessage,this),t.anyMessage.connect(this.onAnyMessage,this)}onKernelStatus(e,t){this._statusChanged.emit(t)}onKernelConnectionStatus(e,t){this._connectionStatusChanged.emit(t)}onIOPubMessage(e,t){this._iopubMessage.emit(t)}onUnhandledMessage(e,t){this._unhandledMessage.emit(t)}onAnyMessage(e,t){this._anyMessage.emit(t)}async _patch(e){let t=await T$.updateSession(Object.assign(Object.assign({},e),{id:this._id}),this.serverSettings);return this.update(t),t}_handleModelChange(e){e.name!==this._name&&this._propertyChanged.emit("name"),e.type!==this._type&&this._propertyChanged.emit("type"),e.path!==this._path&&this._propertyChanged.emit("path")}};wR.SessionConnection=vV});var A$=z(xR=>{"use strict";d();Object.defineProperty(xR,"__esModule",{value:!0});xR.SessionManager=void 0;var N$=Ug(),Nbe=Dx(),R$=Ki(),Rbe=Ls(),Abe=Px(),Mbe=k$(),Nx=CR(),yV=class extends Abe.BaseManager{constructor(e){var t;super(e),this._isReady=!1,this._sessionConnections=new Set,this._models=new Map,this._runningChanged=new R$.Signal(this),this._connectionFailure=new R$.Signal(this),this._connectToKernel=n=>this._kernelManager.connectTo(n),this._kernelManager=e.kernelManager,this._pollModels=new Nbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:SessionManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,await this._kernelManager.ready,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._models.clear(),this._sessionConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}connectTo(e){let t=new Mbe.SessionConnection(Object.assign(Object.assign({},e),{connectToKernel:this._connectToKernel,serverSettings:this.serverSettings}));return this._onStarted(t),this._models.has(e.model.id)||this.refreshRunning().catch(()=>{}),t}running(){return N$.iter([...this._models.values()])}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(e,t={}){let n=await Nx.startSession(e,this.serverSettings);return await this.refreshRunning(),this.connectTo(Object.assign(Object.assign({},t),{model:n}))}async shutdown(e){await Nx.shutdownSession(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all([...this._models.keys()].map(e=>Nx.shutdownSession(e,this.serverSettings))),await this.refreshRunning()}async stopIfNeeded(e){try{let n=(await Nx.listRunning(this.serverSettings)).filter(i=>i.path===e);if(n.length===1){let i=n[0].id;await this.shutdown(i)}}catch(t){}}async findById(e){return this._models.has(e)?this._models.get(e):(await this.refreshRunning(),this._models.get(e))}async findByPath(e){for(let t of this._models.values())if(t.path===e)return t;await this.refreshRunning();for(let t of this._models.values())if(t.path===e)return t}async requestRunning(){var e,t;let n;try{n=await Nx.listRunning(this.serverSettings)}catch(i){throw(i instanceof Rbe.ServerConnection.NetworkError||((e=i.response)===null||e===void 0?void 0:e.status)===503||((t=i.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(i),i}this.isDisposed||this._models.size===n.length&&N$.every(n,i=>{var o,s,a,l;let c=this._models.get(i.id);return c?((o=c.kernel)===null||o===void 0?void 0:o.id)===((s=i.kernel)===null||s===void 0?void 0:s.id)&&((a=c.kernel)===null||a===void 0?void 0:a.name)===((l=i.kernel)===null||l===void 0?void 0:l.name)&&c.name===i.name&&c.path===i.path&&c.type===i.type:!1})||(this._models=new Map(n.map(i=>[i.id,i])),this._sessionConnections.forEach(i=>{this._models.has(i.id)?i.update(this._models.get(i.id)):i.dispose()}),this._runningChanged.emit(n))}_onStarted(e){this._sessionConnections.add(e),e.disposed.connect(this._onDisposed,this),e.propertyChanged.connect(this._onChanged,this),e.kernelChanged.connect(this._onChanged,this)}_onDisposed(e){this._sessionConnections.delete(e),this.refreshRunning().catch(()=>{})}_onChanged(){this.refreshRunning().catch(()=>{})}};xR.SessionManager=yV});var bV=z(Lo=>{"use strict";d();var M$=Lo&&Lo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Obe=Lo&&Lo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),O$=Lo&&Lo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&M$(e,r,t);return Obe(e,r),e},Lbe=Lo&&Lo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&M$(e,r,t)};Object.defineProperty(Lo,"__esModule",{value:!0});Lo.SessionAPI=Lo.Session=void 0;var Kbe=O$(x$());Lo.Session=Kbe;var Fbe=O$(CR());Lo.SessionAPI=Fbe;Lbe(A$(),Lo)});var L$=z(DR=>{"use strict";d();Object.defineProperty(DR,"__esModule",{value:!0});DR.DataConnector=void 0;var IV=class{async list(e){throw new Error("DataConnector#list method has not been implemented.")}async remove(e){throw new Error("DataConnector#remove method has not been implemented.")}async save(e,t){throw new Error("DataConnector#save method has not been implemented.")}};DR.DataConnector=IV});var F$=z(K$=>{"use strict";d();Object.defineProperty(K$,"__esModule",{value:!0})});var W$=z(TR=>{"use strict";d();Object.defineProperty(TR,"__esModule",{value:!0});TR.RestorablePool=void 0;var Ube=Fl(),U$=TW(),PR=Ki(),SV=class{constructor(e){this._added=new PR.Signal(this),this._current=null,this._currentChanged=new PR.Signal(this),this._hasRestored=!1,this._isDisposed=!1,this._objects=new Set,this._restore=null,this._restored=new Ube.PromiseDelegate,this._updated=new PR.Signal(this),this.namespace=e.namespace}get added(){return this._added}get current(){return this._current}set current(e){this._current!==e&&e!==null&&this._objects.has(e)&&(this._current=e,this._currentChanged.emit(this._current))}get currentChanged(){return this._currentChanged}get isDisposed(){return this._isDisposed}get restored(){return this._restored.promise}get size(){return this._objects.size}get updated(){return this._updated}async add(e){var t,n;if(e.isDisposed){let i="A disposed object cannot be added.";throw console.warn(i,e),new Error(i)}if(this._objects.has(e)){let i="This object already exists in the pool.";throw console.warn(i,e),new Error(i)}if(this._objects.add(e),e.disposed.connect(this._onInstanceDisposed,this),!Qc.injectedProperty.get(e)){if(this._restore){let{connector:i}=this._restore,o=this._restore.name(e);if(o){let s=`${this.namespace}:${o}`,a=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);Qc.nameProperty.set(e,s),await i.save(s,{data:a})}}this._added.emit(e)}}dispose(){this.isDisposed||(this._current=null,this._isDisposed=!0,this._objects.clear(),PR.Signal.clearData(this))}find(e){let t=this._objects.values();for(let n of t)if(e(n))return n}forEach(e){this._objects.forEach(e)}filter(e){let t=[];return this.forEach(n=>{e(n)&&t.push(n)}),t}inject(e){return Qc.injectedProperty.set(e,!0),this.add(e)}has(e){return this._objects.has(e)}async restore(e){if(this._hasRestored)throw new Error("This pool has already been restored.");this._hasRestored=!0;let{command:t,connector:n,registry:i,when:o}=e,s=this.namespace,a=o?[n.list(s)].concat(o):[n.list(s)];this._restore=e;let[l]=await Promise.all(a),c=await Promise.all(l.ids.map(async(u,p)=>{let f=l.values[p],m=f&&f.data;return m===void 0?n.remove(u):i.execute(t,m).catch(()=>n.remove(u))}));return this._restored.resolve(),c}async save(e){var t,n;let i=Qc.injectedProperty.get(e);if(!this._restore||!this.has(e)||i)return;let{connector:o}=this._restore,s=this._restore.name(e),a=Qc.nameProperty.get(e),l=s?`${this.namespace}:${s}`:"";if(a&&a!==l&&await o.remove(a),Qc.nameProperty.set(e,l),l){let c=(n=(t=this._restore).args)===null||n===void 0?void 0:n.call(t,e);await o.save(l,{data:c})}a!==l&&this._updated.emit(e)}_onInstanceDisposed(e){if(this._objects.delete(e),e===this._current&&(this._current=null,this._currentChanged.emit(this._current)),Qc.injectedProperty.get(e)||!this._restore)return;let{connector:t}=this._restore,n=Qc.nameProperty.get(e);n&&t.remove(n)}};TR.RestorablePool=SV;var Qc;(function(r){r.injectedProperty=new U$.AttachedProperty({name:"injected",create:()=>!1}),r.nameProperty=new U$.AttachedProperty({name:"name",create:()=>""})})(Qc||(Qc={}))});var V$=z(SI=>{"use strict";d();Object.defineProperty(SI,"__esModule",{value:!0});SI.StateDB=void 0;var Wbe=Ki(),kR=class r{constructor(e={}){this._changed=new Wbe.Signal(this);let{connector:t,transform:n}=e;this._connector=t||new r.Connector,n?this._ready=n.then(i=>{let{contents:o,type:s}=i;switch(s){case"cancel":return;case"clear":return this._clear();case"merge":return this._merge(o||{});case"overwrite":return this._overwrite(o||{});default:return}}):this._ready=Promise.resolve(void 0)}get changed(){return this._changed}async clear(){await this._ready,await this._clear()}async fetch(e){return await this._ready,this._fetch(e)}async list(e){return await this._ready,this._list(e)}async remove(e){await this._ready,await this._remove(e),this._changed.emit({id:e,type:"remove"})}async save(e,t){await this._ready,await this._save(e,t),this._changed.emit({id:e,type:"save"})}async toJSON(){await this._ready;let{ids:e,values:t}=await this._list();return t.reduce((n,i,o)=>(n[e[o]]=i,n),{})}async _clear(){await Promise.all((await this._list()).ids.map(e=>this._remove(e)))}async _fetch(e){let t=await this._connector.fetch(e);if(t)return JSON.parse(t).v}async _list(e=""){let{ids:t,values:n}=await this._connector.list(e);return{ids:t,values:n.map(i=>JSON.parse(i).v)}}async _merge(e){await Promise.all(Object.keys(e).map(t=>e[t]&&this._save(t,e[t])))}async _overwrite(e){await this._clear(),await this._merge(e)}async _remove(e){return this._connector.remove(e)}async _save(e,t){return this._connector.save(e,JSON.stringify({v:t}))}};SI.StateDB=kR;(function(r){class e{constructor(){this._storage={}}async fetch(n){return this._storage[n]}async list(n=""){return Object.keys(this._storage).reduce((i,o)=>((n===""||n===o.split(":")[0])&&(i.ids.push(o),i.values.push(this._storage[o])),i),{ids:[],values:[]})}async remove(n){delete this._storage[n]}async save(n,i){this._storage[n]=i}}r.Connector=e})(kR=SI.StateDB||(SI.StateDB={}))});var j$=z(NR=>{"use strict";d();Object.defineProperty(NR,"__esModule",{value:!0});NR.IStateDB=void 0;var Vbe=Fl();NR.IStateDB=new Vbe.Token("@jupyterlab/coreutils:IStateDB")});var _V=z(Wl=>{"use strict";d();var jbe=Wl&&Wl.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Rx=Wl&&Wl.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&jbe(e,r,t)};Object.defineProperty(Wl,"__esModule",{value:!0});Rx(L$(),Wl);Rx(F$(),Wl);Rx(W$(),Wl);Rx(V$(),Wl);Rx(j$(),Wl)});var CV=z(AR=>{"use strict";d();Object.defineProperty(AR,"__esModule",{value:!0});AR.SettingManager=void 0;var Bbe=ds(),Hbe=_V(),RR=Ls(),Jbe="api/settings",EV=class extends Hbe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:RR.ServerConnection.makeSettings()}async fetch(e){if(!e)throw new Error("Plugin `id` parameter is required for settings fetch.");let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=RR.ServerConnection,a=n+i,l=Ax.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){var e,t;let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=RR.ServerConnection,l=i+o,c=Ax.url(l,""),u=await s(c,{},n);if(u.status!==200)throw new a(u);let p=await u.json(),f=(t=(e=p==null?void 0:p.settings)===null||e===void 0?void 0:e.map(h=>(h.data={composite:{},user:{}},h)))!==null&&t!==void 0?t:[];return{ids:f.map(h=>h.id),values:f}}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=RR.ServerConnection,l=i+o,c=Ax.url(l,e),u={body:JSON.stringify({raw:t}),method:"PUT"},p=await s(c,u,n);if(p.status!==204)throw new a(p)}};AR.SettingManager=EV;var Ax;(function(r){function e(t,n){return Bbe.URLExt.join(t,Jbe,n)}r.url=e})(Ax||(Ax={}))});var Ox=z(Ko=>{"use strict";d();Object.defineProperty(Ko,"__esModule",{value:!0});Ko.shutdownTerminal=Ko.listRunning=Ko.startNew=Ko.isAvailable=Ko.TERMINAL_SERVICE_URL=void 0;var MR=ds(),Fd=Ls();Ko.TERMINAL_SERVICE_URL="api/terminals";function B$(){return String(MR.PageConfig.getOption("terminalsAvailable")).toLowerCase()==="true"}Ko.isAvailable=B$;async function qbe(r=Fd.ServerConnection.makeSettings()){Mx.errorIfNotAvailable();let e=MR.URLExt.join(r.baseUrl,Ko.TERMINAL_SERVICE_URL),t={method:"POST"},n=await Fd.ServerConnection.makeRequest(e,t,r);if(n.status!==200)throw await Fd.ServerConnection.ResponseError.create(n);return await n.json()}Ko.startNew=qbe;async function Gbe(r=Fd.ServerConnection.makeSettings()){Mx.errorIfNotAvailable();let e=MR.URLExt.join(r.baseUrl,Ko.TERMINAL_SERVICE_URL),t=await Fd.ServerConnection.makeRequest(e,{},r);if(t.status!==200)throw await Fd.ServerConnection.ResponseError.create(t);let n=await t.json();if(!Array.isArray(n))throw new Error("Invalid terminal list");return n}Ko.listRunning=Gbe;async function Ybe(r,e=Fd.ServerConnection.makeSettings()){var t;Mx.errorIfNotAvailable();let n=MR.URLExt.join(e.baseUrl,Ko.TERMINAL_SERVICE_URL,r),i={method:"DELETE"},o=await Fd.ServerConnection.makeRequest(n,i,e);if(o.status===404){let a=(t=(await o.json()).message)!==null&&t!==void 0?t:`The terminal session "${r}"" does not exist on the server`;console.warn(a)}else if(o.status!==204)throw await Fd.ServerConnection.ResponseError.create(o)}Ko.shutdownTerminal=Ybe;var Mx;(function(r){function e(){if(!B$())throw new Error("Terminals Unavailable")}r.errorIfNotAvailable=e})(Mx||(Mx={}))});var H$=z(OR=>{"use strict";d();Object.defineProperty(OR,"__esModule",{value:!0});OR.isAvailable=void 0;var $be=Ox();Object.defineProperty(OR,"isAvailable",{enumerable:!0,get:function(){return $be.isAvailable}})});var G$=z(KR=>{"use strict";d();Object.defineProperty(KR,"__esModule",{value:!0});KR.TerminalConnection=void 0;var J$=ds(),zbe=Fl(),LR=Ki(),Qbe=li(),q$=Ox(),wV=class r{constructor(e){var t;this._createSocket=()=>{this._errorIfDisposed(),this._clearSocket(),this._updateConnectionStatus("connecting");let n=this._name,i=this.serverSettings,o=J$.URLExt.join(i.wsUrl,"terminals","websocket",encodeURIComponent(n)),s=i.token;i.appendToken&&s!==""&&(o=o+`?token=${encodeURIComponent(s)}`),this._ws=new i.WebSocket(o),this._ws.onmessage=this._onWSMessage,this._ws.onclose=this._onWSClose,this._ws.onerror=this._onWSClose},this._onWSMessage=n=>{if(this._isDisposed)return;let i=JSON.parse(n.data);if(i[0]==="disconnect"&&this.dispose(),this._connectionStatus==="connecting"){i[0]==="setup"&&this._updateConnectionStatus("connected");return}this._messageReceived.emit({type:i[0],content:i.slice(1)})},this._onWSClose=n=>{console.warn(`Terminal websocket closed: ${n.code}`),this.isDisposed||this._reconnect()},this._connectionStatus="connecting",this._connectionStatusChanged=new LR.Signal(this),this._isDisposed=!1,this._disposed=new LR.Signal(this),this._messageReceived=new LR.Signal(this),this._reconnectTimeout=null,this._ws=null,this._noOp=()=>{},this._reconnectLimit=7,this._reconnectAttempt=0,this._pendingMessages=[],this._name=e.model.name,this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Qbe.ServerConnection.makeSettings(),this._createSocket()}get disposed(){return this._disposed}get messageReceived(){return this._messageReceived}get name(){return this._name}get model(){return{name:this._name}}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0,this._disposed.emit(),this._updateConnectionStatus("disconnected"),this._clearSocket(),LR.Signal.clearData(this))}send(e){this._sendMessage(e)}_sendMessage(e,t=!0){if(!(this._isDisposed||!e.content))if(this.connectionStatus==="connected"&&this._ws){let n=[e.type,...e.content];this._ws.send(JSON.stringify(n))}else if(t)this._pendingMessages.push(e);else throw new Error(`Could not send message: ${JSON.stringify(e)}`)}_sendPending(){for(;this.connectionStatus==="connected"&&this._pendingMessages.length>0;)this._sendMessage(this._pendingMessages[0],!1),this._pendingMessages.shift()}reconnect(){this._errorIfDisposed();let e=new zbe.PromiseDelegate,t=(n,i)=>{i==="connected"?(e.resolve(),this.connectionStatusChanged.disconnect(t,this)):i==="disconnected"&&(e.reject(new Error("Terminal connection disconnected")),this.connectionStatusChanged.disconnect(t,this))};return this.connectionStatusChanged.connect(t,this),this._reconnectAttempt=0,this._reconnect(),e.promise}_reconnect(){if(this._errorIfDisposed(),clearTimeout(this._reconnectTimeout),this._reconnectAttempt<this._reconnectLimit){this._updateConnectionStatus("connecting");let e=xV.getRandomIntInclusive(0,1e3*(Math.pow(2,this._reconnectAttempt)-1));console.error(`Connection lost, reconnecting in ${Math.floor(e/1e3)} seconds.`),this._reconnectTimeout=setTimeout(this._createSocket,e),this._reconnectAttempt+=1}else this._updateConnectionStatus("disconnected");this._clearSocket()}_clearSocket(){this._ws!==null&&(this._ws.onopen=this._noOp,this._ws.onclose=this._noOp,this._ws.onerror=this._noOp,this._ws.onmessage=this._noOp,this._ws.close(),this._ws=null)}async shutdown(){await q$.shutdownTerminal(this.name,this.serverSettings),this.dispose()}clone(){return new r(this)}_updateConnectionStatus(e){this._connectionStatus!==e&&(this._connectionStatus=e,e!=="connecting"&&(this._reconnectAttempt=0,clearTimeout(this._reconnectTimeout)),e==="connected"&&this._sendPending(),this._connectionStatusChanged.emit(e))}_errorIfDisposed(){if(this.isDisposed)throw new Error("Terminal connection is disposed")}get connectionStatusChanged(){return this._connectionStatusChanged}get connectionStatus(){return this._connectionStatus}};KR.TerminalConnection=wV;var xV;(function(r){function e(n,i){return J$.URLExt.join(n,q$.TERMINAL_SERVICE_URL,encodeURIComponent(i))}r.getTermUrl=e;function t(n,i){return n=Math.ceil(n),i=Math.floor(i),Math.floor(Math.random()*(i-n+1))+n}r.getRandomIntInclusive=t})(xV||(xV={}))});var $$=z(FR=>{"use strict";d();Object.defineProperty(FR,"__esModule",{value:!0});FR.TerminalManager=void 0;var Xbe=Ug(),Zbe=Dx(),Y$=Ki(),eIe=li(),tIe=Px(),Lx=Ox(),rIe=G$(),DV=class extends tIe.BaseManager{constructor(e={}){var t;if(super(e),this._isReady=!1,this._names=[],this._terminalConnections=new Set,this._runningChanged=new Y$.Signal(this),this._connectionFailure=new Y$.Signal(this),!this.isAvailable()){this._ready=Promise.reject("Terminals unavailable"),this._ready.catch(n=>{});return}this._pollModels=new Zbe.Poll({auto:!1,factory:()=>this.requestRunning(),frequency:{interval:10*1e3,backoff:!0,max:300*1e3},name:"@jupyterlab/services:TerminalManager#models",standby:(t=e.standby)!==null&&t!==void 0?t:"when-hidden"}),this._ready=(async()=>{await this._pollModels.start(),await this._pollModels.tick,this._isReady=!0})()}get isReady(){return this._isReady}get ready(){return this._ready}get runningChanged(){return this._runningChanged}get connectionFailure(){return this._connectionFailure}dispose(){this.isDisposed||(this._names.length=0,this._terminalConnections.forEach(e=>e.dispose()),this._pollModels.dispose(),super.dispose())}isAvailable(){return Lx.isAvailable()}connectTo(e){let t=new rIe.TerminalConnection(Object.assign(Object.assign({},e),{serverSettings:this.serverSettings}));return this._onStarted(t),this._names.includes(e.model.name)||this.refreshRunning().catch(()=>{}),t}running(){return Xbe.iter(this._models)}async refreshRunning(){await this._pollModels.refresh(),await this._pollModels.tick}async startNew(){let e=await Lx.startNew(this.serverSettings);return await this.refreshRunning(),this.connectTo({model:e})}async shutdown(e){await Lx.shutdownTerminal(e,this.serverSettings),await this.refreshRunning()}async shutdownAll(){await this.refreshRunning(),await Promise.all(this._names.map(e=>Lx.shutdownTerminal(e,this.serverSettings))),await this.refreshRunning()}async requestRunning(){var e,t;let n;try{n=await Lx.listRunning(this.serverSettings)}catch(o){throw(o instanceof eIe.ServerConnection.NetworkError||((e=o.response)===null||e===void 0?void 0:e.status)===503||((t=o.response)===null||t===void 0?void 0:t.status)===424)&&this._connectionFailure.emit(o),o}if(this.isDisposed)return;let i=n.map(({name:o})=>o).sort();i!==this._names&&(this._names=i,this._terminalConnections.forEach(o=>{i.includes(o.name)||o.dispose()}),this._runningChanged.emit(this._models))}_onStarted(e){this._terminalConnections.add(e),e.disposed.connect(this._onDisposed,this)}_onDisposed(e){this._terminalConnections.delete(e),this.refreshRunning().catch(()=>{})}get _models(){return this._names.map(e=>({name:e}))}};FR.TerminalManager=DV});var PV=z(Fo=>{"use strict";d();var z$=Fo&&Fo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nIe=Fo&&Fo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Q$=Fo&&Fo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&z$(e,r,t);return nIe(e,r),e},iIe=Fo&&Fo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&z$(e,r,t)};Object.defineProperty(Fo,"__esModule",{value:!0});Fo.TerminalAPI=Fo.Terminal=void 0;var oIe=Q$(H$());Fo.Terminal=oIe;var sIe=Q$(Ox());Fo.TerminalAPI=sIe;iIe($$(),Fo)});var kV=z(UR=>{"use strict";d();Object.defineProperty(UR,"__esModule",{value:!0});UR.WorkspaceManager=void 0;var aIe=ds(),lIe=_V(),Kx=Ls(),cIe="api/workspaces",TV=class extends lIe.DataConnector{constructor(e={}){var t;super(),this.serverSettings=(t=e.serverSettings)!==null&&t!==void 0?t:Kx.ServerConnection.makeSettings()}async fetch(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Kx.ServerConnection,a=n+i,l=_I.url(a,e),c=await o(l,{},t);if(c.status!==200)throw await s.create(c);return c.json()}async list(){let{serverSettings:e}=this,{baseUrl:t,appUrl:n}=e,{makeRequest:i,ResponseError:o}=Kx.ServerConnection,s=t+n,a=_I.url(s,""),l=await i(a,{},e);if(l.status!==200)throw await o.create(l);return(await l.json()).workspaces}async remove(e){let{serverSettings:t}=this,{baseUrl:n,appUrl:i}=t,{makeRequest:o,ResponseError:s}=Kx.ServerConnection,a=n+i,l=_I.url(a,e),u=await o(l,{method:"DELETE"},t);if(u.status!==204)throw await s.create(u)}async save(e,t){let{serverSettings:n}=this,{baseUrl:i,appUrl:o}=n,{makeRequest:s,ResponseError:a}=Kx.ServerConnection,l=i+o,c=_I.url(l,e),u={body:JSON.stringify(t),method:"PUT"},p=await s(c,u,n);if(p.status!==204)throw await a.create(p)}};UR.WorkspaceManager=TV;var _I;(function(r){function e(t,n){return aIe.URLExt.join(t,cIe,n)}r.url=e})(_I||(_I={}))});var Z$=z(WR=>{"use strict";d();Object.defineProperty(WR,"__esModule",{value:!0});WR.ServiceManager=void 0;var X$=Ki(),uIe=C$(),dIe=hV(),pIe=jW(),fIe=gR(),mIe=bV(),hIe=CV(),gIe=PV(),vIe=Ls(),yIe=kV(),bIe=uV(),NV=class{constructor(e={}){var t,n;this._isDisposed=!1,this._connectionFailure=new X$.Signal(this),this._isReady=!1;let i=e.defaultDrive,o=(t=e.serverSettings)!==null&&t!==void 0?t:vIe.ServerConnection.makeSettings(),s=(n=e.standby)!==null&&n!==void 0?n:"when-hidden",a={defaultDrive:i,serverSettings:o,standby:s},l=new bIe.KernelManager(a);this.serverSettings=o,this.contents=new pIe.ContentsManager(a),this.sessions=new mIe.SessionManager(Object.assign(Object.assign({},a),{kernelManager:l})),this.settings=new hIe.SettingManager(a),this.terminals=new gIe.TerminalManager(a),this.builder=new uIe.BuildManager(a),this.workspaces=new yIe.WorkspaceManager(a),this.nbconvert=new dIe.NbConvertManager(a),this.kernelspecs=new fIe.KernelSpecManager(a),this.kernelspecs.connectionFailure.connect(this._onConnectionFailure,this),this.sessions.connectionFailure.connect(this._onConnectionFailure,this),this.terminals.connectionFailure.connect(this._onConnectionFailure,this);let c=[this.sessions.ready,this.kernelspecs.ready];this.terminals.isAvailable()&&c.push(this.terminals.ready),this._readyPromise=Promise.all(c).then(()=>{this._isReady=!0})}get connectionFailure(){return this._connectionFailure}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,X$.Signal.clearData(this),this.contents.dispose(),this.sessions.dispose(),this.terminals.dispose())}get isReady(){return this._isReady}get ready(){return this._readyPromise}_onConnectionFailure(e,t){this._connectionFailure.emit(t)}};WR.ServiceManager=NV});var li=z(Wi=>{"use strict";d();var IIe=Wi&&Wi.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vl=Wi&&Wi.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&IIe(e,r,t)};Object.defineProperty(Wi,"__esModule",{value:!0});Vl(GY(),Wi);Vl(jW(),Wi);Vl(uV(),Wi);Vl(gR(),Wi);Vl(Z$(),Wi);Vl(Ls(),Wi);Vl(bV(),Wi);Vl(CV(),Wi);Vl(PV(),Wi);Vl(kV(),Wi);Vl(hV(),Wi)});var MV=z((YGe,iz)=>{"use strict";d();var rz=Array.isArray,nz=Object.keys,_Ie=Object.prototype.hasOwnProperty;iz.exports=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){var n=rz(e),i=rz(t),o,s,a;if(n&&i){if(s=e.length,s!=t.length)return!1;for(o=s;o--!==0;)if(!r(e[o],t[o]))return!1;return!0}if(n!=i)return!1;var l=e instanceof Date,c=t instanceof Date;if(l!=c)return!1;if(l&&c)return e.getTime()==t.getTime();var u=e instanceof RegExp,p=t instanceof RegExp;if(u!=p)return!1;if(u&&p)return e.toString()==t.toString();var f=nz(e);if(s=f.length,s!==nz(t).length)return!1;for(o=s;o--!==0;)if(!_Ie.call(t,f[o]))return!1;for(o=s;o--!==0;)if(a=f[o],!r(e[a],t[a]))return!1;return!0}return e!==e&&t!==t}});var QV=z(tm=>{"use strict";d();Object.defineProperty(tm,"__esModule",{value:!0});tm.TargetPopulation=tm.Filters=tm.VSCodeFilterProvider=void 0;var I1=require("vscode"),zV=class r{constructor(e,t,n){this.extensionName=e,this.extensionVersion=t,this.targetPopulation=n}static trimVersionSuffix(e){let t=/\-[a-zA-Z0-9]+$/;return e.split(t)[0]}getFilterValue(e){switch(e){case su.ApplicationVersion:return r.trimVersionSuffix(I1.version);case su.Build:return I1.env.appName;case su.ClientId:return I1.env.machineId;case su.ExtensionName:return this.extensionName;case su.ExtensionVersion:return r.trimVersionSuffix(this.extensionVersion);case su.Language:return I1.env.language;case su.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,t=Object.values(su);for(let n of t)e.set(n,this.getFilterValue(n));return e}};tm.VSCodeFilterProvider=zV;var su;(function(r){r.Market="X-MSEdge-Market",r.CorpNet="X-FD-Corpnet",r.ApplicationVersion="X-VSCode-AppVersion",r.Build="X-VSCode-Build",r.ClientId="X-MSEdge-ClientId",r.ExtensionName="X-VSCode-ExtensionName",r.ExtensionVersion="X-VSCode-ExtensionVersion",r.Language="X-VSCode-Language",r.TargetPopulation="X-VSCode-TargetPopulation"})(su||(tm.Filters=su={}));var iQ;(function(r){r.Team="team",r.Internal="internal",r.Insiders="insider",r.Public="public"})(iQ||(tm.TargetPopulation=iQ={}))});var oQ=z(S1=>{"use strict";d();Object.defineProperty(S1,"__esModule",{value:!0});S1.BaseFeatureProvider=void 0;var XV=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};S1.BaseFeatureProvider=XV});var sQ=z(_1=>{"use strict";d();Object.defineProperty(_1,"__esModule",{value:!0});_1.FilteredFeatureProvider=void 0;var qIe=oQ(),ZV=class extends qIe.BaseFeatureProvider{constructor(e,t){super(e),this.telemetry=e,this.filterProviders=t,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let t of this.filterProviders){let n=t.getFilters();for(let i of n.keys()){let o=n.get(i);e.set(i,o)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let t=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",t]])),this.cachedTelemetryEvents.push(e)}};_1.FilteredFeatureProvider=ZV});var aQ=z(rm=>{"use strict";d();Object.defineProperty(rm,"__esModule",{value:!0});rm.TasApiFeatureProvider=rm.TASAPI_FETCHERROR_EVENTNAME=void 0;var GIe=sQ();rm.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var ej="ErrorType",tj=class extends GIe.FilteredFeatureProvider{constructor(e,t,n){super(t,n),this.httpClient=e,this.telemetry=t,this.filterProviders=n}async fetch(){let e=this.getFilters(),t={};for(let a of e.keys()){let l=e.get(a);t[a]=l}let n;try{n=await this.httpClient.get({headers:t})}catch(a){let l=a,c=new Map;l.response?c.set(ej,"ServerError"):l.request?c.set(ej,"NoResponse"):c.set(ej,"GenericError"),this.telemetry.postEvent(rm.TASAPI_FETCHERROR_EVENTNAME,c)}if(!n)throw Error(rm.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(t);let i=n.data,o=i.Configs,s=[];for(let a of o)if(a.Parameters)for(let l of Object.keys(a.Parameters)){let c=l+(a.Parameters[l]?"":"cf");s.includes(c)||s.push(c)}return{features:s,assignmentContext:i.AssignmentContext,configs:o}}};rm.TasApiFeatureProvider=tj});var jQ=z((WQ,VQ)=>{"use strict";d();function bQ(r,e){return function(){return r.apply(e,arguments)}}var{toString:YIe}=Object.prototype,{getPrototypeOf:fj}=Object,x1=(r=>e=>{let t=YIe.call(e);return r[t]||(r[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),lu=r=>(r=r.toLowerCase(),e=>x1(e)===r),D1=r=>e=>typeof e===r,{isArray:BI}=Array,Xx=D1("undefined");function $Ie(r){return r!==null&&!Xx(r)&&r.constructor!==null&&!Xx(r.constructor)&&ka(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}var IQ=lu("ArrayBuffer");function zIe(r){let e;return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?e=ArrayBuffer.isView(r):e=r&&r.buffer&&IQ(r.buffer),e}var QIe=D1("string"),ka=D1("function"),SQ=D1("number"),P1=r=>r!==null&&typeof r=="object",XIe=r=>r===!0||r===!1,E1=r=>{if(x1(r)!=="object")return!1;let e=fj(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)},ZIe=lu("Date"),eSe=lu("File"),tSe=lu("Blob"),rSe=lu("FileList"),nSe=r=>P1(r)&&ka(r.pipe),iSe=r=>{let e;return r&&(typeof FormData=="function"&&r instanceof FormData||ka(r.append)&&((e=x1(r))==="formdata"||e==="object"&&ka(r.toString)&&r.toString()==="[object FormData]"))},oSe=lu("URLSearchParams"),sSe=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zx(r,e,{allOwnKeys:t=!1}={}){if(r===null||typeof r=="undefined")return;let n,i;if(typeof r!="object"&&(r=[r]),BI(r))for(n=0,i=r.length;n<i;n++)e.call(null,r[n],n,r);else{let o=t?Object.getOwnPropertyNames(r):Object.keys(r),s=o.length,a;for(n=0;n<s;n++)a=o[n],e.call(null,r[a],a,r)}}function _Q(r,e){e=e.toLowerCase();let t=Object.keys(r),n=t.length,i;for(;n-- >0;)if(i=t[n],e===i.toLowerCase())return i;return null}var EQ=(()=>typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:WQ)(),CQ=r=>!Xx(r)&&r!==EQ;function sj(){let{caseless:r}=CQ(this)&&this||{},e={},t=(n,i)=>{let o=r&&_Q(e,i)||i;E1(e[o])&&E1(n)?e[o]=sj(e[o],n):E1(n)?e[o]=sj({},n):BI(n)?e[o]=n.slice():e[o]=n};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Zx(arguments[n],t);return e}var aSe=(r,e,t,{allOwnKeys:n}={})=>(Zx(e,(i,o)=>{t&&ka(i)?r[o]=bQ(i,t):r[o]=i},{allOwnKeys:n}),r),lSe=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),cSe=(r,e,t,n)=>{r.prototype=Object.create(e.prototype,n),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:e.prototype}),t&&Object.assign(r.prototype,t)},uSe=(r,e,t,n)=>{let i,o,s,a={};if(e=e||{},r==null)return e;do{for(i=Object.getOwnPropertyNames(r),o=i.length;o-- >0;)s=i[o],(!n||n(s,r,e))&&!a[s]&&(e[s]=r[s],a[s]=!0);r=t!==!1&&fj(r)}while(r&&(!t||t(r,e))&&r!==Object.prototype);return e},dSe=(r,e,t)=>{r=String(r),(t===void 0||t>r.length)&&(t=r.length),t-=e.length;let n=r.indexOf(e,t);return n!==-1&&n===t},pSe=r=>{if(!r)return null;if(BI(r))return r;let e=r.length;if(!SQ(e))return null;let t=new Array(e);for(;e-- >0;)t[e]=r[e];return t},fSe=(r=>e=>r&&e instanceof r)(typeof Uint8Array!="undefined"&&fj(Uint8Array)),mSe=(r,e)=>{let n=(r&&r[Symbol.iterator]).call(r),i;for(;(i=n.next())&&!i.done;){let o=i.value;e.call(r,o[0],o[1])}},hSe=(r,e)=>{let t,n=[];for(;(t=r.exec(e))!==null;)n.push(t);return n},gSe=lu("HTMLFormElement"),vSe=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,i){return n.toUpperCase()+i}),lQ=(({hasOwnProperty:r})=>(e,t)=>r.call(e,t))(Object.prototype),ySe=lu("RegExp"),wQ=(r,e)=>{let t=Object.getOwnPropertyDescriptors(r),n={};Zx(t,(i,o)=>{let s;(s=e(i,o,r))!==!1&&(n[o]=s||i)}),Object.defineProperties(r,n)},bSe=r=>{wQ(r,(e,t)=>{if(ka(r)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;let n=r[t];if(ka(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},ISe=(r,e)=>{let t={},n=i=>{i.forEach(o=>{t[o]=!0})};return BI(r)?n(r):n(String(r).split(e)),t},SSe=()=>{},_Se=(r,e)=>(r=+r,Number.isFinite(r)?r:e),rj="abcdefghijklmnopqrstuvwxyz",cQ="0123456789",xQ={DIGIT:cQ,ALPHA:rj,ALPHA_DIGIT:rj+rj.toUpperCase()+cQ},ESe=(r=16,e=xQ.ALPHA_DIGIT)=>{let t="",{length:n}=e;for(;r--;)t+=e[Math.random()*n|0];return t};function CSe(r){return!!(r&&ka(r.append)&&r[Symbol.toStringTag]==="FormData"&&r[Symbol.iterator])}var wSe=r=>{let e=new Array(10),t=(n,i)=>{if(P1(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[i]=n;let o=BI(n)?[]:{};return Zx(n,(s,a)=>{let l=t(s,i+1);!Xx(l)&&(o[a]=l)}),e[i]=void 0,o}}return n};return t(r,0)},xSe=lu("AsyncFunction"),DSe=r=>r&&(P1(r)||ka(r))&&ka(r.then)&&ka(r.catch),fe={isArray:BI,isArrayBuffer:IQ,isBuffer:$Ie,isFormData:iSe,isArrayBufferView:zIe,isString:QIe,isNumber:SQ,isBoolean:XIe,isObject:P1,isPlainObject:E1,isUndefined:Xx,isDate:ZIe,isFile:eSe,isBlob:tSe,isRegExp:ySe,isFunction:ka,isStream:nSe,isURLSearchParams:oSe,isTypedArray:fSe,isFileList:rSe,forEach:Zx,merge:sj,extend:aSe,trim:sSe,stripBOM:lSe,inherits:cSe,toFlatObject:uSe,kindOf:x1,kindOfTest:lu,endsWith:dSe,toArray:pSe,forEachEntry:mSe,matchAll:hSe,isHTMLForm:gSe,hasOwnProperty:lQ,hasOwnProp:lQ,reduceDescriptors:wQ,freezeMethods:bSe,toObjectSet:ISe,toCamelCase:vSe,noop:SSe,toFiniteNumber:_Se,findKey:_Q,global:EQ,isContextDefined:CQ,ALPHABET:xQ,generateString:ESe,isSpecCompliantForm:CSe,toJSONObject:wSe,isAsyncFn:xSe,isThenable:DSe};function ir(r,e,t,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),i&&(this.response=i)}fe.inherits(ir,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var DQ=ir.prototype,PQ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{PQ[r]={value:r}});Object.defineProperties(ir,PQ);Object.defineProperty(DQ,"isAxiosError",{value:!0});ir.from=(r,e,t,n,i,o)=>{let s=Object.create(DQ);return fe.toFlatObject(r,s,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),ir.call(s,r.message,e,t,n,i),s.cause=r,s.name=r.name,o&&Object.assign(s,o),s};var PSe=null;function aj(r){return fe.isPlainObject(r)||fe.isArray(r)}function TQ(r){return fe.endsWith(r,"[]")?r.slice(0,-2):r}function uQ(r,e,t){return r?r.concat(e).map(function(i,o){return i=TQ(i),!t&&o?"["+i+"]":i}).join(t?".":""):e}function TSe(r){return fe.isArray(r)&&!r.some(aj)}var kSe=fe.toFlatObject(fe,{},null,function(e){return/^is[A-Z]/.test(e)});function T1(r,e,t){if(!fe.isObject(r))throw new TypeError("target must be an object");e=e||new FormData,t=fe.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,v){return!fe.isUndefined(v[g])});let n=t.metaTokens,i=t.visitor||u,o=t.dots,s=t.indexes,l=(t.Blob||typeof Blob!="undefined"&&Blob)&&fe.isSpecCompliantForm(e);if(!fe.isFunction(i))throw new TypeError("visitor must be a function");function c(h){if(h===null)return"";if(fe.isDate(h))return h.toISOString();if(!l&&fe.isBlob(h))throw new ir("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(h)||fe.isTypedArray(h)?l&&typeof Blob=="function"?new Blob([h]):Buffer.from(h):h}function u(h,g,v){let S=h;if(h&&!v&&typeof h=="object"){if(fe.endsWith(g,"{}"))g=n?g:g.slice(0,-2),h=JSON.stringify(h);else if(fe.isArray(h)&&TSe(h)||(fe.isFileList(h)||fe.endsWith(g,"[]"))&&(S=fe.toArray(h)))return g=TQ(g),S.forEach(function(D,P){!(fe.isUndefined(D)||D===null)&&e.append(s===!0?uQ([g],P,o):s===null?g:g+"[]",c(D))}),!1}return aj(h)?!0:(e.append(uQ(v,g,o),c(h)),!1)}let p=[],f=Object.assign(kSe,{defaultVisitor:u,convertValue:c,isVisitable:aj});function m(h,g){if(!fe.isUndefined(h)){if(p.indexOf(h)!==-1)throw Error("Circular reference detected in "+g.join("."));p.push(h),fe.forEach(h,function(S,_){(!(fe.isUndefined(S)||S===null)&&i.call(e,S,fe.isString(_)?_.trim():_,g,f))===!0&&m(S,g?g.concat(_):[_])}),p.pop()}}if(!fe.isObject(r))throw new TypeError("data must be an object");return m(r),e}function dQ(r){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function mj(r,e){this._pairs=[],r&&T1(r,this,e)}var kQ=mj.prototype;kQ.append=function(e,t){this._pairs.push([e,t])};kQ.toString=function(e){let t=e?function(n){return e.call(this,n,dQ)}:dQ;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function NSe(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function NQ(r,e,t){if(!e)return r;let n=t&&t.encode||NSe,i=t&&t.serialize,o;if(i?o=i(e,t):o=fe.isURLSearchParams(e)?e.toString():new mj(e,t).toString(n),o){let s=r.indexOf("#");s!==-1&&(r=r.slice(0,s)),r+=(r.indexOf("?")===-1?"?":"&")+o}return r}var lj=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){fe.forEach(this.handlers,function(n){n!==null&&e(n)})}},pQ=lj,RQ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RSe=typeof URLSearchParams!="undefined"?URLSearchParams:mj,ASe=typeof FormData!="undefined"?FormData:null,MSe=typeof Blob!="undefined"?Blob:null,OSe={isBrowser:!0,classes:{URLSearchParams:RSe,FormData:ASe,Blob:MSe},protocols:["http","https","file","blob","url","data"]},AQ=typeof window!="undefined"&&typeof document!="undefined",LSe=(r=>AQ&&["ReactNative","NativeScript","NS"].indexOf(r)<0)(typeof navigator!="undefined"&&navigator.product),KSe=(()=>typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),FSe=Object.freeze({__proto__:null,hasBrowserEnv:AQ,hasStandardBrowserWebWorkerEnv:KSe,hasStandardBrowserEnv:LSe}),au={...FSe,...OSe};function USe(r,e){return T1(r,new au.classes.URLSearchParams,Object.assign({visitor:function(t,n,i,o){return au.isNode&&fe.isBuffer(t)?(this.append(n,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function WSe(r){return fe.matchAll(/\w+|\[(\w*)]/g,r).map(e=>e[0]==="[]"?"":e[1]||e[0])}function VSe(r){let e={},t=Object.keys(r),n,i=t.length,o;for(n=0;n<i;n++)o=t[n],e[o]=r[o];return e}function MQ(r){function e(t,n,i,o){let s=t[o++],a=Number.isFinite(+s),l=o>=t.length;return s=!s&&fe.isArray(i)?i.length:s,l?(fe.hasOwnProp(i,s)?i[s]=[i[s],n]:i[s]=n,!a):((!i[s]||!fe.isObject(i[s]))&&(i[s]=[]),e(t,n,i[s],o)&&fe.isArray(i[s])&&(i[s]=VSe(i[s])),!a)}if(fe.isFormData(r)&&fe.isFunction(r.entries)){let t={};return fe.forEachEntry(r,(n,i)=>{e(WSe(n),i,t,0)}),t}return null}function jSe(r,e,t){if(fe.isString(r))try{return(e||JSON.parse)(r),fe.trim(r)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(r)}var hj={transitional:RQ,adapter:["xhr","http"],transformRequest:[function(e,t){let n=t.getContentType()||"",i=n.indexOf("application/json")>-1,o=fe.isObject(e);if(o&&fe.isHTMLForm(e)&&(e=new FormData(e)),fe.isFormData(e))return i&&i?JSON.stringify(MQ(e)):e;if(fe.isArrayBuffer(e)||fe.isBuffer(e)||fe.isStream(e)||fe.isFile(e)||fe.isBlob(e))return e;if(fe.isArrayBufferView(e))return e.buffer;if(fe.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return USe(e,this.formSerializer).toString();if((a=fe.isFileList(e))||n.indexOf("multipart/form-data")>-1){let l=this.env&&this.env.FormData;return T1(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return o||i?(t.setContentType("application/json",!1),jSe(e)):e}],transformResponse:[function(e){let t=this.transitional||hj.transitional,n=t&&t.forcedJSONParsing,i=this.responseType==="json";if(e&&fe.isString(e)&&(n&&!this.responseType||i)){let s=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(s)throw a.name==="SyntaxError"?ir.from(a,ir.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:au.classes.FormData,Blob:au.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],r=>{hj.headers[r]={}});var gj=hj,BSe=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),HSe=r=>{let e={},t,n,i;return r&&r.split(`
`).forEach(function(s){i=s.indexOf(":"),t=s.substring(0,i).trim().toLowerCase(),n=s.substring(i+1).trim(),!(!t||e[t]&&BSe[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e},fQ=Symbol("internals");function Qx(r){return r&&String(r).trim().toLowerCase()}function C1(r){return r===!1||r==null?r:fe.isArray(r)?r.map(C1):String(r)}function JSe(r){let e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,n;for(;n=t.exec(r);)e[n[1]]=n[2];return e}var qSe=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function nj(r,e,t,n,i){if(fe.isFunction(n))return n.call(this,e,t);if(i&&(e=t),!!fe.isString(e)){if(fe.isString(n))return e.indexOf(n)!==-1;if(fe.isRegExp(n))return n.test(e)}}function GSe(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function YSe(r,e){let t=fe.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(r,n+t,{value:function(i,o,s){return this[n].call(this,e,i,o,s)},configurable:!0})})}var WI=class{constructor(e){e&&this.set(e)}set(e,t,n){let i=this;function o(a,l,c){let u=Qx(l);if(!u)throw new Error("header name must be a non-empty string");let p=fe.findKey(i,u);(!p||i[p]===void 0||c===!0||c===void 0&&i[p]!==!1)&&(i[p||l]=C1(a))}let s=(a,l)=>fe.forEach(a,(c,u)=>o(c,u,l));return fe.isPlainObject(e)||e instanceof this.constructor?s(e,t):fe.isString(e)&&(e=e.trim())&&!qSe(e)?s(HSe(e),t):e!=null&&o(t,e,n),this}get(e,t){if(e=Qx(e),e){let n=fe.findKey(this,e);if(n){let i=this[n];if(!t)return i;if(t===!0)return JSe(i);if(fe.isFunction(t))return t.call(this,i,n);if(fe.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Qx(e),e){let n=fe.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||nj(this,this[n],n,t)))}return!1}delete(e,t){let n=this,i=!1;function o(s){if(s=Qx(s),s){let a=fe.findKey(n,s);a&&(!t||nj(n,n[a],a,t))&&(delete n[a],i=!0)}}return fe.isArray(e)?e.forEach(o):o(e),i}clear(e){let t=Object.keys(this),n=t.length,i=!1;for(;n--;){let o=t[n];(!e||nj(this,this[o],o,e,!0))&&(delete this[o],i=!0)}return i}normalize(e){let t=this,n={};return fe.forEach(this,(i,o)=>{let s=fe.findKey(n,o);if(s){t[s]=C1(i),delete t[o];return}let a=e?GSe(o):String(o).trim();a!==o&&delete t[o],t[a]=C1(i),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return fe.forEach(this,(n,i)=>{n!=null&&n!==!1&&(t[i]=e&&fe.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let n=new this(e);return t.forEach(i=>n.set(i)),n}static accessor(e){let n=(this[fQ]=this[fQ]={accessors:{}}).accessors,i=this.prototype;function o(s){let a=Qx(s);n[a]||(YSe(i,s),n[a]=!0)}return fe.isArray(e)?e.forEach(o):o(e),this}};WI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);fe.reduceDescriptors(WI.prototype,({value:r},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>r,set(n){this[t]=n}}});fe.freezeMethods(WI);var Bd=WI;function ij(r,e){let t=this||gj,n=e||t,i=Bd.from(n.headers),o=n.data;return fe.forEach(r,function(a){o=a.call(t,o,i.normalize(),e?e.status:void 0)}),i.normalize(),o}function OQ(r){return!!(r&&r.__CANCEL__)}function eD(r,e,t){ir.call(this,r==null?"canceled":r,ir.ERR_CANCELED,e,t),this.name="CanceledError"}fe.inherits(eD,ir,{__CANCEL__:!0});function $Se(r,e,t){let n=t.config.validateStatus;!t.status||!n||n(t.status)?r(t):e(new ir("Request failed with status code "+t.status,[ir.ERR_BAD_REQUEST,ir.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}var zSe=au.hasStandardBrowserEnv?function(){return{write:function(t,n,i,o,s,a){let l=[];l.push(t+"="+encodeURIComponent(n)),fe.isNumber(i)&&l.push("expires="+new Date(i).toGMTString()),fe.isString(o)&&l.push("path="+o),fe.isString(s)&&l.push("domain="+s),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){let n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function QSe(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function XSe(r,e){return e?r.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):r}function LQ(r,e){return r&&!QSe(e)?XSe(r,e):e}var ZSe=au.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),n;function i(o){let s=o;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(s){let a=fe.isString(s)?i(s):s;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}();function e_e(r){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return e&&e[1]||""}function t_e(r,e){r=r||10;let t=new Array(r),n=new Array(r),i=0,o=0,s;return e=e!==void 0?e:1e3,function(l){let c=Date.now(),u=n[o];s||(s=c),t[i]=l,n[i]=c;let p=o,f=0;for(;p!==i;)f+=t[p++],p=p%r;if(i=(i+1)%r,i===o&&(o=(o+1)%r),c-s<e)return;let m=u&&c-u;return m?Math.round(f*1e3/m):void 0}}function mQ(r,e){let t=0,n=t_e(50,250);return i=>{let o=i.loaded,s=i.lengthComputable?i.total:void 0,a=o-t,l=n(a),c=o<=s;t=o;let u={loaded:o,total:s,progress:s?o/s:void 0,bytes:a,rate:l||void 0,estimated:l&&s&&c?(s-o)/l:void 0,event:i};u[e?"download":"upload"]=!0,r(u)}}var r_e=typeof XMLHttpRequest!="undefined",n_e=r_e&&function(r){return new Promise(function(t,n){let i=r.data,o=Bd.from(r.headers).normalize(),s=r.responseType,a;function l(){r.cancelToken&&r.cancelToken.unsubscribe(a),r.signal&&r.signal.removeEventListener("abort",a)}let c;if(fe.isFormData(i)){if(au.hasStandardBrowserEnv||au.hasStandardBrowserWebWorkerEnv)o.setContentType(!1);else if((c=o.getContentType())!==!1){let[h,...g]=c?c.split(";").map(v=>v.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...g].join("; "))}}let u=new XMLHttpRequest;if(r.auth){let h=r.auth.username||"",g=r.auth.password?unescape(encodeURIComponent(r.auth.password)):"";o.set("Authorization","Basic "+btoa(h+":"+g))}let p=LQ(r.baseURL,r.url);u.open(r.method.toUpperCase(),NQ(p,r.params,r.paramsSerializer),!0),u.timeout=r.timeout;function f(){if(!u)return;let h=Bd.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),v={data:!s||s==="text"||s==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:h,config:r,request:u};$Se(function(_){t(_),l()},function(_){n(_),l()},v),u=null}if("onloadend"in u?u.onloadend=f:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(f)},u.onabort=function(){u&&(n(new ir("Request aborted",ir.ECONNABORTED,r,u)),u=null)},u.onerror=function(){n(new ir("Network Error",ir.ERR_NETWORK,r,u)),u=null},u.ontimeout=function(){let g=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded",v=r.transitional||RQ;r.timeoutErrorMessage&&(g=r.timeoutErrorMessage),n(new ir(g,v.clarifyTimeoutError?ir.ETIMEDOUT:ir.ECONNABORTED,r,u)),u=null},au.hasStandardBrowserEnv){let h=ZSe(p)&&r.xsrfCookieName&&zSe.read(r.xsrfCookieName);h&&o.set(r.xsrfHeaderName,h)}i===void 0&&o.setContentType(null),"setRequestHeader"in u&&fe.forEach(o.toJSON(),function(g,v){u.setRequestHeader(v,g)}),fe.isUndefined(r.withCredentials)||(u.withCredentials=!!r.withCredentials),s&&s!=="json"&&(u.responseType=r.responseType),typeof r.onDownloadProgress=="function"&&u.addEventListener("progress",mQ(r.onDownloadProgress,!0)),typeof r.onUploadProgress=="function"&&u.upload&&u.upload.addEventListener("progress",mQ(r.onUploadProgress)),(r.cancelToken||r.signal)&&(a=h=>{u&&(n(!h||h.type?new eD(null,r,u):h),u.abort(),u=null)},r.cancelToken&&r.cancelToken.subscribe(a),r.signal&&(r.signal.aborted?a():r.signal.addEventListener("abort",a)));let m=e_e(p);if(m&&au.protocols.indexOf(m)===-1){n(new ir("Unsupported protocol "+m+":",ir.ERR_BAD_REQUEST,r));return}u.send(i||null)})},cj={http:PSe,xhr:n_e};fe.forEach(cj,(r,e)=>{if(r){try{Object.defineProperty(r,"name",{value:e})}catch(t){}Object.defineProperty(r,"adapterName",{value:e})}});var hQ=r=>`- ${r}`,i_e=r=>fe.isFunction(r)||r===null||r===!1,KQ={getAdapter:r=>{r=fe.isArray(r)?r:[r];let{length:e}=r,t,n,i={};for(let o=0;o<e;o++){t=r[o];let s;if(n=t,!i_e(t)&&(n=cj[(s=String(t)).toLowerCase()],n===void 0))throw new ir(`Unknown adapter '${s}'`);if(n)break;i[s||"#"+o]=n}if(!n){let o=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build")),s=e?o.length>1?`since :
`+o.map(hQ).join(`
`):" "+hQ(o[0]):"as no adapter specified";throw new ir("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return n},adapters:cj};function oj(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new eD(null,r)}function gQ(r){return oj(r),r.headers=Bd.from(r.headers),r.data=ij.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),KQ.getAdapter(r.adapter||gj.adapter)(r).then(function(n){return oj(r),n.data=ij.call(r,r.transformResponse,n),n.headers=Bd.from(n.headers),n},function(n){return OQ(n)||(oj(r),n&&n.response&&(n.response.data=ij.call(r,r.transformResponse,n.response),n.response.headers=Bd.from(n.response.headers))),Promise.reject(n)})}var vQ=r=>r instanceof Bd?r.toJSON():r;function VI(r,e){e=e||{};let t={};function n(c,u,p){return fe.isPlainObject(c)&&fe.isPlainObject(u)?fe.merge.call({caseless:p},c,u):fe.isPlainObject(u)?fe.merge({},u):fe.isArray(u)?u.slice():u}function i(c,u,p){if(fe.isUndefined(u)){if(!fe.isUndefined(c))return n(void 0,c,p)}else return n(c,u,p)}function o(c,u){if(!fe.isUndefined(u))return n(void 0,u)}function s(c,u){if(fe.isUndefined(u)){if(!fe.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function a(c,u,p){if(p in e)return n(c,u);if(p in r)return n(void 0,c)}let l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(c,u)=>i(vQ(c),vQ(u),!0)};return fe.forEach(Object.keys(Object.assign({},r,e)),function(u){let p=l[u]||i,f=p(r[u],e[u],u);fe.isUndefined(f)&&p!==a||(t[u]=f)}),t}var FQ="1.6.1",vj={};["object","boolean","number","function","string","symbol"].forEach((r,e)=>{vj[r]=function(n){return typeof n===r||"a"+(e<1?"n ":" ")+r}});var yQ={};vj.transitional=function(e,t,n){function i(o,s){return"[Axios v"+FQ+"] Transitional option '"+o+"'"+s+(n?". "+n:"")}return(o,s,a)=>{if(e===!1)throw new ir(i(s," has been removed"+(t?" in "+t:"")),ir.ERR_DEPRECATED);return t&&!yQ[s]&&(yQ[s]=!0,console.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,s,a):!0}};function o_e(r,e,t){if(typeof r!="object")throw new ir("options must be an object",ir.ERR_BAD_OPTION_VALUE);let n=Object.keys(r),i=n.length;for(;i-- >0;){let o=n[i],s=e[o];if(s){let a=r[o],l=a===void 0||s(a,o,r);if(l!==!0)throw new ir("option "+o+" must be "+l,ir.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ir("Unknown option "+o,ir.ERR_BAD_OPTION)}}var uj={assertOptions:o_e,validators:vj},nm=uj.validators,jI=class{constructor(e){this.defaults=e,this.interceptors={request:new pQ,response:new pQ}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=VI(this.defaults,t);let{transitional:n,paramsSerializer:i,headers:o}=t;n!==void 0&&uj.assertOptions(n,{silentJSONParsing:nm.transitional(nm.boolean),forcedJSONParsing:nm.transitional(nm.boolean),clarifyTimeoutError:nm.transitional(nm.boolean)},!1),i!=null&&(fe.isFunction(i)?t.paramsSerializer={serialize:i}:uj.assertOptions(i,{encode:nm.function,serialize:nm.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=o&&fe.merge(o.common,o[t.method]);o&&fe.forEach(["delete","get","head","post","put","patch","common"],h=>{delete o[h]}),t.headers=Bd.concat(s,o);let a=[],l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});let c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,p=0,f;if(!l){let h=[gQ.bind(this),void 0];for(h.unshift.apply(h,a),h.push.apply(h,c),f=h.length,u=Promise.resolve(t);p<f;)u=u.then(h[p++],h[p++]);return u}f=a.length;let m=t;for(p=0;p<f;){let h=a[p++],g=a[p++];try{m=h(m)}catch(v){g.call(this,v);break}}try{u=gQ.call(this,m)}catch(h){return Promise.reject(h)}for(p=0,f=c.length;p<f;)u=u.then(c[p++],c[p++]);return u}getUri(e){e=VI(this.defaults,e);let t=LQ(e.baseURL,e.url);return NQ(t,e.params,e.paramsSerializer)}};fe.forEach(["delete","get","head","options"],function(e){jI.prototype[e]=function(t,n){return this.request(VI(n||{},{method:e,url:t,data:(n||{}).data}))}});fe.forEach(["post","put","patch"],function(e){function t(n){return function(o,s,a){return this.request(VI(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}jI.prototype[e]=t(),jI.prototype[e+"Form"]=t(!0)});var w1=jI,dj=class r{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});let n=this;this.promise.then(i=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](i);n._listeners=null}),this.promise.then=i=>{let o,s=new Promise(a=>{n.subscribe(a),o=a}).then(i);return s.cancel=function(){n.unsubscribe(o)},s},e(function(o,s,a){n.reason||(n.reason=new eD(o,s,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new r(function(i){e=i}),cancel:e}}},s_e=dj;function a_e(r){return function(t){return r.apply(null,t)}}function l_e(r){return fe.isObject(r)&&r.isAxiosError===!0}var pj={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(pj).forEach(([r,e])=>{pj[e]=r});var c_e=pj;function UQ(r){let e=new w1(r),t=bQ(w1.prototype.request,e);return fe.extend(t,w1.prototype,e,{allOwnKeys:!0}),fe.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return UQ(VI(r,i))},t}var Zn=UQ(gj);Zn.Axios=w1;Zn.CanceledError=eD;Zn.CancelToken=s_e;Zn.isCancel=OQ;Zn.VERSION=FQ;Zn.toFormData=T1;Zn.AxiosError=ir;Zn.Cancel=Zn.CanceledError;Zn.all=function(e){return Promise.all(e)};Zn.spread=a_e;Zn.isAxiosError=l_e;Zn.mergeConfig=VI;Zn.AxiosHeaders=Bd;Zn.formToJSON=r=>MQ(fe.isHTMLForm(r)?new FormData(r):r);Zn.getAdapter=KQ.getAdapter;Zn.HttpStatusCode=c_e;Zn.default=Zn;VQ.exports=Zn});var BQ=z(k1=>{"use strict";d();Object.defineProperty(k1,"__esModule",{value:!0});k1.AxiosHttpClient=void 0;var u_e=jQ(),yj=class{constructor(e){this.endpoint=e}get(e){return u_e.default.get(this.endpoint,Object.assign(Object.assign({},e),{proxy:!1}))}};k1.AxiosHttpClient=yj});var HQ=z(N1=>{"use strict";d();Object.defineProperty(N1,"__esModule",{value:!0});N1.MemoryKeyValueStorage=void 0;var bj=class{constructor(){this.storage=new Map}async getValue(e,t){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(t||void 0)}setValue(e,t){this.storage.set(e,t)}};N1.MemoryKeyValueStorage=bj});var JQ=z(R1=>{"use strict";d();Object.defineProperty(R1,"__esModule",{value:!0});R1.ExperimentationServiceBase=void 0;var d_e=HQ(),Ij=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,t,n,i,o){this.telemetry=e,this.assignmentContextTelemetryPropertyName=t,this.telemetryEventName=n,this.storageKey=i,this.storage=o,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(o=new d_e.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((s,a)=>{this.resolveInitialFetchPromise=s})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch(t){}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let t=await this.fetchPromise;this.updateFeatures(t,e)}catch(t){}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,t=!1){let n={features:[],assignmentContext:"",configs:[]};for(let i of e){for(let o of i.features)n.features.includes(o)||n.features.push(o);for(let o of i.configs){let s=n.configs.find(a=>a.Id===o.Id);s?s.Parameters=Object.assign(Object.assign({},s.Parameters),o.Parameters):n.configs.push(o)}n.assignmentContext+=i.assignmentContext}(t||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let t=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),t.features.includes(e)}getTreatmentVariable(e,t){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${t}`);let n=this.features.configs.find(i=>i.Id===e);return n==null?void 0:n.Parameters[t]}async getTreatmentVariableAsync(e,t,n){if(n){let i=this.featuresConsumed,o=this.getTreatmentVariable(e,t);if(o===void 0)this.featuresConsumed=i;else return o}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,t)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let t of e)this.featureProviders.push(t)}};R1.ExperimentationServiceBase=Ij});var qQ=z(A1=>{"use strict";d();Object.defineProperty(A1,"__esModule",{value:!0});A1.PollingService=void 0;var Sj=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};A1.PollingService=Sj});var GQ=z(M1=>{"use strict";d();Object.defineProperty(M1,"__esModule",{value:!0});M1.ExperimentationServiceAutoPolling=void 0;var p_e=JQ(),f_e=qQ(),_j=class extends p_e.ExperimentationServiceBase{constructor(e,t,n,i,o,s,a){if(super(e,i,o,s,a),this.telemetry=e,this.filterProviders=t,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=i,this.telemetryEventName=o,this.storageKey=s,this.storage=a,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new f_e.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let t=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),t}else return await super.getFeaturesAsync(e)}};M1.ExperimentationServiceAutoPolling=_j});var YQ=z(L1=>{"use strict";d();Object.defineProperty(L1,"__esModule",{value:!0});L1.ExperimentationService=void 0;var m_e=aQ(),h_e=BQ(),g_e=GQ(),O1=class extends g_e.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new m_e.TasApiFeatureProvider(new h_e.AxiosHttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};L1.ExperimentationService=O1;O1.REFRESH_RATE_IN_MINUTES=30});var $Q=z(K1=>{"use strict";d();Object.defineProperty(K1,"__esModule",{value:!0});K1.ExperimentationService=void 0;var v_e=YQ();Object.defineProperty(K1,"ExperimentationService",{enumerable:!0,get:function(){return v_e.ExperimentationService}})});var zQ=z(F1=>{"use strict";d();Object.defineProperty(F1,"__esModule",{value:!0});F1.MementoKeyValueStorage=void 0;var Ej=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,t){return await this.mementoGlobalStorage.get(e)||t}setValue(e,t){this.mementoGlobalStorage.update(e,t)}};F1.MementoKeyValueStorage=Ej});var QQ=z(wj=>{"use strict";d();Object.defineProperty(wj,"__esModule",{value:!0});var Cj=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,t){}getTreatmentVariableAsync(e,t){return Promise.resolve(void 0)}};wj.default=Cj});var ZQ=z(HI=>{"use strict";d();Object.defineProperty(HI,"__esModule",{value:!0});HI.getExperimentationServiceAsync=HI.getExperimentationService=void 0;var y_e=QV(),b_e=$Q(),xj=require("vscode"),I_e=zQ(),S_e=QQ(),__e="https://default.exp-tas.com/vscode/ab",E_e="query-expfeature",C_e="abexp.assignmentcontext",w_e="VSCode.ABExp.FeatureData",x_e=1e3*60*30;function XQ(r,e,t,n,i,...o){if(!i)throw new Error("Memento storage was not provided.");let s=xj.workspace.getConfiguration("telemetry");if(!(xj.env.isTelemetryEnabled===void 0?s.get("enableTelemetry",!0):xj.env.isTelemetryEnabled))return new S_e.default;let c=[new y_e.VSCodeFilterProvider(r,e,t),...o],u=new I_e.MementoKeyValueStorage(i);return new b_e.ExperimentationService({filterProviders:c,telemetry:n,storageKey:w_e,keyValueStorage:u,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:C_e,telemetryEventName:E_e,endpoint:__e,refetchInterval:x_e})}HI.getExperimentationService=XQ;async function D_e(r,e,t,n,i,...o){let s=XQ(r,e,t,n,i,...o);return await s.initializePromise,s}HI.getExperimentationServiceAsync=D_e});var tX=z(im=>{"use strict";d();Object.defineProperty(im,"__esModule",{value:!0});im.TargetPopulation=im.getExperimentationServiceAsync=im.getExperimentationService=void 0;var eX=ZQ();Object.defineProperty(im,"getExperimentationService",{enumerable:!0,get:function(){return eX.getExperimentationService}});Object.defineProperty(im,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return eX.getExperimentationServiceAsync}});var P_e=QV();Object.defineProperty(im,"TargetPopulation",{enumerable:!0,get:function(){return P_e.TargetPopulation}})});var q1=z((utt,Rj)=>{"use strict";d();function N_e(r){var e=void 0;typeof r=="string"?e=[r]:e=r.raw;for(var t="",n=0;n<e.length;n++)t+=e[n].replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`"),n<(arguments.length<=1?0:arguments.length-1)&&(t+=arguments.length<=n+1?void 0:arguments[n+1]);var i=t.split(`
`),o=null;return i.forEach(function(s){var a=s.match(/^(\s+)\S+/);if(a){var l=a[1].length;o?o=Math.min(o,l):o=l}}),o!==null&&(t=i.map(function(s){return s[0]===" "?s.slice(o):s}).join(`
`)),t=t.trim(),t.replace(/\\n/g,`
`)}typeof Rj!="undefined"&&(Rj.exports=N_e)});var xX=z((Yd,wX)=>{d();var CX=typeof self!="undefined"?self:Yd,X1=function(){function r(){this.fetch=!1,this.DOMException=CX.DOMException}return r.prototype=CX,new r}();(function(r){var e=function(t){var n={searchParams:"URLSearchParams"in r,iterable:"Symbol"in r&&"iterator"in Symbol,blob:"FileReader"in r&&"Blob"in r&&function(){try{return new Blob,!0}catch(R){return!1}}(),formData:"FormData"in r,arrayBuffer:"ArrayBuffer"in r};function i(R){return R&&DataView.prototype.isPrototypeOf(R)}if(n.arrayBuffer)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(R){return R&&o.indexOf(Object.prototype.toString.call(R))>-1};function a(R){if(typeof R!="string"&&(R=String(R)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(R))throw new TypeError("Invalid character in header field name");return R.toLowerCase()}function l(R){return typeof R!="string"&&(R=String(R)),R}function c(R){var Z={next:function(){var ge=R.shift();return{done:ge===void 0,value:ge}}};return n.iterable&&(Z[Symbol.iterator]=function(){return Z}),Z}function u(R){this.map={},R instanceof u?R.forEach(function(Z,ge){this.append(ge,Z)},this):Array.isArray(R)?R.forEach(function(Z){this.append(Z[0],Z[1])},this):R&&Object.getOwnPropertyNames(R).forEach(function(Z){this.append(Z,R[Z])},this)}u.prototype.append=function(R,Z){R=a(R),Z=l(Z);var ge=this.map[R];this.map[R]=ge?ge+", "+Z:Z},u.prototype.delete=function(R){delete this.map[a(R)]},u.prototype.get=function(R){return R=a(R),this.has(R)?this.map[R]:null},u.prototype.has=function(R){return this.map.hasOwnProperty(a(R))},u.prototype.set=function(R,Z){this.map[a(R)]=l(Z)},u.prototype.forEach=function(R,Z){for(var ge in this.map)this.map.hasOwnProperty(ge)&&R.call(Z,this.map[ge],ge,this)},u.prototype.keys=function(){var R=[];return this.forEach(function(Z,ge){R.push(ge)}),c(R)},u.prototype.values=function(){var R=[];return this.forEach(function(Z){R.push(Z)}),c(R)},u.prototype.entries=function(){var R=[];return this.forEach(function(Z,ge){R.push([ge,Z])}),c(R)},n.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function p(R){if(R.bodyUsed)return Promise.reject(new TypeError("Already read"));R.bodyUsed=!0}function f(R){return new Promise(function(Z,ge){R.onload=function(){Z(R.result)},R.onerror=function(){ge(R.error)}})}function m(R){var Z=new FileReader,ge=f(Z);return Z.readAsArrayBuffer(R),ge}function h(R){var Z=new FileReader,ge=f(Z);return Z.readAsText(R),ge}function g(R){for(var Z=new Uint8Array(R),ge=new Array(Z.length),Ke=0;Ke<Z.length;Ke++)ge[Ke]=String.fromCharCode(Z[Ke]);return ge.join("")}function v(R){if(R.slice)return R.slice(0);var Z=new Uint8Array(R.byteLength);return Z.set(new Uint8Array(R)),Z.buffer}function S(){return this.bodyUsed=!1,this._initBody=function(R){this._bodyInit=R,R?typeof R=="string"?this._bodyText=R:n.blob&&Blob.prototype.isPrototypeOf(R)?this._bodyBlob=R:n.formData&&FormData.prototype.isPrototypeOf(R)?this._bodyFormData=R:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)?this._bodyText=R.toString():n.arrayBuffer&&n.blob&&i(R)?(this._bodyArrayBuffer=v(R.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(R)||s(R))?this._bodyArrayBuffer=v(R):this._bodyText=R=Object.prototype.toString.call(R):this._bodyText="",this.headers.get("content-type")||(typeof R=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(R)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var R=p(this);if(R)return R;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(m)}),this.text=function(){var R=p(this);if(R)return R;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function D(R){var Z=R.toUpperCase();return _.indexOf(Z)>-1?Z:R}function P(R,Z){Z=Z||{};var ge=Z.body;if(R instanceof P){if(R.bodyUsed)throw new TypeError("Already read");this.url=R.url,this.credentials=R.credentials,Z.headers||(this.headers=new u(R.headers)),this.method=R.method,this.mode=R.mode,this.signal=R.signal,!ge&&R._bodyInit!=null&&(ge=R._bodyInit,R.bodyUsed=!0)}else this.url=String(R);if(this.credentials=Z.credentials||this.credentials||"same-origin",(Z.headers||!this.headers)&&(this.headers=new u(Z.headers)),this.method=D(Z.method||this.method||"GET"),this.mode=Z.mode||this.mode||null,this.signal=Z.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ge)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ge)}P.prototype.clone=function(){return new P(this,{body:this._bodyInit})};function M(R){var Z=new FormData;return R.trim().split("&").forEach(function(ge){if(ge){var Ke=ge.split("="),Ce=Ke.shift().replace(/\+/g," "),ae=Ke.join("=").replace(/\+/g," ");Z.append(decodeURIComponent(Ce),decodeURIComponent(ae))}}),Z}function x(R){var Z=new u,ge=R.replace(/\r?\n[\t ]+/g," ");return ge.split(/\r?\n/).forEach(function(Ke){var Ce=Ke.split(":"),ae=Ce.shift().trim();if(ae){var Nt=Ce.join(":").trim();Z.append(ae,Nt)}}),Z}S.call(P.prototype);function A(R,Z){Z||(Z={}),this.type="default",this.status=Z.status===void 0?200:Z.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in Z?Z.statusText:"OK",this.headers=new u(Z.headers),this.url=Z.url||"",this._initBody(R)}S.call(A.prototype),A.prototype.clone=function(){return new A(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},A.error=function(){var R=new A(null,{status:0,statusText:""});return R.type="error",R};var j=[301,302,303,307,308];A.redirect=function(R,Z){if(j.indexOf(Z)===-1)throw new RangeError("Invalid status code");return new A(null,{status:Z,headers:{location:R}})},t.DOMException=r.DOMException;try{new t.DOMException}catch(R){t.DOMException=function(Z,ge){this.message=Z,this.name=ge;var Ke=Error(Z);this.stack=Ke.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function re(R,Z){return new Promise(function(ge,Ke){var Ce=new P(R,Z);if(Ce.signal&&Ce.signal.aborted)return Ke(new t.DOMException("Aborted","AbortError"));var ae=new XMLHttpRequest;function Nt(){ae.abort()}ae.onload=function(){var Je={status:ae.status,statusText:ae.statusText,headers:x(ae.getAllResponseHeaders()||"")};Je.url="responseURL"in ae?ae.responseURL:Je.headers.get("X-Request-URL");var vr="response"in ae?ae.response:ae.responseText;ge(new A(vr,Je))},ae.onerror=function(){Ke(new TypeError("Network request failed"))},ae.ontimeout=function(){Ke(new TypeError("Network request failed"))},ae.onabort=function(){Ke(new t.DOMException("Aborted","AbortError"))},ae.open(Ce.method,Ce.url,!0),Ce.credentials==="include"?ae.withCredentials=!0:Ce.credentials==="omit"&&(ae.withCredentials=!1),"responseType"in ae&&n.blob&&(ae.responseType="blob"),Ce.headers.forEach(function(Je,vr){ae.setRequestHeader(vr,Je)}),Ce.signal&&(Ce.signal.addEventListener("abort",Nt),ae.onreadystatechange=function(){ae.readyState===4&&Ce.signal.removeEventListener("abort",Nt)}),ae.send(typeof Ce._bodyInit=="undefined"?null:Ce._bodyInit)})}return re.polyfill=!0,r.fetch||(r.fetch=re,r.Headers=u,r.Request=P,r.Response=A),t.Headers=u,t.Request=P,t.Response=A,t.fetch=re,Object.defineProperty(t,"__esModule",{value:!0}),t}({})})(X1);X1.fetch.ponyfill=!0;delete X1.fetch.polyfill;var cS=X1;Yd=cS.fetch;Yd.default=cS.fetch;Yd.fetch=cS.fetch;Yd.Headers=cS.Headers;Yd.Request=cS.Request;Yd.Response=cS.Response;wX.exports=Yd});var HX=z((cA,BX)=>{d();var xS=null;typeof WebSocket!="undefined"?xS=WebSocket:typeof MozWebSocket!="undefined"?xS=MozWebSocket:typeof cA!="undefined"?xS=cA.WebSocket||cA.MozWebSocket:typeof window!="undefined"?xS=window.WebSocket||window.MozWebSocket:typeof self!="undefined"&&(xS=self.WebSocket||self.MozWebSocket);BX.exports=xS});var zX=z((ect,qj)=>{d();var $X=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);$X?(Hj=new Uint8Array(16),qj.exports=function(){return $X(Hj),Hj}):(Jj=new Array(16),qj.exports=function(){for(var e=0,t;e<16;e++)e&3||(t=Math.random()*4294967296),Jj[e]=t>>>((e&3)<<3)&255;return Jj});var Hj,Jj});var ZX=z((rct,XX)=>{d();var QX=[];for(pD=0;pD<256;++pD)QX[pD]=(pD+256).toString(16).substr(1);var pD;function V_e(r,e){var t=e||0,n=QX;return[n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],"-",n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]],n[r[t++]]].join("")}XX.exports=V_e});var iv=z((ict,eZ)=>{d();var j_e=zX(),B_e=ZX();function H_e(r,e,t){var n=e&&t||0;typeof r=="string"&&(e=r==="binary"?new Array(16):null,r=null),r=r||{};var i=r.random||(r.rng||j_e)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e)for(var o=0;o<16;++o)e[n+o]=i[o];return e||B_e(i)}eZ.exports=H_e});var SZ=z((gyt,IZ)=>{"use strict";d();IZ.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var $Z=z((DCt,YZ)=>{"use strict";d();var lEe=(r,e={})=>{let t=e.safe===!0||e.keepProtected===!0,n=!1,i=(o,s)=>{let a="",l,c;for(let u of o.nodes)switch(u.type){case"block":if(e.first&&n===!0){a+=i(u,o);break}if(e.preserveNewlines===!0){l=i(u,o),c=l.split(`
`),a+=`
`.repeat(c.length-1);break}if(t===!0&&u.protected===!0){a+=i(u,o);break}n=!0;break;case"line":if(e.first&&n===!0){a+=u.value;break}t===!0&&u.protected===!0&&(a+=u.value),n=!0;break;case"open":case"close":case"text":case"newline":default:{a+=u.value||"";break}}return a};return i(r)};YZ.exports=lEe});var QZ=z((TCt,zZ)=>{"use strict";d();var tM=class{constructor(e){this.type=e.type,e.value&&(this.value=e.value),e.match&&(this.match=e.match),this.newline=e.newline||""}get protected(){return!!this.match&&this.match[1]==="!"}},c9=class extends tM{constructor(e){super(e),this.nodes=e.nodes||[]}push(e){this.nodes.push(e)}get protected(){return this.nodes.length>0&&this.nodes[0].protected===!0}};zZ.exports={Node:tM,Block:c9}});var ZZ=z(XZ=>{"use strict";d();XZ.javascript={BLOCK_OPEN_REGEX:/^\/\*\*?(!?)/,BLOCK_CLOSE_REGEX:/^\*\/(\n?)/,LINE_REGEX:/^\/\/(!?).*/}});var ree=z((ACt,tee)=>{"use strict";d();var{Node:Sm,Block:eee}=QZ(),cEe=ZZ(),u9={ESCAPED_CHAR_REGEX:/^\\./,QUOTED_STRING_REGEX:/^(['"`])((?:\\.|[^\1])+?)(\1)/,NEWLINE_REGEX:/^\r*\n/},uEe=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");let t=new eee({type:"root",nodes:[]}),n=[t],i=(e.language||"javascript").toLowerCase(),o=cEe[i];if(typeof o=="undefined")throw new Error(`Language "${i}" is not supported by strip-comments`);let{LINE_REGEX:s,BLOCK_OPEN_REGEX:a,BLOCK_CLOSE_REGEX:l}=o,c=t,u=r,p,f,m=[a,l].filter(Boolean),h=!1;m.every(D=>D.source==='^"""')&&(h=!0);let g=(D=u[0]||"")=>(u=u.slice(D.length),D),v=(D,P="text")=>{let M=D.exec(u);if(M)return g(M[0]),{type:P,value:M[0],match:M}},S=D=>{if(f&&f.type==="text"&&D.type==="text"){f.value+=D.value;return}c.push(D),D.nodes&&(n.push(D),c=D),f=D},_=()=>{if(c.type==="root")throw new SyntaxError("Unclosed block comment");n.pop(),c=n[n.length-1]};for(;u!=="";){if(p=v(u9.ESCAPED_CHAR_REGEX,"text")){S(new Sm(p));continue}if(c.type!=="block"&&(!f||!/\w$/.test(f.value))&&!(h&&u.startsWith('"""'))&&(p=v(u9.QUOTED_STRING_REGEX,"text"))){S(new Sm(p));continue}if(p=v(u9.NEWLINE_REGEX,"newline")){S(new Sm(p));continue}if(a&&e.block&&!(h&&c.type==="block")&&(p=v(a,"open"))){S(new eee({type:"block"})),S(new Sm(p));continue}if(l&&c.type==="block"&&e.block&&(p=v(l,"close"))){p.newline=p.match[1]||"",S(new Sm(p)),_();continue}if(s&&c.type!=="block"&&e.line&&(p=v(s,"line"))){S(new Sm(p));continue}if(p=v(/^[a-zABD-Z0-9\t ]+/,"text")){S(new Sm(p));continue}S(new Sm({type:"text",value:g(u[0])}))}return t};tee.exports=uEe});var iee=z((OCt,nee)=>{"use strict";d();var rM=$Z(),wD=ree(),nM=nee.exports=(r,e)=>{let t={...e,block:!0,line:!0};return rM(wD(r,t),t)};nM.block=(r,e)=>{let t={...e,block:!0};return rM(wD(r,t),t)};nM.line=(r,e)=>{let t={...e,line:!0};return rM(wD(r,t),t)};nM.first=(r,e)=>{let t={...e,block:!0,line:!0,first:!0};return rM(wD(r,t),t)};nM.parse=wD});var Hee=z((jD,Bee)=>{d();var LEe=typeof jD=="object"&&jD&&jD.Object===Object&&jD;Bee.exports=LEe});var qee=z((qKt,Jee)=>{d();var KEe=Hee(),FEe=typeof self=="object"&&self&&self.Object===Object&&self,UEe=KEe||FEe||Function("return this")();Jee.exports=UEe});var HM=z((YKt,Gee)=>{d();var WEe=qee(),VEe=WEe.Symbol;Gee.exports=VEe});var $ee=z((zKt,Yee)=>{d();function jEe(r,e){for(var t=-1,n=r==null?0:r.length,i=Array(n);++t<n;)i[t]=e(r[t],t,r);return i}Yee.exports=jEe});var Qee=z((XKt,zee)=>{d();var BEe=Array.isArray;zee.exports=BEe});var tte=z((eFt,ete)=>{d();var Xee=HM(),Zee=Object.prototype,HEe=Zee.hasOwnProperty,JEe=Zee.toString,BD=Xee?Xee.toStringTag:void 0;function qEe(r){var e=HEe.call(r,BD),t=r[BD];try{r[BD]=void 0;var n=!0}catch(o){}var i=JEe.call(r);return n&&(e?r[BD]=t:delete r[BD]),i}ete.exports=qEe});var nte=z((rFt,rte)=>{d();var GEe=Object.prototype,YEe=GEe.toString;function $Ee(r){return YEe.call(r)}rte.exports=$Ee});var ate=z((iFt,ste)=>{d();var ite=HM(),zEe=tte(),QEe=nte(),XEe="[object Null]",ZEe="[object Undefined]",ote=ite?ite.toStringTag:void 0;function eCe(r){return r==null?r===void 0?ZEe:XEe:ote&&ote in Object(r)?zEe(r):QEe(r)}ste.exports=eCe});var cte=z((sFt,lte)=>{d();function tCe(r){return r!=null&&typeof r=="object"}lte.exports=tCe});var dte=z((lFt,ute)=>{d();var rCe=ate(),nCe=cte(),iCe="[object Symbol]";function oCe(r){return typeof r=="symbol"||nCe(r)&&rCe(r)==iCe}ute.exports=oCe});var vte=z((uFt,gte)=>{d();var pte=HM(),sCe=$ee(),aCe=Qee(),lCe=dte(),cCe=1/0,fte=pte?pte.prototype:void 0,mte=fte?fte.toString:void 0;function hte(r){if(typeof r=="string")return r;if(aCe(r))return sCe(r,hte)+"";if(lCe(r))return mte?mte.call(r):"";var e=r+"";return e=="0"&&1/r==-cCe?"-0":e}gte.exports=hte});var bte=z((pFt,yte)=>{d();var uCe=vte();function dCe(r){return r==null?"":uCe(r)}yte.exports=dCe});var _te=z((mFt,Ste)=>{d();var pCe=bte(),Ite=/[\\^$.*+?()[\]{}|]/g,fCe=RegExp(Ite.source);function mCe(r){return r=pCe(r),r&&fCe.test(r)?r.replace(Ite,"\\$&"):r}Ste.exports=mCe});var ywe={};Um(ywe,{activate:()=>mwe,deactivate:()=>hwe});module.exports=sP(ywe);d();d();Reflect.metadata===void 0&&Y9();d();var yr=require("vscode");d();d();function jv(){try{return(z9(),sP($9)).isPreRelesVersionOfJupyterExtension===!0}catch(r){return!0}}var ME={isExiting:!1},aP="_builtin.JupyterServerSelectorForTesting",JO="_builtin.jupyterServerUrlProvider";var Q9=!1;function X9(r){Q9=r}function Z9(){return Q9}var eB=!1;function tB(r){eB=r}function Pn(){return eB}var qe="python",KE="markdown",vp="vscode-notebook-cell";var cP={language:qe};var uP="vscode-interactive-input",It="jupyter-notebook",vt="interactive";var nc="GitHub.codespaces",Ye="ms-toolsai.jupyter",rB="ms-toolsai.vscode-jupyter-powertoys",Bv="ms-toolsai.jupyter-hub",nB="0c6ae279ed8443289764825290e4f9e2-1a736e7c-1324-4338-be46-fc2a58ae4d14-7255",Hv="STANDARD_OUTPUT_CHANNEL",lP;(t=>(t.PythonInteractiveHelpLink="https://aka.ms/pyaiinstall",t.JupyterDataRateHelpLink="https://aka.ms/AA5ggm0"))(lP||(lP={}));var hi;(o=>(o.JupyterServerRemoteLaunchNameSeparator=`
`,o.JupyterServerRemoteLaunchService=Ye,o.JupyterServerUriListMax=10,o.IntellisenseTimeout=2e3,o.IntellisenseResolveTimeout=5e3))(hi||(hi={}));var Ji=!1;var jre=!1;function bn(){return jre||FE()}var Bre=!1;function FE(){return Bre}var rt;(g=>(g.GeneratedThemeName="ipython-theme",g.MatplotLibDefaultParams="_VSCode_defaultMatplotlib_Params",g.MatplotLibFigureFormats="_VSCode_matplotLib_FigureFormats",g.DefaultCodeCellMarker="# %%",g.DefaultCommTarget="jupyter.widget",g.ALL_VARIABLES="ALL_VARIABLES",g.KERNEL_VARIABLES="KERNEL_VARIABLES",g.DEBUGGER_VARIABLES="DEBUGGER_VARIABLES",g.PYTHON_VARIABLES_REQUESTER="PYTHON_VARIABLES_REQUESTER",g.MULTIPLEXING_DEBUGSERVICE="MULTIPLEXING_DEBUGSERVICE",g.RUN_BY_LINE_DEBUGSERVICE="RUN_BY_LINE_DEBUGSERVICE",g.REMOTE_URI="https://remote/",g.REMOTE_URI_ID_PARAM="id",g.REMOTE_URI_HANDLE_PARAM="uriHandle",g.REMOTE_URI_EXTENSION_ID_PARAM="extensionId"))(rt||(rt={}));var OE;(n=>(n.ImportIPython=`{0}
from IPython import get_ipython

{1}`,n.MatplotLibInit=`import matplotlib
%matplotlib inline
${rt.MatplotLibDefaultParams} = dict(matplotlib.rcParams)
`,n.DisableJedi="%config Completer.use_jedi = False"))(OE||(OE={}));var iB="JUPYTER_OUTPUT_CHANNEL",qO="Default Light+",Zs="ms-python.python",Jv="ms-toolsai.jupyter-renderers",oB="ms-python.vscode-pylance",sB=["python","html","xml","javascript","markdown","latex","shellscript","bat","powershell","kusto","ruby","sql","perl","qsharp","raw"],aB=new Map([["bash","shellscript"],["c#","csharp"],["f#","fsharp"],["q#","qsharp"],["c++11","c++"],["c++12","c++"],["c++14","c++"]]),lB=["python","r","julia","c++","c#","f#","q#","powershell","java","scala","haskell","bash","cling","rust","sas","sos","ocaml"];var Q;(Re=>(Re.RunAllCells="jupyter.runallcells",Re.RunAllCellsAbove="jupyter.runallcellsabove",Re.RunCellAndAllBelow="jupyter.runcellandallbelow",Re.RunAllCellsAbovePalette="jupyter.runallcellsabove.palette",Re.RunCellAndAllBelowPalette="jupyter.runcurrentcellandallbelow.palette",Re.RunToLine="jupyter.runtoline",Re.RunFromLine="jupyter.runfromline",Re.RunCell="jupyter.runcell",Re.RunCurrentCell="jupyter.runcurrentcell",Re.RunCurrentCellAdvance="jupyter.runcurrentcelladvance",Re.CreateNewInteractive="jupyter.createnewinteractive",Re.ImportNotebook="jupyter.importnotebook",Re.ImportNotebookFile="jupyter.importnotebookfile",Re.ExportFileAsNotebook="jupyter.exportfileasnotebook",Re.ExportFileAndOutputAsNotebook="jupyter.exportfileandoutputasnotebook",Re.InterruptKernel="jupyter.interruptkernel",Re.RestartKernel="jupyter.restartkernel",Re.RestartKernelAndRunAllCells="jupyter.restartkernelandrunallcells",Re.RestartKernelAndRunUpToSelectedCell="jupyter.restartkernelandrunuptoselectedcell",Re.NotebookEditorRemoveAllCells="jupyter.notebookeditor.removeallcells",Re.NotebookEditorRunAllCells="jupyter.notebookeditor.runallcells",Re.NotebookEditorRunSelectedCell="jupyter.notebookeditor.runselectedcell",Re.NotebookEditorAddCellBelow="jupyter.notebookeditor.addcellbelow",Re.ExpandAllCells="jupyter.expandallcells",Re.CollapseAllCells="jupyter.collapseallcells",Re.ExportOutputAsNotebook="jupyter.exportoutputasnotebook",Re.ExecSelectionInInteractiveWindow="jupyter.execSelectionInteractive",Re.RunFileInInteractiveWindows="jupyter.runFileInteractive",Re.DebugFileInInteractiveWindows="jupyter.debugFileInteractive",Re.AddCellBelow="jupyter.addcellbelow",Re.DebugCurrentCellPalette="jupyter.debugcurrentcell.palette",Re.DebugCell="jupyter.debugcell",Re.DebugStepOver="jupyter.debugstepover",Re.DebugContinue="jupyter.debugcontinue",Re.DebugStop="jupyter.debugstop",Re.RunCurrentCellAndAddBelow="jupyter.runcurrentcellandaddbelow",Re.InsertCellBelowPosition="jupyter.insertCellBelowPosition",Re.InsertCellBelow="jupyter.insertCellBelow",Re.InsertCellAbove="jupyter.insertCellAbove",Re.DeleteCells="jupyter.deleteCells",Re.SelectCell="jupyter.selectCell",Re.SelectCellContents="jupyter.selectCellContents",Re.ExtendSelectionByCellAbove="jupyter.extendSelectionByCellAbove",Re.ExtendSelectionByCellBelow="jupyter.extendSelectionByCellBelow",Re.MoveCellsUp="jupyter.moveCellsUp",Re.MoveCellsDown="jupyter.moveCellsDown",Re.ChangeCellToMarkdown="jupyter.changeCellToMarkdown",Re.ChangeCellToCode="jupyter.changeCellToCode",Re.GotoNextCellInFile="jupyter.gotoNextCellInFile",Re.GotoPrevCellInFile="jupyter.gotoPrevCellInFile",Re.ScrollToCell="jupyter.scrolltocell",Re.CreateNewNotebook="jupyter.createnewnotebook",Re.ViewJupyterOutput="jupyter.viewOutput",Re.ExportAsPythonScript="jupyter.exportAsPythonScript",Re.ExportToHTML="jupyter.exportToHTML",Re.ExportToPDF="jupyter.exportToPDF",Re.Export="jupyter.export",Re.NativeNotebookExport="jupyter.notebookeditor.export",Re.LatestExtension="jupyter.latestExtension",Re.EnableLoadingWidgetsFrom3rdPartySource="jupyter.enableLoadingWidgetScriptsFromThirdPartySource",Re.ShowDataViewer="jupyter.showDataViewer",Re.ShowJupyterDataViewer="jupyter.showJupyterDataViewer",Re.RefreshDataViewer="jupyter.refreshDataViewer",Re.ClearSavedJupyterUris="jupyter.clearSavedJupyterUris",Re.OpenVariableView="jupyter.openVariableView",Re.OpenOutlineView="jupyter.openOutlineView",Re.InteractiveClearAll="jupyter.interactive.clearAllCells",Re.InteractiveGoToCode="jupyter.interactive.goToCode",Re.InteractiveCopyCell="jupyter.interactive.copyCell",Re.InteractiveExportAsNotebook="jupyter.interactive.exportasnotebook",Re.InteractiveExportAs="jupyter.interactive.exportas",Re.RunByLine="jupyter.runByLine",Re.RunAndDebugCell="jupyter.runAndDebugCell",Re.RunByLineNext="jupyter.runByLineNext",Re.RunByLineStop="jupyter.runByLineStop",Re.ReplayPylanceLog="jupyter.replayPylanceLog",Re.ReplayPylanceLogStep="jupyter.replayPylanceLogStep",Re.InstallPythonExtensionViaKernelPicker="jupyter.installPythonExtensionViaKernelPicker",Re.InstallPythonViaKernelPicker="jupyter.installPythonViaKernelPicker",Re.ContinueEditSessionInCodespace="jupyter.continueEditSessionInCodespace"))(Q||(Q={}));var Ku;(n=>(n.DefaultDesignLenses=[Q.RunCurrentCell,Q.RunAllCellsAbove,Q.DebugCell],n.DefaultDebuggingLenses=[Q.DebugContinue,Q.DebugStop,Q.DebugStepOver],n.DebuggerCommands=[Q.DebugContinue,Q.DebugStop,Q.DebugStepOver]))(Ku||(Ku={}));var Sr;(j=>(j.HasCodeCells="jupyter.hascodecells",j.IsInteractiveActive="jupyter.isinteractiveactive",j.OwnsSelection="jupyter.ownsSelection",j.HaveNativeCells="jupyter.havenativecells",j.HaveNative="jupyter.havenative",j.IsNativeActive="jupyter.isnativeactive",j.IsInteractiveOrNativeActive="jupyter.isinteractiveornativeactive",j.IsPythonOrNativeActive="jupyter.ispythonornativeactive",j.IsPythonOrInteractiveActive="jupyter.ispythonorinteractiveeactive",j.IsPythonOrInteractiveOrNativeActive="jupyter.ispythonorinteractiveornativeeactive",j.CanRestartNotebookKernel="jupyter.notebookeditor.canrestartNotebookkernel",j.CanInterruptNotebookKernel="jupyter.notebookeditor.canInterruptNotebookKernel",j.CanRestartInteractiveWindowKernel="jupyter.interactive.canRestartNotebookKernel",j.CanInterruptInteractiveWindowKernel="jupyter.interactive.canInterruptNotebookKernel",j.RunByLineCells="jupyter.notebookeditor.runByLineCells",j.RunByLineDocuments="jupyter.notebookeditor.runByLineDocuments",j.DebugDocuments="jupyter.notebookeditor.debugDocuments",j.IsPythonNotebook="jupyter.ispythonnotebook",j.IsJupyterKernelSelected="jupyter.kernel.isjupyter",j.IsDataViewerActive="jupyter.dataViewerActive",j.HasNativeNotebookOrInteractiveWindowOpen="jupyter.hasNativeNotebookOrInteractiveWindowOpen",j.ZmqAvailable="jupyter.zmqavailable",j.ReplayLogLoaded="jupyter.replayLogLoaded",j.KernelSource="jupyter.kernelSource"))(Sr||(Sr={}));var LE;(l=>(l.PythonCellMarker=/^(#\s*%%|#\s*\<codecell\>|#\s*In\[\d*?\]|#\s*In\[ \])/,l.PythonMarkdownCellMarker=/^(#\s*%%\s*\[markdown\]|#\s*\<markdowncell\>)/,l.UrlPatternRegEx="(?<PREFIX>https?:\\/\\/)((\\(.+\\s+or\\s+(?<IP>.+)\\))|(?<LOCAL>[^\\s]+))(?<REST>:.+)",l.HttpPattern=/https?:\/\//,l.ShapeSplitterRegEx=/.*,\s*(\d+).*/,l.SvgHeightRegex=/(\<svg.*height=\")(.*?)\"/,l.SvgWidthRegex=/(\<svg.*width=\")(.*?)\"/,l.SvgSizeTagRegex=/\<svg.*tag=\"sizeTag=\{(.*),\s*(.*)\}\"/))(LE||(LE={}));var ZPe=Symbol("DataScienceStartupTime"),GO={major:4,minor:2},yo="application/vnd.jupyter.widget-view+json";var UE=7,dP="unknown";d();d();d();var Hre=new Map;function cB(){return Hre}d();d();d();var uB=Symbol("MicrotaskDelay");async function oc(r){return new Promise(e=>{setTimeout(()=>e(r),r)})}async function fP(r,e,t){return new Promise(n=>{let i,o=setTimeout(()=>i(!1),e),s=setInterval(()=>{r().then(a=>{a&&i(!0)}).catch(a=>i(!1))},t);i=a=>{clearTimeout(o),clearInterval(s),n(a)}})}function bo(r,e,...t){let n=pP(e)?void 0:e;pP(e)&&t.push(e);let i,o=setTimeout(()=>i==null?void 0:i(n),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(o)),new Promise(s=>i=s)])}function Gv(r,e,...t){let n,i=setTimeout(()=>n==null?void 0:n(e),r);return Promise.race([Promise.race(t).finally(()=>clearTimeout(i)),new Promise((o,s)=>n=s)])}function Yv(r){return typeof(r==null?void 0:r.then)=="function"&&typeof(r==null?void 0:r.catch)=="function"}function pP(r){return typeof(r==null?void 0:r.then)=="function"}var YO=class{constructor(e=null){this.scope=e;this._resolved=!1;this._rejected=!1;this._promise=new Promise((t,n)=>{this._resolve=t,this._reject=n})}get value(){return this._value}resolve(e){this._value=e,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(e){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function ke(r=null){return new YO(r)}function Fu(r){let e=ke();return r.then(e.resolve.bind(e)).catch(e.reject.bind(e)),e}var qv=class{constructor(){this.currentPromise=Promise.resolve(void 0)}async chain(e){let t=ke(),n=this.currentPromise;return this.currentPromise=this.currentPromise.then(async()=>{try{let i=await e();t.resolve(i)}catch(i){throw t.reject(i),i}}),await n,t.promise}chainFinally(e){let t=ke();return this.currentPromise=this.currentPromise.finally(()=>e().then(n=>t.resolve(n)).catch(n=>t.reject(n))),t.promise}};var Jre=(r,e)=>{let t=!0,n=setTimeout(()=>{t=!1,e()},r);return{isTriggered:()=>t,dispose:()=>{clearTimeout(n),t=!1}}},qre=r=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,r())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},ic=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((i,o)=>{this.doResolve=i,this.doReject=o}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let i=this.task;return this.task=null,i()}}),this.completionPromise.catch(y));let n=()=>{var i;this.deferred=null,(i=this.doResolve)==null||i.call(this,null)};return this.deferred=t===uB?qre(n):Jre(t,n),this.completionPromise}isTriggered(){var e;return!!((e=this.deferred)!=null&&e.isTriggered())}cancel(){var e;this.cancelTimeout(),this.completionPromise&&((e=this.doReject)==null||e.call(this,new Error("Canceled")),this.completionPromise=null)}cancelTimeout(){var e;(e=this.deferred)==null||e.dispose(),this.deferred=null}dispose(){this.cancel()}};function y(){}function ea(r){try{let e=r();Yv(e)&&e.catch(y)}catch(e){}}function Tn(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function pB(r){let e=Tn(r)?r:r.uri;return e.scheme.includes(vp)||e.path.endsWith(".interactive")}function yp(){return process.platform.toString()==="web"}function dB(r,e){return Tn(e)?e.toString():e}function fB(r,e){return r===e?!0:r&&!e||!r&&e?!1:JSON.stringify(r,dB)===JSON.stringify(e,dB)}d();var St=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}};var DTe=cB();function In(r){return function(e,t,n){let i=n.value,o=`Jupyter Extension (Error in ${r||t}, method:${t}):`;n.value=function(...s){try{let a=i.apply(this,s);if(a&&typeof a.then=="function"&&typeof a.catch=="function")return a.catch(l=>{bn()||b.error(o,l)})}catch(a){if(bn())return;b.error(o,a)}}}}function Gre(r,e,t){let n=new St;try{t&&r(void 0);let i=e();return Yv(i)?i.then(o=>(r({elapsed:n.elapsedTime,returnValue:o}),o)).catch(o=>{r({elapsed:n.elapsedTime,err:o})}):r({elapsed:n.elapsedTime,returnValue:i}),i}catch(i){throw r({elapsed:n.elapsedTime,err:i}),i}}function mB(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a={kind:"Class",name:t&&t.constructor?t.constructor.name:"",args:s,methodName:n,target:t},l=this;return Gre(c=>r(a,c),()=>o.apply(l,s),e)},i}}function $v(){return function(r,e,t){let n=t.value;return t.value=function(...i){if(!bn())throw new Error(`Function: ${e} can only be called from test code`);return n.apply(this,i)},t}}function $O(){return function(r,e,t){let n=t.value,i=`chainedPromiseFor_${e}`;return t.value=async function(...o){let s=this[i];s?s=s.then(()=>n.apply(this,o)):s=n.apply(this,o),this[i]=s;let a=s.then(l=>l).catch(l=>{throw this[i]=void 0,l});return a.catch(y),a},t}}d();function zO(r,e){if(Array.isArray(r))return r.map(t=>zO(t,e)).join(", ");if(r===void 0)return"undefined";if(r===null)return"null";try{return r&&r.path?`<Uri:${r.path}>`:JSON.stringify(r)}catch(t){return`<${e} cannot be serialized for logging>`}}function QO(r){if(!r)return"";try{return r.map((t,n)=>{let i=zO(t,"argument");return`Arg ${n+1}: ${i}`}).join(", ")}catch(e){return""}}function hB(r){return`Return Value: ${zO(r,"Return value")}`}function mP(){let r=new Date,e=String(r.getHours()).padStart(2,"0"),t=String(r.getMinutes()).padStart(2,"0"),n=String(r.getSeconds()).padStart(2,"0"),i=String(r.getMilliseconds()).padStart(3,"0");return`${e}:${t}:${n}.${i}`}d();function at(r,e={removeEmptyEntries:!0,trim:!0}){r=r||"";let t=r.split(/\r?\n/g);return e&&e.trim&&(t=t.map(n=>n.trim())),e&&e.removeEmptyEntries&&(t=t.filter(n=>n.length>0)),t}function Yre(r){return r&&(r.indexOf(" ")>=0&&!r.startsWith('"')&&!r.endsWith('"')?`"${r}"`:r.toString())}function XO(r){return r&&Yre(r).replace(/\\/g,"/")}function WE(r){return r&&r.replace(/(^['"])|(['"]$)/g,"")}function zv(r){return r?r.replace(/\$\([a-z0-9\-]+?\)/gi,"").trim():r||""}function Qv(r){let e=r.split(`
`),t=e.find(n=>n.trim().length>0&&!n.trim().startsWith("#"));if(t){let n=t.match(/^\s*/)[0];return e.map(i=>i.startsWith(n)?i.replace(n,""):i).join(`
`)}return r}d();var aL=require("vscode");d();d();d();var gP="en",yP=!1,bP=!1,VE=!1,$re=!1,zre=!1,eL=!1,Qre=!1,Xre=!1,Zre=!1,hP,vP=gP,ene,Ip,ta=typeof self=="object"?self:{},Un;typeof ta.vscode!="undefined"&&typeof ta.vscode.process!="undefined"?Un=ta.vscode.process:typeof process!="undefined"&&(Un=process);var vB,yB=typeof((vB=Un==null?void 0:Un.versions)==null?void 0:vB.electron)=="string",bB=yB&&(Un==null?void 0:Un.type)==="renderer",MTe=bB&&(Un==null?void 0:Un.sandboxed);if(typeof navigator=="object"&&!bB)Ip=navigator.userAgent,yP=Ip.indexOf("Windows")>=0,bP=Ip.indexOf("Macintosh")>=0,Xre=(Ip.indexOf("Macintosh")>=0||Ip.indexOf("iPad")>=0||Ip.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,VE=Ip.indexOf("Linux")>=0,eL=!0,hP=navigator.language,vP=hP;else if(typeof Un=="object"){yP=Un.platform==="win32",bP=Un.platform==="darwin",VE=Un.platform==="linux",$re=VE&&!!Un.env.SNAP&&!!Un.env.SNAP_REVISION,Qre=yB,Zre=!!Un.env.CI||!!Un.env.BUILD_ARTIFACTSTAGINGDIRECTORY,hP=gP,vP=gP;let r=Un.env.VSCODE_NLS_CONFIG;if(r)try{let e=JSON.parse(r),t=e.availableLanguages["*"];hP=e.locale,vP=t||gP,ene=e._translationsConfigFile}catch(e){}zre=!0}else console.error("Unable to resolve platform.");var ZO=0;bP?ZO=1:yP?ZO=3:VE&&(ZO=2);var jE=yP,IB=bP,SB=VE;var IP=eL,OTe=eL&&typeof ta.importScripts=="function";var sc=Ip,bp=vP,gB;(n=>{function r(){return bp}n.value=r;function e(){return bp.length===2?bp==="en":bp.length>=3?bp[0]==="e"&&bp[1]==="n"&&bp[2]==="-":!1}n.isDefaultVariant=e;function t(){return bp==="en"}n.isDefault=t})(gB||(gB={}));var LTe=(()=>{if(typeof ta.postMessage=="function"&&!ta.importScripts){let r=[];ta.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let n=0,i=r.length;n<i;n++){let o=r[n];if(o.id===t.data.vscodeScheduleAsyncWork){r.splice(n,1),o.callback();return}}});let e=0;return t=>{let n=++e;r.push({id:n,callback:t}),ta.postMessage({vscodeScheduleAsyncWork:n},"*")}}return r=>setTimeout(r)})();var tne=!!(sc&&sc.indexOf("Chrome")>=0),KTe=!!(sc&&sc.indexOf("Firefox")>=0),FTe=!!(!tne&&sc&&sc.indexOf("Safari")>=0),UTe=!!(sc&&sc.indexOf("Edg/")>=0),WTe=!!(sc&&sc.indexOf("Android")>=0);var Wm;if(typeof ta.vscode!="undefined"&&typeof ta.vscode.process!="undefined"){let r=ta.vscode.process;Wm={get platform(){return r.platform},get arch(){return r.arch},get env(){return r.env},cwd(){return r.cwd()}}}else typeof process!="undefined"?Wm={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:Wm={get platform(){return jE?"win32":IB?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var SP=Wm.cwd,_B=Wm.env,jo=Wm.platform,JTe=Wm.arch;var nne=65,ine=97,one=90,sne=122,Ep=46,gi=47,Bo=92,Sp=58,ane=63,_P=class extends Error{constructor(t,n,i){let o;typeof n=="string"&&n.indexOf("not ")===0?(o="must not be",n=n.replace(/^not /,"")):o="must be";let s=t.indexOf(".")!==-1?"property":"argument",a=`The "${t}" ${s} ${o} of type ${n}`;a+=`. Received type ${typeof i}`;super(a);this.code="ERR_INVALID_ARG_TYPE"}};function Sn(r,e){if(typeof r!="string")throw new _P(e,"string",r)}function Dt(r){return r===gi||r===Bo}function tL(r){return r===gi}function _p(r){return r>=nne&&r<=one||r>=ine&&r<=sne}function EP(r,e,t,n){let i="",o=0,s=-1,a=0,l=0;for(let c=0;c<=r.length;++c){if(c<r.length)l=r.charCodeAt(c);else{if(n(l))break;l=gi}if(n(l)){if(!(s===c-1||a===1))if(a===2){if(i.length<2||o!==2||i.charCodeAt(i.length-1)!==Ep||i.charCodeAt(i.length-2)!==Ep){if(i.length>2){let u=i.lastIndexOf(t);u===-1?(i="",o=0):(i=i.slice(0,u),o=i.length-1-i.lastIndexOf(t)),s=c,a=0;continue}else if(i.length!==0){i="",o=0,s=c,a=0;continue}}e&&(i+=i.length>0?`${t}..`:"..",o=2)}else i.length>0?i+=`${t}${r.slice(s+1,c)}`:i=r.slice(s+1,c),o=c-s-1;s=c,a=0}else l===Ep&&a!==-1?++a:a=-1}return i}function EB(r,e){if(e===null||typeof e!="object")throw new _P("pathObject","Object",e);let t=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return t?t===e.root?`${t}${n}`:`${t}${r}${n}`:n}var Wn={resolve(...r){let e="",t="",n=!1;for(let i=r.length-1;i>=-1;i--){let o;if(i>=0){if(o=r[i],Sn(o,"path"),o.length===0)continue}else e.length===0?o=SP():(o=_B[`=${e}`]||SP(),(o===void 0||o.slice(0,2).toLowerCase()!==e.toLowerCase()&&o.charCodeAt(2)===Bo)&&(o=`${e}\\`));let s=o.length,a=0,l="",c=!1,u=o.charCodeAt(0);if(s===1)Dt(u)&&(a=1,c=!0);else if(Dt(u))if(c=!0,Dt(o.charCodeAt(1))){let p=2,f=p;for(;p<s&&!Dt(o.charCodeAt(p));)p++;if(p<s&&p!==f){let m=o.slice(f,p);for(f=p;p<s&&Dt(o.charCodeAt(p));)p++;if(p<s&&p!==f){for(f=p;p<s&&!Dt(o.charCodeAt(p));)p++;(p===s||p!==f)&&(l=`\\\\${m}\\${o.slice(f,p)}`,a=p)}}}else a=1;else _p(u)&&o.charCodeAt(1)===Sp&&(l=o.slice(0,2),a=2,s>2&&Dt(o.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(n){if(e.length>0)break}else if(t=`${o.slice(a)}\\${t}`,n=c,c&&e.length>0)break}return t=EP(t,!n,"\\",Dt),n?`${e}\\${t}`:`${e}${t}`||"."},normalize(r){Sn(r,"path");let e=r.length;if(e===0)return".";let t=0,n,i=!1,o=r.charCodeAt(0);if(e===1)return tL(o)?"\\":r;if(Dt(o))if(i=!0,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){let c=r.slice(l,a);for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${r.slice(l)}\\`;a!==l&&(n=`\\\\${c}\\${r.slice(l,a)}`,t=a)}}}else t=1;else _p(o)&&r.charCodeAt(1)===Sp&&(n=r.slice(0,2),t=2,e>2&&Dt(r.charCodeAt(2))&&(i=!0,t=3));let s=t<e?EP(r.slice(t),!i,"\\",Dt):"";return s.length===0&&!i&&(s="."),s.length>0&&Dt(r.charCodeAt(e-1))&&(s+="\\"),n===void 0?i?`\\${s}`:s:i?`${n}\\${s}`:`${n}${s}`},isAbsolute(r){Sn(r,"path");let e=r.length;if(e===0)return!1;let t=r.charCodeAt(0);return Dt(t)||e>2&&_p(t)&&r.charCodeAt(1)===Sp&&Dt(r.charCodeAt(2))},join(...r){if(r.length===0)return".";let e,t;for(let o=0;o<r.length;++o){let s=r[o];Sn(s,"path"),s.length>0&&(e===void 0?e=t=s:e+=`\\${s}`)}if(e===void 0)return".";let n=!0,i=0;if(typeof t=="string"&&Dt(t.charCodeAt(0))){++i;let o=t.length;o>1&&Dt(t.charCodeAt(1))&&(++i,o>2&&(Dt(t.charCodeAt(2))?++i:n=!1))}if(n){for(;i<e.length&&Dt(e.charCodeAt(i));)i++;i>=2&&(e=`\\${e.slice(i)}`)}return Wn.normalize(e)},relative(r,e){if(Sn(r,"from"),Sn(e,"to"),r===e)return"";let t=Wn.resolve(r),n=Wn.resolve(e);if(t===n||(r=t.toLowerCase(),e=n.toLowerCase(),r===e))return"";let i=0;for(;i<r.length&&r.charCodeAt(i)===Bo;)i++;let o=r.length;for(;o-1>i&&r.charCodeAt(o-1)===Bo;)o--;let s=o-i,a=0;for(;a<e.length&&e.charCodeAt(a)===Bo;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===Bo;)l--;let c=l-a,u=s<c?s:c,p=-1,f=0;for(;f<u;f++){let h=r.charCodeAt(i+f);if(h!==e.charCodeAt(a+f))break;h===Bo&&(p=f)}if(f!==u){if(p===-1)return n}else{if(c>u){if(e.charCodeAt(a+f)===Bo)return n.slice(a+f+1);if(f===2)return n.slice(a+f)}s>u&&(r.charCodeAt(i+f)===Bo?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=i+p+1;f<=o;++f)(f===o||r.charCodeAt(f)===Bo)&&(m+=m.length===0?"..":"\\..");return a+=p,m.length>0?`${m}${n.slice(a,l)}`:(n.charCodeAt(a)===Bo&&++a,n.slice(a,l))},toNamespacedPath(r){if(typeof r!="string")return r;if(r.length===0)return"";let e=Wn.resolve(r);if(e.length<=2)return r;if(e.charCodeAt(0)===Bo){if(e.charCodeAt(1)===Bo){let t=e.charCodeAt(2);if(t!==ane&&t!==Ep)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(_p(e.charCodeAt(0))&&e.charCodeAt(1)===Sp&&e.charCodeAt(2)===Bo)return`\\\\?\\${e}`;return r},dirname(r){Sn(r,"path");let e=r.length;if(e===0)return".";let t=-1,n=0,i=r.charCodeAt(0);if(e===1)return Dt(i)?r:".";if(Dt(i)){if(t=n=1,Dt(r.charCodeAt(1))){let a=2,l=a;for(;a<e&&!Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&Dt(r.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!Dt(r.charCodeAt(a));)a++;if(a===e)return r;a!==l&&(t=n=a+1)}}}}else _p(i)&&r.charCodeAt(1)===Sp&&(t=e>2&&Dt(r.charCodeAt(2))?3:2,n=t);let o=-1,s=!0;for(let a=e-1;a>=n;--a)if(Dt(r.charCodeAt(a))){if(!s){o=a;break}}else s=!1;if(o===-1){if(t===-1)return".";o=t}return r.slice(0,o)},basename(r,e){e!==void 0&&Sn(e,"ext"),Sn(r,"path");let t=0,n=-1,i=!0,o;if(r.length>=2&&_p(r.charCodeAt(0))&&r.charCodeAt(1)===Sp&&(t=2),e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=t;--o){let l=r.charCodeAt(o);if(Dt(l)){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=t;--o)if(Dt(r.charCodeAt(o))){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){Sn(r,"path");let e=0,t=-1,n=0,i=-1,o=!0,s=0;r.length>=2&&r.charCodeAt(1)===Sp&&_p(r.charCodeAt(0))&&(e=n=2);for(let a=r.length-1;a>=e;--a){let l=r.charCodeAt(a);if(Dt(l)){if(!o){n=a+1;break}continue}i===-1&&(o=!1,i=a+1),l===Ep?t===-1?t=a:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||i===-1||s===0||s===1&&t===i-1&&t===n+1?"":r.slice(t,i)},format:EB.bind(null,"\\"),parse(r){Sn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.length,n=0,i=r.charCodeAt(0);if(t===1)return Dt(i)?(e.root=e.dir=r,e):(e.base=e.name=r,e);if(Dt(i)){if(n=1,Dt(r.charCodeAt(1))){let p=2,f=p;for(;p<t&&!Dt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&Dt(r.charCodeAt(p));)p++;if(p<t&&p!==f){for(f=p;p<t&&!Dt(r.charCodeAt(p));)p++;p===t?n=p:p!==f&&(n=p+1)}}}}else if(_p(i)&&r.charCodeAt(1)===Sp){if(t<=2)return e.root=e.dir=r,e;if(n=2,Dt(r.charCodeAt(2))){if(t===3)return e.root=e.dir=r,e;n=3}}n>0&&(e.root=r.slice(0,n));let o=-1,s=n,a=-1,l=!0,c=r.length-1,u=0;for(;c>=n;--c){if(i=r.charCodeAt(c),Dt(i)){if(!l){s=c+1;break}continue}a===-1&&(l=!1,a=c+1),i===Ep?o===-1?o=c:u!==1&&(u=1):o!==-1&&(u=-1)}return a!==-1&&(o===-1||u===0||u===1&&o===a-1&&o===s+1?e.base=e.name=r.slice(s,a):(e.name=r.slice(s,o),e.base=r.slice(s,a),e.ext=r.slice(o,a))),s>0&&s!==n?e.dir=r.slice(0,s-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},Cr={resolve(...r){let e="",t=!1;for(let n=r.length-1;n>=-1&&!t;n--){let i=n>=0?r[n]:SP();Sn(i,"path"),i.length!==0&&(e=`${i}/${e}`,t=i.charCodeAt(0)===gi)}return e=EP(e,!t,"/",tL),t?`/${e}`:e.length>0?e:"."},normalize(r){if(Sn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===gi,t=r.charCodeAt(r.length-1)===gi;return r=EP(r,!e,"/",tL),r.length===0?e?"/":t?"./":".":(t&&(r+="/"),e?`/${r}`:r)},isAbsolute(r){return Sn(r,"path"),r.length>0&&r.charCodeAt(0)===gi},join(...r){if(r.length===0)return".";let e;for(let t=0;t<r.length;++t){let n=r[t];Sn(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":Cr.normalize(e)},relative(r,e){if(Sn(r,"from"),Sn(e,"to"),r===e||(r=Cr.resolve(r),e=Cr.resolve(e),r===e))return"";let t=1,n=r.length,i=n-t,o=1,s=e.length-o,a=i<s?i:s,l=-1,c=0;for(;c<a;c++){let p=r.charCodeAt(t+c);if(p!==e.charCodeAt(o+c))break;p===gi&&(l=c)}if(c===a)if(s>a){if(e.charCodeAt(o+c)===gi)return e.slice(o+c+1);if(c===0)return e.slice(o+c)}else i>a&&(r.charCodeAt(t+c)===gi?l=c:c===0&&(l=0));let u="";for(c=t+l+1;c<=n;++c)(c===n||r.charCodeAt(c)===gi)&&(u+=u.length===0?"..":"/..");return`${u}${e.slice(o+l)}`},toNamespacedPath(r){return r},dirname(r){if(Sn(r,"path"),r.length===0)return".";let e=r.charCodeAt(0)===gi,t=-1,n=!0;for(let i=r.length-1;i>=1;--i)if(r.charCodeAt(i)===gi){if(!n){t=i;break}}else n=!1;return t===-1?e?"/":".":e&&t===1?"//":r.slice(0,t)},basename(r,e){e!==void 0&&Sn(e,"ext"),Sn(r,"path");let t=0,n=-1,i=!0,o;if(e!==void 0&&e.length>0&&e.length<=r.length){if(e===r)return"";let s=e.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===gi){if(!i){t=o+1;break}}else a===-1&&(i=!1,a=o+1),s>=0&&(l===e.charCodeAt(s)?--s===-1&&(n=o):(s=-1,n=a))}return t===n?n=a:n===-1&&(n=r.length),r.slice(t,n)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===gi){if(!i){t=o+1;break}}else n===-1&&(i=!1,n=o+1);return n===-1?"":r.slice(t,n)},extname(r){Sn(r,"path");let e=-1,t=0,n=-1,i=!0,o=0;for(let s=r.length-1;s>=0;--s){let a=r.charCodeAt(s);if(a===gi){if(!i){t=s+1;break}continue}n===-1&&(i=!1,n=s+1),a===Ep?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||n===-1||o===0||o===1&&e===n-1&&e===t+1?"":r.slice(e,n)},format:EB.bind(null,"/"),parse(r){Sn(r,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return e;let t=r.charCodeAt(0)===gi,n;t?(e.root="/",n=1):n=0;let i=-1,o=0,s=-1,a=!0,l=r.length-1,c=0;for(;l>=n;--l){let u=r.charCodeAt(l);if(u===gi){if(!a){o=l+1;break}continue}s===-1&&(a=!1,s=l+1),u===Ep?i===-1?i=l:c!==1&&(c=1):i!==-1&&(c=-1)}if(s!==-1){let u=o===0&&t?1:o;i===-1||c===0||c===1&&i===s-1&&i===o+1?e.base=e.name=r.slice(u,s):(e.name=r.slice(u,i),e.base=r.slice(u,s),e.ext=r.slice(i,s))}return o>0?e.dir=r.slice(0,o-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Cr.win32=Wn.win32=Wn;Cr.posix=Wn.posix=Cr;var _s=jo==="win32"?Wn.normalize:Cr.normalize,GTe=jo==="win32"?Wn.isAbsolute:Cr.isAbsolute,BE=jo==="win32"?Wn.join:Cr.join,CB=jo==="win32"?Wn.resolve:Cr.resolve,wB=jo==="win32"?Wn.relative:Cr.relative,ki=jo==="win32"?Wn.dirname:Cr.dirname,rr=jo==="win32"?Wn.basename:Cr.basename,Cp=jo==="win32"?Wn.extname:Cr.extname,YTe=jo==="win32"?Wn.format:Cr.format,$Te=jo==="win32"?Wn.parse:Cr.parse,zTe=jo==="win32"?Wn.toNamespacedPath:Cr.toNamespacedPath,qi=jo==="win32"?Wn.sep:Cr.sep,QTe=jo==="win32"?Wn.delimiter:Cr.delimiter;d();var JE=require("vscode");d();d();d();d();var lne=require("vscode");var CP=class{constructor(e){this.computeFn=e;this.lastCache=void 0;this.lastArgKey=void 0}get(e){let t=JSON.stringify(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this.computeFn(e)),this.lastCache}};d();var HE=class r{constructor(e){this.executor=e;this._didRun=!1}hasValue(){return this._didRun}getValue(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}map(e){return new r(()=>e(this.getValue()))}};function kB(r,e){return r<e?-1:r>e?1:0}function cne(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l<c)return-1;if(l>c)return 1}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function NB(r,e,t=0,n=r.length,i=0,o=e.length){for(;t<n&&i<o;t++,i++){let l=r.charCodeAt(t),c=e.charCodeAt(i);if(l===c)continue;if(l>=128||c>=128)return cne(r.toLowerCase(),e.toLowerCase(),t,n,i,o);xB(l)&&(l-=32),xB(c)&&(c-=32);let u=l-c;if(u!==0)return u}let s=n-t,a=o-i;return s<a?-1:s>a?1:0}function xB(r){return r>=97&&r<=122}function RB(r,e){return r.length===e.length&&NB(r,e)===0}function AB(r,e){let t=e.length;return e.length>r.length?!1:NB(r,e,0,t)===0}var ac=class ac{constructor(e){this.confusableDictionary=e}static getInstance(e){return ac.cache.get(Array.from(e))}static getLocales(){return ac._locales.getValue()}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};ac.ambiguousCharacterData=new HE(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),ac.cache=new CP(e=>{function t(u){let p=new Map;for(let f=0;f<u.length;f+=2)p.set(u[f],u[f+1]);return p}function n(u,p){let f=new Map(u);for(let[m,h]of p)f.set(m,h);return f}function i(u,p){if(!u)return p;let f=new Map;for(let[m,h]of u)p.has(m)&&f.set(m,h);return f}let o=ac.ambiguousCharacterData.getValue(),s=e.filter(u=>!u.startsWith("_")&&u in o);s.length===0&&(s=["_default"]);let a;for(let u of s){let p=t(o[u]);a=i(a,p)}let l=t(o._common),c=n(l,a);return new ac(c)}),ac._locales=new HE(()=>Object.keys(ac.ambiguousCharacterData.getValue()).filter(e=>!e.startsWith("_")));var DB=ac,Xv=class Xv{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(Xv.getRawData())),this._data}static isInvisibleCharacter(e){return Xv.getData().has(e)}static get codePoints(){return Xv.getData()}};Xv._data=void 0;var PB=Xv;function wp(r){return r===47||r===92}function rL(r){return r.replace(/[\\/]/g,Cr.sep)}function MB(r){return r.indexOf("/")===-1&&(r=rL(r)),/^[a-zA-Z]:(\/|$)/.test(r)&&(r="/"+r),r}function nL(r,e=Cr.sep){if(!r)return"";let t=r.length,n=r.charCodeAt(0);if(wp(n)){if(wp(r.charCodeAt(1))&&!wp(r.charCodeAt(2))){let o=3,s=o;for(;o<t&&!wp(r.charCodeAt(o));o++);if(s!==o&&!wp(r.charCodeAt(o+1))){for(o+=1;o<t;o++)if(wp(r.charCodeAt(o)))return r.slice(0,o+1).replace(/[\\/]/g,e)}}return e}else if(une(n)&&r.charCodeAt(1)===58)return wp(r.charCodeAt(2))?r.slice(0,2)+e:r.slice(0,2);let i=r.indexOf("://");if(i!==-1){for(i+=3;i<t;i++)if(wp(r.charCodeAt(i)))return r.slice(0,i+1)}return""}function iL(r,e,t,n=qi){if(r===e)return!0;if(!r||!e||e.length>r.length)return!1;if(t){if(!AB(r,e))return!1;if(e.length===r.length)return!0;let o=e.length;return e.charAt(e.length-1)===n&&o--,r.charAt(o)===n}return e.charAt(e.length-1)!==n&&(e+=n),r.indexOf(e)===0}function une(r){return r>=65&&r<=90||r>=97&&r<=122}d();var Wa;(ae=>(ae.inMemory="inmemory",ae.vscode="vscode",ae.internal="private",ae.walkThrough="walkThrough",ae.walkThroughSnippet="walkThroughSnippet",ae.http="http",ae.https="https",ae.file="file",ae.mailto="mailto",ae.untitled="untitled",ae.data="data",ae.command="command",ae.vscodeRemote="vscode-remote",ae.vscodeRemoteResource="vscode-remote-resource",ae.vscodeUserData="vscode-userdata",ae.vscodeCustomEditor="vscode-custom-editor",ae.vscodeNotebook="vscode-notebook",ae.vscodeNotebookCell="vscode-notebook-cell",ae.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",ae.vscodeNotebookCellOutput="vscode-notebook-cell-output",ae.vscodeInteractive="vscode-interactive",ae.vscodeInteractiveInput="vscode-interactive-input",ae.vscodeSettings="vscode-settings",ae.vscodeWorkspaceTrust="vscode-workspace-trust",ae.vscodeTerminal="vscode-terminal",ae.webviewPanel="webview-panel",ae.vscodeWebview="vscode-webview",ae.extension="extension",ae.vscodeFileResource="vscode-file",ae.tmp="tmp",ae.vsls="vsls"))(Wa||(Wa={}));function Va(r){return IP?(r==null?void 0:r.path)||"":(r==null?void 0:r.fsPath)||""}var qE=class{constructor(e){this._ignorePathCasing=e}compare(e,t,n=!1){return e===t?0:kB(this.getComparisonKey(e,n),this.getComparisonKey(t,n))}isEqual(e,t,n=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,n)===this.getComparisonKey(t,n)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,t,n=!1,i=jE?"\\":"/"){if(e.scheme===t.scheme){if(e.scheme===Wa.file)return iL(Va(e),Va(t),this._ignorePathCasing(e),i)&&e.query===t.query&&(n||e.fragment===t.fragment);if(OB(e.authority,t.authority))return iL(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(n||e.fragment===t.fragment)}return!1}joinPath(e,...t){return JE.Uri.joinPath(e,...t)}basenameOrAuthority(e){return vi(e)||e.authority}basename(e,t){return Cr.basename(e.path,t)}extname(e){return Cr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Wa.file?t=JE.Uri.file(ki(Va(e))).path:(t=Cr.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Wa.file?t=JE.Uri.file(_s(Va(e))).path:t=Cr.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!OB(e.authority,t.authority))return;if(e.scheme===Wa.file){let o=wB(Va(e),Va(t));return jE?rL(o):o}let n=e.path||"/",i=t.path||"/";if(this._ignorePathCasing(e)){let o=0;for(let s=Math.min(n.length,i.length);o<s&&!(n.charCodeAt(o)!==i.charCodeAt(o)&&n.charAt(o).toLowerCase()!==i.charAt(o).toLowerCase());o++);n=i.substr(0,o)+n.substr(o)}return Cr.relative(n,i)}resolvePath(e,t){if(e.scheme===Wa.file){let n=JE.Uri.file(CB(Va(e),t));return e.with({authority:n.authority,path:n.path})}return t=MB(t),e.with({path:Cr.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&RB(e,t)}hasTrailingPathSeparator(e,t=qi){if(e.scheme===Wa.file){let n=Va(e);return n.length>nL(n).length&&n[n.length-1]===t}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=qi){return LB(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=qi){let n=!1;if(e.scheme===Wa.file){let i=Va(e);n=i!==void 0&&i.length===nL(i).length&&i[i.length-1]===t}else{t="/";let i=e.path;n=i.length===1&&i.charCodeAt(i.length-1)===47}return!n&&!LB(e,t)?e.with({path:e.path+"/"}):e}},dr=new qE(()=>!1),_ke=new qE(r=>r.scheme===Wa.file?!SB:!0),Eke=new qE(r=>!0),ra=dr.isEqual.bind(dr),wP=dr.isEqualOrParent.bind(dr),ja=dr.getComparisonKey.bind(dr),Cke=dr.basenameOrAuthority.bind(dr),vi=dr.basename.bind(dr),Zv=dr.extname.bind(dr),ey=dr.dirname.bind(dr),Gi=dr.joinPath.bind(dr),wke=dr.normalizePath.bind(dr),oL=dr.relativePath.bind(dr),xke=dr.resolvePath.bind(dr),Dke=dr.isAbsolutePath.bind(dr),OB=dr.isEqualAuthority.bind(dr),LB=dr.hasTrailingPathSeparator.bind(dr),Pke=dr.removeTrailingPathSeparator.bind(dr),Tke=dr.addTrailingPathSeparator.bind(dr),KB;(o=>{o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function i(s){let a=new Map;s.path.substring(s.path.indexOf(";")+1,s.path.lastIndexOf(";")).split(";").forEach(u=>{let[p,f]=u.split(":");p&&f&&a.set(p,f)});let c=s.path.substring(0,s.path.indexOf(";"));return c&&a.set(o.META_DATA_MIME,c),a}o.parseMetaData=i})(KB||(KB={}));d();function Ni(r=process.platform){return/^win/.test(r)?"Windows":/^darwin/.test(r)?"OSX":/^linux/.test(r)?"Linux":"Unknown"}function xP(r,e){return r.replace(/^~(?=$|\/|\\)/,e)}function pne(){if(!yp())return aL.Uri.file(require("os").homedir())}function lt(r){let e=Ni()==="Windows";if(r){let t=Va(r);return t&&t.startsWith(qi)&&t.length>1&&t[1]!==qi&&e?t.slice(1):t||""}return""}function ye(r,e=[],t){t=t||pne();let n;typeof r=="string"&&(n=aL.Uri.file(r)),typeof r!="string"&&(n=r);let i=sL(n,void 0,t),o=e.find(l=>n&&wP(n,l.uri,!0));if(e.length>1&&o)return`${o.name}${qi}${sL(n,o.uri,t)}`;let s=o?[sL(n,o.uri,t)]:[],a=i;return[i,...s].forEach(l=>{l.length<a.length&&(a=l)}),a}function sL(r,e,t){let n=Ni()==="Windows";if(r&&e&&wP(r,e,!0)){let i=oL(e,r);if(i)return n?i.replace(/\//g,"\\"):i}if(r&&t&&wP(r,t,!0)){let i=oL(t,r);if(i)return i=n?i.replace(/\//g,"\\"):i,`~${qi}${i}`}return lt(r)}d();d();var DP=class{constructor(){this.event=(e,t,n)=>{let i=this.add(t?e.bind(t):e);return n==null||n.push(i),i}}get size(){return this.listeners?typeof this.listeners=="function"?1:this.listeners.length:0}fire(e){if(this.listeners)if(typeof this.listeners=="function")this.listeners(e);else for(let t of this.listeners)t(e)}dispose(){this.listeners=void 0}add(e){return this.listeners?typeof this.listeners=="function"?this.listeners=[this.listeners,e]:this.listeners.push(e):this.listeners=e,{dispose:()=>this.rm(e)}}rm(e){if(!this.listeners)return;if(typeof this.listeners=="function"){this.listeners===e&&(this.listeners=void 0);return}let t=this.listeners.indexOf(e);t!==-1&&(this.listeners.length===2?this.listeners=t===0?this.listeners[1]:this.listeners[0]:this.listeners=this.listeners.slice(0,t).concat(this.listeners.slice(t+1)))}};d();function pr(r){let e=this,t=!1,n;return function(){return t||(t=!0,n=r.apply(e,arguments)),n}}d();var PP;(v=>{function r(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}v.is=r;let e=Object.freeze([]);function t(){return e}v.empty=t;function*n(S){yield S}v.single=n;function i(S){return r(S)?S:n(S)}v.wrap=i;function o(S){return S||e}v.from=o;function s(S){return!S||S[Symbol.iterator]().next().done===!0}v.isEmpty=s;function a(S){return S[Symbol.iterator]().next().value}v.first=a;function l(S,_){for(let D of S)if(_(D))return!0;return!1}v.some=l;function c(S,_){for(let D of S)if(_(D))return D}v.find=c;function*u(S,_){for(let D of S)_(D)&&(yield D)}v.filter=u;function*p(S,_){let D=0;for(let P of S)yield _(P,D++)}v.map=p;function*f(...S){for(let _ of S)for(let D of _)yield D}v.concat=f;function m(S,_,D){let P=D;for(let M of S)P=_(P,M);return P}v.reduce=m;function*h(S,_,D=S.length){for(_<0&&(_+=S.length),D<0?D+=S.length:D>S.length&&(D=S.length);_<D;_++)yield S[_]}v.slice=h;function g(S,_=Number.POSITIVE_INFINITY){let D=[];if(_===0)return[D,S];let P=S[Symbol.iterator]();for(let M=0;M<_;M++){let x=P.next();if(x.done)return[D,v.empty()];D.push(x.value)}return[D,{[Symbol.iterator](){return P}}]}v.consume=g})(PP||(PP={}));var TP;function UB(r){TP=r}function Uu(r){return TP==null||TP.push(r),r}function me(r){if(PP.is(r)){for(let e of r)if(e)try{e.dispose()}catch(t){console.warn(`dispose() failed for ${e}`,t)}return Array.isArray(r)?[]:r}else if(r)return r.dispose(),r}var NP=class NP{constructor(...e){this._toDispose=new Set;this._isDisposed=!1;e.forEach(t=>this.add(t)),Uu(this)}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{me(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?NP.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}};NP.DISABLE_DISPOSED_WARNING=!1;var kn=NP,Vr=class{constructor(...e){this._store=new kn;this._isDisposed=!1;e.forEach(t=>this._store.add(t)),Uu(this)}get isDisposed(){return this._isDisposed}dispose(){this._store.dispose(),this._isDisposed=!0}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},lc=class extends Vr{constructor(){super();this._onDidDispose=new DP,this.onDidDispose=this._onDidDispose.event}dispose(){super.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose()}};var FB=class{constructor(){this._store=new Map;this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{me(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get(e){return this._store.get(e)}set(e,t,n=!1){var i;this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||(i=this._store.get(e))==null||i.dispose(),this._store.set(e,t)}deleteAndDispose(e){var t;(t=this._store.get(e))==null||t.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var kP=class{constructor(){this.references=new Map}acquire(e,...t){let n=this.references.get(e);n||(n={counter:0,object:this.createReferencedObject(e,...t)},this.references.set(e,n));let{object:i}=n,o=pr(()=>{n&&--n.counter===0&&(this.destroyReferencedObject(e,n.object),this.references.delete(e))});return n.counter++,{object:i,dispose:o}}};d();var w=require("vscode");d();var Ze=require("vscode"),lL=60,cL=lL*60,GE=cL*24,WB=GE*7,VB=GE*30,jB=GE*365;function ty(r,e,t,n){typeof r!="number"&&(r=r.getTime());let i=Math.round((new Date().getTime()-r)/1e3);if(i<-30)return Ze.l10n.t("in {0}",ty(new Date().getTime()+i*1e3,!1));if(!n&&i<30)return Ze.l10n.t("now");let o;return i<lL?(o=i,e?o===1?t?Ze.l10n.t("{0} second ago",o):Ze.l10n.t("{0} sec ago",o):t?Ze.l10n.t("{0} seconds ago",o):Ze.l10n.t("{0} secs ago",o):o===1?t?Ze.l10n.t("{0} second",o):Ze.l10n.t("{0} sec",o):t?Ze.l10n.t("{0} seconds",o):Ze.l10n.t("{0} secs",o)):i<cL?(o=Math.floor(i/lL),e?o===1?t?Ze.l10n.t("{0} minute ago",o):Ze.l10n.t("{0} min ago",o):t?Ze.l10n.t("{0} minutes ago",o):Ze.l10n.t("{0} mins ago",o):o===1?t?Ze.l10n.t("{0} minute",o):Ze.l10n.t("{0} min",o):t?Ze.l10n.t("{0} minutes",o):Ze.l10n.t("{0} mins",o)):i<GE?(o=Math.floor(i/cL),e?o===1?t?Ze.l10n.t("{0} hour ago",o):Ze.l10n.t("{0} hr ago",o):t?Ze.l10n.t("{0} hours ago",o):Ze.l10n.t("{0} hrs ago",o):o===1?t?Ze.l10n.t("{0} hour",o):Ze.l10n.t("{0} hr",o):t?Ze.l10n.t("{0} hours",o):Ze.l10n.t("{0} hrs",o)):i<WB?(o=Math.floor(i/GE),e?o===1?Ze.l10n.t("{0} day ago",o):Ze.l10n.t("{0} days ago",o):o===1?Ze.l10n.t("{0} day",o):Ze.l10n.t("{0} days",o)):i<VB?(o=Math.floor(i/WB),e?o===1?t?Ze.l10n.t("{0} week ago",o):Ze.l10n.t("{0} wk ago",o):t?Ze.l10n.t("{0} weeks ago",o):Ze.l10n.t("{0} wks ago",o):o===1?t?Ze.l10n.t("{0} week",o):Ze.l10n.t("{0} wk",o):t?Ze.l10n.t("{0} weeks",o):Ze.l10n.t("{0} wks",o)):i<jB?(o=Math.floor(i/VB),e?o===1?t?Ze.l10n.t("{0} month ago",o):Ze.l10n.t("{0} mo ago",o):t?Ze.l10n.t("{0} months ago",o):Ze.l10n.t("{0} mos ago",o):o===1?t?Ze.l10n.t("{0} month",o):Ze.l10n.t("{0} mo",o):t?Ze.l10n.t("{0} months",o):Ze.l10n.t("{0} mos",o)):(o=Math.floor(i/jB),e?o===1?t?Ze.l10n.t("{0} year ago",o):Ze.l10n.t("{0} yr ago",o):t?Ze.l10n.t("{0} years ago",o):Ze.l10n.t("{0} yrs ago",o):o===1?t?Ze.l10n.t("{0} year",o):Ze.l10n.t("{0} yr",o):t?Ze.l10n.t("{0} years",o):Ze.l10n.t("{0} yrs",o))}d();d();d();d();var h7=$(te());var cy=class{async createHash(e,t="SHA-256"){return qa(e,t)}};cy=E([(0,h7.injectable)()],cy);var cT={},m7=!1,uT;typeof window=="object"?uT=window.crypto:typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope?uT=self.crypto:uT=require("node:crypto").webcrypto;async function qa(r,e){let t=r.includes("/")||r.includes("\\")||r.endsWith(".interactive");if(t&&cT[r])return cT[r];let n=await Xae(r,e);return t&&!m7&&(Object.keys(cT).length>1e4&&(m7=!0),cT[r]=n),n}async function Xae(r,e){let t=new TextEncoder().encode(r),n=await uT.subtle.digest({name:e},t);return Array.from(new Uint8Array(n)).map(o=>o.toString(16).padStart(2,"0")).join("")}function uy(r){if(typeof r=="string")try{let[e,t,n]=`${r.trim()}...`.split(".").map(i=>parseInt(i,10));return isNaN(e)?"":isNaN(t)?e.toString():isNaN(n)?`${e}.${t}`:`${e}.${t}.${n}`}catch(e){return b.error(`Failed to parse version ${r}`,e),""}return r?`${r.major}.${r.minor}.${r.micro}`:""}async function Rt(r){return qa(r,"SHA-256")}var jL=$(g7());var ZE=require("vscode");function ju(r){var l,c,u;let e=Zi(r);if(e){let p=[];typeof((l=e.version)==null?void 0:l.major)=="number"&&(p.push(e.version.major.toString()),typeof e.version.minor=="number"&&(p.push(e.version.minor.toString()),typeof e.version.micro=="number"&&p.push(e.version.micro.toString())));let f=p.length?p.join("."):"",m=((c=e.environment)==null?void 0:c.name)||(e.environment?vi((u=e.environment)==null?void 0:u.folderUri):""),h=f?`Python ${f}`:"Python";return kp(r)&&m?m:m?`${m} (${h})`:h}if(Object.keys(r).length===1&&r.id)return r.id;let t=uy(Bu(r)||"").trim(),n=kp(r),i=t?`Python ${t}`:"Python",o=Es(r);if(n&&o)return o;let s=[];o&&s.push(o);let a=Zr(r);return a&&a!=="Unknown"&&s.push(a),[i,s.length?`(${s.join(": ")})`:""].join(" ").trim()}function Es(r){var n,i,o;let e=Zi(r),t=(n=e==null?void 0:e.environment)==null?void 0:n.name;return!t&&((i=e==null?void 0:e.environment)!=null&&i.folderUri)&&Zr(r)==="Conda"&&(t=vi((o=e==null?void 0:e.environment)==null?void 0:o.folderUri)),t}var tle=["Unknown","Conda","PipEnv","Poetry","Pyenv","Venv","VirtualEnv","VirtualEnvWrapper"];function Zr(r){let e=Zi(r);return e?rle(e):"Unknown"}function rle(r){var t,n;if(((t=r.environment)==null?void 0:t.type)==="Conda")return"Conda";let e=[["Conda","Conda"],["Pyenv","Pyenv"],["Pipenv","PipEnv"],["Poetry","Poetry"],["VirtualEnvWrapper","VirtualEnvWrapper"],["VirtualEnv","VirtualEnv"],["Venv","Venv"]];for(let[i,o]of e)if(r.tools.includes(i))return o;if(((n=r.environment)==null?void 0:n.type)==="VirtualEnvironment")return"VirtualEnv";for(let i of tle)if(r.tools.some(o=>o.toLowerCase()===i.toLowerCase()))return i;return"Unknown"}var Go;function v7(r){Go=r}function kp(r){if(!r||!Go)return!1;let e=Zi(r);return e&&Zr(e)==="Conda"&&!e.executable.uri}function Zi(r){if(r){if(!Go)throw new Error("Python API not initialized");return Go.environments.known.find(e=>e.id===r.id)}}async function BL(r){var n;if(!(r!=null&&r.id))return;if(Go){let i=Go.environments.known.find(o=>o.id===r.id);if((n=i==null?void 0:i.executable)!=null&&n.sysPrefix)return i.executable.sysPrefix}let t=await(await jL.PythonExtension.api()).environments.resolveEnvironment(r.id).then(i=>{var o;return(o=i==null?void 0:i.executable)==null?void 0:o.sysPrefix});return t||b.warn(`Unable to find sysPrefix for interpreter ${ye(r.id)}`),t}function y7(r){var t;if(!(r!=null&&r.id))return;if(!Go)throw new Error("Python API not initialized");let e=Go.environments.known.find(n=>n.id===r.id);return(t=e==null?void 0:e.executable)==null?void 0:t.sysPrefix}async function Np(r,e=!1){if(!(r!=null&&r.id))return;if(Go&&!e){let i=Go.environments.known.find(o=>o.id===r.id);if(i!=null&&i.version)return i.version}let n=await(await jL.PythonExtension.api()).environments.resolveEnvironment(r.id);return n!=null&&n.version||b.warn(`Unable to find Version for interpreter ${ye(r.id)}`),n==null?void 0:n.version}function Bu(r){if(!(r!=null&&r.id))return;if(!Go)throw new Error("Python API not initialized");let e=Go.environments.known.find(t=>t.id===r.id);return e==null?void 0:e.version}function b7(){return Go?Go.environments.known:[]}function dT(r){var n,i;if(!r)return;let e,t=r.id;if(r.executable.uri)e=r.executable.uri;else if(Zr(r)==="Conda")e=Ni()==="Windows"?ZE.Uri.joinPath(((n=r.environment)==null?void 0:n.folderUri)||ZE.Uri.file(r.path),"python.exe"):ZE.Uri.joinPath(((i=r.environment)==null?void 0:i.folderUri)||ZE.Uri.file(r.path),"bin","python");else{b.warn(`Python environment ${ye(r.id)} excluded as Uri is undefined`);return}return{id:t,uri:e}}function nle(r){return ju(r)}var Ue;(S=>(S.bannerLabelYes=w.l10n.t("Yes"),S.bannerLabelNo=w.l10n.t("No"),S.canceled=w.l10n.t("Canceled"),S.cancel=w.l10n.t("Cancel"),S.ok=w.l10n.t("Ok"),S.refresh=w.l10n.t("Refresh"),S.refreshing=w.l10n.t("Refreshing..."),S.install=w.l10n.t("Install"),S.loadingExtension=w.l10n.t("Jupyter Extension loading..."),S.handleExtensionActivationError=w.l10n.t("Extension activation failed, run the 'Developer: Toggle Developer Tools' command for more information."),S.doNotShowAgain=w.l10n.t("Do not show again"),S.reload=w.l10n.t("Reload"),S.moreInfo=w.l10n.t("More Info"),S.learnMore=w.l10n.t("Learn more"),S.and=w.l10n.t("and"),S.reportThisIssue=w.l10n.t("Report this issue"),S.clickHereForMoreInfoWithHtml=_=>w.l10n.t("Click <a href='{0}'>here</a> for more info.",_)))(Ue||(Ue={}));var Rp;(t=>(t.notInGroup=n=>w.l10n.t("User does not belong to experiment group '{0}'",n),t.inGroup=n=>w.l10n.t("User belongs to experiment group '{0}'",n)))(Rp||(Rp={}));var pT;(e=>e.jupyter=w.l10n.t("Jupyter"))(pT||(pT={}));var I7;(e=>e.currentWorkingDirectory="cwd:")(I7||(I7={}));var S7;(e=>e.bannerMessage=w.l10n.t("Would you like shift-enter to send code to the new Interactive Window experience?"))(S7||(S7={}));var _7;(e=>e.bannerMessage=w.l10n.t("Can you please take a minute to tell us about your notebooks experience in VS Code?"))(_7||(_7={}));var E7;(t=>(t.bannerLabelYes=w.l10n.t("Yes, take survey now"),t.bannerLabelNo=w.l10n.t("No, thanks")))(E7||(E7={}));var C;(T=>(T.warnWhenSelectingKernelWithUnSupportedPythonVersion=w.l10n.t("The version of Python associated with the selected kernel is no longer supported. Please consider selecting a different kernel."),T.installingPythonExtension=w.l10n.t("Installing Python extension and locating kernels."),T.pythonExtensionRequired=w.l10n.t("The Python Extension is required to perform that task. Click Yes to open Python Extension installation page."),T.rendererExtensionRequired=w.l10n.t("The Renderer Extension is required to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),T.rendererExtension1015Required=w.l10n.t("The installed version of the Renderer Extension is outdated and requires and update to view IPyWidgets. Click Yes to open Jupyter Notebook Renderer Extension installation page."),T.pythonExtensionInstalled=w.l10n.t("Python Extension is now installed. Some features might not be available until a notebook or interactive window session is restarted."),T.unknownPackage=w.l10n.t("unknown"),T.interactiveWindowTitleFormat=B=>w.l10n.t("Interactive - {0}",B),T.interactiveWindowModeBannerTitle=w.l10n.t({message:"Do you want to open a new Interactive Window for this file? [More Information](command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D).",args:[],comment:'The string "command:workbench.action.openSettings?%5B%22jupyter.interactiveWindowMode%22%5D" should not be translated. It is a command that opens the settings page with the "jupyter.interactiveWindowMode" setting selected.'}),T.interactiveWindowModeBannerSwitchYes=w.l10n.t("Yes"),T.interactiveWindowModeBannerSwitchNo=w.l10n.t("No"),T.dataExplorerTitle=w.l10n.t("Data Viewer"),T.badWebPanelFormatString=B=>w.l10n.t({message:"<html><body><h1>{0} is not a valid file name</h1></body></html>",args:[B],comment:["Only translate the text within the HTML tags"]}),T.installingMissingDependencies=w.l10n.t("Installing missing dependencies"),T.validatingKernelDependencies=w.l10n.t("Validating kernel dependencies"),T.performingExport=w.l10n.t("Performing Export"),T.exportNotebookToPython=w.l10n.t("Exporting Notebook to Python"),T.sessionDisposed=w.l10n.t("Cannot execute code, session has been disposed. Please try restarting the Kernel."),T.passwordFailure=w.l10n.t("Failed to connect to password protected server. Check that password is correct."),T.incorrectPassword=w.l10n.t("Incorrect Password."),T.exportDialogFilter=w.l10n.t("Jupyter Notebooks"),T.exportDialogComplete=B=>w.l10n.t("Notebook written to {0}",B),T.exportDialogFailed=B=>w.l10n.t("Failed to export notebook. {0}",B),T.exportOpenQuestion1=w.l10n.t("Open in editor"),T.runCellLensCommandTitle=w.l10n.t("Run Cell"),T.importDialogTitle=w.l10n.t("Import Jupyter Notebook"),T.importDialogFilter="Jupyter Notebooks",T.notebookCheckForImportNo=w.l10n.t("Later"),T.libraryRequiredToLaunchJupyterNotInstalled=B=>w.l10n.t("Running cells requires {0} package.",B),T.librariesRequiredToLaunchJupyterNotInstalled=B=>w.l10n.t("Running cells requires {0} package.",B),T.libraryRequiredToLaunchJupyterNotInstalledInterpreter=(B,Qe)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,Qe),T.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter=(B,Qe)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,Qe),T.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreterAndRequiresUpdate=(B,Qe)=>w.l10n.t("Running cells with '{0}' requires the {1} package to be installed or requires an update.",B,Qe),T.librariesRequiredToLaunchJupyterNotInstalledInterpreter=(B,Qe)=>w.l10n.t("Running cells with '{0}' requires the {1} package.",B,Qe),T.installPackageInstructions=(B,Qe)=>w.l10n.t(`Run the following command to install '{0}' into the Python environment. 
Command: '{1}'`,B,Qe),T.pythonCondaKernelsWithoutPython=w.l10n.t("The Python Runtime and IPyKernel will be automatically installed upon selecting this environment."),T.selectJupyterInterpreter=w.l10n.t("Select an Interpreter to start Jupyter"),T.jupyterInstall=w.l10n.t("Install"),T.currentlySelectedJupyterInterpreterForPlaceholder=B=>w.l10n.t("Selected Environment {0}",B),T.jupyterNotSupported=B=>w.l10n.t("Jupyter cannot be started. Error attempting to locate Jupyter: {0}",B),T.jupyterNotebookNotInstalledOrNotFound=B=>{if(B){let Qe=nle(B);return w.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment '{0}'.",Qe)}else return w.l10n.t("Failed to start Jupyter Server as the packages 'jupyter' and 'notebook' could not be located in the Python environment.")},T.jupyterNotSupportedBecauseOfEnvironment=(B,Qe)=>w.l10n.t("Activating {0} to run Jupyter failed with {1}",B,Qe),T.jupyterNbConvertNotSupported=w.l10n.t("Jupyter nbconvert is not installed"),T.jupyterLaunchTimedOut=w.l10n.t("The Jupyter notebook server failed to launch in time"),T.jupyterLaunchNoURL=w.l10n.t("Failed to find the URL of the launched Jupyter notebook server"),T.jupyterSelfCertFail=B=>w.l10n.t(`The security certificate used by server {0} was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),T.jupyterExpiredCertFail=B=>w.l10n.t(`The security certificate used by server {0} has expired.\r
This may indicate an attempt to steal your information.\r
Do you want to enable the Allow Unauthorized Remote Connection setting for this workspace to allow you to connect?`,B),T.jupyterSelfCertFailErrorMessageOnly=w.l10n.t(`The security certificate used by server was not issued by a trusted certificate authority.\r
This may indicate an attempt to steal your information.`),T.jupyterSelfCertExpiredErrorMessageOnly=w.l10n.t(`The security certificate used by server has expired.\r
This may indicate an attempt to steal your information.`),T.jupyterSelfCertEnable=w.l10n.t("Yes, connect anyways"),T.jupyterSelfCertClose=w.l10n.t("No, close the connection"),T.pythonInteractiveHelpLink=w.l10n.t("See <https://aka.ms/pyaiinstall> for help on installing Jupyter."),T.importingFormat=B=>w.l10n.t("Importing {0}",B),T.startingJupyter=w.l10n.t("Starting Jupyter Server"),T.connectingToKernel=B=>w.l10n.t("Connecting to kernel: {0}",B),T.connectingToJupyter=w.l10n.t("Connecting to Jupyter Server"),T.exportingFormat=B=>w.l10n.t("Exporting {0}",B),T.runAllCellsLensCommandTitle=w.l10n.t("Run All Cells"),T.runAllCellsAboveLensCommandTitle=w.l10n.t("Run Above"),T.runCellAndAllBelowLensCommandTitle=w.l10n.t("Run Below"),T.restartKernelMessage=w.l10n.t("Do you want to restart the Jupyter kernel? All variables will be lost."),T.restartKernelMessageYes=w.l10n.t("Restart"),T.restartKernelMessageDontAskAgain=w.l10n.t("Don't Ask Again"),T.automaticallyReconnectingToAKernelProgressMessage=B=>w.l10n.t("Reconnecting to the kernel {0}",B),T.restartingKernelStatus=B=>w.l10n.t("Restarting Kernel {0}",B),T.interruptingKernelFailed=w.l10n.t("Kernel interrupt failed. Jupyter Server is hung. Please reload VS Code."),T.sessionStartFailedWithKernel=B=>w.l10n.t({message:`Failed to start the Kernel '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyter=B=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyterWithErrorInfo=(B,Qe)=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}'. 
{1} 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.failedToStartJupyterDueToOutdatedTraitlets=(B,Qe)=>w.l10n.t({message:`Failed to start Jupyter in the environment '{0}' possibly due to an outdated version of 'traitlets'. 
{1} 
Consider updating the 'traitlets' module to '5.1.1' or later. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B,Qe],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the text 'traitlets', that is a Python module name"]}),T.failedToStartKernel=w.l10n.t("Failed to start the Kernel."),T.failedToRestartKernel=w.l10n.t("Failed to restart the Kernel."),T.failedToInterruptKernel=w.l10n.t("Failed to interrupt the Kernel."),T.rawKernelStartFailedDueToTimeout=B=>w.l10n.t({message:`Unable to start Kernel '{0}' due to a connection timeout. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.rawKernelStartFailedDueToTimeoutWaitingForPort=B=>w.l10n.t({message:`Unable to start Kernel '{0}' due to a timeout waiting for the ports to get used. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.viewJupyterLogForFurtherInfo=w.l10n.t({message:"View Jupyter [log](command:jupyter.viewOutput) for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.kernelDied=B=>w.l10n.t({message:"The kernel died. Error: {0}... View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.kernelDiedWithoutError=B=>w.l10n.t({message:"The kernel '{0}' died. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.failedToStartAnUntrustedKernelSpec=(B,Qe)=>w.l10n.t({message:`The kernel '{0}' was not started as it is located in an insecure location '{1}'.  
Click [here](https://aka.ms/JupyterTrustedKernelPaths) for further details, optionally update the setting [jupyter.kernels.trusted](command:workbench.action.openSettings?["jupyter.kernels.trusted"]) to trust the kernel.`,args:[B,Qe],comment:['Do not translate the text "jupyter.kernels.trusted", that is a setting in VS Code','Do not translate the text command:workbench.action.openSettings?["jupyter.kernels.trusted"], that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/JupyterTrustedKernelPaths"]}),T.kernelDiedWithoutErrorAndAutoRestarting=B=>w.l10n.t({message:"The kernel '{0}' died and is being automatically restarted by Jupyter. Click [here](https://aka.ms/vscodeJupyterKernelCrash) for more info. View Jupyter [log](command:jupyter.viewOutput) for further details.",args:[B],comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.kernelCrashedDueToCodeInCurrentOrPreviousCell=w.l10n.t({message:`The Kernel crashed while executing code in the current cell or a previous cell. 
Please review the code in the cell(s) to identify a possible cause of the failure. 
Click <a href='https://aka.ms/vscodeJupyterKernelCrash'>here</a> for more info. 
View Jupyter [log](command:jupyter.viewOutput) for further details.`,comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel',"Do not translate the link https://aka.ms/vscodeJupyterKernelCrash"]}),T.kernelDisconnected=B=>w.l10n.t("Unable to connect to the kernel '{0}', please verify the Jupyter Server connection. View Jupyter [log](command:jupyter.viewOutput) for further details.",B),T.cannotRunCellKernelIsDead=B=>w.l10n.t("Cannot run cells, as the kernel '{0}' is dead.",B),T.showJupyterLogs=w.l10n.t("Show Jupyter Logs."),T.restartKernel=w.l10n.t("Restart Kernel"),T.reloadRequired=w.l10n.t("Please reload the window for new settings to take effect."),T.restartedKernelHeader=B=>w.l10n.t("Restarted {0}",B),T.connectedKernelHeader=B=>w.l10n.t("Connected to {0}",B),T.restartingKernelCustomHeader=B=>w.l10n.t("_Restarting {0}..._",B),T.restartingKernelHeader=w.l10n.t("_Restarting kernel..._"),T.startingNewKernelHeader=w.l10n.t("_Connecting to kernel..._"),T.startingNewKernelCustomHeader=B=>w.l10n.t("_Connecting to {0}..._",B),T.noKernelConnected=w.l10n.t("No kernel connected"),T.jupyterSelectUriCommandLabel=w.l10n.t("Enter the URL of the running Jupyter Server..."),T.jupyterSelectUriInputTitle=w.l10n.t("Enter the URL of the running Jupyter Server"),T.jupyterSelectUriInputPlaceholder=w.l10n.t("Enter the url of the running Jupyter Server"),T.connectToToTheJupyterServer=B=>w.l10n.t("Connect to the Jupyter Server {0}",B),T.enterOrSelectRemoteJupyterPlaceholder=w.l10n.t("Enter a remote url, or select a remote server"),T.selectRemoteJupyterPlaceholder=w.l10n.t("Select a remote server"),T.jupyterServerLastConnectionForQuickPickDescription=B=>w.l10n.t("Last connected {0}",ty(B,!0,!1,!1)),T.jupyterServerNotUsedBeforeQuickPickSeparatorTitle=w.l10n.t("Jupyter Servers"),T.jupyterSelectURIInvalidURI=w.l10n.t("Invalid URL specified"),T.jupyterSelectURIMustBeHttpOrHttps=w.l10n.t("Invalid protocol in URL specified, only HTTP or HTTPS are supported."),T.jupyterSelectLiveRemoteKernelDescription=(B,Qe)=>B?Qe===0?w.l10n.t("Last activity {0}",ty(B,!0,!1,!1)):Qe===1?w.l10n.t("Last activity {0}, 1 connection",ty(B,!0,!1,!1)):w.l10n.t("Last activity {0}, {1} connections",ty(B,!0,!1,!1),Qe.toString()):Qe===0?"":Qe===1?w.l10n.t("1 connection"):w.l10n.t("{0} connections",Qe.toString()),T.installJupyterHub=w.l10n.t("Install the JupyterHub extension to connect to JupyterHub servers."),T.useJupyterHubExtension=w.l10n.t("Select 'Existing JupyterHub Server...' from the Kernel Picker"),T.useJupyterHubExtensionDetail=w.l10n.t("Use this option when connecting to JupyterHub servers"),T.installJupyterHubDetail=w.l10n.t("Once installed, open the Kernel Picker and select 'Existing JupyterHub Server...'"),T.jupyterSelectUserAndPasswordTitle=w.l10n.t("Enter your user name and password to connect to Jupyter Hub"),T.jupyterRenameServer=w.l10n.t("Change Server Display Name (Leave Blank To Use URL)"),T.jupyterServerUriDisplayNameInputPlaceholder=w.l10n.t("Enter a display name"),T.jupyterSelectUserPrompt=w.l10n.t("Enter your user name"),T.jupyterSelectPasswordPrompt=w.l10n.t("Enter your password"),T.jupyterSelectPasswordTitle=w.l10n.t("Enter your password for the Jupyter Server"),T.pythonNotInstalled=w.l10n.t(`Python is not installed. 
Please download and install Python in order to execute cells in this notebook. 
Once installed please reload VS Code.`),T.pleaseReloadVSCodeOncePythonHasBeenInstalled=w.l10n.t("Upon installing Python please reload VS Code."),T.jupyterNotebookFailure=B=>w.l10n.t(`Jupyter notebook failed to launch. \r
{0}`,B),T.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid=B=>w.l10n.t("The remote Jupyter Server contributed by the extension '{0}' is no longer available.",B),T.remoteJupyterConnectionFailedWithServerWithError=(B,Qe)=>w.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable. ({1}).",B,Qe),T.remoteJupyterConnectionFailedWithServer=B=>w.l10n.t("Failed to connect to the remote Jupyter Server '{0}'. Verify the server is running and reachable.",B),T.remoteJupyterConnectionFailedWithoutServerWithError=B=>w.l10n.t("Connection failure. Verify the server is running and reachable. ({0}).",B),T.remoteJupyterConnectionFailedWithoutServerWithErrorWeb=B=>w.l10n.t(`Connection failure. Verify the server is running and reachable from a browser. ({0}). 
When connecting from vscode.dev Jupyter servers must be started with specific options to connect. 
Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),T.removeRemoteJupyterConnectionButtonText=w.l10n.t("Forget Connection"),T.jupyterNotebookRemoteConnectFailedWeb=B=>w.l10n.t(`Failed to connect to remote Jupyter Server.\r
Check that the Jupyter Server URL can be reached from a browser.\r
{0}. Click [here](https://aka.ms/vscjremoteweb) for more information.`,B),T.packageNotInstalledWindowsLongPathNotEnabledError=(B,Qe)=>w.l10n.t(`Support for Windows Long Path has not been enabled, hence the package {0} could not be installed into the Python Environment '{1}'.
Please ensure that support for Windows Long Path is enabled.
See [here](https://pip.pypa.io/warnings/enable-long-paths) for more information.`,B,Qe),T.changeRemoteJupyterConnectionButtonText=w.l10n.t("Manage Connections"),T.rawConnectionBrokenError=w.l10n.t("Direct kernel connection broken"),T.jupyterServerCrashed=B=>w.l10n.t(`Jupyter Server crashed. Unable to connect. \r
Error code from Jupyter: {0}`,B.toString()),T.jupyterKernelSpecModuleNotFound=B=>w.l10n.t(`'Kernelspec' module not installed in the selected interpreter ({0}).
 Please re-install or update 'jupyter'.`,B),T.interruptKernelStatus=B=>w.l10n.t("Interrupting Kernel {0}",B),T.exportPythonQuickPickLabel=w.l10n.t("Python Script"),T.exportHTMLQuickPickLabel=w.l10n.t("HTML"),T.exportPDFQuickPickLabel=w.l10n.t("PDF"),T.restartKernelAfterInterruptMessage=B=>w.l10n.t("Interrupting the kernel '{0}' timed out. Do you want to restart the kernel instead? All variables will be lost.",B),T.documentMismatch=B=>w.l10n.t("Cannot run cells, duplicate documents for {0} found.",B),T.jupyterGetVariablesBadResults=w.l10n.t("Failed to fetch variable info from the Jupyter Server."),w.l10n.t("Failure to create an 'Interactive' window. Try reinstalling the Python Extension."),T.jupyterGetVariablesExecutionError=B=>w.l10n.t(`Failure during variable extraction: \r
{0}`,B),T.selectKernel=w.l10n.t("Change Kernel"),T.selectDifferentKernel=w.l10n.t("Select a different Kernel"),T.kernelFilterPlaceholder=w.l10n.t("Choose the kernels that are available in the kernel picker."),T.recommendedItemCategoryInQuickPick=w.l10n.t("Recommended"),T.selectedKernelCategoryInQuickPick=w.l10n.t("Selected"),T.createPythonEnvironmentInQuickPick=w.l10n.t("Create Python Environment"),T.createPythonEnvironmentInQuickPickTooltip=w.l10n.t("Create an isolated Python Environment per workspace folder"),T.selectDifferentJupyterInterpreter=w.l10n.t("Change Interpreter"),T.pandasTooOldForViewingFormat=(B,Qe)=>w.l10n.t({message:"Python package 'pandas' is version {0}. Version {1} or greater is required for viewing data.",args:[B,Qe],comment:["Do not translate 'pandas' as that is a Python module name"]}),T.pandasRequiredForViewing=B=>w.l10n.t({message:"Python package 'pandas' version {0} (or above) is required for viewing data.",args:[B],comment:["Do not translate 'pandas' as that is a Python module name"]}),T.tooManyColumnsMessage=w.l10n.t("Variables with over a 1000 columns may take a long time to display. Are you sure you wish to continue?"),T.tooManyColumnsYes=w.l10n.t("Yes"),T.tooManyColumnsNo=w.l10n.t("No"),T.tooManyColumnsDontAskAgain=w.l10n.t("Don't Ask Again"),T.plotViewerTitle=w.l10n.t("Plots"),T.exportPlotTitle=w.l10n.t("Save plot image"),T.pdfFilter="PDF",T.pngFilter="PNG",T.svgFilter="SVG",T.exportImageFailed=B=>w.l10n.t("Error exporting image: {0}",B),T.jupyterDataRateExceeded=w.l10n.t({message:"Cannot view variable because data rate exceeded. Please restart your server with a higher data rate limit. For example, --NotebookApp.iopub_data_rate_limit=10000000000.0",comment:["Do not translate the text --NotebookApp.iopub_data_rate_limit=10000000000.0 as that is a command argument."]}),T.addCellBelowCommandTitle=w.l10n.t("Add cell"),T.debugCellCommandTitle=w.l10n.t("Debug Cell"),T.debugStepOverCommandTitle=w.l10n.t("Step over"),T.debugContinueCommandTitle=w.l10n.t("Continue"),T.debugStopCommandTitle=w.l10n.t("Stop"),T.runCurrentCellAndAddBelow=w.l10n.t("Run current cell and add empty cell below"),T.jupyterDebuggerNotInstalledError=B=>w.l10n.t("Pip module {0} is required for debugging cells. You will need to install it to debug cells.",B),T.jupyterDebuggerOutputParseError=B=>w.l10n.t("Unable to parse {0} output, please log an issue with https://github.com/microsoft/vscode-jupyter",B),T.cellStopOnErrorMessage=w.l10n.t("Cell was canceled due to an error in a previous cell."),T.scrollToCellTitleFormatMessage=B=>w.l10n.t("Go to [{0}]",B.toString()),T.instructionComments=B=>w.l10n.t(`# To add a new cell, type '{0}'
# To add a new markdown cell, type '{0} [markdown]'
`,B),T.exportButtonTitle=w.l10n.t("Export"),T.exportAsQuickPickPlaceholder=w.l10n.t("Export As..."),T.openExportedFileMessage=w.l10n.t("Would you like to open the exported file?"),T.openExportFileYes=w.l10n.t("Yes"),T.openExportFileNo=w.l10n.t("No"),T.exportFailedGeneralMessage=w.l10n.t({message:"Please check the 'Jupyter' [output](command:jupyter.viewOutput) panel for further details.",comment:['Do not translate the text "command:jupyter.viewOutput", that is a command Id that will be used by VS Code to open the output panel']}),T.exportToPDFDependencyMessage=w.l10n.t(`If you have not installed xelatex (TeX), you will need to do so before you can export to PDF. For further instructions, please see https://nbconvert.readthedocs.io/en/latest/install.html#installing-tex. \r
To avoid installing xelatex (TeX), you might want to try exporting to HTML and using your browser's "Print to PDF" feature.`),T.failedExportMessage=w.l10n.t("Export failed."),T.startingJupyterLogMessage=(B,Qe)=>w.l10n.t("Starting Jupyter from {0} with arguments {1}",B,Qe),T.waitingForJupyterSessionToBeIdle=w.l10n.t("Waiting for Jupyter Session to be idle"),T.gettingListOfKernelsForRemoteConnection=w.l10n.t("Fetching Kernels"),T.gettingListOfKernelSpecs=w.l10n.t("Fetching Kernel specs"),T.startingJupyterNotebook=w.l10n.t("Starting Jupyter Notebook"),T.registeringKernel=w.l10n.t("Registering Kernel"),T.jupyterCommandLineReloadQuestion=w.l10n.t("Please reload the window when changing the Jupyter command line."),T.jupyterCommandLineReloadAnswer=w.l10n.t("Reload"),T.createdNewKernel=(B,Qe)=>w.l10n.t("{0}: Kernel started: {1}",B,Qe),T.kernelInvalid=B=>w.l10n.t("Kernel {0} is not usable. Check the Jupyter output tab for more information.",B),T.removeRemoteJupyterServerEntryInQuickPick=w.l10n.t("Remove"),T.loadClassFailedWithNoInternet=(B,Qe)=>w.l10n.t("Error loading {0}:{1}. Internet connection required for loading 3rd party widgets.",B,Qe),T.useCDNForWidgetsNoInformation=w.l10n.t("Widgets require us to download supporting files from a 3rd party website."),T.enableCDNForWidgetsSetting=(B,Qe)=>w.l10n.t("Widgets require us to download supporting files from a 3rd party website. (Error loading {0}:{1}).",B,Qe),T.enableCDNForWidgetsButton=w.l10n.t("Enable Downloads"),T.unhandledMessage=(B,Qe)=>w.l10n.t("Unhandled kernel message from a widget: {0} : {1}",B,Qe),T.cdnWidgetScriptNotAccessibleWarningMessage=(B,Qe)=>w.l10n.t("Unable to download widget '{0}' from 3rd party website {1}, due to network access. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,Qe),T.widgetScriptNotFoundOnCDNWidgetMightNotWork=(B,Qe,Lre)=>w.l10n.t("Unable to find widget '{0}' version '{1}' from configured widget sources {2}. Expected behavior may be affected. Click [here](https://aka.ms/PVSCIPyWidgets) for more information.",B,Qe,Lre),T.insecureSessionMessage=w.l10n.t("Connecting over HTTP without a token may be an insecure connection. Do you want to connect to a possibly insecure server?"),T.insecureSessionDenied=w.l10n.t("Denied connection to insecure server."),T.selectKernelForEditor=w.l10n.t("[Select a kernel](command:_notebook.selectKernel) to run cells."),T.needIpykernel6=w.l10n.t("Ipykernel setup required for this feature"),T.setup=w.l10n.t("Setup"),T.showDataViewerFail=w.l10n.t("Failed to create the Data Viewer. Check the Jupyter tab of the Output window for more info."),T.defaultNotebookName=w.l10n.t("default"),T.recommendExtensionForNotebookLanguage=(B,Qe)=>w.l10n.t("The {0} extension is recommended for notebooks targeting the language '{1}'",B,Qe),T.kernelWasNotStarted=w.l10n.t("Kernel was not started. A kernel session is needed to start debugging."),T.noNotebookToDebug=w.l10n.t("No active notebook document to debug."),T.cantStartDebugging=w.l10n.t("Can't start debugging."),T.restartNotSupported=w.l10n.t("Restarting is not supported in the interactive window."),T.importingIpynb=w.l10n.t("Importing notebook file"),T.exportingToFormat=B=>w.l10n.t("Exporting to {0}",B),T.kernelCategoryForJupyterSession=w.l10n.t("Jupyter Session"),T.kernelDefaultRemoteDisplayName=w.l10n.t("Remote"),T.kernelCategoryForJupyterKernel=w.l10n.t("Jupyter Kernel"),T.kernelCategoryForRemoteJupyterKernel=w.l10n.t("Jupyter Kernel"),T.kernelCategoryForConda=w.l10n.t("Conda Env"),T.kernelCategoryForCondaWithoutPython=w.l10n.t("Conda Env Without Python"),T.kernelCategoryForPoetry=w.l10n.t("Poetry Env"),T.kernelCategoryForPipEnv=w.l10n.t("Pipenv Env"),T.kernelCategoryForPyEnv=w.l10n.t("PyEnv Env"),T.kernelCategoryForGlobal=w.l10n.t("Global Env"),T.kernelCategoryForVirtual=w.l10n.t("Virtual Env"),T.fileSeemsToBeInterferingWithKernelStartup=B=>w.l10n.t("The file '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the file and starting the kernel again.",B),T.moduleSeemsToBeInterferingWithKernelStartup=B=>w.l10n.t("The module '{0}' seems to be overriding built in modules and interfering with the startup of the kernel. Consider renaming the folder and starting the kernel again.",B),T.pipCondaInstallHoverWarning=(B,Qe)=>w.l10n.t("'!{0} install' could install packages into the wrong environment. [More info]({1})",B,Qe),T.percentPipCondaInstallInsteadOfBang=B=>w.l10n.t({message:"Use '%{0} install' instead of '!{0} install'",args:[B],comment:['Do not translate the string within quotes, such as "%{0} install" and "!{0} install" as that is a Jupyter Shell Magic command']}),T.replacePipCondaInstallCodeAction=B=>w.l10n.t("Replace with '%{0} install'",B),T.failedToStartKernelDueToMissingModule=B=>w.l10n.t("The kernel failed to start due to the missing module '{0}'. Consider installing this module.",B),T.failedToStartKernelDueToImportFailure=B=>w.l10n.t("The kernel failed to start as the module '{0}' could not be imported.",B),T.failedToStartKernelDueToImportFailureFromFile=(B,Qe)=>w.l10n.t("The kernel failed to start as '{0}' could not be imported from '{1}'.",B,Qe),T.failedToStartKernelDueToUnknownDllLoadFailure=w.l10n.t("The kernel failed to start as a dll could not be loaded."),T.failedToStartKernelDueToDllLoadFailure=B=>w.l10n.t("The kernel failed to start as the dll '{0}' could not be loaded.",B),T.failedToStartKernelDueToWin32APIFailure=w.l10n.t("The kernel failed to start due to an error with the Win32api module. Consider (re) installing this module."),T.failedToStartKernelDueToPyZmqFailure=w.l10n.t({message:"The kernel failed to start due to an error with the 'pyzmq' module. Consider re-installing this module.",comment:['Do not translate the string "pyzmq" as that is a Python module.']}),T.failedToStartKernelDueToOldIPython=w.l10n.t("The kernel failed to start due to an outdated version of IPython. Consider updating this module to the latest version."),T.failedToStartKernelDueToOldIPyKernel=w.l10n.t("The kernel failed to start due to an outdated version of IPyKernel. Consider updating this module to the latest version."),T.failedToStartKernelDueToMissingPythonEnv=B=>w.l10n.t("The kernel failed to start as the Python Environment '{0}' is no longer available. Consider selecting another kernel or refreshing the list of Python Environments.",B),T.matplotlibWidgetInsteadOfOther=w.l10n.t("'%matplotlib' widget works best inside of VS Code"),T.matplotlibWidgetCodeActionTitle=w.l10n.t("More info"),T.allowExtensionToUseJupyterKernelApi=(B,Qe)=>w.l10n.t("Do you want to give the extension '{0}' access to the Jupyter Kernels? Clicking '{1}' would allow this extension to execute code against the Jupyter Kernels.",B,Qe),T.thanksForUsingJupyterKernelApiPleaseRegisterWithUs=B=>w.l10n.t("Thank you for trying the Jupyter API. Please file an issue on our repo to allow the extension {0} to use this API in production. This would prevent us from breaking your extension when updating the API (as it is still a work in progress).",B),T.activatingPythonEnvironment=B=>w.l10n.t("Activating Python Environment '{0}'",B),T.runningKernelStartupHooksFor=B=>w.l10n.t("Running Kernel startup hooks in '{0}'",B),T.cellAtFormat=(B,Qe)=>w.l10n.t("{0} Cell {1}",B,Qe),T.jupyterServerConsoleOutputChannel=w.l10n.t("Jupyter Server Console"),T.kernelConsoleOutputChannel=B=>w.l10n.t("{0} Kernel Console Output",B),T.webNotSupported=w.l10n.t("Operation not supported in web version of Jupyter Extension."),T.failedToInstallPythonExtension=w.l10n.t("Failed to install the Python Extension."),T.filesPossiblyOverridingPythonModulesMayHavePreventedKernelFromStarting=B=>w.l10n.t("Some of the following files found in the working directory may have prevented the Kernel from starting. Consider renaming them.",B),T.listOfFilesWithLinksThatMightNeedToBeRenamed=B=>w.l10n.t("File(s): {0} might need to be renamed.",B),T.failedToGetVersionOfPandas=w.l10n.t("Failed to get version of Pandas to use the Data Viewer."),T.failedToInstallPandas=w.l10n.t("Failed to install Pandas to use the Data Viewer."),T.localKernelSpecs=w.l10n.t("Jupyter Kernel..."),T.localPythonEnvironments=w.l10n.t("Python Environments..."),T.quickPickTitleForSelectionOfJupyterServer=w.l10n.t("Select a Jupyter Server"),T.UserJupyterServerUrlProviderDisplayName=w.l10n.t("Existing Jupyter Server..."),T.UserJupyterServerUrlProviderDetail=w.l10n.t("Connect to an existing Jupyter Server"),T.kernelPickerSelectKernelTitle=w.l10n.t("Select Kernel"),T.kernelPickerSelectLocalKernelSpecTitle=w.l10n.t("Select a Jupyter Kernel"),T.quickPickSelectPythonEnvironmentTitle=w.l10n.t("Select a Python Environment"),T.kernelPickerSelectKernelFromRemoteTitle=B=>w.l10n.t("Select a Kernel from {0}",B),T.kernelPickerSelectKernelFromRemoteTitleWithoutName=w.l10n.t("Select a Jupyter Kernel"),T.installPythonExtensionViaKernelPickerTitle=w.l10n.t("Install Python Extension"),T.installPythonExtensionViaKernelPickerToolTip=w.l10n.t("Python Extension is required to detect and use Python environments for the execution of code cells."),T.installPythonQuickPickTitle=w.l10n.t("Install Python"),T.installPythonQuickPickToolTip=w.l10n.t("Python Environments not detected. Upon installation reload VS Code or refresh the list of Kernels."),T.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel=w.l10n.t({message:"$(error) Unable to connect to the remote server",comment:"Do not translate the string $(error) as that is a VS Code icon."}),T.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail=w.l10n.t("Ensure the server is running and reachable."),T.dataViewerDeprecationMessage=w.l10n.t("The built-in data viewer will be deprecated soon. Please install other data viewing extensions to keep the ability to inspect data."),T.dataViewerDeprecationRecommendationActionMessage=w.l10n.t("See Recommended Extensions")))(C||(C={}));var Jt;(Je=>(Je.collapseSingle=w.l10n.t("Collapse"),Je.expandSingle=w.l10n.t("Expand"),Je.noRowsInDataViewer=w.l10n.t("No rows match current filter"),Je.sliceIndexError=w.l10n.t({message:"Index {0} out of range for axis {1} with {2} elements",comment:["Do not translate the strings {0}, {1} and {2} as they are variable names and will be replaced later"]}),Je.sliceMismatchedAxesError=w.l10n.t({message:"Expected {0} axes, got {1} in slice expression",comment:["Do not translate the strings {0} and {2} as they are variable names and will be replaced later"]}),Je.fetchingDataViewer=w.l10n.t("Fetching data ..."),Je.dataViewerHideFilters=w.l10n.t("Hide filters"),Je.dataViewerShowFilters=w.l10n.t("Show filters"),Je.refreshDataViewer=w.l10n.t("Refresh data viewer"),Je.sliceSummaryTitle=w.l10n.t("SLICING"),Je.sliceData=w.l10n.t("Slice Data"),Je.sliceSubmitButton=w.l10n.t("Apply"),Je.sliceDropdownAxisLabel=w.l10n.t("Axis"),Je.sliceDropdownIndexLabel=w.l10n.t("Index"),Je.variableExplorerNameColumn=w.l10n.t("Name"),Je.variableExplorerTypeColumn=w.l10n.t("Type"),Je.variableExplorerCountColumn=w.l10n.t("Size"),Je.variableExplorerValueColumn=w.l10n.t("Value"),Je.collapseVariableExplorerLabel=w.l10n.t("Variables"),Je.variableLoadingValue=w.l10n.t("Loading..."),Je.showDataExplorerTooltip=w.l10n.t("Show variable snapshot in data viewer"),Je.noRowsInVariableExplorer=w.l10n.t("No variables defined"),Je.loadingRowsInVariableExplorer=w.l10n.t("Loading variables"),Je.previousPlot=w.l10n.t("Previous"),Je.nextPlot=w.l10n.t("Next"),Je.panPlot=w.l10n.t("Pan"),Je.zoomInPlot=w.l10n.t("Zoom in"),Je.zoomOutPlot=w.l10n.t("Zoom out"),Je.exportPlot=w.l10n.t("Export to different formats"),Je.deletePlot=w.l10n.t("Remove"),Je.selectedImageListLabel=w.l10n.t("Selected Image"),Je.selectedImageLabel=w.l10n.t("Image"),Je.errorOutputExceedsLinkToOpenFormatString=w.l10n.t({message:"Output exceeds the <a href={0}>size limit</a>. Open the full output data <a href={1}>in a text editor</a>",comment:['Do not translate the the Hyperlink text "<a href={0}>size limit</a>" and "<a href={1}>in a text editor</a>". However the text inside those tags can be translated']})))(Jt||(Jt={}));var py;(n=>(n.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE=w.l10n.t({message:"The setting 'python.formatting.formatOnSave' is deprecated, please use 'editor.formatOnSave'.",comment:['Do not translate the string "python.formatting.formatOnSave" as that is a setting in VS Code','Do not translate the string "editor.formatOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE=w.l10n.t({message:"The setting 'python.linting.lintOnTextChange' is deprecated, please enable 'python.linting.lintOnSave' and 'files.autoSave'.",comment:['Do not translate the string "python.linting.lintOnTextChange" as that is a setting in VS Code','Do not translate the string "python.linting.lintOnSave" as that is a setting in VS Code']}),n.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES=w.l10n.t({message:"The setting 'python.autoComplete.preloadModules' is deprecated, please consider using Pylance Language Server ('python.languageServer' setting).",comment:['Do not translate the string "python.autoComplete.preloadModules" as that is a setting in VS Code','Do not translate the string "python.languageServer" as that is a setting in VS Code']})))(py||(py={}));var C7;(n=>(n.noCondaOrPipInstaller=w.l10n.t("There is no Conda or Pip installer available in the selected environment."),n.noPipInstaller=w.l10n.t("There is no Pip installer available in the selected environment."),n.searchForHelp=w.l10n.t("Search for help")))(C7||(C7={}));var w7;(e=>e.installingModule=t=>w.l10n.t("Installing {0}",t))(w7||(w7={}));d();var D7=HL(),fT=class{constructor(e,t,n){this.channel=e;this.homeReplaceRegEx=t,this.userNameReplaceRegEx=n}format(e,t,...n){let i=e?`${mP()} [${e}] ${D7(t,...n)}`:D7(t,...n);return this.homeReplaceRegEx&&(i=i.replace(this.homeReplaceRegEx,"~")),this.userNameReplaceRegEx&&(i=i.replace(this.userNameReplaceRegEx,"<username>")),i}error(e,...t){this.channel.appendLine(this.format("error",e,...t))}warn(e,...t){this.channel.appendLine(this.format("warn",e,...t))}info(e,...t){this.channel.appendLine(this.format("info",e,...t))}debug(e,...t){this.channel.appendLine(this.format("debug",e,...t))}trace(e,...t){this.channel.appendLine(this.format("trace",e,...t))}ci(e,...t){}};d();var P7=HL();function eC(r,e,...t){let i=[...t].length===0?P7(e):P7(e,...t);return r?`${r} ${mP()}: ${i}`:i}var mT=class{constructor(e){this.prefix=e}error(e,...t){console.error(eC("error",`${this.prefix||""} ${e}`,...t))}warn(e,...t){console.warn(eC("warn",`${this.prefix||""} ${e}`,...t))}info(e,...t){console.info(eC("info",`${this.prefix||""} ${e}`,...t))}debug(e,...t){console.log(eC("debug",`${this.prefix||""} ${e}`,...t))}trace(e,...t){console.trace(eC("trace",`${this.prefix||""} ${e}`,...t))}ci(e,...t){}};var JL="",sle=3,Ap=[],Mp=yr.LogLevel.Info,b={error:(r,...e)=>ale(r,...e),warn:(r,...e)=>M7(r,...e),info:(r,...e)=>lle(r,...e),debug:(r,...e)=>cle(r,...e),trace:(r,...e)=>ule(r,...e),ci:(r,...e)=>{e&&Array.isArray(e)?N7(r,...e):N7(r)}};function R7(r){Mp=k7(),Uu(yr.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.logging")&&(Mp=k7())}));let e=yr.window.createOutputChannel(pT.jupyter,"log");return T7(new fT(e,r==null?void 0:r.userNameRegEx,r==null?void 0:r.homePathRegEx)),T7(new mT(Ji?void 0:"Jupyter Extension:")),e}function T7(r){return Ap.push(r),{dispose:()=>{Ap=Ap.filter(e=>e!==r)}}}function k7(){try{let{level:r}=yr.workspace.getConfiguration("jupyter").get("logging",{level:"Info"});switch(r){case"debug":case"Debug":return yr.LogLevel.Debug;case"warn":case"Warn":case"warning":case"Warning":return yr.LogLevel.Warning;case"Off":case"off":return yr.LogLevel.Off;case"Error":case"error":return yr.LogLevel.Error;case"Trace":case"trace":return yr.LogLevel.Trace;default:return yr.LogLevel.Info}}catch(r){return console.error("Failed to get logging level from configuration",r),yr.LogLevel.Info}}function A7(...r){return Mp<=yr.LogLevel.Debug?r:r.map(t=>{if(!(t instanceof Error)||!("isJupyterError"in t))return t;let n=[`${t.name}: ${t.message}`.trim()];if("kernelConnectionMetadata"in t&&t.kernelConnectionMetadata&&typeof t.kernelConnectionMetadata=="object"&&"id"in t.kernelConnectionMetadata&&(n.push(`Kernel Id = ${t.kernelConnectionMetadata.id}`),"interpreter"in t.kernelConnectionMetadata&&t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter=="object"&&"id"in t.kernelConnectionMetadata.interpreter&&typeof t.kernelConnectionMetadata.interpreter.id=="string"&&n.push(`Interpreter Id = ${ye(t.kernelConnectionMetadata.interpreter.id)}`)),t.stack){let o=at(t.stack),s=o.find(a=>a.indexOf("at ")===0);o.length===1||(o.length===1?n.push(o[0]):o.length>1&&(s!=null&&s.length)?n.push(s):n.push(o[0]))}let i=["stack","message","name","kernelConnectionMetadata","category","exitCode","isJupyterError"];return Object.keys(t).filter(o=>i.indexOf(o)===-1).forEach(o=>n.push(`${o} = ${String(t[o]).trim()}`)),n.filter(o=>o.trim().length).map((o,s)=>s===0?o:`    > ${o}`).join(`
`)})}function ale(r,...e){Mp<=yr.LogLevel.Error&&(e=A7(...e),Ap.forEach(t=>t.error(r,...e)))}function M7(r,...e){Mp<=yr.LogLevel.Warning&&(e=A7(...e),Ap.forEach(t=>t.warn(r,...e)))}function lle(r,...e){Mp<=yr.LogLevel.Info&&Ap.forEach(t=>t.info(r,...e))}function cle(r,...e){Mp<=yr.LogLevel.Debug&&Ap.forEach(t=>t.debug(r,...e))}function ule(r,...e){Mp<=yr.LogLevel.Trace&&Ap.forEach(t=>t.trace(r,...e))}function N7(r,...e){if(Ji)if(typeof r=="function"){let n=r(),i="",o=[];typeof n=="string"?i=n:(i=n.shift(),o=n),b.info(i,...o)}else b.info(r,...e)}function O7(r,e=sle){return dle({message:r,opts:e,level:yr.LogLevel.Debug})}var Hu=new WeakMap;function GL(r){return(e,t,n)=>{Hu.has(e)||Hu.set(e,new Map);let i=Hu.get(e);i||Hu.set(e,i=new Map),i.has(t)||i.set(t,[]),i.get(t).push({parameterIndex:n,propertyOfParameterToLog:r})}}function L7(){return(r,e,t)=>{Hu.has(r)||Hu.set(r,new Map);let n=Hu.get(r);n||Hu.set(r,n=new Map),n.has(e)||n.set(e,[]),n.get(e).push({parameterIndex:t,ignore:!0})}}function dle(r){return mB((e,t)=>gle(r,t,e),(r.opts&4)>0)}function ple(r){let{kind:e,name:t,args:n}=r;return(!e||e==="")&&(e="Function"),(!t||t==="")&&(t="<anon>"),n||(n=[]),{kind:e,name:t,args:n,methodName:r.methodName||"",target:r.target||void 0}}function fle(r){if(!r)return!1;let e=r;return typeof e.path=="string"&&typeof e.scheme=="string"}function qL(r){let e=JL?r.toLowerCase().indexOf(JL):-1;return e===-1?r:`~${r.substring(e+JL.length)}`}function mle(r,e,t,n){var a;if(fle(t))return qL(t.path);if(!t)return t;let i=(a=Hu.get(r))==null?void 0:a.get(e),o=i==null?void 0:i.find(l=>l.parameterIndex===n);if(!o)return typeof t=="string"?qL(t):t;if("ignore"in o&&o.ignore)return"";let s=t;return"propertyOfParameterToLog"in o&&o.propertyOfParameterToLog&&(s=t[o.propertyOfParameterToLog]),typeof s=="string"?qL(s):s}function hle(r,e,t){t=ple(t);let n=[r.message];return n.push(`${t.kind} name = ${t.name}`.trim()),e?(n.push(`completed in ${e.elapsed}ms`),n.push(`has a ${e.returnValue?"truthy":"falsy"} return value`)):n[n.length-1]=`${n[n.length-1]} (started execution)`,(r.opts&1)===1&&(r.level===yr.LogLevel.Debug?n.push(QO(t.args.map((i,o)=>t?mle(t.target,t.methodName,i,o):i))):n.push(QO(t.args))),e&&(r.opts&2)===2&&n.push(hB(e.returnValue)),n.join(", ")}function gle(r,e,t){let n=hle(r,e,t);e?e.err===void 0?r.level&&r.level===yr.LogLevel.Error||(r.level?hT(r.level,n):hT(yr.LogLevel.Info,n)):hT(yr.LogLevel.Error,n,e.err):r.level&&r.level!==yr.LogLevel.Error&&hT(r.level,n)}function hT(r,e,...t){switch(r){case yr.LogLevel.Error:b.error(e,...t);break;case yr.LogLevel.Warning:M7(e,...t);break;case yr.LogLevel.Info:b.info(e,...t);break;case yr.LogLevel.Debug:case yr.LogLevel.Trace:b.debug(e,...t);break;default:break}}var rc=require("vscode");d();var qV=require("vscode");d();var K7=Symbol("IsDevMode"),Hm=Symbol("IOutputChannel"),F7=Symbol("IS_WINDOWS"),ie=Symbol("IDisposableRegistry"),_t=Symbol("IGlobalMemento"),sr=Symbol("IGlobalMemento"),Cs=Symbol("IWorkspaceMemento");var gT=Symbol("IPersistentStateFactory"),YRe=Symbol("IRandom"),Me=Symbol("IConfigurationService"),st=Symbol("ExtensionContext"),Ga=Symbol("IExtensions"),$Re=Symbol("IJupyterExtensionBanner"),vT=Symbol("IFeaturesManager"),fy=Symbol("ICryptoUtils"),Ya=Symbol("IAsyncDisposableRegistry");var wc=Symbol("IExperimentService"),my=Symbol("IDataScienceCommandListener"),hy=Symbol("IVariableScriptGenerator"),gy=Symbol("IDataFrameScriptGenerator");d();var Oz=require("vscode");d();var z7=$($7()),tC=$(te());try{(0,tC.decorate)((0,tC.injectable)(),z7.EventEmitter)}catch(r){b.warn("Failed to decorate EventEmitter for DI (possibly already decorated by another Extension)",r)}var nt=class{constructor(e){this.container=e;nt._instance=this}static get instance(){return nt._instance}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}};nt=E([(0,tC.injectable)()],nt);d();d();var wt=require("vscode");d();var yy=Symbol("IPythonApi"),Eo=Symbol("IPythonExtensionChecker");var Pa=$(te());d();d();d();var $L="Python Kernel Debug Adapter",zL="Python Interactive Window Debug Adapter";d();d();var IT=$(X7()),iC=$(Z7());d();d();var Iy=require("vscode");d();d();var ot=class extends Error{constructor(t,n){super(n);this.category=t;this.isJupyterError=!0}},ti=class r extends ot{constructor(t,n,i){super(i||QL(n),t);this.originalException=n;n&&(this.stack=`${new Error("").stack}

${n.stack}`)}static from(t,n){return n instanceof ot?n:new r(t,n)}static unwrap(t){return t&&(t instanceof r&&t.originalException&&t.originalException instanceof ot&&(t=t.originalException),t)}};function QL(r){return r&&r instanceof ot?r.category:"unknown"}var Op=class extends ot{constructor(t,n,i){super("jupyterconnection",t+(n?`
${n}`:""));this.interpreter=i}};d();var nn=class extends ot{constructor(){super("sessionDisposed",C.sessionDisposed)}};function t8(r=""){let e=r8(r);return e?e[1]:void 0}function r8(r=""){if(!r)return;let e=r.trim().split(`
`).map(t=>t.trim()).filter(t=>t.trim().length).reverse();if(e.length!==0&&e[0].includes("Error"))return[e.length>1?e[1]:"",e[0]]}function n8(r){if(!r)return;let t=(Array.isArray(r)?r[0]:r).split(`
`).map(l=>l.trim().toLowerCase()).filter(l=>l.length).reverse().find(l=>l.startsWith("file ")&&l.includes(", line ")&&l.includes(".py")&&l.includes(".py"));if(!t)return;let i=(t.substring(0,t.lastIndexOf(".py"))+".py").replace(/\\/g,"/").split("/"),o=i.indexOf("site-packages"),s=o>=0&&i.length>o+1?i[o+1]:"",a=i.reverse();if(!(a.length<2))return{fileName:a[0],folderName:a[1],packageName:s}}function Jm(r,e,t,n="",i=[]){let o=e instanceof ot?e.stdErr||e.stack||"":e.toString(),s=r8(o),a=o.toLowerCase();if(e instanceof nn)return{reason:"sessionDisposed",message:C.sessionDisposed,moreInfoLink:"https://aka.ms/kernelDisposedCannotRunCell",telemetrySafeTags:["deadSession"]};if(a.includes("ImportError: No module named 'win32api'".toLowerCase()))return{reason:"importWin32apiFailure",message:C.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())&&a.includes("win32api"))return{reason:"importWin32apiFailure",message:C.failedToStartKernelDueToWin32APIFailure,moreInfoLink:"https://aka.ms/kernelFailuresWin32Api",telemetrySafeTags:["dll.load.failed","win32api"]};if(a.includes("ImportError: DLL load failed".toLowerCase())){let u=s&&s[0].toLowerCase().startsWith("import")?s[0].substring(6).trim():void 0;return{reason:"dllLoadFailure",moduleName:u,message:u?C.failedToStartKernelDueToDllLoadFailure(u):C.failedToStartKernelDueToUnknownDllLoadFailure,moreInfoLink:"https://aka.ms/kernelFailuresDllLoad",telemetrySafeTags:["dll.load.failed"]}}if(a.includes("AssertionError: Couldn't find Class NSProcessInfo".toLowerCase()))return{reason:"oldIPythonFailure",message:C.failedToStartKernelDueToOldIPython,moreInfoLink:"https://aka.ms/kernelFailuresOldIPython",telemetrySafeTags:["oldipython"]};if(a.includes("NotImplementedError".toLowerCase())&&a.includes("asyncio".toLowerCase())&&a.includes("events.py".toLowerCase()))return{reason:"oldIPyKernelFailure",message:C.failedToStartKernelDueToOldIPyKernel,moreInfoLink:"https://aka.ms/kernelFailuresOldIPyKernel",telemetrySafeTags:["oldipykernel"]};{let u=[];if(a.includes("ImportError: cannot import name".toLowerCase())&&a.includes("from partially initialized module".toLowerCase())&&a.includes("zmq.backend.cython".toLowerCase())&&u.push("zmq.backend.cython"),a.includes("zmq".toLowerCase())&&a.includes("cython".toLowerCase())&&a.includes("__init__.py".toLowerCase())&&u.push("zmq.cython"),a.includes("zmq.error.ZMQError")&&u.push("zmq.error"),u.length)return{reason:"zmqModuleFailure",message:C.failedToStartKernelDueToPyZmqFailure,moreInfoLink:"https://aka.ms/kernelFailuresPyzmq",telemetrySafeTags:u}}if(s&&s[1].toLowerCase().startsWith("importerror")){let u=e8(s[1]);if(u&&n){let p=xle(u.moduleName,u.fileName,r,n);return p||{reason:"importFailure",moduleName:u.moduleName,fileName:u.fileName,message:u.fileName?C.failedToStartKernelDueToImportFailureFromFile(u.moduleName,u.fileName):C.failedToStartKernelDueToImportFailure(u.moduleName),moreInfoLink:u.fileName?"https://aka.ms/kernelFailuresModuleImportErrFromFile":"https://aka.ms/kernelFailuresModuleImportErr",telemetrySafeTags:["import.error"]}}}let l="No module named".toLowerCase(),c="is not a package".toLowerCase();if(a.includes(l)&&!c){let u=at(o).map(f=>f.trim()).filter(f=>f.length).find(f=>f.toLowerCase().includes(l)),p=u?u.substring(u.toLowerCase().indexOf(l)+l.length).trim():"";if(u)return{reason:"moduleNotFound",moduleName:p,message:C.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(a.includes(l)&&c){let u=at(o).map(g=>g.trim()).filter(g=>g.length).find(g=>g.toLowerCase().includes(l)),p=u?u.substring(u.toLowerCase().indexOf(l)+l.length).trim():"",f="",m="";p.split("'").length>2&&(f=p.split("'").slice(-2)[0]||"",f=f?`${f}.py`:"",m=f||"",p=p.split("'")[1]||p);let h=i.filter(g=>vi(g).toLowerCase()==="__init__.py").map(g=>vi(ey(g)));return p&&f&&p!==f&&i.some(g=>vi(g).toLowerCase()===f.toLowerCase())?{reason:"overridingBuiltinModules",fileName:f,moduleName:p,message:C.fileSeemsToBeInterferingWithKernelStartup(f),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:p&&h&&p!==m&&h.some(g=>g.toLowerCase()===m.toLowerCase())?{reason:"overridingBuiltinModules",folderName:m,moduleName:p,message:C.moduleSeemsToBeInterferingWithKernelStartup(m),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}:{reason:"moduleNotFound",moduleName:p,message:C.failedToStartKernelDueToMissingModule(p),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}else if(e instanceof ot&&e.category==="invalidkernel"&&i.length){let u=vi(i[0]);return{reason:"overridingBuiltinModules",fileName:u,moduleName:vi(i[0],".py"),message:C.fileSeemsToBeInterferingWithKernelStartup(u),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}else if(s&&s[1].toLowerCase().startsWith("ModuleNotFoundError".toLowerCase())){let u=e8(s[1]);if(u)return{reason:"moduleNotFound",moduleName:u.moduleName,message:C.failedToStartKernelDueToMissingModule(u.moduleName),moreInfoLink:"https://aka.ms/kernelFailuresMissingModule",telemetrySafeTags:["module.notfound.error"]}}if(e instanceof Op){let u=at(o).map(v=>v.trim()).reverse().find(v=>v.toLowerCase().includes("error: ")),p="AttributeError: 'Namespace' object has no attribute '_flags'",f=["jupyter.startup.failure"],m,h="jupyterStartFailure",g=at(e.message,{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: "));if(g=g||at(e.stdErr||"",{removeEmptyEntries:!0,trim:!0}).reverse().find(v=>v.toLowerCase().includes("error: ")),a.includes(p.toLowerCase())?(h="jupyterStartFailureOutdatedTraitlets",u=C.failedToStartJupyterDueToOutdatedTraitlets(t||"",g||""),f.push("outdated.traitlets"),m="https://aka.ms/kernelFailuresJupyterTrailtletsOutdated"):(u=g?C.failedToStartJupyterWithErrorInfo(t||"",g):C.failedToStartJupyter(t||""),m=void 0),u)return{reason:h,message:u,pythonError:g,moreInfoLink:m,telemetrySafeTags:f}}}function e8(r){r=r.replace(/"/g,"'");let e=r.match(/'[^\\']*(\\'[^\\']*)*'/g),t=r.match(/\((.*?)\)/g),n,i;return e&&e[0].length>2&&(n=e[0],n=n.substring(1,n.length-1)),t&&t[0].length>2&&(i=t[0],i=i.substring(1,i.length-1)),n?{moduleName:n,fileName:i}:void 0}function xle(r,e,t,n){if(n&&t.length!==0&&e&&!e.toLowerCase().startsWith(n)&&t.some(i=>e.toLowerCase().startsWith(i.uri.fsPath.toLowerCase())))return{reason:"overridingBuiltinModules",fileName:e,moduleName:r,message:C.fileSeemsToBeInterferingWithKernelStartup(ye(Iy.Uri.file(e),t||[])),moreInfoLink:"https://aka.ms/kernelFailuresOverridingBuiltInModules",telemetrySafeTags:["import.error","override.modules"]}}function Sy(r){if(!r)return;let e=/\[([^\[\]]*)\]\((.*?)\)/gm,t;for(;(t=e.exec(r))!==null;)t.length===3&&(r=r.replace(t[0],`<a href='${t[2]}'>${t[1]}</a>`));let n=at(r,{removeEmptyEntries:!1,trim:!1}).map(i=>`\x1B[1;31m${i}`).join(`
`);return new Iy.NotebookCellOutput([Iy.NotebookCellOutputItem.error({message:"",name:"",stack:n})])}var Dle=[Ple,Tle];function i8(r){let e=[],t=Array.isArray(r)?r[0].toLowerCase():r.toLowerCase();Dle.forEach(i=>i(t,e));let n=Jm([],t,void 0);return n!=null&&n.telemetrySafeTags.length&&e.push(...n.telemetrySafeTags),Array.from(new Set(e)).join(",")}function Ple(r,e=[]){r.includes("ChildProcess.exithandler".toLowerCase())&&e.push("childproc.exit")}function Tle(r,e=[]){r.includes("KernelRestarter: restart failed".toLowerCase())&&e.push("KernelRestarter.failed")}function o8(){return(new Error().stack||"").split(`
`).filter(r=>r.includes(Ye))}async function s8(r,e){r.failed=!0,r.failureCategory=r.failureCategory||QL(e);let t=!IT.FetchError&&(e==null?void 0:e.name)==="TypeError"&&(e==null?void 0:e.message)==="Failed to fetch",i=(t||IT.FetchError!==void 0)&&Rle(e,t?TypeError:IT.FetchError);r.failureCategory==="unknown"&&i&&(r.failureCategory="fetcherror"),r.stackTrace=kle(e),typeof e=="string"&&(r.failureSubCategory="errorisstring");let o=e.stdErr?e.stdErr:e.stack||"";if(!o)return;r.failureSubCategory=r.failureSubCategory||i8(o);let s=n8(o);s&&([r.pythonErrorFile,r.pythonErrorFolder,r.pythonErrorPackage]=await Promise.all([Promise.resolve(r.pythonErrorFile||Rt(s.fileName)),Promise.resolve(r.pythonErrorFolder||Rt(s.folderName)),Promise.resolve(r.pythonErrorPackage||Rt(s.packageName))]))}function XL(r){if(r.stack&&Array.isArray(r.stack)){let e={...r,stack:r.stack.join(`
`)};return iC.parse.call(iC,e)}return iC.parse.call(iC,r)}function kle(r){let e="";for(let t of XL(r)){let n=t.getFileName();if(n){let i=t.getLineNumber(),o=t.getColumnNumber();e+=`
	at ${Nle(t)} ${n}:${i}:${o}`}else e+=`
	at <anonymous>`}return e.trim().replace(/\\/g,"/")}function Nle(r){let e=[];return typeof r.getTypeName()=="string"&&r.getTypeName().length>0&&e.push(r.getTypeName()),typeof r.getMethodName()=="string"&&r.getMethodName().length>0&&e.push(r.getMethodName()),typeof r.getFunctionName()=="string"&&r.getFunctionName().length>0&&(e.length!==2||e.join(".")!==r.getFunctionName())&&e.push(r.getFunctionName()),e.join(".")}function Rle(r,e){return e?r instanceof e||r instanceof ti&&r.originalException instanceof e:(console.error("Error type is not defined",r),!1)}var P0=require("vscode");function hfe(){try{return require("vscode")===void 0?!1:kG()!==void 0}catch(r){return!1}}function k0(){return P0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1}function N0(r){return P0.workspace.onDidChangeConfiguration(e=>{if(!e.affectsConfiguration("telemetry"))return;let n=P0.workspace.getConfiguration("telemetry").inspect("enableTelemetry").globalValue===!1;r(n)})}var T0={};function Zb(r,e){let t=r;FE()&&t.startsWith("ds_")||(e===void 0?delete T0[t]:T0[t]=e)}var rW;function kG(){if(rW)return rW;let r=(DG(),sP(xG)).default;return rW=new r(nB)}function PG(r,e){let t={};return Object.getOwnPropertyNames(e).forEach(n=>{if(!(e[n]===void 0||e[n]===null))try{t[n]=typeof e[n]=="string"?e[n]:typeof e[n]=="object"?"object":e[n].toString()}catch(i){b.error(`Failed to serialize ${n} for ${r}`,i)}}),t}function J(r,e,t,n){!NG(r.toString())&&(bn()||!hfe())||gfe(r,e,t,n)}function NG(r){return r==="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"||r==="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE"}function gfe(r,e,t,n){let i=kG(),o={},s=r;n?(o={},Object.assign(o,T0),Object.assign(o,t||{}),s8(o,n).then(()=>{o=PG(s,o),i.sendTelemetryEvent(s,o,e)}).catch(y)):(t&&(o=PG(s,t)),Object.assign(o,T0),NG(s)?i.sendDangerousTelemetryEvent(s,o,e):i.sendTelemetryEvent(s,o,e))}var TG=new Set;function Ar(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){let a=e||{},l=new St,c=`${r.toString()}${JSON.stringify(a)}`,u=!TG.has(c);TG.add(c);let p=o.apply(this,s);return p&&typeof p.then=="function"&&typeof p.catch=="function"?p.then(f=>{let m={...a};return u&&(m.firstTime=u),J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,m),f}).catch(f=>{let m={...a};m.failed=!0,J(r,l?{duration:l==null?void 0:l.elapsedTime}:{},m,f)}):J(r,l?{duration:l==null?void 0:l.elapsedTime}:void 0,a),p},i}}function Ln(r,e){return function(t,n,i){let o=i.value;return i.value=function(...s){return J(r,void 0,e),o.apply(this,s)},i}}function vfe(){return{isInsiderExtension:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether this is the Insider version of the Jupyter extension or not. Common to all events."},isPythonExtensionInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether Python extension is installed or not. Common to all events."},rawKernelSupported:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Whether the raw kernel is supported or not. Common to all events."}}}function ct(){return{duration:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth",isMeasurement:!0}}}function cs(){return{resourceType:{classification:"PublicNonPersonalData",comment:"",purpose:"FeatureInsight"}}}function Md(){return{failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},failureSubCategory:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFile:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorFolder:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonErrorPackage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},stackTrace:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}}function co(){return{properties:{actionSource:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},disableUI:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},userExecutedCell:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},resourceHash:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},pythonEnvironmentVersion:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPath:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},pythonEnvironmentPackages:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSessionId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelLanguage:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},kernelConnectionType:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},isUsingActiveInterpreter:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},capturedEnvVars:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},newKernelPicker:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"},...cs()}}}var b3e={...ct(),...Md(),...vfe()};var yfe,bfe,Ife,Sfe,_fe,Efe,Cfe,wfe,xfe,Dfe,Pfe,Tfe,kfe,Nfe,Rfe,Afe,Mfe,Ofe,Lfe,Kfe,Ffe,Ufe,Wfe,Vfe,jfe,Bfe,Hfe,Jfe,qfe,Gfe,Yfe,$fe,zfe,Qfe,Xfe,Zfe,eme,tme,rme,nme,ime,ome,sme,ame,lme,cme,ume,dme,pme,fme,mme,hme,gme,vme,yme,bme,Ime,Sme,_me,Eme,Cme,wme,xme,Dme,Pme,Tme,kme,Nme,Rme,Ame,Mme,Ome,Lme,Kme,Fme,Ume,Wme,Vme,jme,Bme,Hme,Jme,qme,Gme,Yme,$me,zme,Qme,Xme,Zme,ehe,the,rhe,nhe,ihe,ohe,she,ahe,lhe,che,uhe,dhe,phe,fhe,mhe,hhe,ghe,vhe,yhe,bhe,Ihe,She,_he,Ehe,Che,whe,xhe,Dhe,Phe,The,khe,Nhe,Rhe,Ahe,Mhe,Ohe,Lhe,Khe,Fhe,Uhe,Whe,Vhe,jhe,Bhe,Hhe,Jhe,qhe,Ghe,Yhe,$he,zhe,Qhe,Xhe,Zhe,ege,tge,rge,nge,ige,oge,sge,age,lge,cge,uge,dge,pge,fge,mge,hge,gge,vge,RG=class{constructor(){this[yfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{totalActivateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},codeLoadingTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},workspaceFolderCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[bfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:ct()};this[Ife]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Sfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[_fe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{hashedNamev2:{classification:"SystemMetaData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...cs()}};this[Efe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{firstTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:ct()};this[Cfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{mimeType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},when:{classification:"SystemMetaData",purpose:"FeatureInsight"},...cs()}};this[wfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:ct()};this[xfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Dfe]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer","VariableViewer"]};this[Pfe]={owner:"IanMatthewHuff",source:"User Action",feature:["DataFrameViewer","VariableViewer"]};this[Tfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:ct()};this[kfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action",measures:ct()};this[Nfe]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:{codeLensUpdateTime:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},maxCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Rfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Afe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Mfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Ofe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Lfe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Kfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Md(),failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Reason for failure to fetch kernel specs"},sessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},specsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSessionManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasSpecsManagerReady:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:ct()};this[Ffe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},serverIdHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},providerExtensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},baseUrlHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelId:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelLanguage:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"},isArgv0SameAsInterpreter:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},argv:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ufe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{serverIdHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},baseUrlHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isLocalHost:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},isJupyterHub:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"},reason:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Wfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[Vfe]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[jfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:co().properties,measures:{...ct()}};this[Bfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Hfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action"};this[Jfe]={owner:"IanMatthewHuff",feature:["Import-Export","InteractiveWindow"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[qfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"},cancelled:{classification:"SystemMetaData",purpose:"FeatureInsight"},successful:{classification:"SystemMetaData",purpose:"FeatureInsight"},opened:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Gfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{scope:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Yfe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"User Action",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[$fe]={owner:"IanMatthewHuff",feature:["Import-Export"],source:"N/A",properties:{format:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Qfe]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Xfe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},info:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Zfe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[eme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[tme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[rme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[nme]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{nbformat:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"},nbformat_minor:{classification:"PublicNonPersonalData",isMeasurement:!0,purpose:"FeatureInsight"}}};this[ime]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"User Action"};this[ome]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[sme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[ame]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[lme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[cme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[ume]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[dme]={owner:"amunger",feature:["InteractiveWindow"],source:"User Action"};this[pme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[fme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[mme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[hme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[gme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[vme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[yme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[bme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Ime]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Sme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[_me]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Eme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Cme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[wme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[xme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Dme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Pme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",measures:ct()};this[Tme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[kme]={owner:"donjayamanne",feature:"N/A",source:"N/A"};this[Nme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Rme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Ame]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"]};this[Mme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[Ome]={owner:"IanMatthewHuff",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Lme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Kme]={owner:"donjayamanne",feature:["KernelPicker"],source:"User Action",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Fme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{action:{classification:"SystemMetaData",purpose:"FeatureInsight"},isModulePresent:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pythonEnvType:{classification:"SystemMetaData",purpose:"FeatureInsight"},resourceHash:{classification:"SystemMetaData",purpose:"FeatureInsight"},...cs()},measures:ct()};this[Ume]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Wme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",measures:ct()};this[Vme]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rows:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0},columns:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[jme]={owner:"IanMatthewHuff",source:"N/A",feature:["DataFrameViewer"],measures:{rowsTimer:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[Bme]={owner:"IanMatthewHuff",feature:["DataFrameViewer","VariableViewer"],source:"N/A"};this[Hme]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action"};this[Jme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[qme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"FeatureInsight"},fallbackTried:{classification:"SystemMetaData",purpose:"FeatureInsight"},alpine:{classification:"SystemMetaData",purpose:"FeatureInsight"},zmqarch:{classification:"SystemMetaData",purpose:"FeatureInsight"},libc:{classification:"SystemMetaData",purpose:"FeatureInsight"},armv:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},distro_version_id:{classification:"SystemMetaData",purpose:"FeatureInsight"},errorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},fallbackErrorMessage:{classification:"CallstackOrException",purpose:"FeatureInsight"},zmqBinaries:{classification:"CallstackOrException",purpose:"FeatureInsight"}}};this[Gme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:ct()};this[Yme]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:{variableCount:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",isMeasurement:!0}}};this[$me]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{kind:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},usesShell:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[zme]={owner:"donjayamanne",feature:"N/A",source:"N/A",tags:["KernelStartup"],properties:{...Md(),...cs()},measures:{...ct()}};this[Qme]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonPathDefined:{classification:"SystemMetaData",purpose:"FeatureInsight"},pythonEnvFound:{classification:"SystemMetaData",purpose:"FeatureInsight"},language:{classification:"SystemMetaData",purpose:"FeatureInsight"},kernelSpecHash:{classification:"EndUserPseudonymizedInformation",purpose:"FeatureInsight"},argv0:{classification:"SystemMetaData",purpose:"FeatureInsight"},isCreatedByUs:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Xme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A"};this[Zme]={owner:"amunger",feature:["InteractiveWindow"],source:"N/A",properties:{hasKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the kernel was known at the time of creation"},hasOwner:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"If the window was created for a text file"},mode:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Creation mode: multiple, perfile or single"},restored:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Was the window restored from a previous session"}},measures:{windowCount:{classification:"SystemMetaData",purpose:"FeatureInsight",comment:"Number of active interactive windows the user has open",isMeasurement:!0}}};this[ehe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{cdnSearched:{classification:"SystemMetaData",purpose:"FeatureInsight"},hashedName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},source:{classification:"SystemMetaData",purpose:"FeatureInsight"},moduleName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},modelName:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[the]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{type:{classification:"SystemMetaData",purpose:"FeatureInsight"}},measures:ct()};this[rhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[nhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},isOnline:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[ohe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{moduleHash:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},moduleVersion:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[she]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[ahe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{selection:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[lhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A"};this[che]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],tags:["Widgets"],source:"N/A",properties:{msg_type:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[uhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:{...ct(),attempts:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{...co().properties,timedout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[dhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],measures:ct()};this[phe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],measures:{...ct()},properties:{...co().properties,...Md()}};this[fhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Code Execution"],measures:ct(),properties:{...co().properties,...Md(),extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[mhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",tags:["Cell Execution"],properties:{...co().properties,...Md()}};this[hhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",tags:["KernelStartup"],properties:{...co().properties,...Md()}};this[ghe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:co().properties};this[vhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{result:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},...cs(),...Md(),...co().properties},measures:{...ct()}};this[yhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"User Action",properties:{...cs(),...Md(),...co().properties},measures:ct()};this[bhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...cs(),...co().properties},measures:{reason:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}}};this[Ihe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{exitReason:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...cs(),...co().properties},measures:{exitCode:{classification:"CallstackOrException",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[She]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...cs(),...co().properties,manuallySelectedKernel:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...ct(),computeCwd:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},duration:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},envVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},executeCell:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},getConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},interruptHandle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelIdle:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInfo:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelReady:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},portUsage:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},postKernelStart:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},preExecuteCellTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},pythonEnvVars:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},sessionTelemetry:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},spawn:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startKernel:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},startupCode:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},updateConnection:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},codeCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},mdCellCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},outputsByteSize:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},attachmentCharLength:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[_he]={owner:"donjayamanne",feature:["Notebook"],source:"N/A",properties:{...cs(),...co().properties,wasAlreadyOpen:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}},measures:{...ct(),callPythonApi:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},activatePython:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},discoverEnv:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},createController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},selectController:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Ehe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{isRequestToShutdownRestartSession:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...cs(),...co().properties}};this[Che]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{stacktrace:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},...cs(),...co().properties}};this[whe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[xhe]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{kernelSpecCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelInterpreterCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},kernelLiveCount:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0},localKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},remoteKernelSpecCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}}};this[Dhe]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{outputType:{classification:"PublicNonPersonalData",purpose:"PerformanceAndHealth"}}};this[Phe]={owner:"IanMatthewHuff",feature:["InteractiveWindow"],tags:["IntelliSense"],source:"N/A",measures:ct(),properties:{isResultNull:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[The]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A",measures:ct()};this[khe]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[Nhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:ct()};this[Rhe]={owner:"IanMatthewHuff",feature:["PlotViewer"],source:"N/A",measures:ct()};this[Ahe]={owner:"amunger",feature:"N/A",source:"N/A",properties:{command:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Mhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{newState:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Ohe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A",measures:{numberOfDimensions:{classification:"SystemMetaData",purpose:"FeatureInsight",isMeasurement:!0}}};this[Lhe]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"User Action",properties:{source:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Khe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{failed:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},reason:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},dependenciesInstalled:{classification:"SystemMetaData",purpose:"FeatureInsight"},envType:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Fhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"SystemMetaData",purpose:"FeatureInsight"},action:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Uhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Whe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Vhe]={owner:"roblourens",feature:["Debugger"],properties:{status:{classification:"SystemMetaData",purpose:"FeatureInsight"}},source:"N/A"};this[jhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[Bhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Hhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Jhe]={owner:"roblourens",feature:["Debugger"],source:"User Action"};this[qhe]={owner:"roblourens",feature:["Debugger"],source:"N/A"};this[Ghe]={owner:"roblourens",feature:["Debugger"],source:"N/A",properties:{reason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[Yhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{...ct(),requestDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},timesExceededTimeout:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0},completionItems:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",isMeasurement:!0}},properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},monacoLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},completed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusAfterRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelStatusBeforeRequest:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[$he]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{kernelConnectionType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelLanguage:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[zhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Qhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"}},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Xhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{accessAllowed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[Zhe]={owner:"donjayamanne",feature:"N/A",source:"N/A",measures:{executionCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},cancelledAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestAcknowledgedAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},requestSentAfter:{classification:"SystemMetaData",isMeasurement:!0,purpose:"FeatureInsight"},...ct()},properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},kernelId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelled:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},requestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestAcknowledged:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},cancelledBeforeRequestSent:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},mimeTypes:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},failed:{classification:"PublicNonPersonalData",comment:"",purpose:"PerformanceAndHealth"}}};this[ege]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{clientExtId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},pemUsed:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}}};this[tge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},allowed:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[rge]={owner:"donjayamanne",feature:"N/A",source:"N/A",properties:{extensionId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"},providerId:{classification:"PublicNonPersonalData",purpose:"FeatureInsight"}},measures:ct()};this[nge]={owner:"IanMatthewHuff",feature:["VariableViewer"],source:"N/A"};this[ige]={owner:"roblourens",feature:["InteractiveWindow","Debugger"],source:"N/A"};this[oge]={owner:"donjayamanne",feature:["Notebook","InteractiveWindow"],source:"N/A",properties:{...co().properties,...cs()}};this[sge]={owner:"donjayamanne",source:"N/A",feature:["KernelPicker"]};this[age]={owner:"donjayamanne",source:"User Action",feature:["KernelPicker"]};this[lge]={owner:"amunger",feature:"N/A",source:"N/A",properties:{testName:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},testResult:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},perfWarmup:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},commitHash:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},timedCheckpoints:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"}}};this[cge]={owner:"donjayamanne",feature:["KernelPicker"],source:"N/A",measures:{matchedReason:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[uge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{requireEntryPointCount:{classification:"SystemMetaData",isMeasurement:!0,purpose:"PerformanceAndHealth"}},properties:{failed:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},failure:{classification:"CallstackOrException",purpose:"PerformanceAndHealth"},patternUsedToRegisterRequireConfig:{classification:"SystemMetaData",purpose:"PerformanceAndHealth"},widgetFolderNameHash:{classification:"SystemMetaData",purpose:"FeatureInsight"}}};this[dge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:ct()};this[pge]={owner:"donjayamanne",feature:["DataFrameViewer"],source:"N/A"};this[fge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[mge]={owner:"IanMatthewHuff",feature:["DataFrameViewer"],source:"N/A"};this[hge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0},preExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code before starting execution.",isMeasurement:!0},executeDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent executing cells.",isMeasurement:!0},postExecuteDuration:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total time spent in VS Code after executing cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[gge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}},properties:{outputType:{classification:"PublicNonPersonalData",purpose:"FeatureInsight",comment:"The kind of outputs generated in the notebook, text, html or images."}}};this[vge]={owner:"donjayamanne",feature:["Notebook","Notebook"],tags:["Widgets"],source:"N/A",measures:{...ct(),codeCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of code cells.",isMeasurement:!0},markdownCellCount:{classification:"SystemMetaData",purpose:"PerformanceAndHealth",comment:"Total number of markdown cells.",isMeasurement:!0}}}}};yfe="EXTENSION.LOAD",bfe="DS_INTERNAL.EXPERIMENT_LOAD",Ife="ENVFILE_VARIABLE_SUBSTITUTION",Sfe="ENVFILE_WORKSPACE",_fe="HASHED_PACKAGE_NAME",Efe="DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",Cfe="DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",wfe="DS_INTERNAL.GET_ACTIVATED_ENV_VARIABLES",xfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX",Dfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",Pfe="OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX",Tfe="DATASCIENCE.ADD_CELL_BELOW",kfe="DS_INTERNAL.CODE_LENS_ACQ_TIME",Nfe="DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",Rfe="DATASCIENCE.DEBUG_CONTINUE",Afe="DATASCIENCE.DEBUG_CURRENT_CELL",Mfe="DATASCIENCE.DEBUG_STEP_OVER",Ofe="DATASCIENCE.DEBUG_STOP",Lfe="DATASCIENCE.DEBUG_FILE_INTERACTIVE",Kfe="DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",Ffe="DS_INTERNAL.JUPYTER_KERNEL_SPEC",Ufe="DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",Wfe="DATASCIENCE.DISABLE_INTERACTIVE_SHIFT_ENTER",Vfe="DATASCIENCE.ENABLE_INTERACTIVE_SHIFT_ENTER",jfe="DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",Bfe="DATASCIENCE.EXPORT_PYTHON_FILE",Hfe="DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT",Jfe="DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",qfe="DATASCIENCE.EXPORT_NOTEBOOK_AS",Gfe="DATASCIENCE.IMPORT_NOTEBOOK",Yfe="DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",$fe="DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",zfe="DS_INTERNAL.GET_PASSWORD_FAILURE",Qfe="DS_INTERNAL.GET_PASSWORD_SUCCESS",Xfe="DS_INTERNAL.JUPYTER_HUB_PASSWORD",Zfe="DS_INTERNAL.SHOW_DATA_NO_PANDAS",eme="DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD",tme="DS_INTERNAL.SHOW_DATA_PANDAS_OK",rme="DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED",nme="DATASCIENCE.NATIVE.OPEN_NOTEBOOK_ALL",ime="DATASCIENCE.OPEN_PLOT_VIEWER",ome="DATASCIENCE.RUN_ALL_CELLS",sme="DATASCIENCE.RUN_SELECTION_OR_LINE",ame="DATASCIENCE.RUN_CURRENT_CELL",lme="DATASCIENCE.RUN_ALL_CELLS_ABOVE",cme="DATASCIENCE.RUN_CELL_AND_ALL_BELOW",ume="DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE",dme="DATASCIENCE.RUN_FILE_INTERACTIVE",pme="DATASCIENCE.RUN_TO_LINE",fme="DATASCIENCE.RUN_FROM_LINE",mme="DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION",hme="DATASCIENCE.RUN_INSERT_CELL_BELOW",gme="DATASCIENCE.RUN_INSERT_CELL_ABOVE",vme="DATASCIENCE.RUN_DELETE_CELLS",yme="DATASCIENCE.RUN_SELECT_CELL",bme="DATASCIENCE.RUN_SELECT_CELL_CONTENTS",Ime="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE",Sme="DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW",_me="DATASCIENCE.RUN_MOVE_CELLS_UP",Eme="DATASCIENCE.RUN_MOVE_CELLS_DOWN",Cme="DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN",wme="DATASCIENCE.RUN_CHANGE_CELL_TO_CODE",xme="DATASCIENCE.GOTO_NEXT_CELL_IN_FILE",Dme="DATASCIENCE.GOTO_PREV_CELL_IN_FILE",Pme="DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW",Tme="DATASCIENCE.SELFCERTSMESSAGECLOSE",kme="DATASCIENCE.SELFCERTSMESSAGEENABLED",Nme="DATASCIENCE.USER_INSTALLED_JUPYTER",Rme="DATASCIENCE.USER_INSTALLED_PANDAS",Ame="DATASCIENCE.USER_DID_NOT_INSTALL_JUPYTER",Mme="DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS",Ome="DS_INTERNAL.PYTHON_NOT_INSTALLED",Lme="DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",Kme="DS_INTERNAL.PYTHON_EXTENSION_INSTALLED_VIA_KERNEL_PICKER",Fme="DS_INTERNAL.PYTHON_MODULE_INSTALL",Ume="DS_INTERNAL.SHIFTENTER_BANNER_SHOWN",Wme="DATASCIENCE.START_SHOW_DATA_EXPLORER",Vme="DATASCIENCE.SHOW_DATA_EXPLORER",jme="DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",Bme="DATASCIENCE.FAILED_SHOW_DATA_EXPLORER",Hme="DATASCIENCE.REFRESH_DATA_VIEWER",Jme="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT",qme="DS_INTERNAL.JUPYTER_ZMQ_SUPPORT_FAILURE",Gme="DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME",Yme="DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",$me="DATASCIENCE.KERNEL_SPEC_LANGUAGE",zme="DS_INTERNAL.KERNEL_LAUNCHER_PERF",Qme="GLOBAL_PYTHON_KERNELSPEC",Xme="DS_INTERNAL.NEW_FILE_USED_IN_INTERACTIVE",Zme="DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",ehe="DS_INTERNAL.IPYWIDGET_USED_BY_USER",the="DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",rhe="DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED",nhe="DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",ihe="DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",ohe="DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",she="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN",ahe="DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",lhe="DS_INTERNAL.IPYWIDGET_RENDER_FAILURE",che="DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",uhe="DS_INTERNAL.RAWKERNEL_INFO_RESPONSE",dhe="DS_INTERNAL.RAWKERNEL_PROCESS_LAUNCH",phe="DATASCIENCE.EXECUTE_CELL",fhe="DATASCIENCE.EXECUTE_CODE",mhe="DATASCIENCE.RESUME_EXECUTE_CELL",hhe="DATASCIENCE.NOTEBOOK_START",ghe="DS_INTERNAL.SWITCH_KERNEL",vhe="DATASCIENCE.NOTEBOOK_INTERRUPT",yhe="DATASCIENCE.NOTEBOOK_RESTART",bhe="DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",Ihe="DS_INTERNAL.RAWKERNEL_SESSION_KERNEL_PROCESS_EXITED",She="DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",_he="DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",Ehe="DS_INTERNAL.RAWKERNEL_SESSION_SHUTDOWN",Che="DS_INTERNAL.RAWKERNEL_SESSION_DISPOSED",whe="DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER",xhe="DS_INTERNAL.KERNEL_COUNT",Dhe="DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",Phe="DS_INTERNAL.INTERACTIVE_FILE_TOOLTIPS_PERF",The="DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED",khe="DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE",Nhe="DATAVIEWER.WEBVIEW_LOADED",Rhe="PLOTVIEWER.WEBVIEW_LOADED",Ahe="DS_INTERNAL.COMMAND_EXECUTED",Mhe="DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",Ohe="DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",Lhe="DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",Khe="DATASCIENCE.CREATE_PYTHON_ENVIRONMENT",Fhe="DATASCIENCE.RECOMMENT_EXTENSION",Uhe="DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP",Whe="DATASCIENCE.DEBUGGING.CLOSED_MODAL",Vhe="DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",jhe="DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE",Bhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE",Hhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_IW_JUPYTER",Jhe="DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL",qhe="DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL",Ghe="DATASCIENCE.DEBUGGING.ENDED_SESSION",Yhe="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",$he="DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",zhe="DATASCIENCE.JUPYTER_KERNEL_API_USAGE",Qhe="DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",Xhe="DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",Zhe="DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",ege="DATASCIENCE.JUPYTER_API_USAGE",tge="DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",rge="DATASCIENCE.JUPYTER_KERNEL_STARTUP_HOOK",nge="DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE",ige="DATASCIENCE.INTERACTIVE_WINDOW_DEBUG_SETUP_CODE_FAILURE",oge="DATASCIENCE.KERNEL_CRASH",sge="DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER",age="DATASCIENCE.JUPYTER_KERNEL_FILTER_USED",lge="DS_INTERNAL.RUNTEST",cge="DS_INTERNAL.PREFERRED_KERNEL_EXACT_MATCH",uge="DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",dge="DS_INTERNAL.IPYWIDGET_TIME_TO_COPY_NBEXTENSIONS_DIR",pge="DATASCIENCE.NO_ACTIVE_KERNEL_SESSION",fge="DATAVIEWER.USING_INTERPRETER",mge="DATAVIEWER.USING_KERNEL",hge="DATASCIENCE.JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",gge="DATASCIENCE.JUPYTER_JUPYTER_NOTEBOOK_EXEC_PERFORMANCE",vge="DATASCIENCE.JUPYTER_NOTEBOOK_EDIT_PERFORMANCE";d();var Of=require("vscode");function eI(r){let e=Uc(r.uri);return Rt(e.path)}function iW(r=Of.Uri.file(""),e=Of.Uri.file(""),t=Ni(),n=!1){let i=Uc(r,t,t=="Windows"||n),o=Uc(e,t,t=="Windows"||n);return i===o||ra(i,o,!0)}function Uc(r=Of.Uri.file(""),e=Ni(),t=!1){let n=lt(r);return t&&(n=n.toLowerCase()),n.endsWith("/bin/python")?["Linux","OSX"].includes(e)?n.endsWith("/bin/python")&&n.split("/").length>4?Of.Uri.file(n.replace("/bin/python","/python")):Of.Uri.file(n):Of.Uri.file(n):Of.Uri.file(n)}d();var AG=require("vscode");var tI=class{constructor(){this.promises=new Set;this._onStateChange=new AG.EventEmitter;this.onStateChange=this._onStateChange.event}get isComplete(){return this.promises.size===0}dispose(){this._onStateChange.dispose()}push(e){this.promises.add(e),this._onStateChange.fire(),e.finally(()=>{this.promises.delete(e),this.isComplete&&this._onStateChange.fire()}).catch(y)}};d();var R0=class extends ti{constructor(e){super("Python Extension failed to activate",e,"pythonExtension")}};d();var A0=class extends ot{constructor(){super("pythonExtension","Python Extension API not exported")}};var pY=$(EW());d();var Ag=require("vscode");var B0=class{};function zG(r,e=""){let t=r?Ag.workspace.getWorkspaceFolder(r):Ag.workspace.workspaceFolders?Ag.workspace.workspaceFolders[0]:void 0;return t?_s(Ni()==="Windows"?t.uri.path.toUpperCase():t.uri.path):e}function cI(){let r=Array.isArray(Ag.workspace.workspaceFolders)&&Ag.workspace.workspaceFolders.length>0?Ag.workspace.workspaceFolders[0]:void 0;return r==null?void 0:r.uri}d();var Fg=require("vscode");d();d();d();var QG=$(EW());var Og=require("vscode");d();function Mg(r){return(e,t=null,n)=>{let i=!1,o;return o=r(s=>{if(!i)return o?o.dispose():i=!0,e.call(t,s)},null,n),i&&o.dispose(),o}}function vx(r,e=null,t){return new Promise(n=>Mg(r)(n,e,t))}var eve={output_type:"stream",name:"stdout",text:""},tve={output_type:"error",ename:"",evalue:"",traceback:[""]},rve={output_type:"display_data",data:{},metadata:{}},nve={output_type:"execute_result",execution_count:0,data:{},metadata:{}},eJe={stream:new Set(Object.keys(eve)),error:new Set(Object.keys(tve)),display_data:new Set(Object.keys(rve)),execute_result:new Set(Object.keys(nve))};function Kl(r){return r&&Zv(r).toLowerCase().endsWith("ipynb")?"notebook":"interactive"}function Vc(r){return r=r.toLowerCase(),r.length===2&&r.endsWith("#")?`${r.substring(0,1)}sharp`:aB.get(r)||r}function br(r){return typeof r=="string"?r===It||r===vt:r.notebookType===It||r.notebookType===vt}function xa(r){let e=r.metadata;return JSON.parse(JSON.stringify((e==null?void 0:e.metadata)||{}))}async function XG(r,e){let t=new Og.WorkspaceEdit;t.set(r.uri,[Og.NotebookEdit.updateNotebookMetadata(CW({...r.metadata||{},metadata:e}))]),await Og.workspace.applyEdit(t)}function uI(r){return Og.workspace.notebookDocuments.find(e=>br(e)&&e.getCells().some(t=>t.document===r))}function jc(r){if(Array.isArray(r)){let e="";for(let t=0;t<r.length;t+=1){let n=r[t];t<r.length-1&&!n.endsWith(`
`)?e=e.concat(`${n}
`):e=e.concat(n)}return e}return r.toString()}function dI(r){if(Array.isArray(r))return r;let e=r.toString();if(e.length>0){let t=e.split(`
`);return t.map((n,i)=>i<t.length-1?`${n}
`:n).filter(n=>n.length>0)}return[]}function ive(r){let e=r;do r=e,e=r.replace(/[^\n]\x08/gm,"");while(e.length<r.length);return r}function ove(r){for(r=r.replace(/\r+\n/gm,`
`);r.search(/\r[^$]/g)>-1;){var e=r.match(/^(.*)\r+/m)[1],t=r.match(/\r+(.*)$/m)[1];t=t+e.slice(t.length,e.length),r=r.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,t)}return r}function ZG(r){return ove(ive(r))}var H0="'''",J0='"""';function Lg(r,e,t){let n,i,o=0;for(let s of r){let a=s.trim(),l=a.startsWith(H0)?H0:a.startsWith(J0)?J0:void 0,c=a.includes(H0)?H0:a.includes(J0)?J0:void 0;if(i)i===c&&(i=void 0),t(s,o);else if(n)n===l&&(n=void 0),n&&e(s,o);else if(c&&!l){let u=a.indexOf(c);i=a.lastIndexOf(c)!==u?void 0:c,t(s,o)}else if(l){let u=a.indexOf(l,3);n=u>=0?void 0:l,a.length>3&&e(a.slice(3,u>=0?u:void 0),o)}else a.startsWith("#")?e(a.slice(1),o):t(s,o);o+=1}}function pI(r,e=`
`,t){return r.map((n,i)=>{let o=t?t(n):n;return i===r.length-1?`${o}`:`${o}${e}`})}function sve(r){let e=[];return Lg(r,t=>e.push(t),t=>{}),e}function q0(r){return pI(sve(r.slice(r.length>1?1:0)))}function eY(r){let e=r.length,t=-1;return r.forEach((n,i)=>{n.trim()&&(e=i,t<0&&(t=i))}),t>=0?r.slice(t,e+1):[]}function tY(r){var t;let e=/^\s*(\d+)\.(\d+)\.(.+)\s*$/.exec(r);if(e&&e.length>2){let n=parseInt(e[1],10),i=parseInt(e[2],10),o=parseInt(e[3],10);return(t=(0,QG.parse)(`${n}.${i}.${o}`,!0))!=null?t:void 0}}function Lf(r){let e=JSON.parse(JSON.stringify(r.metadata||{}))||{metadata:{}};return e.metadata=e.metadata||{},e}function CW(r){return ave(r)}function ave(r){return Array.isArray(r)?r.map(CW):r!=null&&typeof r=="object"&&Object.keys(r).length>0?Object.keys(r).sort().reduce((e,t)=>(e[t]=CW(r[t]),e),{}):r}async function Kg(r,e=[]){let t=vx(r.onDidDispose,void 0,e);r.dispose(),await t}var G0=new Map,xW=new Map,wW;function rY(r){wW=r}function DW(r,e){if(!r.pythonEnvironmentPath)return;let t=ke();lve({interpreterHash:r.pythonEnvironmentPath}).then(n=>{r.pythonEnvironmentPackages=n||r.pythonEnvironmentPackages,e&&(e.pythonEnvironmentPackages=n||e.pythonEnvironmentPackages)}).catch(()=>{}).finally(()=>{t.resolve()})}async function lve(r){if(!wW)return b.error("Python package provider is not initialized."),"{}";let e;if("interpreter"in r?e=r.interpreter:e=xW.get(r.interpreterHash),!e)return"{}";let t=await wW(e);return!t||t.size===0?"{}":JSON.stringify(Object.fromEntries(t))}async function nY(r){if(!r)return{};let e=G0.get(ja(r)),t=Kl(r);if(!e&&t)return{resourceType:t,resourceHash:r?await Rt(r.toString()):void 0};if(!e)return{};let n=JSON.parse(JSON.stringify(e[0]));return DW(e[0],n),n}function Yr(r,e,t,n,i){nY(r).then(o=>{Object.assign(o,n||{}),J(e,t,o,i)}).catch(y)}var Qn=!1,fI=new WeakMap,Y0=new Map,Da,oY=0;function Bc(r){var t,n;if(!r)return;if(Tn(r)&&!Y0.has(r.toString())){let i=Fg.workspace.notebookDocuments.find(o=>o.uri.toString()===r.toString());i&&Y0.set(r.toString(),new WeakRef(i))}let e=Tn(r)?(t=Y0.get(r.toString()))==null?void 0:t.deref():r;if(e)return(n=fI.get(e))==null?void 0:n.tracker}function sY(r){let e=new kn;return Da=r,oY=r.elapsedTime,Fg.workspace.notebookDocuments.forEach(t=>fI.set(t,iY(t,!0,r))),e.add(Fg.workspace.onDidOpenNotebookDocument(t=>{!fI.has(t)&&!Qn&&fI.set(t,iY(t,!1,r))})),e.add(Fg.workspace.onDidCloseNotebookDocument(t=>{fI.delete(t),Y0.delete(t.uri.toString())})),e}function aY(r){var e;(e=fI.get(r))==null||e.tracker.kernelManuallySelected()}var $0={starAfter:-1,completedAfter:-1},PW=new Map,lY=new Map,cve=new Map,cY=pr(()=>($0.starAfter=Da==null?void 0:Da.elapsedTime,{stop:pr(()=>{$0.completedAfter=Da.elapsedTime})}));function uY(r,e){PW.set(r,Da==null?void 0:Da.elapsedTime),cve.set(r,e||"")}function dY(r){r.executable.uri&&lY.set(r.id,Da==null?void 0:Da.elapsedTime)}function iY(r,e,t){let n=Da.elapsedTime,i=t.elapsedTime,o={openedAfter:i},s=c=>(c==="executeCell"&&(Qn=!0),o[`${c}StartedAfter`]=t.elapsedTime,{stop:pr(()=>{o[`${c}CompletedAfter`]=t.elapsedTime})}),a={wasAlreadyOpen:e},l=()=>{};return{measures:o,info:a,tracker:{kernelSelected:pr((c,u)=>{let p=PW.get(c);typeof p=="number"&&(a.wasAlreadyOpen?o.controllerCreatedAfter=PW.get(c):o.controllerCreatedAfter=n-p),o.interpreterDiscoveredAfter=lY.get(u||""),o.kernelSelectedAfter=t.elapsedTime,a.manuallySelectedKernel||pve(r,{wasAlreadyOpen:a.wasAlreadyOpen},{controllerCreatedAfter:o.controllerCreatedAfter,kernelSelectedAfter:o.kernelSelectedAfter,openedAfter:i,interpreterDiscoveredAfter:o.interpreterDiscoveredAfter})}),kernelManuallySelected:pr(()=>a.manuallySelectedKernel=!0),cellExecutionCount:Qn?l:pr(c=>o.executeCellCount=c),preExecuteCellTelemetry:Qn?l:pr(()=>s("preExecuteCellTelemetry")),startKernel:Qn?l:pr(()=>s("startKernel")),executeCell:Qn?l:pr(()=>s("executeCell")),executeCellAcknowledged:Qn?l:pr(()=>{o.executeCellAcknowledgedAfter=t.elapsedTime,uve(r,a,o)}),jupyterSessionTelemetry:Qn?l:pr(()=>s("sessionTelemetry")),postKernelStartup:Qn?l:pr(()=>s("postKernelStart")),computeCwd:Qn?l:pr(()=>s("computeCwd")),getConnection:Qn?l:pr(()=>s("getConnection")),updateConnection:Qn?l:pr(()=>s("updateConnection")),kernelReady:Qn?l:pr(()=>s("kernelReady")),portUsage:Qn?l:pr(()=>s("portUsage")),spawn:Qn?l:pr(()=>s("spawn")),pythonEnvVars:Qn?l:pr(()=>s("pythonEnvVars")),envVars:Qn?l:pr(()=>s("envVars")),interruptHandle:Qn?l:pr(()=>s("interruptHandle")),kernelInfo:Qn?l:pr(()=>s("kernelInfo")),kernelIdle:Qn?l:pr(()=>s("kernelIdle"))}}}var uve=pr(function(r,e,t){if(typeof t.preExecuteCellTelemetryStartedAfter!="number"||typeof t.preExecuteCellTelemetryCompletedAfter!="number"||typeof t.executeCellAcknowledgedAfter!="number"||typeof t.startKernelStartedAfter!="number"||typeof t.startKernelCompletedAfter!="number"||typeof t.executeCellStartedAfter!="number"||typeof t.sessionTelemetryStartedAfter!="number"||typeof t.sessionTelemetryCompletedAfter!="number"||typeof t.postKernelStartStartedAfter!="number"||typeof t.postKernelStartCompletedAfter!="number"||typeof t.kernelInfoStartedAfter!="number"||typeof t.kernelInfoCompletedAfter!="number"||typeof t.kernelIdleStartedAfter!="number"||typeof t.kernelIdleCompletedAfter!="number"||typeof t.computeCwdStartedAfter!="number"||typeof t.computeCwdCompletedAfter!="number"||typeof t.kernelReadyStartedAfter!="number"||typeof t.kernelReadyCompletedAfter!="number"||typeof t.getConnectionStartedAfter!="number"||typeof t.getConnectionCompletedAfter!="number"||typeof t.updateConnectionStartedAfter!="number"||typeof t.updateConnectionCompletedAfter!="number"||typeof t.portUsageStartedAfter!="number"||typeof t.portUsageCompletedAfter!="number"||typeof t.spawnStartedAfter!="number"||typeof t.spawnCompletedAfter!="number"||typeof t.pythonEnvVarsStartedAfter!="number"||typeof t.pythonEnvVarsCompletedAfter!="number"||typeof t.envVarsStartedAfter!="number"||typeof t.envVarsCompletedAfter!="number")return;let n={duration:0,preExecuteCellTelemetry:0,startKernel:0,executeCell:0};{let c=[{name:"preExecuteCellTelemetry",start:t.preExecuteCellTelemetryStartedAfter,end:t.preExecuteCellTelemetryCompletedAfter},{name:"startKernel",start:t.startKernelStartedAfter,end:t.startKernelCompletedAfter},{name:"executeCell",start:t.executeCellStartedAfter,end:t.executeCellAcknowledgedAfter}],u=t.executeCellAcknowledgedAfter-t.preExecuteCellTelemetryStartedAfter;n.duration=u,yx(n,c,u,t.openedAfter)}let i={sessionTelemetry:0,postKernelStart:0,computeCwd:0,getConnection:0,updateConnection:0,kernelReady:0,portUsage:0,spawn:0};{let c=[{name:"sessionTelemetry",start:t.sessionTelemetryStartedAfter,end:t.sessionTelemetryCompletedAfter},{name:"postKernelStart",start:t.postKernelStartStartedAfter,end:t.postKernelStartCompletedAfter},{name:"computeCwd",start:t.computeCwdStartedAfter,end:t.computeCwdCompletedAfter},{name:"getConnection",start:t.getConnectionStartedAfter,end:t.getConnectionCompletedAfter},{name:"updateConnection",start:t.updateConnectionStartedAfter,end:t.updateConnectionCompletedAfter},{name:"spawn",start:t.spawnStartedAfter,end:t.spawnCompletedAfter},{name:"portUsage",start:t.portUsageStartedAfter,end:t.portUsageCompletedAfter},{name:"kernelReady",start:t.kernelReadyStartedAfter,end:t.kernelReadyCompletedAfter}],u=t.startKernelCompletedAfter-t.startKernelStartedAfter;yx(i,c,u,t.openedAfter)}let o={startupCode:0,kernelInfo:0,kernelIdle:0};{let c=[{name:"startupCode",start:t.postKernelStartStartedAfter,end:t.kernelInfoStartedAfter},{name:"kernelInfo",start:t.kernelInfoStartedAfter,end:t.kernelInfoCompletedAfter},{name:"kernelIdle",start:t.kernelIdleStartedAfter,end:t.kernelIdleCompletedAfter}],u=t.postKernelStartCompletedAfter-t.postKernelStartStartedAfter;yx(o,c,u,t.openedAfter)}let s={pythonEnvVars:0,envVars:0,interruptHandle:0};{let c=[{name:"pythonEnvVars",start:t.pythonEnvVarsStartedAfter,end:t.pythonEnvVarsCompletedAfter},{name:"envVars",start:t.envVarsStartedAfter,end:t.envVarsCompletedAfter},{name:"interruptHandle",start:t.interruptHandleStartedAfter||0,end:t.interruptHandleCompletedAfter||0}],u=t.spawnCompletedAfter-t.spawnStartedAfter;yx(s,c,u,t.openedAfter)}let a=dve(r),l={...n,...i,...o,...s,...a};Yr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_START_BREAKDOWN",l,e)});function dve(r){let e={attachmentCharLength:0,attachmentCount:0,codeCellCharLength:0,codeCellCount:0,mdCellCharLength:0,mdCellCount:0,outputCount:0,outputsByteSize:0};return r.getCells().forEach(t=>{let n=t.document.lineAt(t.document.lineCount-1).range.end,i=t.document.offsetAt(n);if(t.kind===Fg.NotebookCellKind.Markup){e.mdCellCount+=1,e.mdCellCharLength+=i;try{let s=Lf(t).attachments||{};Object.keys(s).forEach(a=>{e.attachmentCount+=1;let l=s[a];typeof l=="object"&&Object.keys(l).forEach(c=>{let u=l[c];u&&typeof u=="string"&&(e.attachmentCharLength+=u.length)})})}catch(o){b.warn("Error parsing attachments in cell metadata",o)}}else e.codeCellCount+=1,e.codeCellCharLength+=i,e.outputCount+=t.outputs.length,e.outputsByteSize+=t.outputs.reduce((o,s)=>o+s.items.reduce((a,l)=>a+l.data.byteLength,0),0)}),e}var pve=pr(function(r,e,t){if(t.pythonExtensionActivationStartedAfter=$0.starAfter,t.pythonExtensionActivationCompletedAfter=$0.completedAfter,typeof t.controllerCreatedAfter=="undefined"||typeof t.interpreterDiscoveredAfter=="undefined"||typeof t.pythonExtensionActivationCompletedAfter=="undefined"||typeof t.pythonExtensionActivationStartedAfter=="undefined")return;let n=[{name:"callPythonApi",start:oY,end:t.pythonExtensionActivationStartedAfter},{name:"activatePython",start:t.pythonExtensionActivationStartedAfter,end:t.pythonExtensionActivationCompletedAfter},{name:"discoverEnv",start:t.pythonExtensionActivationCompletedAfter,end:t.interpreterDiscoveredAfter},{name:"createController",start:t.interpreterDiscoveredAfter,end:t.controllerCreatedAfter},{name:"selectController",start:t.controllerCreatedAfter,end:t.kernelSelectedAfter}],i=t.kernelSelectedAfter-t.openedAfter,o={duration:i};yx(o,n,i,t.openedAfter),Yr(r.uri,"DATASCIENCE.NOTEBOOK_FIRST_KERNEL_AUTO_SELECTION_BREAKDOWN",o,e)});function yx(r,e,t,n){e.sort((i,o)=>i.start-o.start).forEach(i=>{typeof n=="number"&&n>=i.start&&n<=i.end?r[i.name]=(i.end-n)*100/t:typeof n=="number"&&n>i.end?r[i.name]=0:(typeof n=="number"&&n<i.start||typeof n!="number")&&(r[i.name]=(i.end-i.start)*100/t)})}function bx(r,e){if(r){let t={...r,uri:wt.Uri.file(r.path||""),id:e||r.id};return delete t.path,t}}function Ix(r){if(r){let e=Object.assign({},r,{path:lt(r.uri)});return delete e.uri,e}}var mI=class{constructor(e,t){this.disposables=e;this.extensionChecker=t;this.api=ke();this.didActivatePython=new wt.EventEmitter;this._pythonExtensionHooked=ke();this.extensionChecker.isPythonExtensionInstalled||wt.extensions.onDidChange(async()=>{this.extensionChecker.isPythonExtensionInstalled&&await this.registerHooks()},this,this.disposables),this.disposables.push(this.didActivatePython)}get onDidActivatePythonExtension(){return this.didActivatePython.event}get pythonExtensionHooked(){return this._pythonExtensionHooked.promise}get pythonExtensionVersion(){return this._pythonExtensionVersion}getApi(){return this.init().catch(y),this.api.promise}async getNewApi(){var t,n;await this.init();let e=wt.extensions.getExtension(Zs);return(t=e==null?void 0:e.packageJSON)!=null&&t.version&&(this._pythonExtensionVersion=new pY.SemVer((n=e==null?void 0:e.packageJSON)==null?void 0:n.version)),e!=null&&e.exports&&(v7(e.exports),e.exports.environments.known.forEach(i=>{dY(i)})),e==null?void 0:e.exports}setApi(e){this.api.resolved||!wt.workspace.isTrusted||this.api.resolve(e)}async init(){if(this.initialized)return;wt.extensions.getExtension(Zs)?await this.registerHooks():await this.extensionChecker.showPythonExtensionInstallRequiredPrompt(),this.initialized=!0}async registerHooks(){var n;if(this.hooksRegistered)return;let e=wt.extensions.getExtension(Zs);if(!e)return;let t=!1;if(!e.isActive){let i=cY();try{let o=e.activate();o.then(()=>i.stop(),()=>i.stop()),await o,t=!0}catch(o){b.error("Failed activating the python extension: ",o),this.api.reject(new R0(o));return}}this.hooksRegistered||(this.hooksRegistered=!0,t&&this.didActivatePython.fire(),(n=e.exports)!=null&&n.jupyter?e.exports.jupyter.registerHooks():(b.error("Python extension is not exporting the jupyter API"),this.api.reject(new A0)),this._pythonExtensionHooked.resolve())}};mI=E([(0,Pa.injectable)(),I(0,(0,Pa.inject)(ie)),I(1,(0,Pa.inject)(Eo))],mI);var Kf=class{constructor(e){this.disposables=e;this.pythonExtensionInstallationStatusChanged=new wt.EventEmitter;wt.extensions.onDidChange(this.extensionsChangeHandler.bind(this),this,this.disposables),this.previousInstallState=this.isPythonExtensionInstalled}get onPythonExtensionInstallationStatusChanged(){return this.pythonExtensionInstallationStatusChanged.event}get isPythonExtensionInstalled(){return wt.extensions.getExtension(Zs)!==void 0}get isPythonExtensionActive(){var e;return((e=wt.extensions.getExtension(Zs))==null?void 0:e.isActive)===!0}async directlyInstallPythonExtension(){return wt.commands.executeCommand("workbench.extensions.installExtension",Zs,{context:{skipWalkthrough:!0}})}async showPythonExtensionInstallRequiredPrompt(){if(!wt.workspace.isTrusted)return;Kf.promptDisplayed=!0;let e=Ue.bannerLabelYes;J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"displayed"}),await wt.window.showInformationMessage(C.pythonExtensionRequired,{modal:!0},e)===e?(J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"download"}),await this.installPythonExtension()):J("DS_INTERNAL.PYTHON_EXTENSION_NOT_INSTALLED",void 0,{action:"dismissed"})}async installPythonExtension(){wt.commands.executeCommand("extension.open",Zs).then(y,y)}async extensionsChangeHandler(){let e=this.isPythonExtensionInstalled;e!==this.previousInstallState&&(this.pythonExtensionInstallationStatusChanged.fire(e?"installed":"uninstalled"),this.previousInstallState=e)}};Kf=E([(0,Pa.injectable)(),I(0,(0,Pa.inject)(ie))],Kf);var z0=class{constructor(e,t,n,i){this.apiProvider=e;this.extensionChecker=t;this.disposables=n;this.context=i;this.didChangeInterpreter=new wt.EventEmitter;this.didChangeInterpreters=new wt.EventEmitter;this._onDidEnvironmentVariablesChange=new wt.EventEmitter;this._onDidRemoveInterpreter=new wt.EventEmitter;this.onDidRemoveInterpreter=this._onDidRemoveInterpreter.event;this.onDidEnvironmentVariablesChange=this._onDidEnvironmentVariablesChange.event;this._status="idle";this._onDidChangeStatus=new wt.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.refreshPromises=new tI;this.onResumeEnvDetection=new wt.EventEmitter;this.workspaceCachedActiveInterpreter=new Set;this.lastLoggedResourceAndInterpreterId="";this.pythonEnvHashes=new Map;this.loggedEnvsWithoutInterpreterPath=new Set;this.pendingInterpreterChangeEventTriggers=new Map;this.pendingInterpretersChangeEventTriggers=new Map;this.extensionChecker.isPythonExtensionInstalled&&!this.extensionChecker.isPythonExtensionActive&&this.apiProvider.onDidActivatePythonExtension(()=>{this.hookupOnDidChangeInterpreterEvent()},this,this.disposables),wt.workspace.onDidGrantWorkspaceTrust(()=>this.refreshInterpreters(!0),this,this.disposables),this.disposables.push(this._onDidChangeStatus),this.disposables.push(this.refreshPromises),this.disposables.push(this.onResumeEnvDetection),this.refreshPromises.onStateChange(()=>{this.status=this.refreshPromises.isComplete?"idle":"refreshing"})}get status(){return this._status}set status(e){this._status!==e&&(this._status=e,this._onDidChangeStatus.fire())}initialize(){this.hookupOnDidChangeInterpreterEvent()}async resolveEnvironment(e){return this.getApi().then(t=>{if(!t)return;let n=typeof e=="string"?t.environments.known.find(i=>i.id===e||i.path===e):e;return t.environments.resolveEnvironment(n||e)})}get onDidChangeInterpreter(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreter.event}get onDidChangeInterpreters(){return this.hookupOnDidChangeInterpreterEvent(),this.didChangeInterpreters.event}async refreshInterpreters(e=!1){let t=(async()=>{let n=await this.getApi();if(n)try{await n.environments.refreshEnvironments({forceRefresh:e}),this.hookupOnDidChangeInterpreterEvent(),b.debug("Refreshed Environments")}catch(i){b.error("Failed to refresh the list of interpreters")}})();this.refreshPromises.push(t),this.refreshPromises.push(t.then(()=>oc(1e3))),await t}async getActiveInterpreter(e){var o,s,a;if(!wt.workspace.isTrusted)return;let t=new St;this.hookupOnDidChangeInterpreterEvent(),!e&&((o=wt.workspace.workspaceFolders)==null?void 0:o.length)===1&&(e=wt.workspace.workspaceFolders[0].uri),(s=wt.workspace.workspaceFolders)!=null&&s.length&&(e=(e?(a=wt.workspace.getWorkspaceFolder(e))==null?void 0:a.uri:void 0)||wt.workspace.workspaceFolders[0].uri);let n=zG(e),i=this.getApi().then(async l=>{if(!l)return;let c=l.environments.getActiveEnvironmentPath(e),u=await l.environments.resolveEnvironment(c);return this.trackResolvedEnvironment(u)});return i.then(()=>{this.workspaceCachedActiveInterpreter.has(n)||(this.workspaceCachedActiveInterpreter.add(n),J("DS_INTERNAL.ACTIVE_INTERPRETER_LISTING_PERF",{duration:t.elapsedTime},{firstTime:!0}))}).catch(l=>{b.warn(`Failed to get active interpreter from Python for workspace ${n}`,l)}),(Ji||[wt.ExtensionMode.Development,wt.ExtensionMode.Test].includes(this.context.extensionMode))&&i.then(l=>{let c=`${ye(e)}'-${ye(l==null?void 0:l.id)}`;if(this.lastLoggedResourceAndInterpreterId===c)return;this.lastLoggedResourceAndInterpreterId=c;let u=Bu(l);b.trace(`Active Interpreter ${e?`for '${ye(e)}' `:""}is ${ye(l==null?void 0:l.id)} (${l&&Zr(l)}, '${l?Es(l):""}', ${u==null?void 0:u.major}.${u==null?void 0:u.minor}.${u==null?void 0:u.micro})`)}).catch(y),i}getInterpreterHash(e){return this.pythonEnvHashes.get(e)}async getInterpreterDetails(e,t){if(!wt.workspace.isTrusted)throw new Error("Unable to determine active Interpreter as Workspace is not trusted");this.hookupOnDidChangeInterpreterEvent();try{return await this.getApi().then(async n=>{if(!n||t!=null&&t.isCancellationRequested)return;let i=n.environments.known.find(l=>Tn(e)?iW(l.executable.uri,e):typeof e=="string"?l.id===e:iW(wt.Uri.file(l.path),wt.Uri.file(e.path))),o=Tn(e)?ye(e):typeof e=="string"?e:ye(wt.Uri.file(e.path));if(i){let l=await n.environments.resolveEnvironment(i),c=this.trackResolvedEnvironment(l);return b.ci(`Interpreter details for ${o} from Python is ${JSON.stringify(l)} and our mapping is ${JSON.stringify(c)}`),c}let s=o;if(this.loggedEnvsWithoutInterpreterPath.has(s)||(this.loggedEnvsWithoutInterpreterPath.add(s),b.warn(`No interpreter with path ${o} found in Python API, will convert Uri path to string as Id ${o}`)),t!=null&&t.isCancellationRequested)return;let a=await n.environments.resolveEnvironment(Tn(e)?e.fsPath:typeof e=="string"?e:e.path);return this.trackResolvedEnvironment(a)})}catch(n){b.warn(`Failed to get Python interpreter details from Python Extension API for ${typeof e=="string"?e:ye(Tn(e)?e:wt.Uri.file(e.path))}`,n);return}}trackResolvedEnvironment(e){if(e){let t=dT(e);return t?(eI(t).then(n=>{this.pythonEnvHashes.set(t.id,n)}).catch(y),this.triggerEventIfAllowed("interpretersChangeEvent",t),t):void 0}}triggerEventIfAllowed(e,t){e==="interpreterChangeEvent"?this.pendingInterpreterChangeEventTriggers.set((t==null?void 0:t.id)||"",t):this.pendingInterpretersChangeEventTriggers.set((t==null?void 0:t.id)||"",t),this.triggerPendingEvents()}triggerPendingEvents(){this.pendingInterpreterChangeEventTriggers.forEach(t=>this.didChangeInterpreter.fire(t)),this.pendingInterpreterChangeEventTriggers.clear();let e=Array.from(this.pendingInterpretersChangeEventTriggers.values());if(e.length){let t=e.filter(n=>!!n);t.length!==e.length&&t.length===0?this.didChangeInterpreters.fire([]):this.didChangeInterpreters.fire(t)}this.pendingInterpretersChangeEventTriggers.clear()}async getApi(){if(this.extensionChecker.isPythonExtensionInstalled)return this.apiPromise||(this.apiPromise=this.apiProvider.getNewApi()),this.apiPromise}hookupOnDidChangeInterpreterEvent(){this.eventHandlerAdded||this.getApi().then(e=>{!this.eventHandlerAdded&&e&&(this.eventHandlerAdded=!0,e.environments.onDidEnvironmentVariablesChange(t=>{var n,i;b.debug(`Detected changes to env file ${(i=(n=t.resource)==null?void 0:n.uri)==null?void 0:i.path} in PythonApi`),this._onDidEnvironmentVariablesChange.fire()},this,this.disposables),e.environments.onDidChangeActiveEnvironmentPath(()=>{b.trace("Detected change in Active Python environment via Python API"),this.workspaceCachedActiveInterpreter.clear(),this.triggerEventIfAllowed("interpreterChangeEvent",void 0)},this,this.disposables),e.environments.onDidChangeEnvironments(async t=>{if(b.trace(`Python API env change detected, ${t.type} => '${t.env.id}'`),t.type==="remove"){this.triggerEventIfAllowed("interpreterChangeEvent",void 0),this.triggerEventIfAllowed("interpretersChangeEvent",void 0),this._onDidRemoveInterpreter.fire({id:t.env.id});return}let n=dT(Zi(t.env));n&&(this.triggerEventIfAllowed("interpreterChangeEvent",n),this.triggerEventIfAllowed("interpretersChangeEvent",n))},this,this.disposables),this.didChangeInterpreters.fire(b7().map(dT).filter(t=>!!t).map(t=>t)))}).catch(y)}};z0=E([(0,Pa.injectable)(),I(0,(0,Pa.inject)(yy)),I(1,(0,Pa.inject)(Eo)),I(2,(0,Pa.inject)(ie)),I(3,(0,Pa.inject)(st))],z0);d();var EI=require("vscode");d();function fY(r,e){let t=r.length>0?`?token=${r}`:"";return`${e}${t}`}async function VR(r,e){let t=C.jupyterSelfCertEnable,n=C.jupyterSelfCertClose,i=await EI.window.showErrorMessage(C.jupyterSelfCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,EI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}async function jR(r,e){let t=C.jupyterSelfCertEnable,n=C.jupyterSelfCertClose,i=await EI.window.showErrorMessage(C.jupyterExpiredCertFail(e),{modal:!0},t,n);return i===t?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await r.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,EI.ConfigurationTarget.Workspace),!0):(i===n&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE"),!1)}function RV(r,e,t,n,i,o,s){var _;let a=e.baseUrl,l=e.token,c=new URL(e.baseUrl).hostname,u=e.authorizationHeader&&Object.keys((_=e==null?void 0:e.authorizationHeader)!=null?_:{}).length>0?e.authorizationHeader:void 0,p=u?()=>u:void 0,f={baseUrl:a,appUrl:"",wsUrl:a.replace("http","ws"),fetch:e.fetch,WebSocket:e.WebSocket},m=t.getRequestInit();(!(l===""||l==="null")||p)&&(f={...f,token:l,appendToken:!0});let g=i.getSettings(void 0).allowUnauthorizedRemoteConnection;if(a.startsWith("https")&&g&&n){let D=n.createHttpRequestAgent();m={...m,agent:D}}let{ServerConnection:v}=li();return f={...f,init:m,WebSocket:e.WebSocket?t.wrapWebSocketCtor(e.WebSocket):t.getWebsocketCtor(void 0,g,p),fetch:e.fetch||t.getFetchMethod(),Request:t.getRequestCtor(void 0,g,p),Headers:t.getHeadersCtor()},{baseUrl:a,providerId:r.id,serverProviderHandle:r,token:l,hostName:c,displayName:e&&e.displayName?e.displayName:fY(l,a),dispose:()=>s==null?void 0:s.dispose(),rootDirectory:o,getAuthHeader:p,settings:v.makeSettings(f)}}async function ez(r){let e=qt(r);return qa(e,"SHA-256")}var SIe=new Set([Ye,"ms-toolsai.vscode-ai","GitHub.codespaces"].map(r=>r.toLowerCase()));function qt(r){return SIe.has(r.extensionId.toLowerCase())?`${rt.REMOTE_URI}?${rt.REMOTE_URI_ID_PARAM}=${r.id}&${rt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}`:`${rt.REMOTE_URI}?${rt.REMOTE_URI_ID_PARAM}=${r.id}&${rt.REMOTE_URI_HANDLE_PARAM}=${encodeURI(r.handle)}&${rt.REMOTE_URI_EXTENSION_ID_PARAM}=${encodeURI(r.extensionId)}`}async function BR(r){var e;if(!yp()&&((e=r.interpreter)!=null&&e.uri)){let t=r.interpreter.uri.fsPath,n=Uc(r.interpreter.uri).fsPath,i=r.id.replace(t,n);return Rt(i)}return Rt(r.id)}var Xc=class{static fromJSON(e){let t=Object.assign(e,{});switch(t.interpreter&&(t.interpreter=bx(t.interpreter,"")),e.kind){case"startUsingLocalKernelSpec":return AV.create(t);case"connectToLiveRemoteKernel":return Fx.create(t);case"startUsingRemoteKernelSpec":return Ux.create(t);case"startUsingPythonInterpreter":return Wx.create(t);default:throw new Error(`Invalid object to be deserialized into a connection, kind = ${t.kind}`)}}},Fx=class r{constructor(e){this.kind="connectToLiveRemoteKernel";this.kernelModel=e.kernelModel,this.interpreter=e.interpreter,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,HR(this)}static create(e){return new r(e)}updateModel(e){Object.assign(this.kernelModel,e)}getHashId(){return BR(this)}toJSON(){return{id:this.id,kind:this.kind,baseUrl:this.baseUrl,interpreter:Ix(this.interpreter),kernelModel:this.kernelModel,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Xc.fromJSON(e)}},AV=class r{constructor(e){this.kind="startUsingLocalKernelSpec";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,HR(this)}static create(e){return new r(e)}getHashId(){return BR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),kind:this.kind}}static fromJSON(e){return Xc.fromJSON(e)}},Ux=class r{constructor(e){this.kind="startUsingRemoteKernelSpec";this.interpreter=e.interpreter,this.kernelSpec=e.kernelSpec,this.baseUrl=e.baseUrl,this.id=e.id,this.serverProviderHandle=e.serverProviderHandle,HR(this)}static create(e){return new r(e)}getHashId(){return BR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),baseUrl:this.baseUrl,kind:this.kind,serverProviderHandle:this.serverProviderHandle}}static fromJSON(e){return Xc.fromJSON(e)}},Wx=class r{constructor(e){this.kind="startUsingPythonInterpreter";this.kernelSpec=e.kernelSpec,this.interpreter=e.interpreter,this.id=e.id,HR(this)}static create(e){return new r(e)}getHashId(){return BR(this)}toJSON(){return{id:this.id,kernelSpec:this.kernelSpec,interpreter:Ix(this.interpreter),kind:this.kind}}updateInterpreter(e){Object.assign(this.interpreter,e)}static fromJSON(e){return Xc.fromJSON(e)}};function tr(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"}function Ot(r){return!tr(r)}var He=Symbol("IKernelProvider"),Yg=Symbol("IThirdPartyKernelProvider");var BGe=Symbol("IJupyterServerConnector"),Vx=Symbol("IKernelSessionFactory");var CI=Symbol("IKernelDependencyService"),ui=Symbol("IKernelFinder"),wI=Symbol("ITracebackFormatter");var Ud=Symbol("IStartupCodeProviders"),tz=new Set;function HR(r){var m,h;if(tz.has(r.id))return;tz.add(r.id);let e="kernelSpec"in r?r.kernelSpec:void 0,t=(e==null?void 0:e.language)||(r.kind==="startUsingPythonInterpreter"?qe:void 0),n="",i="",o="interpreter"in r?r.interpreter:void 0,s="<#>",a;e&&Array.isArray(e.argv)&&e.argv.length>0&&(n=e.argv[0],a=n.toLowerCase()===((h=(m=o==null?void 0:o.uri)==null?void 0:m.fsPath)==null?void 0:h.toLowerCase()),rr(n)!==n&&(n=`<P>${rr(n)}`),i=e.argv.map(g=>g.includes("/")||g.includes("\\")?`<P>${rr(g)}`:g).join(s));let l="kernelSpec"in r&&r.kernelSpec.specFile?Rt(r.kernelSpec.specFile):Promise.resolve(""),c=Rt(r.id),u=Ot(r)?Rt(qt(r.serverProviderHandle)):Promise.resolve(""),p=Ot(r)?r.serverProviderHandle.extensionId:Ye,f=Ot(r)?Rt(r.baseUrl.toLowerCase()):Promise.resolve("");Promise.all([l,c,u,f]).then(([g,v,S,_])=>J("DS_INTERNAL.JUPYTER_KERNEL_SPEC",void 0,{kernelId:v,serverIdHash:S,kernelSpecHash:g,baseUrlHash:_,providerExtensionId:p,kernelConnectionType:r.kind,kernelLanguage:t,envType:o&&Zr(o),isArgv0SameAsInterpreter:a,argv0:n,argv:i})).catch(y)}d();var Xn=require("vscode");d();var TIe=$(MW()),Wd=require("vscode");d();var xI=class{constructor(e,t,n,i){this.specFile=t;this.interpreterPath=n;this.isRegisteredByVSC=i;this.name=e.name,this.argv=e.argv,this.language=e.language,this.executable=e.argv&&e.argv.length>0?e.argv[0]:"",this.display_name=e.display_name,this.metadata=e.metadata,this.env=e.env,this.interrupt_mode=e.interrupt_mode}};d();var di=require("vscode"),cz=$(MV());d();var OV=class{constructor(e,t,n,i=!1){this._impl=e;this.controllerId=t;this._endCallback=n;this.clearOutputOnStartWithTime=i;this._started=!1}get started(){return this._started}get cell(){return this._impl.cell}get token(){return this._impl.token}get executionOrder(){return this._impl.executionOrder}set executionOrder(e){var t;e&&((t=Bc(this._impl.cell.notebook))==null||t.executeCellAcknowledged()),this._impl.executionOrder=e}startIfNecessary(){this.started||this._impl.start()}start(e){this.started||(this._started=!0,this._impl.start(e),this._startTime=e,this.clearOutputOnStartWithTime?(b.trace(`Start cell ${this.cell.index} execution @ ${e} (clear output)`),this._impl.clearOutput().then(y,y)):b.trace(`Start cell ${this.cell.index} execution @ ${e}`))}end(e,t){if(this._endCallback)try{this._impl.end(e,t,this.errorInfo),b.trace(`Cell ${this.cell.index} completed in ${((t||0)-(this._startTime||0))/1e3}s (start: ${this._startTime}, end: ${t})`)}finally{this._endCallback(),this._endCallback=void 0}}clearOutput(e){return this.startIfNecessary(),this._impl.clearOutput(e)}replaceOutput(e,t){return this.startIfNecessary(),this._impl.replaceOutput(e,t)}appendOutput(e,t){return this.startIfNecessary(),this._impl.appendOutput(e,t)}replaceOutputItems(e,t){return this.startIfNecessary(),this._impl.replaceOutputItems(e,t)}appendOutputItems(e,t){return this.startIfNecessary(),this._impl.appendOutputItems(e,t)}},Jf=class Jf{static getOrCreate(e,t,n=!1){let i,o=e.document;if(i=this.get(e),!i)i=Jf.create(o,e,t,n);else if(i.controllerId!==t.id){let s=i;s.end(void 0),i=Jf.create(o,e,t,n),s.started&&i.start(new Date().getTime())}return i}static get(e){let t=e.document;return Jf._map.get(t)}static create(e,t,n,i=!1){let o=new OV(n.createNotebookCellExecution(t),n.id,()=>{Jf._map.delete(e)},i);return Jf._map.set(e,o),o}};Jf._map=new WeakMap;var po=Jf;d();function JR(r){return typeof Buffer!="undefined"&&typeof Buffer.from=="function"?Buffer.from(r,"base64"):Uint8Array.from(atob(r),e=>e.charCodeAt(0))}var EIe=new TextDecoder;function qR(r){if(typeof Buffer!="undefined"&&typeof Buffer.from=="function")return Buffer.from(r).toString("base64");{let e=EIe.decode(r);return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(t,n){return String.fromCharCode(Number.parseInt("0x"+n))}))}}var oz=["application/vnd.*","application/vdom.*","application/geo+json","application/x-nteract-model-debug+json","text/html","application/javascript","image/gif","text/latex","text/markdown","image/png","image/svg+xml","image/jpeg","application/json","text/plain"];function sz(r){if(r.mime.startsWith("application/vnd."))try{return new TextDecoder().decode(r.data).length===0}catch(e){}return!1}function CIe(r){return r.sort((e,t)=>{let n=(s,a)=>(s.endsWith(".*")&&(s=s.substr(0,s.indexOf(".*"))),a.startsWith(s)),i=oz.findIndex(s=>n(s,e.mime)),o=oz.findIndex(s=>n(s,t.mime));return sz(e)&&(i=-1),sz(t)&&(o=-1),i=i==-1?100:i,o=o==-1?100:o,i-o})}var qf=class qf{static getCellState(e){var t;return(t=qf.cellStates.get(e))==null?void 0:t.state}static getCellStatus(e){var t;return(((t=qf.cellStates.get(e))==null?void 0:t.stateTransition)||[]).join(", ")||""}static setCellState(e,t){var o,s;let n=((o=qf.cellStates.get(e))==null?void 0:o.start)||new St,i=((s=qf.cellStates.get(e))==null?void 0:s.stateTransition)||[];i.push(`${t} ${i.length===0?"@ start":`After ${n.elapsedTime}ms`}`),qf.cellStates.set(e,{stateTransition:i,state:t,start:n})}};qf.cellStates=new WeakMap;var Gf=qf;function it(r,e){let t=typeof e=="string"?()=>e:e;b.ci(()=>{var n;return`Cell Index:${r.index}, of document ${vi(r.notebook.uri)} with state:${Gf.getCellStatus(r)}, exec: ${(n=r.executionSummary)==null?void 0:n.executionOrder}. ${t()}. called from ${o8()}`})}var PI=new Map;PI.set("display_data",YR);PI.set("error",PIe);PI.set("execute_result",YR);PI.set("stream",wIe);PI.set("update_display_data",YR);function fs(r){let e=PI.get(r.output_type),t;return e?t=e(r):(b.warn(`Unable to translate cell from ${r.output_type} to NotebookCellData for VS Code.`),t=YR(r)),t}function LV(r){let e={outputType:r.output_type};switch(r.transient&&(e.transient=r.transient),r.output_type){case"display_data":case"execute_result":case"update_display_data":{e.executionCount=r.execution_count,e.metadata=r.metadata?JSON.parse(JSON.stringify(r.metadata)):{};break}default:break}return e}function $g(r){return r.metadata}function YR(r){let e=LV(r);("image/svg+xml"in r.data||"image/png"in r.data)&&(e.__displayOpenPlotIcon=!0);let t=[];if(r.data)for(let n in r.data)t.push(DIe(n,r.data[n]));return new di.NotebookCellOutput(CIe(t),e)}function wIe(r){let e=jc(r.text),t=r.name==="stderr"?di.NotebookCellOutputItem.stderr:di.NotebookCellOutputItem.stdout;return new di.NotebookCellOutput([t(e)],LV(r))}function xIe(r){if(r.items.length>0)return r.items[0].mime==="application/vnd.code.notebook.stderr"?"stderr":"stdout"}function az(r){var i;let e=r.items[0];if(!e.data)return{output_type:"error",ename:"",evalue:"",traceback:[]};let t=(i=r.metadata)==null?void 0:i.originalError,n=JSON.parse(new TextDecoder().decode(e.data));return{output_type:"error",ename:n.name,evalue:n.message,traceback:(t==null?void 0:t.traceback)||dI(n.stack||n.message||"")}}var DI=new TextDecoder,uz=["text/plain","text/markdown","application/vnd.code.notebook.stderr","application/vnd.code.notebook.stdout"];function GR(r,e){if(!e)return"";try{if(r==="application/vnd.code.notebook.error"){let t=DI.decode(e);return JSON.parse(t)}else if(r.startsWith("text/")||uz.includes(r)){let t=DI.decode(e);return dI(t)}else{if(r.startsWith("image/")&&r!=="image/svg+xml")return qR(e);if(r.toLowerCase().startsWith("application/vnd.holoviews_load.v")&&r.toLowerCase().endsWith("+json")){let t=DI.decode(e);try{return t.length>0?JSON.parse(t):t}catch(n){return t}}else if(r.toLowerCase().includes("json")){let t=DI.decode(e);return t.length>0?JSON.parse(t):t}else return DI.decode(e)}}catch(t){return b.error(`Failed to convert ${r} output from a buffer ${typeof e}, ${e}`,t),""}}function DIe(r,e){if(!e)return di.NotebookCellOutputItem.text("",r);try{if((r.startsWith("text/")||uz.includes(r))&&(Array.isArray(e)||typeof e=="string")){let t=Array.isArray(e)?jc(e):e;return di.NotebookCellOutputItem.text(t,r)}else return r.startsWith("image/")&&typeof e=="string"&&r!=="image/svg+xml"?new di.NotebookCellOutputItem(JR(e),r):typeof e=="object"&&e!==null&&!Array.isArray(e)?di.NotebookCellOutputItem.text(JSON.stringify(e),r):(e=Array.isArray(e)?jc(e):e,di.NotebookCellOutputItem.text(e,r))}catch(t){return b.error(`Failed to convert ${r} output to a buffer ${typeof e}, ${e}`,t),di.NotebookCellOutputItem.text("")}}function lz(r){let e=[];r.items.filter(n=>n.mime==="application/vnd.code.notebook.stderr"||n.mime==="application/vnd.code.notebook.stdout").map(n=>DI.decode(n.data)).forEach(n=>{let i=n.split(`
`);e.length&&i.length&&i[0].length>0&&(e[e.length-1]=`${e[e.length-1]}${i.shift()}`);for(let o of i)e.push(o)});for(let n=0;n<e.length-1;n++)e[n]=`${e[n]}
`;return e.length&&e[e.length-1].length===0&&e.pop(),{output_type:"stream",name:xIe(r)||"stdout",text:e}}function KV(r){let e=r.metadata,t;switch(e==null?void 0:e.outputType){case"error":{t=az(r);break}case"stream":{t=lz(r);break}case"display_data":{t={output_type:"display_data",data:r.items.reduce((i,o)=>(i[o.mime]=GR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}case"execute_result":{t={output_type:"execute_result",data:r.items.reduce((i,o)=>(i[o.mime]=GR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{},execution_count:typeof(e==null?void 0:e.executionCount)=="number"?e==null?void 0:e.executionCount:null};break}case"update_display_data":{t={output_type:"update_display_data",data:r.items.reduce((i,o)=>(i[o.mime]=GR(o.mime,o.data),i),{}),metadata:(e==null?void 0:e.metadata)||{}};break}default:{let i=r.items.length===1&&r.items.every(l=>l.mime==="application/vnd.code.notebook.error"),o=r.items.every(l=>l.mime==="application/vnd.code.notebook.stderr"||l.mime==="application/vnd.code.notebook.stdout");if(i)return az(r);let s=(e==null?void 0:e.outputType)||(o?"stream":"display_data");J("DS_INTERNAL.VSCNOTEBOOK_CELL_TRANSLATION_FAILED",void 0,{outputType:s});let a;s==="stream"?a=lz(r):s==="display_data"?a={data:{},metadata:{},output_type:"display_data"}:a={output_type:s},e!=null&&e.metadata&&(a.metadata=e.metadata),r.items.length>0&&(a.data=r.items.reduce((l,c)=>(l[c.mime]=GR(c.mime,c.data),l),{})),t=a;break}}return t&&e&&e.transient&&(t.transient=e.transient),t}function PIe(r){return r=r||{output_type:"error",ename:"",evalue:"",traceback:[]},new di.NotebookCellOutput([di.NotebookCellOutputItem.error({name:(r==null?void 0:r.ename)||"",message:(r==null?void 0:r.evalue)||"",stack:((r==null?void 0:r.traceback)||[]).join(`
`)})],{...LV(r),originalError:r})}async function dz(r,e,t){var a,l,c,u,p,f,m,h,g,v,S,_,D,P,M,x;let n=!1,i;if(!r)return{changed:n,kernelId:i};(a=r==null?void 0:r.language_info)!=null&&a.name||(r.language_info=r.language_info||{name:""});let o;switch(e==null?void 0:e.kind){case"connectToLiveRemoteKernel":o=e.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":o=e.kernelSpec.language;break;case"startUsingPythonInterpreter":o=qe;break;default:break}if(r.language_info.name!==o&&o&&(r.language_info.name=o,n=!0),t&&"language_info"in t&&t.language_info)(0,cz.default)(r.language_info,t.language_info)||(r.language_info=JSON.parse(JSON.stringify(t.language_info)),n=!0);else{let A=Gt(e),j=A?fz(e):void 0,re=await Np(j),R=re?`${re.major}.${re.minor}.${re.micro}`:"";j&&re&&r&&r.language_info&&r.language_info.version!==R?(r.language_info.version=R,n=!0):!j&&(r!=null&&r.language_info)&&A&&(r.language_info=void 0,n=!0)}let s=e&&TI(e)?e.kernelModel:e&&"kernelSpec"in e?e.kernelSpec:void 0;if((e==null?void 0:e.kind)==="startUsingPythonInterpreter"){let A=e.kernelSpec,j=A.display_name||((c=(l=Zi(e.interpreter))==null?void 0:l.environment)==null?void 0:c.name)||"",re="";switch(zg(A)){case"registeredByOldVersionOfExt":case"registeredByNewVersionOfExt":re="python3";break;case"registeredByNewVersionOfExtForCustomKernelSpec":{re=((p=(u=A.metadata)==null?void 0:u.vscode)!=null&&p.originalSpecFile?rr(ki(A.metadata.vscode.originalSpecFile)):void 0)||A.name,j=((m=(f=A.metadata)==null?void 0:f.vscode)==null?void 0:m.originalDisplayName)||j;break}default:re=A.name;break}((h=r.kernelspec)==null?void 0:h.name)!==re&&(n=!0,r.kernelspec={name:re,language:qe,display_name:j},"vscode"in r&&delete r.vscode,"interpreter"in r&&delete r.interpreter)}else if(s&&!r.kernelspec){let A=(v=(g=s.metadata)==null?void 0:g.vscode)!=null&&v.originalSpecFile?rr(ki(s.metadata.vscode.originalSpecFile)):void 0;r.kernelspec={name:A||s.name||s.display_name||"",display_name:((_=(S=s.metadata)==null?void 0:S.vscode)==null?void 0:_.originalDisplayName)||s.display_name||s.name||""},s.language&&(r.kernelspec.language=s.language),i=s.id,n=!0}else if(s&&r.kernelspec){let j=((P=(D=s.metadata)==null?void 0:D.vscode)!=null&&P.originalSpecFile?rr(ki(s.metadata.vscode.originalSpecFile)):void 0)||s.name||s.display_name||"",re=((x=(M=s.metadata)==null?void 0:M.vscode)==null?void 0:x.originalDisplayName)||s.display_name||s.name||"",R=s.language||s.language||"";(r.kernelspec.name!==j||r.kernelspec.language!==R||r.kernelspec.display_name!==re||i!==s.id)&&(n=!0,r.kernelspec.name=j,r.kernelspec.display_name=re,r.kernelspec.language=R,i=s.id);try{delete r.kernelspec.metadata}catch(Z){}}return{changed:n,kernelId:i}}async function Yf(r,e,t,n){var a,l,c,u,p,f,m;let i=Sy(t);if(!i){let h=po.get(r);n&&(h!=null&&h.started)&&h.end(n?void 0:!1,(l=(a=r.executionSummary)==null?void 0:a.timing)==null?void 0:l.endTime);return}po.get(r)||(n=!0);let o=po.getOrCreate(r,e),s=o.executionOrder;o.started||(o.start((u=(c=r.executionSummary)==null?void 0:c.timing)==null?void 0:u.startTime),o.executionOrder=((p=r.executionSummary)==null?void 0:p.executionOrder)||s),await o.appendOutput(i),o.end(n?void 0:!1,(m=(f=r.executionSummary)==null?void 0:f.timing)==null?void 0:m.endTime)}function pz(r,e){var s;let t=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,n=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\][^<]*<cell line:\s?(?<lineNumber>\d+)>.*/,i;for(let a of r){let l=(s=t.exec(a))!=null?s:n.exec(a);if(l&&l.groups){i=parseInt(l.groups.lineNumber);break}}let o;if(i&&i>0&&i<=e.document.lineCount){let a=e.document.lineAt(i-1),l=a.text.split("#")[0].trimEnd().length;o=new di.Range(new di.Position(a.lineNumber,a.firstNonWhitespaceCharacterIndex),new di.Position(a.lineNumber,l))}return o}d();function jx(r){if(r.hasOwnProperty("text/html")){let e=r["text/html"];typeof e=="string"&&e.includes('<iframe id="tensorboard-frame-')&&(r["text/html"]=e.replace(/new URL\((.*), window.location\)/,'new URL("http://localhost")'))}return r}var kIe="{connection_file}";var $f="-jvsc-",NIe=/^python\d*.?\d*$/;async function Hx(r,e){return RIe(await KIe(r),r,e)}function RIe(r,e,t){var s,a;let n=e?{path:lt(e.uri)}:{},i={name:r,language:"python",display_name:(e?(a=(s=Zi(e))==null?void 0:s.environment)==null?void 0:a.name:"")||"Python 3",metadata:{interpreter:n},argv:["python","-m","ipykernel_launcher","-f",kIe],env:{},resources:{}},o=t&&i.name?Gi(t,i.name,"kernel.json"):void 0;return new xI(i,o?lt(o):void 0,lt(e==null?void 0:e.uri),"registeredByNewVersionOfExt")}function $R(r){var t,n,i;let e=r==null?void 0:r.kernelspec;return(t=r==null?void 0:r.language_info)!=null&&t.name&&r.language_info.name!==qe?!1:(n=e==null?void 0:e.name)!=null&&n.includes(qe)?!0:(e==null?void 0:e.language)===qe||((i=r==null?void 0:r.language_info)==null?void 0:i.name)===qe}function AIe(r){var i,o,s,a,l;let e=((o=(i=r.metadata)==null?void 0:i.vscode)==null?void 0:o.originalSpecFile)||((s=r.metadata)==null?void 0:s.originalSpecFile),t=e?rr(ki(e)):r.name||"",n=((l=(a=r.metadata)==null?void 0:a.vscode)==null?void 0:l.originalDisplayName)||r.display_name||"";return!!(t.toLowerCase().match(NIe)||n.toLowerCase()==="python 3 (ipykernel)"||n.toLowerCase()==="python 3")}function MIe(r){if(r.includes($f)){let e=/[a-f0-9]$/;if(r.substring(r.lastIndexOf($f)+$f.length).search(e)!==-1){let t=r.substring(0,r.lastIndexOf($f));return t.toLowerCase().endsWith(".ipynb")||t.toLowerCase().endsWith(".py")?t:`${t}.ipynb`}}return r}function zR(r){return r.kind!=="connectToLiveRemoteKernel"}function TI(r){return r.kind==="connectToLiveRemoteKernel"}function QR(r,e,t){var c,u,p;e=FV(r)?e:void 0;let n=r.name,i=zg(r);if(i&&n.includes(Bx)&&(n=n.substring(n.indexOf(Bx)),i==="registeredByNewVersionOfExtForCustomKernelSpec")){let f=((u=(c=r.metadata)==null?void 0:c.vscode)==null?void 0:u.originalSpecFile)||((p=r.metadata)==null?void 0:p.originalSpecFile);f&&(n=`${n}#${rr(ki(f))}`)}let o="";FV(r)?o=r.argv.slice(1).filter(f=>!["-f","{connection_file}"].includes(f)).join("#").toLowerCase():o=r.argv.join("#").toLowerCase();let s=t?`${t}.`:"",a=lt(Uc(r.interpreterPath?Wd.Uri.file(r.interpreterPath):Wd.Uri.file(r.executable))),l=lt(Uc(e==null?void 0:e.uri))||"";return`${s}${r.id||""}.${n}.${a}.${l}.${o}`}function ut(r){var t,n,i,o;let e=OIe(r);if(!r)return e;switch(r.kind){case"connectToLiveRemoteKernel":{let a=MIe(((n=(t=r.kernelModel)==null?void 0:t.notebook)==null?void 0:n.path)||((o=(i=r.kernelModel)==null?void 0:i.model)==null?void 0:o.path)||"");return a?`${e} (${a})`:e}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":if(r.interpreter&&Zr(r.interpreter)!=="Unknown"){let a=Es(r.interpreter);if(r.kernelSpec.language===qe){let l=`Python ${uy(Bu(r.interpreter))||""}`.trim();return a?`${e} (${l})`:e}else return a?`${e} (${a})`:e}else return e;case"startUsingPythonInterpreter":let s=(uy(Bu(r.interpreter))||"").trim();if(r.interpreter&&Zr(r.interpreter)!=="Unknown"){if(r.kernelSpec.display_name&&zg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return r.kernelSpec.display_name;let a=kp(r.interpreter),l=s.trim()?`Python ${s}`:"Python",c=Es(r.interpreter);return a&&c?c:c?`${c} (${l})`:l}else return`Python ${s}`.trim()}return e}function OIe(r){var i,o;if(!r)return"";let e=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.display_name:(i=r.kernelSpec)==null?void 0:i.display_name,t=r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(o=r.kernelSpec)==null?void 0:o.name,n=r.kind==="startUsingPythonInterpreter"?ju(r.interpreter):void 0;return[e,t,n,""].find(s=>typeof s=="string"&&s.length>0)||""}function mz(r,e=""){var t;return r?r.kind==="connectToLiveRemoteKernel"?r.kernelModel.name:(t=r.kernelSpec)==null?void 0:t.name:e}function LIe(r){var n,i,o,s,a;if(!r)return;let e=TI(r)?r.kernelModel:void 0,t=zR(r)?r.kernelSpec:void 0;if(r.kind==="startUsingPythonInterpreter"||(r.kind==="startUsingRemoteKernelSpec"||r.kind==="startUsingLocalKernelSpec")&&r.kernelSpec.language===qe){let l=((i=(n=t==null?void 0:t.metadata)==null?void 0:n.interpreter)==null?void 0:i.path)||(t==null?void 0:t.interpreterPath)||(t==null?void 0:t.executable);if(l==="/python"||l==="python"){let c=Zi(r.interpreter);return((o=c==null?void 0:c.environment)==null?void 0:o.folderUri)||(c?Wd.Uri.file(c.path):void 0)}return l?Wd.Uri.file(l):void 0}else{let l=(e==null?void 0:e.executable)||(t==null?void 0:t.executable)||((a=(s=t==null?void 0:t.metadata)==null?void 0:s.interpreter)==null?void 0:a.path)||(t==null?void 0:t.interpreterPath);return l?Wd.Uri.file(l):void 0}}function UV(r,e=""){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel"){let t;if(typeof r.kernelModel.lastActivityTime=="string")try{t=new Date(r.kernelModel.lastActivityTime)}catch(n){b.debug(`Error parsing date ${n}`)}else t=r.kernelModel.lastActivityTime;return C.jupyterSelectLiveRemoteKernelDescription(t,r.kernelModel.numberOfConnections)}return e}function hz(r,e){if((r==null?void 0:r.kind)==="connectToLiveRemoteKernel")return;let t=LIe(r),n=Wd.workspace.workspaceFolders?Wd.workspace.workspaceFolders:[];return t?ye(t,n,e.homeDir):""}function fz(r){var n,i,o;if(!r)return;if(r.interpreter)return r.interpreter;let e=TI(r)?r.kernelModel:void 0;if((n=e==null?void 0:e.metadata)!=null&&n.interpreter)return bx((i=e==null?void 0:e.metadata)==null?void 0:i.interpreter,"");let t=zR(r)?r.kernelSpec:void 0;return bx((o=t==null?void 0:t.metadata)==null?void 0:o.interpreter,"")}function gz(r){return r.kind==="startUsingLocalKernelSpec"||r.kind==="startUsingPythonInterpreter"&&r.kernelSpec&&zg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec"}function Gt(r){if(!r)return!1;if(r.kind==="startUsingPythonInterpreter")return!0;let e=TI(r)?r.kernelModel:void 0,t=zR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)===qe||FV(t)}function FV(r){return((r==null?void 0:r.language)||"").toLowerCase()===qe}function Zc(r){if(!r)return;if(r.kind==="startUsingPythonInterpreter")return qe;let e=TI(r)?r.kernelModel:void 0,t=zR(r)?r.kernelSpec:void 0;return(e==null?void 0:e.language)||yz(t)}function vz(r){var t;if(!r)return;let e=r.kernelspec;return yz(e)||((t=r.language_info)==null?void 0:t.name)}function yz(r){return r==null?void 0:r.language}var Bx="jvsc74a57bd0";async function KIe(r){let t=(uy(Bu(r))||"3").replace(/\./g,""),n=r?`python${t}`:"";return r?`${n}${Bx}${await eI(r)}`:"python3"}function zg(r){var o,s,a,l;if(r.isRegisteredByVSC)return r.isRegisteredByVSC;if(!r.name)return;let e=((s=(o=r.metadata)==null?void 0:o.vscode)==null?void 0:s.originalSpecFile)||((a=r.metadata)==null?void 0:a.originalSpecFile),t=e?rr(ki(e)):r.name,n=AIe({...r,name:t})?Object.keys(r.env||{}).length>0:typeof e=="string"&&!e.includes(Bx);if(r.name.includes(Bx))return n?"registeredByNewVersionOfExtForCustomKernelSpec":"registeredByNewVersionOfExt";let i=/[a-f0-9]{32}$/;if((l=r.metadata)!=null&&l.interpreter&&r.name.toLowerCase().search(i)!==-1)return"registeredByOldVersionOfExt"}function bz(r,e){return!r&&!e?!0:!r&&e||r&&!e?!1:(r==null?void 0:r.id)===(e==null?void 0:e.id)}async function Vi(r,e,t){b.trace(`Executing silently Code (${r.status}) = ${at(e.substring(0,100)).join("\\n")}`);let n=li(),i=r.requestExecute({code:e.replace(/\r\n/g,`
`),silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!1},!0),o=[];i.onIOPub=a=>{if(n.KernelMessage.isStreamMsg(a))if(b.ci(`Got io pub message (stream), ${at(a.content.text.substr(0,100)).join("\\n")}`),o.length>0&&o[o.length-1].output_type==="stream"&&o[o.length-1].name===a.content.name){let l=o[o.length-1];l.text+=a.content.text}else{let l={name:a.content.name,text:a.content.text,output_type:"stream"};o.push(l)}else if(n.KernelMessage.isExecuteResultMsg(a)){b.ci("Got io pub message (execresult)}");let l={data:a.content.data,execution_count:a.content.execution_count,metadata:a.content.metadata,output_type:"execute_result"};o.push(l)}else if(n.KernelMessage.isDisplayDataMsg(a)){b.ci("Got io pub message (displaydata)}");let l={data:a.content.data,metadata:a.content.metadata,output_type:"display_data"};o.push(l)}else if(n.KernelMessage.isErrorMsg(a)){if(b.ci(`Got io pub message (error), ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join().substring(0,100)}}`),t!=null&&t.traceErrors){let c=`${t.traceErrorsMessage||"Failed to execute (silent) code against the kernel"}, 
Code = ${e}
Error details: `;b.error(`${c} ${a.content.ename},${a.content.evalue}, ${a.content.traceback.join()}`)}let l={ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback,output_type:"error"};o.push(l)}else b.ci(`Got io pub message (${a.header.msg_type})`)},await i.done;let s=at(e.substring(0,100)).join("\\n");return t&&FIe(o,t,s),b.trace(`Executing silently Code (completed) = ${s} with ${o.length} output(s)`),o}function Iz(r,e,t,n){e=e.replace(/\r\n/g,`
`);let i=li(),o=r.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!1,store_history:!1},!0),s=pr(t);return o.onIOPub=a=>{s(),i.KernelMessage.isStreamMsg(a)?n(fs({output_type:"stream",name:a.content.name,text:a.content.text})):i.KernelMessage.isExecuteResultMsg(a)?n(fs({output_type:"execute_result",data:a.content.data,metadata:a.content.metadata,transient:a.content.transient,execution_count:a.content.execution_count})):i.KernelMessage.isDisplayDataMsg(a)?n(fs({output_type:"display_data",data:jx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isUpdateDisplayDataMsg(a)?n(fs({output_type:"display_data",data:jx(a.content.data),metadata:a.content.metadata,transient:a.content.transient})):i.KernelMessage.isErrorMsg(a)?n(fs({output_type:"error",ename:a.content.ename,evalue:a.content.evalue,traceback:a.content.traceback})):i.KernelMessage.isExecuteInputMsg(a)||i.KernelMessage.isStatusMsg(a)||b.warn(`Got unexpected io pub message when executing code sillenty (${a.header.msg_type})`)},o}function FIe(r,e,t){r.filter(n=>n.output_type==="error").forEach(n=>{let i=n,o=`${i.ename}: ${i.evalue} 
 ${i.traceback.map(a=>`    ${a}`).join(`
`)}`,s=`${e.traceErrorsMessage||""} ${t} ${o}`;e.traceErrors?b.error(s):b.warn(s),e.telemetryName&&J(e.telemetryName)})}d();var XR="application/vnd.vscode.chat_message",Sz=`
def __VSCODE_inject_module():

    def __VSCODE_call_function(function, callback, data=None):
        __VSCODE_send_chat_message__(function, data, callback=callback)

    def __VSCODE_send_chat_message__(function, data, callback):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        import uuid as __VSCODE_send_chat_message__uuid
        import IPython.display as __VSCODE_send_chat_message__ipython_display

        id = str(__VSCODE_send_chat_message__uuid.uuid4())
        requests[id] = callback
        data_is_none = data is None
        __VSCODE_send_chat_message__ipython_display.display({"${XR}": data}, metadata={"id":id, "function": function, "dataIsNone": data_is_none}, raw=True)

        del __VSCODE_send_chat_message__ipython_display
        del __VSCODE_send_chat_message__uuid

    def __VSCODE_on_chat_message(id, data):
        requests = {}
        try:
            requests = __VSCODE_send_chat_message__.__requests
        except Exception:
            __VSCODE_send_chat_message__.__requests = requests

        if id in requests:
            requests[id](data)
            del requests[id]
        else:
            raise NotImplementedError(f"Callback not found for message {id}")

    import sys as __VSCODE_send_chat_message__sys
    import IPython as __VSCODE_send_chat_message__IPython
    chat = type(__VSCODE_send_chat_message__IPython)("chat")
    chat.send_message = __VSCODE_send_chat_message__
    chat.call_function = __VSCODE_call_function
    chat.__on_message = __VSCODE_on_chat_message
    __VSCODE_send_chat_message__sys.modules["vscode"] = type(__VSCODE_send_chat_message__IPython)("vscode")
    __VSCODE_send_chat_message__sys.modules["vscode"].chat = chat
    del __VSCODE_send_chat_message__sys
    del __VSCODE_send_chat_message__IPython


__VSCODE_inject_module()
del __VSCODE_inject_module
`,UIe=[[new RegExp("\\\\","g"),"\\\\"],[new RegExp('"',"g"),'\\"'],[new RegExp("'","g"),"'"],[new RegExp("\\\b","g"),"\\b"],[new RegExp("\\f","g"),"\\f"],[new RegExp("\\n","g"),"\\n"],[new RegExp("\\r","g"),"\\r"],[new RegExp("\\t","g"),"\\t"]];function _z(r,e){let t=Jx(e),n=typeof t=="string"?`"${t}"`:"None";return`
import vscode as __vscode
try:
    __vscode.chat.__on_message('${r}', ${n})
finally:
    del __vscode
`}function Jx(r){if(typeof r!="string")return r;for(let[e,t]of UIe)r=r.replace(e,t);return r}d();var qx=new WeakMap;function ZR(r,e,t){var a,l;let n=$g(t),i=(a=n==null?void 0:n.transient)==null?void 0:a.display_id;if(((l=t.metadata)==null?void 0:l.outputType)!=="display_data"||!i)return;let o=qx.get(e)||new Map;qx.set(e,o);let s=o.get(r)||[];o.set(r,s),s.push(i),s.length>1e3&&s.shift()}function Ez(r,e){let t=qx.get(r)||new Map;for(let n of t.values())if(n.includes(e))return!0;return!1}function Cz(r,e,t){return((qx.get(e)||new Map).get(r)||[]).includes(t)}function wz(r,e){let t=qx.get(r)||new Map;for(let n of t.values()){let i=n.indexOf(e);i>=0&&n.splice(i,1)}}d();var Kn=require("vscode");var kI=new Map,xz=new Set,r1=new Kn.EventEmitter;Uu(r1);function Dz(r){return r1.event(r)}async function Pz(r){if(!Kn.workspace.isTrusted)return{accessAllowed:!1};if(r===Ye)return{accessAllowed:!0};let e=kI.get(r);return e||(e=WIe(r),kI.set(r,e),e.then(({result:t})=>{(t==="learnMore"||t==="cancelled")&&kI.get(r)===e&&(kI.delete(r),xz.add(r))})),e.then(({result:t})=>({accessAllowed:t==="allowed"}))}async function WIe(r){var s,a;let e=await WV();if(e.get(r)===!0)return{result:"allowed"};if(e.get(r)===!1)return{result:"denied"};let t=(a=(s=Kn.extensions.getExtension(r))==null?void 0:s.packageJSON)==null?void 0:a.displayName;if(!t)return b.error(`Kernel API access revoked, as extension ${r} does not exist!`),{result:"denied"};let n=Kn.l10n.t("Allow"),i=Kn.l10n.t("Deny"),o=await Kn.window.showInformationMessage(Kn.l10n.t("Do you want to grant Kernel access to the extension {0} ({1})?",t,r),{modal:!0,detail:Kn.l10n.t("This allows the extension to execute code against Jupyter Kernels.")},n,Ue.learnMore,i);switch(o===Ue.learnMore?Kn.env.openExternal(Kn.Uri.parse("https://aka.ms/vscodeJupyterKernelApiAccess")).then(y,y):(o===n||o===i)&&await VIe(r,o===n),o){case n:return{result:"allowed"};case Ue.learnMore:return{result:"learnMore"};case i:return{result:"denied"};default:return{result:"cancelled"}}}async function Tz(){let r=new Set,[e]=await Promise.all([WV().then(t=>new Map(t)),...Array.from(kI.entries()).map(async([t,n])=>{(await n).result!=="allowed"&&r.add(t)})]);return r.forEach(t=>e.set(t,!1)),xz.forEach(t=>e.set(t,e.get(t)===!0)),e}var e1="API.Access",zf;async function WV(r=!1){let e=nt.instance.get(st);if(e.extensionMode===Kn.ExtensionMode.Test)return new Map;if(pr(()=>{nt.instance.get(ie).push(e.secrets.onDidChange(i=>{i.key===e1&&(zf=void 0)}))})(),zf&&!r)return zf;let t="";try{return t=await e.secrets.get(e1),!t||t.length===0?new Map:(zf=new Map(Object.entries(JSON.parse(t))),zf)}catch(n){return b.error(`Failed to parse API access information ${t}`,n),new Map}}var t1=Promise.resolve();async function kz(r){return t1=t1.then(async()=>{await Promise.all(Array.from(kI.entries()).map(async([t,n])=>{let i=await n;i.result=r.includes(t)===!0?"allowed":"denied"})),zf=new Map(r.map(t=>[t,!0]));let e=nt.instance.get(st);if(e.extensionMode!==Kn.ExtensionMode.Test)try{await e.secrets.store(e1,JSON.stringify(Object.fromEntries(zf))),r1.fire()}catch(t){b.error(`Failed to update API access information ${JSON.stringify(Object.fromEntries(zf))}`,t)}})}async function VIe(r,e){return t1=t1.then(async()=>{let t=nt.instance.get(st);if(t.extensionMode===Kn.ExtensionMode.Test)return;let n=await WV(!0);if(e!==n.get(r)){n.set(r,e);try{await t.secrets.store(e1,JSON.stringify(Object.fromEntries(n))),r1.fire()}catch(i){b.error(`Failed to store API access information ${JSON.stringify(Object.fromEntries(n))}`,i)}}})}d();var Nz=" (Interactive)",kt=Symbol("IControllerRegistration");var n1=Symbol("IRemoteNotebookKernelSourceSelector"),Rz=Symbol("ILocalNotebookKernelSourceSelector"),i1=Symbol("ILocalPythonNotebookKernelSourceSelector"),NI=Symbol("IConnectionDisplayData");var jV=class extends kP{constructor(t,n){super();this.controller=t;this.notebook=n}dispose(){this.disposeExistingExecution()}createReferencedObject(t,...n){return this.existingExecutions||(this.existingExecutions=this.controller.createNotebookExecution(this.notebook),this.existingExecutions.start()),this.existingExecutions}destroyReferencedObject(t,n){this.disposeExistingExecution()}disposeExistingExecution(){var t;try{(t=this.existingExecutions)==null||t.end()}catch(n){}this.existingExecutions=void 0}},Gx=class Gx{constructor(e,t,n){this.extensionId=e;this.kernel=t;var o,s;this.executionRefCountedDisposableFactory=n?new jV(n,t.notebook):void 0;let i=((s=(o=Xn.extensions.getExtension(e))==null?void 0:o.packageJSON)==null?void 0:s.displayName)||e;this.notebook=Xn.workspace.notebookDocuments.find(a=>{var l;return a.uri.toString()===((l=t.resourceUri)==null?void 0:l.toString())}),this.controllerDisplayName=ut(t.kernelConnectionMetadata),this.title=Xn.l10n.t("Executing code in {0} from {1}",this.controllerDisplayName,i),this.eventHandler=Xn.window.onDidChangeVisibleNotebookEditors(this.showProgressImpl,this)}dispose(){var e,t;this.eventHandler.dispose(),(e=this.disposable)==null||e.dispose(),(t=this.executionRefCountedDisposableFactory)==null||t.dispose()}show(){var t;let e=(t=this.executionRefCountedDisposableFactory)==null?void 0:t.acquire("");if(this.deferred&&!this.deferred.completed){let n=this.deferred;this.deferred=ke(),n.resolve()}else this.deferred=ke(),this.showProgress().catch(y);return this.disposable=new Xn.Disposable(()=>{var n;e==null||e.dispose(),(n=this.deferred)==null||n.resolve()})}async showProgress(){await oc(1e3),!(!this.deferred||this.deferred.completed||this.displayInProgress)&&(this.shouldDisplayProgress=!0,await Promise.all([this.showProgressImpl(),this.waitUntilCompleted()]),this.shouldDisplayProgress=!1)}async showProgressImpl(){let e=Gx.notificationsPerExtension.get(this.kernel)||new Set;Gx.notificationsPerExtension.set(this.kernel,e),!e.has(this.extensionId)&&(e.add(this.extensionId),!(!this.notebook||!this.shouldDisplayProgress)&&Xn.window.visibleNotebookEditors.some(t=>t.notebook===this.notebook)&&(this.displayInProgress=!0,await Xn.window.withProgress({location:Xn.ProgressLocation.Notification,title:this.title},async()=>this.waitUntilCompleted()),this.displayInProgress=!1))}async waitUntilCompleted(){let e=this.deferred;for(;e&&!e.completed;)await e.promise,e=this.deferred}};Gx.notificationsPerExtension=new WeakMap;var BV=Gx,HV=class r extends Vr{constructor(t,n,i,o){super();this.extensionId=t;this.kernel=n;this.execution=i;this._onDidChangeStatus=this._register(new Xn.EventEmitter);this._onDidReceiveDisplayUpdate=this._register(new Xn.EventEmitter);this.progress=this._register(new BV(t,n,o)),this._register(Mg(n.onDisposed)(()=>this.progress.dispose())),this.language=n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?qe:n.kernelConnectionMetadata.kernelSpec.language||qe,this._register(this.kernel.onStatusChanged(()=>this._onDidChangeStatus.fire(this.kernel.status))),this._register(i.onDidReceiveDisplayUpdate(a=>{var u,p;let l=this.kernel.session,c=$g(a);(c==null?void 0:c.outputType)==="display_data"&&((u=c==null?void 0:c.transient)!=null&&u.display_id)&&l&&Cz(this.extensionId,l,(p=c==null?void 0:c.transient)==null?void 0:p.display_id)&&this._onDidReceiveDisplayUpdate.fire(a)}));let s=this;this._api=Object.freeze({language:this.language,get status(){return s.kernel.status},onDidChangeStatus:s.onDidChangeStatus.bind(this),get onDidReceiveDisplayUpdate(){if(![Ye,rB].includes(t))throw new Error(`Proposed API is not supported for extension ${t}`);return s.onDidReceiveDisplayUpdate.bind(this)},executeCode:(a,l)=>this.executeCode(a,l),executeChatCode:(a,l,c)=>this.executeChatCode(a,l,c)})}get status(){return this.kernel.status}get onDidChangeStatus(){return this._onDidChangeStatus.event}get onDidReceiveDisplayUpdate(){return this._onDidReceiveDisplayUpdate.event}static createApiKernel(t,n,i,o){let s=new r(t,n,i,o);return nt.instance.get(ie).push(s),s._api}async checkAccess(){if(this.extensionId===Ye)return;if(this.accessAllowed||(this.accessAllowed=this.doCheckAccess(),this._register(Dz(()=>this.accessAllowed=void 0))),!await this.accessAllowed)throw new Error(Xn.l10n.t("Access to Jupyter Kernel has been revoked"))}async doCheckAccess(){let n=(await Pz(this.extensionId)).accessAllowed;return J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:this.extensionId,pemUsed:"getKernel",accessAllowed:n}),n}async*executeCode(t,n){await this.checkAccess();for await(let i of this.executeCodeInternal(t,void 0,n))yield i}async*executeChatCode(t,n,i){if(await this.checkAccess(),!["ms-vscode.dscopilot-agent",Ye].includes(this.extensionId.toLowerCase()))throw new Error(`Proposed API is not supported for extension ${this.extensionId}`);if(!Gt(this.kernel.kernelConnectionMetadata))throw new Error("Chat code execution is only supported for Python kernels");for await(let s of this.executeCodeInternal(t,n,i))yield s}async*executeCodeInternal(t,n={},i){var m;let o=!1,s={executionCount:this.execution.executionCount,requestSentAfter:0,requestAcknowledgedAfter:0,cancelledAfter:0,duration:0},a={kernelId:"",extensionId:this.extensionId,cancelled:!1,requestSent:!1,requestAcknowledged:!1,cancelledBeforeRequestSent:!1,cancelledBeforeRequestAcknowledged:!1,mimeTypes:"",failed:!1},l=new St,c=new Set;if(jIe(this.extensionId,this.kernel,"executeCode",s.executionCount).catch(y),this.kernel.disposed)throw a.failed=!0,VV(this.kernel,s,a).catch(y),new Error("Kernel is disposed");if(!((m=this.kernel.session)!=null&&m.kernel))throw a.failed=!0,VV(this.kernel,s,a).catch(y),this.kernel.status==="dead"||this.kernel.status==="terminating"?new Error("Kernel is dead or terminating"):new Error("Kernel connection not available to execute 3rd party code");let u=[];u.push({dispose:()=>{s.duration=l.elapsedTime,a.mimeTypes=Array.from(c).join(","),o=!0,VV(this.kernel,s,a).catch(y)}});let p=nt.instance.get(He).getKernelExecution(this.kernel),f={started:new Xn.EventEmitter,executionAcknowledged:new Xn.EventEmitter};f.started.event(()=>{a.requestSent=!0,s.requestSentAfter=l.elapsedTime,!i.isCancellationRequested&&this.extensionId!==Ye&&u.push(this.progress.show())},this,u),f.executionAcknowledged.event(()=>{a.requestAcknowledged=!0,s.requestAcknowledgedAfter=l.elapsedTime},this,u),i.onCancellationRequested(()=>{o||(a.cancelled=!0,s.cancelledAfter=l.elapsedTime,a.cancelledBeforeRequestSent=!a.requestSent,a.cancelledBeforeRequestAcknowledged=!a.requestAcknowledged,b.debug(`Code execution cancelled by extension ${this.extensionId}`))},this,u);try{for await(let h of p.executeCode(t,this.extensionId,f,i))if(ZR(this.extensionId,this.kernel.session,h),h.items.forEach(g=>c.add(g.mime)),n&&Az(h))for await(let g of this.handleChatOutput(h,p,f,c,n,i))yield g;else yield h}finally{me(u)}}async*handleChatOutput(t,n,i,o,s={},a){let l=t.items.find(v=>v.mime===XR);if(!l)return;let c=(t.metadata||{}).metadata,u=c.function,p=c.id,f=c.dataIsNone?void 0:new TextDecoder().decode(l.data),m=s[u];if(!m)throw new Error(`Chat Function ${u} not found`);let h=await m(f),g=_z(p,h);for await(let v of n.executeCode(g,this.extensionId,i,a))if(v.items.forEach(S=>o.add(S.mime)),Az(v))for await(let S of this.handleChatOutput(v,n,i,o,s,a))yield S;else yield v}};function Az(r){return r.items.some(e=>e.mime===XR)}async function jIe(r,e,t,n){let i=await Rt(e.id);J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_USAGE",{executionCount:n},{kernelId:i,pemUsed:t,extensionId:r})}async function VV(r,e,t){t.kernelId=await Rt(r.id),J("DATASCIENCE.JUPYTER_NEW_KERNEL_API_EXEC",e,t)}function o1(r,e){var i;let t=nt.instance.get(He),n=(i=nt.instance.get(kt).getSelected(e.notebook))==null?void 0:i.controller;return HV.createApiKernel(r,e,t.getKernelExecution(e),n)}var Mz=new WeakMap;function Lz(r){return{async getKernel(e){let t,n=nt.instance.get(He),i=Oz.workspace.notebookDocuments.find(l=>l.uri.toString()===e.toString()),o=n.get(i||e);if(!o||!o.startedAtLeastOnce){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let s=n.getKernelExecution(o);if(!Ot(o.kernelConnectionMetadata)&&s.executionCount===0){J("DATASCIENCE.JUPYTER_NEW_KERNELS_API_USAGE",void 0,{extensionId:r,pemUsed:"getKernel",accessAllowed:t});return}let a=Mz.get(o)||o1(r,o);return Mz.set(o,a),a}}}d();d();var s1=Symbol("JupyterServerHelper"),F$e=Symbol("INotebookImporter"),RI=Symbol("INotebookExporter"),Kz=Symbol("IJupyterInterpreterDependencyManager"),U$e=Symbol("INbConvertInterpreterDependencyChecker"),W$e=Symbol("INbConvertExportToPythonService"),a1=Symbol("IJupyterServerProvider"),hr=Symbol("IJupyterServerUriStorage"),l1=Symbol("IJupyterKernelService"),c1=Symbol("IJupyterRequestAgentCreator"),Qg=Symbol("IJupyterRequestCreator"),V$e=Symbol("INotebookStarter"),Xg=Symbol("ILiveRemoteKernelConnectionUsageTracker"),u1=Symbol("IJupyterRemoteCachedKernelValidator"),ur=Symbol("IJupyterServerProviderRegistry");function d1(r,e,t,n,i){J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"createJupyterServerCollection"});let s=i.get(ur).createJupyterServerCollection(n,r,zv(e),t);return{dispose:()=>{s==null||s.dispose()},get id(){return r},set label(l){s.label=zv(l)},get label(){return s.label},set documentation(l){s.documentation=l},get documentation(){return s.documentation},set commandProvider(l){s.commandProvider=l},get commandProvider(){return s.commandProvider}}}d();var Fz=!1;function Uz(r,e){if(Fz)return;Fz=!0,e.get(yy).setApi(r)}d();var em=require("vscode");d();var AI=$(te());d();var ru=$(te());d();var Qf=class extends ot{constructor(t,n){super("remotejupyterserveruriprovider",n.message||n.toString());this.serverProviderHandle=t;this.originalError=n}};d();var Fs=class extends ot{constructor(e){super("jupyterselfcert",e)}static isSelfCertsError(e){return e.message.indexOf("reason: self signed certificate")>=0}};d();var eu=class extends ot{constructor(e){super("jupyterselfexpiredcert",e)}static isSelfCertsExpiredError(e){return e.message.indexOf("reason: certificate has expired")>=0}};d();var xn=Symbol("IDataScienceErrorHandler"),wi=class extends ot{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}},tu=class extends ti{constructor(t,n,i){super(t,n);this.kernelConnectionMetadata=i}};d();var fo=class extends ot{constructor(t,n,i){super("remotejupyterserverconnection",C.remoteJupyterConnectionFailedWithServerWithError(Wz(t),i.message||i.toString()));this.url=t;this.serverProviderHandle=n;this.originalError=i;this.baseUrl=Wz(t)}};function Wz(r){let e=new URL(r);return`${e.protocol}//${e.host}/`}var Yx=require("vscode");d();var Vz=require("vscode");var Xf=class r extends lc{constructor(t){super();this.serverSettings=t;this._isDisposing=!1;this.kernelSpecManager=new this.jupyterlab.KernelSpecManager({serverSettings:this.serverSettings}),this.kernelManager=new this.jupyterlab.KernelManager({serverSettings:this.serverSettings}),this.sessionManager=new this.jupyterlab.SessionManager({serverSettings:this.serverSettings,kernelManager:this.kernelManager}),this.contentsManager=new this.jupyterlab.ContentsManager({serverSettings:this.serverSettings})}get jupyterlab(){return this._jupyterlab||(this._jupyterlab=li()),this._jupyterlab}static create(t){return new r(t)}dispose(){this.isDisposed||this._isDisposing||(this._isDisposing=!0,(async()=>{var t,n,i,o;b.trace("Disposing Jupyter Lab Helper");try{this.contentsManager&&(b.trace("SessionManager - dispose contents manager"),this.contentsManager.dispose()),this.sessionManager&&!this.sessionManager.isDisposed&&(b.trace("ShutdownSessionAndConnection - dispose session manager"),await bo(1e4,this.sessionManager.ready),this.sessionManager.dispose()),(t=this.kernelManager)!=null&&t.isDisposed||(n=this.kernelManager)==null||n.dispose(),(i=this.kernelSpecManager)!=null&&i.isDisposed||(o=this.kernelSpecManager)==null||o.dispose()}catch(s){b.error("Exception on Jupyter Lab Helper shutdown: ",s)}finally{b.trace("Finished disposing Jupyter Lab Helper")}})().catch(y).finally(()=>super.dispose()))}async getRunningSessions(){if(!this.sessionManager)return[];await bo(1e4,this.sessionManager.ready).catch(y),await this.sessionManager.refreshRunning();let t=[],n=this.sessionManager.running(),i=n.next();for(;i;)t.push(i),i=n.next();return t}async getRunningKernels(){let t=await this.jupyterlab.KernelAPI.listRunning(this.serverSettings),n=new Set;return t.map(i=>{let o=i;return{id:i.id,name:i.name,lastActivityTime:o.last_activity?new Date(Date.parse(o.last_activity.toString())):new Date,numberOfConnections:o.connections?parseInt(o.connections.toString(),10):0}}).filter(i=>n.has(i.id)?!1:(n.add(i.id),!0))}async getKernelSpecs(){var t,n,i;if(!this.serverSettings||!this.sessionManager||!this.contentsManager)throw new nn;try{let o=new St,s=this.kernelSpecManager;if(!s)return b.error(`No SessionManager to enumerate kernelspecs (no specs manager). Returning a default kernel. Specs ${JSON.stringify(((n=(t=this.kernelSpecManager)==null?void 0:t.specs)==null?void 0:n.kernelspecs)||{})}.`),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsManager"}),[await Hx()];let a={wasSessionManagerReady:this.sessionManager.isReady,wasSpecsManagerReady:s.isReady,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,waitedForChangeEvent:!1},l=(f={})=>s.specs&&Object.keys(s.specs.kernelspecs).length?s.specs.kernelspecs:f,c=l();await bo(1e4,this.sessionManager.ready),a.sessionManagerReady=this.sessionManager.isReady,await bo(1e4,s.refreshSpecs()),a.specsManagerReady=s.isReady;let u=!1;if(s&&Object.keys(((i=s.specs)==null?void 0:i.kernelspecs)||{}).length===0){let f=[],m=ke(),h=m.resolve.bind(m);s.specsChanged.connect(h),f.push(new Vz.Disposable(()=>s.specsChanged.disconnect(h)));let g=Promise.all([m.promise,s.ready,s.refreshSpecs(),this.sessionManager.ready]);await bo(1e4,g),a.waitedForChangeEvent=!0,m.completed||(u=!0,J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,sessionManagerReady:this.sessionManager.isReady,specsManagerReady:s.isReady,reason:s.isReady?this.sessionManager.isReady?"SpecsDidNotChangeInTime":"SessionManagerIsNotReady":"SpecManagerIsNotReady"})),me(f)}let p=l(c);if(Object.keys(p||{}).length){let f=[];return Object.entries(p).forEach(([m,h])=>{h&&f.push(new xI(h))}),J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",{duration:o.elapsedTime},a),f}else return b.error(`Jupyter Lab Helper cannot enumerate kernelspecs. Returning a default kernel. Specs ${JSON.stringify(p)}.`),u||J("DATASCIENCE.JUPYTER_KERNEL_SPEC_FETCH_FAILURE",void 0,{failed:!0,reason:"NoSpecsEventAfterRefresh"}),[await Hx()]}catch(o){return b.error("Jupyter Lab Helper:getKernelSpecs failure: ",o),[]}}};var vn=class{constructor(e,t,n,i,o){this.jupyterPickerRegistration=e;this.configService=t;this.errorHandler=n;this.requestAgentCreator=i;this.requestCreator=o}async createConnectionInfo(e){let t=await this.getJupyterServerUri(e);if(!t)throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`);let n={baseUrl:t.connectionInformation.baseUrl.toString(!0),displayName:t.label,token:t.connectionInformation.token||"",authorizationHeader:t.connectionInformation.headers||{},fetch:t.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:t.connectionInformation.WebSocket};return RV(e,n,this.requestCreator,this.requestAgentCreator,this.configService,Yx.Uri.file(""))}async validateRemoteUri(e,t,n){let i;if(!t){let s=await this.getJupyterServerUri(e);if(s)t={baseUrl:s.connectionInformation.baseUrl.toString(!0),displayName:s.label,token:s.connectionInformation.token||"",authorizationHeader:s.connectionInformation.headers||{},fetch:s.connectionInformation.fetch,mappedRemoteNotebookDir:void 0,WebSocket:s.connectionInformation.WebSocket};else throw new Error(`Unable to get resolved server information for ${e.extensionId}:${e.id}:${e.handle}`)}let o=RV(e,t,this.requestCreator,this.requestAgentCreator,this.configService,Yx.Uri.file(""));try{i=Xf.create(o.settings),await Promise.all([i.getRunningKernels(),i.getKernelSpecs()])}catch(s){if(Fs.isSelfCertsError(s)){if(!await VR(this.configService,s.message))throw s}else if(eu.isSelfCertsExpiredError(s)){if(!await jR(this.configService,s.message))throw s}else throw t&&!n&&await this.errorHandler.handleError(new fo(t.baseUrl,e,s)),s}finally{o.dispose(),i&&i.dispose()}}async getJupyterServerUri(e){let t=new Yx.CancellationTokenSource;try{let n=this.jupyterPickerRegistration.jupyterCollections.find(l=>l.extensionId===e.extensionId&&l.id===e.id)||await this.jupyterPickerRegistration.activateThirdPartyExtensionAndFindCollection(e.extensionId,e.id);if(!n)return;let i=await Promise.resolve(n.serverProvider.provideJupyterServers(t.token)),o=i==null?void 0:i.find(l=>l.id===e.handle);if(!o&&(i==null?void 0:i.length)===0)try{o=await n.serverProvider.resolveJupyterServer({id:e.handle,label:""},t.token)}catch(l){}if(!o)return;if(o.connectionInformation)return o;let s=await Promise.resolve(n.serverProvider.resolveJupyterServer(o,t.token));if(!(s!=null&&s.connectionInformation))return;let a=Object.assign({},o);return a.connectionInformation=s.connectionInformation,a}catch(n){throw n instanceof ot?n:new Qf(e,n)}finally{t.dispose()}}};vn=E([(0,ru.injectable)(),I(0,(0,ru.inject)(ur)),I(1,(0,ru.inject)(Me)),I(2,(0,ru.inject)(xn)),I(3,(0,ru.inject)(c1)),I(3,(0,ru.optional)()),I(4,(0,ru.inject)(Qg))],vn);var jl=class{constructor(e,t,n){this.serverUriStorage=e;this.jupyterConnection=t;this.serverProviderRegistry=n}async addJupyterServer(e){if(e.extensionId.toLowerCase()!=nc.toLowerCase())throw new Error("Deprecated API");try{await this.jupyterConnection.validateRemoteUri(e)}catch(t){b.error(`Error in validating the Remote Uri ${e.id}.${e.handle}`,t);return}this.serverProviderRegistry.jupyterCollections.some(t=>t.extensionId===e.extensionId)||await this.serverUriStorage.add(e)}};jl=E([(0,AI.injectable)(),I(0,(0,AI.inject)(hr)),I(1,(0,AI.inject)(vn)),I(2,(0,AI.inject)(ur))],jl);d();var Bz=$(te()),nu=require("vscode");d();var Zf=require("vscode");function xi(r,e=!1){return typeof r!="object"||!r?!1:!!(r instanceof Zf.CancellationError||e&&(r.message.includes("Canceled")||r.message.includes(Ue.canceled)))}async function Us(r,e,...t){let n;return pP(e)?(t.push(e),n=void 0):n=e,r?r.isCancellationRequested?n:new Promise((i,o)=>{if(r.isCancellationRequested)return i(n);let s=r.onCancellationRequested(()=>{s.dispose(),i(n)});Promise.race(t).then(i,o).finally(()=>s.dispose())}):await Promise.race(t)}async function ms(r,...e){if(!r)return Promise.race(e);if(r.isCancellationRequested)throw new Zf.CancellationError;return new Promise((t,n)=>{if(r.isCancellationRequested)return n(new Zf.CancellationError);let i=r.onCancellationRequested(()=>{i.dispose(),n(new Zf.CancellationError)});Promise.race(e).then(t,n).finally(()=>i.dispose())})}function jz(...r){let e=new Zf.CancellationTokenSource,t=[];for(let i of r)i&&(i.isCancellationRequested&&e.cancel(),i.onCancellationRequested(()=>e.cancel(),void 0,t));let n=e.dispose.bind(e);return e.dispose=()=>{n(),me(t)},e}var Vd;(e=>{function r(t){if(t!=null&&t.isCancellationRequested)throw new Zf.CancellationError}e.throwIfCanceled=r})(Vd||(Vd={}));function Hz(r){let e=new Map,t=(a,l)=>{if(!e.has(a)){let c={id:a,label:l.displayName,connectionInformation:{baseUrl:nu.Uri.parse(l.baseUrl),token:l.token,fetch:l.fetch,headers:l.authorizationHeader,WebSocket:l.WebSocket}};e.set(a,{serverUri:l,server:c})}return e.get(a).server},n=new nu.EventEmitter,i={async provideJupyterServers(a){let l=r.getHandles?await ms(a,r.getHandles()):[];return!l||l.length===0?[]:ms(a,Promise.all(l.map(c=>r.getServerUri(c).then(u=>t(c,u)))))},resolveJupyterServer(a,l){return a},onDidChangeServers:n.event};if(!r.handleQuickPick||!r.getQuickPickEntryItems)return{serverProvider:i};let o=new Map;return{serverProvider:i,commandProvider:{async handleCommand(a,l){let c=o.get(a.label);if(!c||!r.handleQuickPick)return;let u=await ms(l,r.handleQuickPick(c,!0));if(u==="back")return;if(!u)throw new nu.CancellationError;let p=await r.getServerUri(u);return t(u,p)},async provideCommands(a,l){return r.getQuickPickEntryItems?(await ms(l,Promise.resolve(r.getQuickPickEntryItems()))).map(u=>{let p={label:zv(u.label),canBeAutoSelected:u.default,description:zv(u.description)};return o.set(p.label,u),p}):[]}}}}var JV=class extends lc{constructor(t,n,i,o){super();this.extensionId=t;this.id=n;this.label=i;this.serverProvider=o;this._onDidChangeProvider=new nu.EventEmitter;this.onDidChangeProvider=this._onDidChangeProvider.event}set commandProvider(t){this._commandProvider=t,this._onDidChangeProvider.fire()}get commandProvider(){return this._commandProvider}},MI=class extends Vr{constructor(){super();this._onDidChangeCollections=new nu.EventEmitter;this._collections=new Map;nt.instance.get(ie).push(this)}get onDidChangeCollections(){return this._onDidChangeCollections.event}get jupyterCollections(){return Array.from(this._collections.values())}async activateThirdPartyExtensionAndFindCollection(t,n){return await this.loadExtension(t,n).catch(y),this.jupyterCollections.find(i=>i.extensionId===t&&i.id===n)}async loadExtension(t,n){if(t===Ye)return;let i=nu.extensions.getExtension(t);if(!i)throw new Error(`Extension '${t}' that provides Jupyter Server '${n}' not found`);i.isActive||await i.activate().then(y,y)}createJupyterServerCollection(t,n,i,o){let s=`${t}#${n}`;if(this._collections.has(s)&&t!==Ye)throw new Error(`Jupyter Server Provider with id ${s} already exists`);let a=new JV(t,n,i,o);return this._collections.set(s,a),this._onDidChangeCollections.fire({added:[a],removed:[]}),this._register(a.onDidDispose(()=>{this._collections.delete(s),this._onDidChangeCollections.fire({removed:[a],added:[]})},this)),a}};MI=E([(0,Bz.injectable)()],MI);d();var p1=Symbol("IExportedKernelServiceFactory");function BIe(r,e){return new Promise(t=>{e.onDidChange(n=>{for(let i of n.added)Ot(i.connection)&&i.connection.serverProviderHandle.id===r.id&&i.connection.serverProviderHandle.handle===r.handle&&t()})})}function Jz(r,e){let t=e.get(Ga),n=r.id.startsWith("_builtin")?Ye:t.determineExtensionFromCallStack().extensionId;if(b.error(`The API registerRemoteServerProvider has being deprecated and will be removed soon, please use createJupyterServerCollection (extension ${n}).`),n.toLowerCase()!=nc.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n,pemUsed:"registerRemoteServerProvider"});let{serverProvider:i,commandProvider:o}=Hz(r),s=d1(r.id,r.displayName||r.detail||r.id,i,n,e);return o&&(s.commandProvider=o),{dispose:()=>{s.dispose()}}}function qz(r){return r.then(()=>void 0).catch(e=>(b.error("Failure during activation.",e),Promise.reject(e)))}function Gz(r){let e=r.get(Ga);return J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:e.determineExtensionFromCallStack().extensionId,pemUsed:"registerRemoteServerProvider"}),r.get(p1).getService()}async function Yz(r,e,t){let n=t.get(Ga);b.error("The API addRemoteJupyterServer has being deprecated and will be removed soon, please use createJupyterServerCollection.");let i=n.determineExtensionFromCallStack().extensionId;if(i.toLowerCase()!=nc.toLowerCase())throw new Error("Deprecated API");J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:i,pemUsed:"addRemoteJupyterServer"});let o=t.get(jl),s=t.get(kt),a=BIe({id:r,handle:e},s);await o.addJupyterServer({id:r,handle:e,extensionId:i}),await a}async function $z(r,e,t){var c,u,p,f,m,h;let n=t.get(Ga);J("DATASCIENCE.JUPYTER_API_USAGE",void 0,{clientExtId:n.determineExtensionFromCallStack().extensionId,pemUsed:"openNotebook"});let i=t.get(kt),o=typeof e=="string"?e:void 0,s=typeof e=="string"?void 0:e,a=o&&((c=i.all.find(g=>g.id===e))==null?void 0:c.id);if(!a&&s&&!yp()&&(a=(u=i.all.find(g=>g.kind==="startUsingPythonInterpreter"&&g.interpreter.id===s.id))==null?void 0:u.id,!a)){let v=await t.get(i1).getKernelConnection(s);a=v&&((p=i.all.find(S=>S.id===(v==null?void 0:v.id)))==null?void 0:p.id)}if(!a)throw new Error(`Kernel ${e} not found.`);let l=((h=(m=(f=em.window.activeNotebookEditor)==null?void 0:f.notebook)==null?void 0:m.uri)==null?void 0:h.toString())===r.toString()?em.window.activeNotebookEditor:await em.window.showNotebookDocument(await em.workspace.openNotebookDocument(r));return await em.commands.executeCommand("notebook.selectKernel",{notebookEditor:l,id:a,extension:Ye}),l.notebook}function zz(r,e,t,n){let i=t.get(Ga),o={ready:qz(r),registerPythonApi:s=>Uz(s,t),registerRemoteServerProvider:s=>Jz(s,t),getKernelService:()=>Gz(t),addRemoteJupyterServer:(s,a)=>Yz(s,a,t),openNotebook:async(s,a)=>$z(s,a,t),createJupyterServerCollection:(s,a,l)=>d1(s,a,l,i.determineExtensionFromCallStack().extensionId,t),get kernels(){return Lz(i.determineExtensionFromCallStack().extensionId)}};return(bn()||n.extensionMode===qV.ExtensionMode.Development||n.extensionMode===qV.ExtensionMode.Test)&&(o.serviceContainer=t,o.serviceManager=e),o}d();var Qz=require("vscode"),Xz={codeLoadingTime:0,endActivateTime:0,startActivateTime:0,totalActivateTime:0,workspaceFolderCount:0};function Zz(r,e){if(!bn())try{r.endActivateTime=e.elapsedTime,r.totalActivateTime=e.elapsedTime,Object.assign(Xz,r),tQ(r),J("EXTENSION.LOAD",r)}catch(t){b.error("sendStartupTelemetry() failed.",t)}}function eQ(r,e,t){try{let n={};e.endActivateTime=t.elapsedTime,e.totalActivateTime=t.elapsedTime,Object.assign(Xz,e),tQ(e),J("EXTENSION.LOAD",e,n,r)}catch(n){b.error("sendErrorTelemetry() failed.",n)}}function tQ(r){var t,n;let e=(n=(t=Qz.workspace.workspaceFolders)==null?void 0:t.length)!=null?n:0;r.workspaceFolderCount=e}d();d();var f1=Symbol("IWorkspaceService"),mo=Symbol("IDebugManager"),OI=Symbol("IApplicationEnvironment"),GQe=Symbol("IWebviewPanelMessageListener"),YQe=Symbol("IWebviewViewMessageListener"),$Qe=Symbol("IWebview"),zQe=Symbol("IWebviewView"),QQe=Symbol("IWebviewPanel"),LI=Symbol("IWebviewPanelProvider"),m1=Symbol("IWebviewViewProvider"),$x=Symbol("IEncryptedStorage");d();var rQ=$(te());d();var Di=require("vscode");d();var jd=require("vscode");var Zg=class Zg{constructor(e){this.jupyterConfig=e}async migrateSettings(){let e=[];for(let t of Object.keys(Zg.migratedSettings))e.push(...this.migrateSetting(t,Zg.migratedSettings[t]));e.push(this.migrateIntellisenseSettings());try{await Promise.all(e)}catch(t){KI(t)}}async migrateIntellisenseSettings(){let e="pythonCompletionTriggerCharacters",t="completionTriggerCharacters",n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t);try{if((n==null?void 0:n.globalValue)===(n==null?void 0:n.defaultValue)||!i||i!=null&&i.globalValue&&i.globalValue[qe])return;if(typeof(n==null?void 0:n.globalValue)=="string"){let o=i.globalValue||i.defaultValue||{};o[qe]=n.globalValue.split(""),await this.jupyterConfig.update(t,o,jd.ConfigurationTarget.Global).then(y,KI)}}finally{n!=null&&n.globalValue&&await this.jupyterConfig.update(e,void 0,jd.ConfigurationTarget.Global).then(y,KI)}}migrateSetting(e,t){let n=this.jupyterConfig.inspect(e),i=this.jupyterConfig.inspect(t),o=[];if((n==null?void 0:n.workspaceValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceValue,jd.ConfigurationTarget.Workspace)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,jd.ConfigurationTarget.Workspace),KI))}if((n==null?void 0:n.workspaceFolderValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.workspaceFolderValue)===void 0&&(s=this.jupyterConfig.update(t,n.workspaceFolderValue,jd.ConfigurationTarget.WorkspaceFolder)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,jd.ConfigurationTarget.WorkspaceFolder),KI))}if((n==null?void 0:n.globalValue)!==void 0){let s=Promise.resolve();(i==null?void 0:i.globalValue)===void 0&&(s=this.jupyterConfig.update(t,n.globalValue,jd.ConfigurationTarget.Global)),o.push(s.then(()=>this.jupyterConfig.update(e,void 0,jd.ConfigurationTarget.Global),KI))}return o}};Zg.migratedSettings={interactiveWindowMode:"interactiveWindow.creationMode",interactiveWindowViewColumn:"interactiveWindow.viewColumn",splitRunFileIntoCells:"interactiveWindow.splitRunFileIntoCells",sendSelectionToInteractiveWindow:"interactiveWindow.textEditor.executeSelection",normalizeSelectionForInteractiveWindow:"interactiveWindow.textEditor.normalizeSelection",magicCommandsAsComments:"interactiveWindow.textEditor.magicCommandsAsComments",enableAutoMoveToNextCell:"interactiveWindow.textEditor.autoMoveToNextCell",newCellOnRunLast:"interactiveWindow.textEditor.autoAddNewCell",pythonCellFolding:"interactiveWindow.textEditor.cellFolding",enableCellCodeLens:"interactiveWindow.codeLens.enable",addGotoCodeLenses:"interactiveWindow.codeLens.enableGotoCell",codeLenses:"interactiveWindow.codeLens.commands",debugCodeLenses:"interactiveWindow.codeLes.debugCommands",codeRegularExpression:"interactiveWindow.cellMarker.codeRegex",markdownRegularExpression:"interactiveWindow.cellMarker.markdownRegex",decorateCells:"interactiveWindow.cellMarker.decorateCells",defaultCellMarker:"interactiveWindow.cellMarker.default",enableExtendedKernelCompletions:"enableExtendedPythonKernelCompletions"},Zg.fullSettingIds={...Zg.migratedSettings};var zx=Zg;function KI(r){b.warn("Error migrating Jupyter configuration",r)}d();function HIe(r){return(e,t,n)=>{let i=null,o=null;if(typeof n.value=="function"?(i="value",o=n.value):typeof n.get=="function"&&(i="get",o=n.get),!o)throw new Error("not supported");n[i]=r(o,t)}}function h1(r,e,t){return HIe((n,i)=>{let o=`$debounce$${i}`,s=`$debounce$result$${i}`;return function(...a){this[s]||(this[s]=t?t():void 0),clearTimeout(this[o]),e&&(this[s]=e(this[s],...a),a=[this[s]]),this[o]=setTimeout(()=>{n.apply(this,a),this[s]=t?t():void 0},r)}})}var Ta=class Ta{constructor(e,t,n){this._systemVariablesCtor=t;this._type=n;this.allowUnauthorizedRemoteConnection=!1;this.jupyterInterruptTimeout=1e4;this.jupyterLaunchTimeout=6e4;this.jupyterLaunchRetries=3;this.notebookFileRoot="";this.useDefaultConfigForJupyter=!1;this.sendSelectionToInteractiveWindow=!1;this.normalizeSelectionForInteractiveWindow=!0;this.splitRunFileIntoCells=!0;this.markdownRegularExpression="";this.codeRegularExpression="";this.errorBackgroundColor="";this.variableExplorerExclude="";this.decorateCells="currentCell";this.enableCellCodeLens=!1;this.askForLargeDataFrames=!1;this.enableAutoMoveToNextCell=!1;this.askForKernelRestart=!1;this.codeLenses="";this.debugCodeLenses="";this.debugpyDistPath="";this.stopOnFirstLineWhileDebugging=!1;this.magicCommandsAsComments=!1;this.pythonExportMethod="direct";this.stopOnError=!1;this.addGotoCodeLenses=!1;this.runStartupCommands=[];this.debugJustMyCode=!1;this.defaultCellMarker="";this.themeMatplotlibPlots=!1;this.disableJupyterAutoStart=!1;this.enablePythonKernelLogging=!1;this.jupyterCommandLineArguments=[];this.widgetScriptSources=[];this.interactiveWindowMode="multiple";this.pythonCellFolding=!0;this.interactiveWindowViewColumn="secondGroup";this.disableZMQSupport=!1;this.forceIPyKernelDebugger=!1;this.verboseLogging=!1;this.showVariableViewWhenDebugging=!0;this.newCellOnRunLast=!0;this.logKernelOutputSeparately=!1;this.development=!1;this.poetryPath="";this.excludeUserSitePackages=!1;this.enableExtendedPythonKernelCompletions=!1;this.formatStackTraces=!1;this._changeEmitter=new Di.EventEmitter;this._disposables=[];this._workspaceRoot=e,this.initialize(),Di.workspace.isTrusted===!1&&(this.disableJupyterAutoStart=!0)}get onDidChange(){return this._changeEmitter.event}static getInstance(e,t,n){let i=Ta.getSettingsUriAndTarget(e).uri,o=i?i.path:"",s=Ta.jupyterSettings.get(o);return s?s._type==="web"&&n==="node"&&(s._systemVariablesCtor=t,s._type=n):(s=new Ta(i,t,n),Ta.jupyterSettings.set(o,s)),s}static getSettingsUriAndTarget(e){let t=e?Di.workspace.getWorkspaceFolder(e):void 0,n=t?t.uri:void 0;!n&&Array.isArray(Di.workspace.workspaceFolders)&&Di.workspace.workspaceFolders.length>0&&(n=Di.workspace.workspaceFolders[0].uri);let i=n?Di.ConfigurationTarget.WorkspaceFolder:Di.ConfigurationTarget.Global;return{uri:n,target:i}}static dispose(){if(!bn())throw new Error("Dispose can only be called from unit tests");Ta.jupyterSettings.forEach(e=>e&&e.dispose()),Ta.jupyterSettings.clear()}dispose(){this._disposables.forEach(e=>e&&e.dispose()),this._disposables=[]}createSystemVariables(e){return new this._systemVariablesCtor(e,this._workspaceRoot)}toJSON(){let e={};return this.getSerializableKeys().forEach(n=>e[n]=this[n]),e}update(e,t){let n=this.createSystemVariables(void 0),i=n.resolveAny(e.get("experiments"));this.experiments?Object.assign(this.experiments,i):this.experiments=i,this.experiments=this.experiments?this.experiments:{enabled:!0,optInto:[],optOutFrom:[]};let o=(a,l)=>{let c=zx.fullSettingIds[a],u=c&&l.get(c)!==void 0?l.get(c):l.get(a),p=n.resolveAny(u);p!==void 0&&(this[a]=p)};this.getSerializableKeys().filter(a=>a!=="experiments"&&a!=="logging"&&a!=="kernelPickerType").forEach(a=>o(a,e)),t&&o("poetryPath",t)}onWorkspaceFoldersChanged(){let e=(Di.workspace.workspaceFolders||[]).map(i=>i.uri.path),n=Array.from(Ta.jupyterSettings.keys()).filter(i=>e.indexOf(i)<0);if(n.length>0)for(let i of n)Ta.jupyterSettings.delete(i)}initialize(){let e=()=>{let i=Di.workspace.getConfiguration("jupyter",this._workspaceRoot),o=Di.workspace.getConfiguration("python",this._workspaceRoot);this.update(i,o),this.debounceChangeNotification()};this._disposables.push(Di.workspace.onDidChangeWorkspaceFolders(this.onWorkspaceFoldersChanged,this)),this._disposables.push(Di.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("jupyter")&&e(),i.affectsConfiguration("python.poetryPath")&&e()}));let t=Di.workspace.getConfiguration("jupyter",this._workspaceRoot),n=Di.workspace.getConfiguration("python",this._workspaceRoot);t&&(this.update(t,n),this.migrateSettings(t).catch(y))}async migrateSettings(e){await new zx(e).migrateSettings()}debounceChangeNotification(){this._changeEmitter.fire()}fireChangeNotification(){this._changeEmitter.fire()}getSerializableKeys(){return Object.getOwnPropertyNames(this).filter(e=>!e.startsWith("_"))}};Ta.jupyterSettings=new Map,E([h1(1)],Ta.prototype,"debounceChangeNotification",1);var FI=Ta;d();var iu=require("vscode");d();d();var GV={number:"number",string:"string",undefined:"undefined",object:"object",function:"function"};function YV(r){return Array.isArray?Array.isArray(r):!!(r&&typeof r.length===GV.number&&r.constructor===Array)}function g1(r){return typeof r===GV.string||r instanceof String}function $V(r){return typeof r===GV.object&&r!==null&&!Array.isArray(r)&&!(r instanceof RegExp)&&!(r instanceof Date)}var v1=class{resolve(e){return g1(e)?this.__resolveString(e):YV(e)?this.__resolveArray(e):$V(e)?this.__resolveLiteral(e):e}resolveAny(e){return g1(e)?this.__resolveString(e):YV(e)?this.__resolveAnyArray(e):$V(e)?this.__resolveAnyLiteral(e):e}__resolveString(e){let t=/\$\{(.*?)\}/g;return e.replace(t,(n,i)=>{let o=this[i];return g1(o)?o:n&&(n.indexOf("env.")>0||n.indexOf("env:")>0)?"":n})}__resolveLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolve(i)}),t}__resolveAnyLiteral(e){let t=Object.create(null);return Object.keys(e).forEach(n=>{let i=e[n];t[n]=this.resolveAny(i)}),t}__resolveArray(e){return e.map(t=>this.__resolveString(t))}__resolveAnyArray(e){return e.map(t=>this.resolveAny(t))}};var y1=class extends v1{constructor(t,n){super();let i=t?iu.workspace.getWorkspaceFolder(t):void 0;this._workspaceFolder=i?i.uri.path:n||"",this._filePath=t?t.path:void 0,iu.window.activeTextEditor&&(this._lineNumber=iu.window.activeTextEditor.selection.anchor.line+1,this._selectedText=iu.window.activeTextEditor.document.getText(new iu.Range(iu.window.activeTextEditor.selection.start,iu.window.activeTextEditor.selection.end)))}get cwd(){return this.workspaceFolder}get workspaceRoot(){return this._workspaceFolder}get workspaceFolder(){return this._workspaceFolder}get file(){return this._filePath}get lineNumber(){return this._lineNumber}get selectedText(){return this._selectedText}};d();var ou=require("vscode");var b1=class{async updateSectionSetting(e,t,n,i,o){let a={uri:i,target:o||ou.ConfigurationTarget.WorkspaceFolder};e==="jupyter"&&o!==ou.ConfigurationTarget.Global&&(a=FI.getSettingsUriAndTarget(i));let l=ou.workspace.getConfiguration(e,a.uri),c=l.inspect(t);c!==void 0&&(o===ou.ConfigurationTarget.Global&&c.globalValue===n||o===ou.ConfigurationTarget.Workspace&&c.workspaceValue===n||o===ou.ConfigurationTarget.WorkspaceFolder&&c.workspaceFolderValue===n)||(await l.update(t,n,o),o&&await this.verifySetting(l,o,t,n))}async updateSetting(e,t,n,i){return this.updateSectionSetting("jupyter",e,t,n,i)}async verifySetting(e,t,n,i){if(bn()&&!FE()){let o=0;do{let s=e.inspect(n);if(!s&&i===void 0||s&&i!==void 0&&(t===ou.ConfigurationTarget.Global?s.globalValue:t===ou.ConfigurationTarget.Workspace?s.workspaceValue:s.workspaceFolderValue)===i)break;await new Promise(a=>setTimeout(a,250)),o+=1}while(o<20)}}};var UI=class extends b1{getSettings(e){return FI.getInstance(e,y1,"web")}};UI=E([(0,rQ.injectable)()],UI);d();function nQ(r){r.addSingleton(yy,mI),r.addSingleton(Eo,Kf)}d();d();var om=$(te()),rX=require("vscode"),tD=$(tX());d();var U1=class{setSharedProperty(e,t){Zb(e,t)}postEvent(e,t){let n={};t.forEach((i,o)=>{n[o]=i}),J(e,void 0,n)}};d();var Dj=$(require("vscode")),W1=$(te());var JI=class{constructor(e){this.extensionContext=e}get extensionVersion(){return this.extensionContext.extension.packageJSON.version}};JI=E([(0,W1.injectable)(),I(0,(0,W1.inject)(st))],JI);function Hd(){return Dj.env.appName.indexOf("Insider")>0||Dj.env.appName.indexOf("Code - OSS Dev")>=0?"insiders":"stable"}var T_e="VSCode.ABExp.FeatureData",Pj="vscode",qI=class{constructor(e,t,n){this.configurationService=e;this.appEnvironment=t;this.globalState=n;this._optInto=[];this._optOutFrom=[];this.settings=e.getSettings(void 0);let i=this.settings.experiments.optInto,o=this.settings.experiments.optOutFrom;if(this._optInto=i.filter(l=>!l.endsWith("control")),this._optOutFrom=o.filter(l=>!l.endsWith("control")),!this.enabled)return;let s;Hd()==="insiders"?s=tD.TargetPopulation.Insiders:s=tD.TargetPopulation.Public;let a=new U1;this.experimentationService=(0,tD.getExperimentationService)(Ye,this.appEnvironment.extensionVersion,s,a,this.globalState)}get enabled(){return this.settings.experiments.enabled&&!this.settings.experiments.optOutFrom.includes("All")}async activate(){this.experimentationService&&this.enabled&&(await this.experimentationService.initializePromise,this.getFeatures().length===0&&await this.experimentationService.initialFetch,this.logExperiments())}inExperiment(e){return!this.experimentationService||!this.enabled||this._optOutFrom.includes(e.toString())?!1:this._optInto.includes(e.toString())||this._optInto.includes("All")?(this.experimentationService.getTreatmentVariable(Pj,e),!0):e==="DoNotWaitForZmqPortsToBeUsed"&&(Hd()==="insiders"||jv())||e==="DataViewerContribution"&&(Hd()==="insiders"||jv())?!0:this.experimentationService.getTreatmentVariable(Pj,e)===!0}async getExperimentValue(e){if(!(!this.experimentationService||!this.enabled||this._optOutFrom.includes(e)))return this.experimentationService.getTreatmentVariable(Pj,e)}getFeatures(){return this.globalState.get(T_e,{features:[]}).features}logExperiments(){let e=rX.workspace.getConfiguration("telemetry"),t=!1;if(e&&e.get("enableTelemetry")===!1&&(b.info("Telemetry is disabled"),t=!0),e&&e.get("telemetryLevel")==="off"&&(b.info("Telemetry level is off"),t=!0),t&&b.info("Experiments are disabled, only manually opted experiments are active."),this._optOutFrom.includes("All"))return;if(this._optInto.includes("All")){b.info(Rp.inGroup("All"));return}let n=new Set(this._optInto),i=new Set;this._optOutFrom.filter(o=>o!=="All").forEach(o=>{b.info(Rp.notInGroup(o))}),this._optInto.filter(o=>o!=="All").forEach(o=>{i.add(o),b.info(Rp.inGroup(o))}),t&&!i.has("DoNotWaitForZmqPortsToBeUsed")&&(Hd()==="insiders"||jv())&&b.info(Rp.inGroup("DoNotWaitForZmqPortsToBeUsed")),t||this.getFeatures().forEach(o=>{o.toLowerCase().startsWith("jupyter")&&!this._optOutFrom.includes(o)&&!this._optInto.includes(o)&&(n.add(o),b.info(Rp.inGroup(o)))})}};qI=E([(0,om.injectable)(),I(0,(0,om.inject)(Me)),I(1,(0,om.inject)(OI)),I(2,(0,om.inject)(_t)),I(2,(0,om.named)(sr))],qI);d();var j1=$(te()),Ws=require("vscode");d();var V1=require("vscode");function GI(r){V1.env.openExternal(typeof r=="string"?V1.Uri.parse(r):r).then(y,y)}var k_e=[{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE",message:py.SHOW_DEPRECATED_FEATURE_PROMPT_FORMAT_ON_SAVE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/309",setting:{setting:"formatting.formatOnSave",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE",message:py.SHOW_DEPRECATED_FEATURE_PROMPT_LINT_ON_TEXT_CHANGE,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/313",setting:{setting:"linting.lintOnTextChange",values:["true",!0]}},{doNotDisplayPromptStateKey:"SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES",message:py.SHOW_DEPRECATED_FEATURE_PROMPT_FOR_AUTO_COMPLETE_PRELOAD_MODULES,moreInfoUrl:"https://github.com/Microsoft/vscode-python/issues/1704",setting:{setting:"autoComplete.preloadModules"}}],YI=class{constructor(e){this.persistentStateFactory=e;this._onDidChangeFeatures=new Ws.EventEmitter;this.onDidChangeFeatures=this._onDidChangeFeatures.event;this._features={};this.disposables=[];this._updateFeatures(),this.disposables.push(Ws.workspace.onDidChangeConfiguration(()=>{this._updateFeatures()}))}get features(){return this._features}set features(e){this._features=e,this._onDidChangeFeatures.fire()}_updateFeatures(){this.features={}}dispose(){this.disposables.forEach(e=>e.dispose())}initialize(){k_e.forEach(this.registerDeprecation.bind(this))}registerDeprecation(e){Array.isArray(e.commands)&&e.commands.forEach(t=>{this.disposables.push(Ws.commands.registerCommand(t,()=>this.notifyDeprecation(e),this))}),e.setting&&this.checkAndNotifyDeprecatedSetting(e)}async notifyDeprecation(e){let t=this.persistentStateFactory.createGlobalPersistentState(e.doNotDisplayPromptStateKey,!0);if(!t.value)return;let n="Learn more",i="Never show again",o=await Ws.window.showInformationMessage(e.message,n,i);if(o)switch(o){case n:{GI(e.moreInfoUrl);break}case i:{await t.updateValue(!1);break}default:throw new Error("Selected option not supported.")}}checkAndNotifyDeprecatedSetting(e){let t=!1;Array.isArray(Ws.workspace.workspaceFolders)&&Ws.workspace.workspaceFolders.length>0?Ws.workspace.workspaceFolders.forEach(n=>{t||(t=this.isDeprecatedSettingAndValueUsed(Ws.workspace.getConfiguration("jupyter",n.uri),e.setting))}):t=this.isDeprecatedSettingAndValueUsed(Ws.workspace.getConfiguration("jupyter"),e.setting),t&&this.notifyDeprecation(e).catch(n=>b.debug("Jupyter Extension: notifyDeprecation",n))}isDeprecatedSettingAndValueUsed(e,t){if(!e.has(t.setting))return!1;let n=e.get(t.setting);return!Array.isArray(t.values)||t.values.length===0?Array.isArray(n)?n.length>0:!0:!Array.isArray(t.values)||t.values.length===0?n===void 0?!1:Array.isArray(n)?n.length>0:!0:t.values.indexOf(e.get(t.setting))>=0}};YI=E([(0,j1.injectable)(),I(0,(0,j1.inject)(gT))],YI);d();var sm=$(te());var B1=class{constructor(e,t,n,i){this.storage=e;this.key=t;this.defaultValue=n;this.expiryDurationMs=i}get value(){if(this.expiryDurationMs){let e=this.storage.get(this.key,{data:this.defaultValue});return!e||!e.expiry||e.expiry<Date.now()?this.defaultValue:e.data}else return this.storage.get(this.key,this.defaultValue)}async updateValue(e){this.expiryDurationMs?await this.storage.update(this.key,{data:e,expiry:Date.now()+this.expiryDurationMs}):await this.storage.update(this.key,e)}},$I=class{constructor(e,t){this.globalState=e;this.workspaceState=t}createGlobalPersistentState(e,t,n){return new B1(this.globalState,e,t,n)}createWorkspacePersistentState(e,t,n){return new B1(this.workspaceState,e,t,n)}};$I=E([(0,sm.injectable)(),I(0,(0,sm.inject)(_t)),I(0,(0,sm.named)(sr)),I(1,(0,sm.inject)(_t)),I(1,(0,sm.named)(Cs))],$I);d();d();var nX=$(te());var zI=class{constructor(){this.osType="Unknown"}get tempDir(){}get homeDir(){}get pathVariableName(){return""}get isWindows(){return this.osType==="Windows"}get isMac(){return this.osType==="OSX"}get isLinux(){return this.osType==="Linux"}};zI=E([(0,nX.injectable)()],zI);d();var hs=Symbol("IPlatformService"),xt=Symbol("IFileSystem");function iX(r){r.addSingleton(hs,zI)}d();var oX=$(te()),kj=require("vscode");var QI=class{determineExtensionFromCallStack(e){if(e=e||new Error().stack,e){let t=kj.extensions.getExtension(Ye).extensionUri.toString().toLowerCase(),n=e.split(`
`).map(i=>{let o=/\((.*)\)/.exec(i);if(o)return o[1]}).filter(i=>i&&i.toLowerCase().startsWith("http")).filter(i=>i&&!i.toLowerCase().startsWith(t));XL(new Error("Ex")).forEach(i=>{let o=i.getFileName();o&&!o.toLowerCase().startsWith(t)&&n.push(o)});for(let i of n){let o=kj.extensions.all.find(s=>s.id!==Ye&&i.startsWith(s.extensionUri.toString()));if(o)return{extensionId:o.id,displayName:o.packageJSON.displayName}}b.error("Unable to determine the caller of the extension API for trace stack.",e)}return{extensionId:dP,displayName:C.unknownPackage}}};QI=E([(0,oX.injectable)()],QI);d();var H1=$(te()),Nj=require("vscode");var XI=class{constructor(e){this.extensionContext=e;this.testingState=new Map}async store(e,t,n){if(Ji&&this.extensionContext.extensionMode!==Nj.ExtensionMode.Production){this.testingState.set(`${e}#${t}`,n||"");return}if(n)await this.extensionContext.secrets.store(`${e}.${t}`,n);else try{await this.extensionContext.secrets.delete(`${e}.${t}`)}catch(i){b.error(i)}}async retrieve(e,t){if(Ji&&this.extensionContext.extensionMode!==Nj.ExtensionMode.Production)return this.testingState.get(`${e}#${t}`);try{return await this.extensionContext.secrets.get(`${e}.${t}`)}catch(n){try{await this.extensionContext.secrets.delete(`${e}.${t}`);return}catch(i){b.error(i)}}}};XI=E([(0,H1.injectable)(),I(0,(0,H1.inject)(st))],XI);d();var sX=$(te());var ZI=class{constructor(){this._list=[]}async dispose(){let e=this._list.map(t=>t.dispose());await Promise.all(e),this._list=[]}push(e){e&&this._list.push(e)}get list(){return this._list}};ZI=E([(0,sX.injectable)()],ZI);d();var aX=$(te()),cu=require("vscode");var am=class am extends Error{};am.back=new am("back"),am.cancel=new am("cancel"),am.resume=new am("resume");var $e=am,rD=class{constructor(){this.steps=[]}run(e,t){return this.stepThrough(e,t)}async showQuickPick(e){return this.showLazyLoadQuickPick(e).selection}showLazyLoadQuickPick({title:e,step:t,totalSteps:n,items:i,activeItem:o,placeholder:s,buttons:a,shouldResume:l,matchOnDescription:c,matchOnDetail:u,acceptFilterBoxTextAsSelection:p,startBusy:f,stopBusy:m,validate:h,onDidTriggerItemButton:g,onDidTriggerButton:v,supportBackInFirstStep:S,onDidChangeItems:_,ignoreFocusOut:D}){let P=[],M=ke(),x=cu.window.createQuickPick();return x.title=e,x.step=t,x.totalSteps=n,x.placeholder=s,x.ignoreFocusOut=D!=null?D:!0,x.items=i,m&&(x.busy=f!=null?f:!1,m(()=>{x.enabled&&(x.busy=!1)},this,P)),_&&(x.keepScrollPosition=!0,_(A=>{x.items=A},this,P)),g&&x.onDidTriggerItemButton(A=>g(A),void 0,P),x.matchOnDescription=c||!1,x.matchOnDetail=u||!1,o?x.activeItems=[o]:x.activeItems=[],x.buttons=[...this.steps.length>1||S?[cu.QuickInputButtons.Back]:[],...a||[]],P.push(x.onDidTriggerButton(A=>{A===cu.QuickInputButtons.Back?M.reject($e.back):v?v(A):M.resolve(A)}),x.onDidChangeSelection(async A=>{let j=A.length?A[0].label:"",re=!!j;if(j&&h&&A.length){x.enabled=!1,x.busy=!0;let R=await h(A[0]);R&&(re=!1,await cu.window.showErrorMessage(R,{modal:!0})),x.enabled=!0,x.busy=!1}re&&M.resolve(A[0])}),x.onDidHide(()=>{(async()=>{M.reject(l&&await l()?$e.resume:$e.cancel)})().catch(M.reject)})),p&&P.push(x.onDidAccept(async()=>{if(!x.busy){let A=h?await h(x):void 0;A?(x.enabled=!1,x.busy=!0,await cu.window.showErrorMessage(A),x.enabled=!0,x.busy=!1):M.resolve(x.value)}})),this.current&&this.current.dispose(),this.current=x,this.current.show(),M.promise.finally(()=>me(P)).catch(y),{quickPick:x,selection:M.promise}}async showInputBox({title:e,step:t,totalSteps:n,value:i,prompt:o,validate:s,password:a,buttons:l,shouldResume:c,validationMessage:u}){let p=[];try{return await new Promise((f,m)=>{let h=cu.window.createInputBox();h.title=e,h.step=t,h.totalSteps=n,h.password=!!a,h.value=i||"",h.prompt=o,h.validationMessage=u||"",h.ignoreFocusOut=!0,h.validationMessage=u||"",h.buttons=[...this.steps.length>1?[cu.QuickInputButtons.Back]:[],...l||[]],p.push(h.onDidTriggerButton(g=>{g===cu.QuickInputButtons.Back?m($e.back):f(g)}),h.onDidAccept(async()=>{let g=h.value;h.enabled=!1,h.busy=!0;let v=await s(g);v?(h.validationMessage=v,h.show()):(h.validationMessage="",f(g)),h.enabled=!0,h.busy=!1}),h.onDidChangeValue(async()=>{h.validationMessage=""}),h.onDidHide(()=>{(async()=>{h.busy||m(c&&await c()?$e.resume:$e.cancel)})().catch(m)})),this.current&&this.current.dispose(),this.current=h,this.current.show()})}finally{p.forEach(f=>f.dispose())}}async stepThrough(e,t){let n=e;for(;n;){this.steps.push(n),this.current&&(this.current.enabled=!1,this.current.busy=!0);try{n=await n(this,t)}catch(i){if(i===$e.back)this.steps.pop(),n=this.steps.pop();else if(i===$e.resume)n=this.steps.pop();else if(i===$e.cancel)n=void 0;else throw i;if(!n)return i}}this.current&&this.current.dispose()}},J1=Symbol("IMultiStepInputFactory"),eS=class{create(){return new rD}};eS=E([(0,aX.injectable)()],eS);d();var lX=$(te()),Uo=require("vscode");var Jd=class{get activeDebugConsole(){return Uo.debug.activeDebugConsole}get activeDebugSession(){var e;return b.ci(`Getting active debug session, ${(e=Uo.debug.activeDebugSession)==null?void 0:e.name}`),Uo.debug.activeDebugSession}get breakpoints(){return Uo.debug.breakpoints}get onDidChangeActiveDebugSession(){return Uo.debug.onDidChangeActiveDebugSession}get onDidStartDebugSession(){return Uo.debug.onDidStartDebugSession}get onDidReceiveDebugSessionCustomEvent(){return Uo.debug.onDidReceiveDebugSessionCustomEvent}get onDidTerminateDebugSession(){return Uo.debug.onDidTerminateDebugSession}get onDidChangeBreakpoints(){return Uo.debug.onDidChangeBreakpoints}registerDebugConfigurationProvider(e,t){return Uo.debug.registerDebugConfigurationProvider(e,t)}registerDebugAdapterTrackerFactory(e,t){return Uo.debug.registerDebugAdapterTrackerFactory(e,t)}startDebugging(e,t,n){return Uo.debug.startDebugging(e,t,n)}addBreakpoints(e){Uo.debug.addBreakpoints(e)}removeBreakpoints(e){Uo.debug.removeBreakpoints(e)}};Jd.instance=new Jd,Jd=E([(0,lX.injectable)()],Jd);d();var nD=$(te());var uX=$(q1());var cX="_VSCODE_getDataFrame",G1=uX.default`
                            try:
                                del _VSCODE_getDataFrame
                            except:
                                pass
                            `,uu=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetDataFrameInfo(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${cX}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:G1}:{code:`${t}

${i}

${G1}`}}async generateCodeToGetDataFrameRows(e){let t=await this.getContentsOfDataFrameScript(),n=e.isDebugging?"True":"False",i=`${cX}("rows", ${n}, ${e.variableName}, ${e.startIndex}, ${e.endIndex})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:G1}:{code:`${t}

${i}

${G1}`}}async getContentsOfDataFrameScript(){if(uu.contentsOfDataFrameScript)return uu.contentsOfDataFrameScript;let e=Gi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","dataframes","vscodeDataFrame.py"),t=await this.fs.readFile(e);return uu.contentsOfDataFrameScript=t,t}};uu=E([(0,nD.injectable)(),I(0,(0,nD.inject)(xt)),I(1,(0,nD.inject)(st))],uu);d();var iD=$(te());var Mj=$(q1());var Aj="_VSCODE_getVariable",tS=Mj.default`
                            try:
                                del _VSCODE_getVariable
                            except:
                                pass
                            `,Vs=class{constructor(e,t){this.fs=e;this.context=t}async generateCodeToGetVariableInfo(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Aj}("info", ${n}, ${e.variableName})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:tS}:{code:`${t}

${i}

${tS}`}}async generateCodeToGetVariableProperties(e){let t=await this.getContentsOfScript(),n=e.isDebugging?"True":"False",i=`${Aj}("properties", ${n}, ${e.variableName}, ${e.stringifiedAttributeNameList})`;return e.isDebugging?{initializeCode:t,code:i,cleanupCode:tS}:{code:`${t}

${i}

${tS}`}}async generateCodeToGetAllVariableDescriptions(e){let t=await this.getContentsOfVariablesScript();return e?t=t+`

return _VSCODE_getAllChildrenDescriptions('${e.root}', ${JSON.stringify(e.propertyChain)}, ${e.startIndex})`:t=t+`

variables= %who_ls
return _VSCODE_getVariableDescriptions(variables)`,t}async generateCodeToGetVariableTypes(e){let n=`${await this.getContentsOfScript()}

_VSCODE_rwho_ls = %who_ls
`,i=e.isDebugging?"True":"False",o=Mj.default`
        try:
            del _VSCODE_rwho_ls
        except:
            pass
        `,s=`${Aj}("types", ${i}, _VSCODE_rwho_ls)`;return e.isDebugging?{initializeCode:n,code:s,cleanupCode:`${tS}
${o}`}:{code:`${n}${s}

${tS}
${o}`}}async generateCodeToGetVariableValueSummary(e){let t=await this.getContentsOfVariablesScript();return t=t+`

variables= %who_ls
return _VSCODE_getVariableSummary(${e})`,t}async getContentsOfScript(){if(Vs.contentsOfScript)return Vs.contentsOfScript;let e=Gi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariableInfo.py"),t=await this.fs.readFile(e);return Vs.contentsOfScript=t,t}async getContentsOfVariablesScript(){if(Vs.contentsOfVariablesScript)return Vs.contentsOfVariablesScript;let e=Gi(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","getVariableInfo","vscodeGetVariablesForProvider.py"),t=await this.fs.readFile(e);return Vs.contentsOfVariablesScript=t,t}};Vs=E([(0,iD.injectable)(),I(0,(0,iD.inject)(xt)),I(1,(0,iD.inject)(st))],Vs);d();var Y1=Symbol("IExtensionActivationManager"),We=Symbol("IExtensionSyncActivationService");d();var oD=require("vscode");var du=$(te());var dX=["currentServerHash","connectToLocalKernelsOnly","JUPYTER_LOCAL_KERNELSPECS","JUPYTER_LOCAL_KERNELSPECS_V1","JUPYTER_LOCAL_KERNELSPECS_V2","JUPYTER_LOCAL_KERNELSPECS_V3","JUPYTER_REMOTE_KERNELSPECS","JUPYTER_REMOTE_KERNELSPECS_V1","JUPYTER_REMOTE_KERNELSPECS_V2","JUPYTER_REMOTE_KERNELSPECS_V3","JUPYTER_LOCAL_KERNELSPECS_V4","JUPYTER_REMOTE_KERNELSPECS_V4-","LOCAL_KERNEL_SPECS_CACHE_KEY_V_2022_10","LOCAL_KERNEL_PYTHON_AND_RELATED_SPECS_CACHE_KEY_V_2022_10","user-jupyter-server-uri-list-v2","REGISTRATION_ID_EXTENSION_OWNER_MEMENTO_KEY","jupyter.jupyterServer.uriList"],rS=class{constructor(e,t,n,i){this.globalState=e;this.crypto=t;this.workspaceState=n;this.extensionContext=i}activate(){this.removeOldCachedItems().then(y,y)}async removeOldCachedItems(){await Promise.all([await this.getUriAccountKey()].concat(dX).filter(t=>this.globalState.get(t,void 0)!==void 0).map(t=>this.globalState.update(t,void 0).then(y,y)));let e=this.workspaceState.keys().filter(t=>t.startsWith("LAST_EXECUTED_CELL_")&&!t.startsWith("LAST_EXECUTED_CELL_V2_"));await Promise.all(e.map(t=>this.workspaceState.update(t,void 0))),await Promise.all(dX.map(t=>this.globalState.keys().filter(n=>n.startsWith(t)).map(n=>this.globalState.update(n,void 0).then(y,y))).flat()),await this.extensionContext.secrets.delete(`${hi.JupyterServerRemoteLaunchService}.remote-uri-list`).then(y,y)}async getUriAccountKey(){let e=cI();return e?this.crypto.createHash(lt(e),"SHA-512"):oD.workspace.workspaceFile?this.crypto.createHash(lt(oD.workspace.workspaceFile),"SHA-512"):oD.env.machineId}};rS=E([(0,du.injectable)(),I(0,(0,du.inject)(_t)),I(0,(0,du.named)(sr)),I(1,(0,du.inject)(fy)),I(2,(0,du.inject)(_t)),I(2,(0,du.named)(Cs)),I(3,(0,du.inject)(st))],rS);function pX(r){r.addSingletonInstance(F7,!1),r.addSingleton(wc,qI),r.addSingleton(vT,YI),r.addSingleton(gT,$I),r.addSingleton(Ga,QI),r.addSingleton(fy,cy),r.addSingleton($x,XI),r.addSingleton(mo,Jd),r.addSingleton(Ya,ZI),r.addSingleton(J1,eS),r.addSingleton(gy,uu),r.addSingleton(hy,Vs),r.addSingleton(We,rS),iX(r)}d();d();var $1=$(te()),qd=require("vscode");var Gd=class{constructor(e){this.disposables=[];this._onDidChange=new qd.EventEmitter;e.push(this),Pn()||qd.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("jupyter.kernels.excludePythonEnvironments")&&this._onDidChange.fire()},this,this.disposables)}get onDidChange(){return this._onDidChange.event}dispose(){this._onDidChange.dispose(),me(this.disposables)}isPythonEnvironmentExcluded(e){if(Pn())return!1;let t=this.getExcludedPythonEnvironments(),n=R_e(e,t),i="uri"in e?e.uri:e.executable.uri;return n&&(J("DATASCIENCE.JUPYTER_KERNEL_HIDDEN_VIA_FILTER"),b.debug(`Python Env hidden via filter: ${ye(i)}`)),n}getExcludedPythonEnvironments(){if(!qd.workspace.workspaceFolders||qd.workspace.workspaceFolders.length===0)return qd.workspace.getConfiguration("jupyter",void 0).get("kernels.excludePythonEnvironments",[]);let e=[];return qd.workspace.workspaceFolders.forEach(t=>{e.push(...qd.workspace.getConfiguration("jupyter",t.uri).get("kernels.excludePythonEnvironments",[]))}),e}};Gd=E([(0,$1.injectable)(),I(0,(0,$1.inject)(ie))],Gd);function R_e(r,e){var o;let t="uri"in r?r.envPath:(o=r.environment)==null?void 0:o.folderUri,n="uri"in r?r.uri:r.executable.uri;return!n&&!t?!1:e.some(s=>{let a=ye(s.trim()).toLowerCase().replace(/\\/g,"/");if(s=s.trim().toLowerCase().replace(/\\/g,"/"),s.length===0||a.length===0)return!1;let l=ye(n).toLowerCase().replace(/\\/g,"/"),c=n?n.fsPath.toLowerCase().replace(/\\/g,"/"):"";if(s===l||a===l||s===c||a===c)return!0;let u=ye(t||"").toLowerCase().replace(/\\/g,"/"),p=ye(t||"").toLowerCase().replace(/\\/g,"/");return s===u||a===u||s===p||a===p})}d();var fX=$(te()),ho=require("vscode");var nS=class{activate(){this.migrateFilters().catch(y)}async migrateFilters(){let e=Array.isArray(ho.workspace.workspaceFolders)?ho.workspace.workspaceFolders:[];await this.migrateWorkspaceFilters(ho.workspace.getConfiguration("jupyter",void 0),ho.ConfigurationTarget.Global),e.length===0?await this.migrateWorkspaceFilters(ho.workspace.getConfiguration("jupyter",void 0),ho.ConfigurationTarget.Global):e.length===1?await this.migrateWorkspaceFilters(ho.workspace.getConfiguration("jupyter",e[0].uri),ho.ConfigurationTarget.WorkspaceFolder):(await this.migrateWorkspaceFilters(ho.workspace.getConfiguration("jupyter",void 0),ho.ConfigurationTarget.Workspace),await Promise.all(e.map(t=>this.migrateWorkspaceFilters(ho.workspace.getConfiguration("jupyter",t.uri),ho.ConfigurationTarget.WorkspaceFolder))))}async migrateWorkspaceFilters(e,t){let n=e.inspect("kernels.filter"),i=[];switch(t){case ho.ConfigurationTarget.Global:i=(n==null?void 0:n.globalValue)||[];break;case ho.ConfigurationTarget.Workspace:i=(n==null?void 0:n.workspaceValue)||[];break;default:i=(n==null?void 0:n.workspaceFolderValue)||[]}let o=i.filter(s=>s.type==="pythonEnvironment").map(s=>s.path);i.length&&await e.update("kernels.filter",void 0,t),o.length&&await e.update("kernels.excludePythonEnvironments",Array.from(new Set(o)),t)}};nS=E([(0,fX.injectable)()],nS);d();var z1=$(te());var Oj=require("vscode");var iS=class{constructor(e){this.disposables=e}activate(){this.disposables.push(Oj.commands.registerCommand("jupyter.filterKernels",()=>Oj.commands.executeCommand("workbench.action.openSettings","jupyter.kernels.excludePythonEnvironments").then(y,y),this))}};iS=E([(0,z1.injectable)(),I(0,(0,z1.inject)(ie))],iS);function mX(r){r.addSingleton(We,nS),r.addSingleton(We,iS),r.addSingleton(Gd,Gd)}d();var bX=$(te()),oS=require("vscode");d();var gX=new Set;function vX(r){gX.add(r)}function hX(r){try{gX.forEach(e=>e.report(r))}catch(e){b.error("Failed to report progress",e)}}function yX(r){return function(e,t,n){let i=n.value;n.value=async function(...o){return hX({action:r,phase:"started"}),i.apply(this,o).finally(()=>{hX({action:r,phase:"completed"})})}}}d();d();var M_e={JupyterSessionWaitForIdleSession:C.waitingForJupyterSessionToBeIdle,KernelsGetKernelForRemoteConnection:C.gettingListOfKernelsForRemoteConnection,KernelsGetKernelSpecs:C.gettingListOfKernelSpecs,KernelsRegisterKernel:C.registeringKernel,NotebookConnect:C.connectingToJupyter,NotebookStart:C.startingJupyterNotebook,InstallingMissingDependencies:C.installingMissingDependencies,ExportNotebookToPython:C.exportNotebookToPython,PerformingExport:C.performingExport};function Q1(r){return M_e[r]}var Bl=class{constructor(){this.progressReporters=[];this.actionPhases=new Map;this.currentActions=[];vX(this)}get currentAction(){return this.currentActions.length===0?void 0:this.currentActions[this.currentActions.length-1]}createProgressIndicator(e,t=!1){let n=new oS.CancellationTokenSource,i=ke(),o={location:oS.ProgressLocation.Notification,cancellable:t,title:e};return oS.window.withProgress(o,async(s,a)=>{a.onCancellationRequested(()=>{a.isCancellationRequested&&n.cancel(),i.resolve()}),n.token.onCancellationRequested(()=>{i.resolve()}),this.progressReporters.push(s),await i.promise}).then(y,y),{token:n.token,dispose:()=>i.resolve()}}report(e){if(this.progressReporters.length!==0&&(this.actionPhases.set(e.action,e.phase),e.phase==="started"&&this.currentActions.push(e.action),!!this.currentAction)){for(;this.actionPhases.get(this.currentAction)&&this.actionPhases.get(this.currentAction)!=="started";)this.actionPhases.delete(this.currentAction),this.currentActions.pop();this.updateProgressMessage()}}updateProgressMessage(){if(!this.currentAction||this.progressReporters.length===0)return;let e=Q1(this.currentAction);e&&this.progressReporters.forEach(t=>t.report({message:e}))}};Bl=E([(0,bX.injectable)()],Bl);d();var IX=$(te());var SX=require("vscode");var sS=class extends B0{async computeWorkingDirectory(e){var t;if(e){let n=lt(e);return n.includes(".")?lt(ey(e)):n}return e=(e?(t=SX.workspace.getWorkspaceFolder(e))==null?void 0:t.uri:void 0)||cI(),e?lt(e):"."}};sS=E([(0,IX.injectable)()],sS);d();var ev=$(te());var _X=require("vscode");var aS=class{constructor(e,t){this.jupyterOutput=e;this.disposableRegistry=t}register(){this.disposableRegistry.push(_X.commands.registerCommand(Q.ViewJupyterOutput,this.viewJupyterOutput,this))}viewJupyterOutput(){this.jupyterOutput.show(!0)}};aS=E([(0,ev.injectable)(),I(0,(0,ev.inject)(Hm)),I(0,(0,ev.named)(Hv)),I(1,(0,ev.inject)(ie))],aS);d();var TX=$(te()),lm=$(require("vscode"));d();var lS=$(require("vscode")),Lj;(l=>{let r=lS.FileSystemError.FileNotFound().name,e=lS.FileSystemError.FileExists().name,t=lS.FileSystemError.FileIsADirectory().name,n=lS.FileSystemError.FileNotADirectory().name,i=lS.FileSystemError.NoPermissions().name,o=[r,e,t,n,i];function s(c,u){if(o.includes(c.name))return c.name===u}function a(c){return s(c,r)}l.isFileNotFound=a})(Lj||(Lj={}));function O_e(r,e){let t=r.code;if(t)return t===e}function EX(r){let e=Lj.isFileNotFound(r);return e!==void 0?e:O_e(r,"ENOENT")}d();var DX=$(xX()),PX=require("vscode"),pu=class{constructor(e=DX.fetch){this.fetchImplementation=e;this.requestOptions={};let t=PX.workspace.getConfiguration("http").get("proxy","");t&&(this.requestOptions={headers:{proxy:t}})}async downloadFile(e){return this.fetchImplementation(e,this.requestOptions)}async exists(e){try{return(await this.downloadFile(e)).status===200}catch(t){return b.debug(`HttpClient - Failure checking for file ${e}: ${t}`),!1}}};var uS=class{constructor(){this.vscfs=lm.workspace.fs}arePathsSame(e,t){return ra(e,t)}async getFiles(e){return(await this.vscfs.readDirectory(e)).filter(n=>n[1]===lm.FileType.File).map(n=>lm.Uri.file(n[0]))}async copy(e,t,n){await this.vscfs.copy(e,t,n)}async createDirectory(e){await this.vscfs.createDirectory(e)}async delete(e){await this.vscfs.delete(e)}async readFile(e){let t=await this.vscfs.readFile(e);return new TextDecoder().decode(t)}async stat(e){return this.vscfs.stat(e)}async writeFile(e,t){return this.vscfs.writeFile(e,typeof t=="string"?new TextEncoder().encode(t):t)}async exists(e,t){if(e.scheme.toLowerCase()==="http"||e.scheme.toLowerCase()==="https")return new pu().exists(e.toString());let n;try{n=await this.stat(e)}catch(i){return EX(i)||b.error(`stat() failed for "${e}"`,i),!1}return t===void 0?!0:t===lm.FileType.Unknown?n.type===lm.FileType.Unknown:(n.type&t)===t}async getFileHash(e){let t=await this.stat(e),n=`${t.ctime}-${t.mtime}`;return qa(n,"SHA-512")}};uS=E([(0,TX.injectable)()],uS);d();var Z1=$(te()),fu=require("vscode");var Vt=class{constructor(e){this.kernelResourceProgressReporter=new Map;e.push(this),Vt.instance=this}activate(){}dispose(){me(Array.from(Vt.disposables))}static createProgressReporter(e,t,n){if(!Vt.instance)return new fu.Disposable(y);let i=e?ja(e):"";return Vt.instance.kernelResourceProgressReporter.has(i)?Vt.reportProgress(e,t):Vt.createProgressReporterInternal(i,t,n)}static wrapAndReportProgress(e,t,n){let i=e?ja(e):"";if(!Vt.instance)return n();let o=Vt.reportProgressInternal(i,t);return n().finally(()=>o==null?void 0:o.dispose())}static reportProgress(e,t){let n=Q1(t)||t,i=e?ja(e):"";return n?Vt.reportProgressInternal(i,n||""):new fu.Disposable(()=>y)}static reportProgressInternal(e,t){if(!Vt.instance)return new fu.Disposable(y);let n=Vt.instance.kernelResourceProgressReporter.get(e);if(n||(n={title:t,pendingProgress:[],progressList:[],dispose:y},Vt.instance.kernelResourceProgressReporter.set(e,n)),n.reporter)n.progressList.push(t),n.reporter.report({message:t});else{if(n.progressList.includes(t))return new fu.Disposable(y);n.pendingProgress.push(t)}return{dispose:()=>{try{if(!n)return;let i=n.progressList.findIndex(o=>o===t);if(i>=0&&n.progressList.splice(i),n.progressList.length>0){let o=n.progressList[n.progressList.length-1];n.reporter&&n.reporter.report({message:o===n.title&&n.reporter?"":o})}else Vt.instance.kernelResourceProgressReporter.delete(e),n.dispose()}catch(i){b.error(`Failed to dispose Progress reporter for ${e}`,i)}}}}static createProgressReporterInternal(e,t,n){let i=ke(),o=new fu.Disposable(()=>i.resolve()),s=Vt.instance.kernelResourceProgressReporter.get(e)||{title:t,pendingProgress:[],progressList:[],tokenSources:[],dispose:()=>{o.dispose()}},a=!1,l=()=>{a||(a=!0,fu.window.withProgress({location:fu.ProgressLocation.Notification,title:t},async(c,u)=>{let p=Vt.instance.kernelResourceProgressReporter.get(e);if(p){for(p.reporter=c;p.pendingProgress.length>0;){let f=p.pendingProgress.shift();f===t?p.progressList.push(f):f!==t&&f&&(p.progressList.push(f),c.report({message:f}))}await Us(u,i.promise),Vt.instance.kernelResourceProgressReporter.get(e)===p&&Vt.instance.kernelResourceProgressReporter.delete(e),Vt.disposables.delete(o)}}).then(y,y))};return Vt.instance.kernelResourceProgressReporter.set(e,{...s,dispose:()=>o.dispose(),show:l}),Vt.disposables.add(o),s.pendingProgress.push(t),n||l(),{dispose:()=>o.dispose(),show:l}}};Vt.disposables=new Set,Vt=E([(0,Z1.injectable)(),I(0,(0,Z1.inject)(ie))],Vt);d();var fS=$(te()),eA=require("vscode");d();var kX=require("vscode");var dS=class{constructor(e,t,n,i=[]){this.fs=e;this.disposableRegistry=t;this.options=n;this.loadFailedEmitter=new kX.EventEmitter;let o={enableScripts:!0,localResourceRoots:[this.options.rootPath,this.options.cwd,...i]};n.webviewHost?(this.webviewHost=n.webviewHost,this.webviewHost.webview.options=o):this.webviewHost=this.createWebview(o),this.loadPromise=this.load()}get loadFailed(){return this.loadFailedEmitter.event}asWebviewUri(e){var t;if(!((t=this.webviewHost)!=null&&t.webview))throw new Error("WebView not initialized, too early to get a Uri");return this.webviewHost.webview.asWebviewUri(e)}postMessage(e){var t,n;(t=this.webviewHost)!=null&&t.webview&&((n=this.webviewHost)==null||n.webview.postMessage(e))}async generateLocalReactHtml(){var o;if(!((o=this.webviewHost)!=null&&o.webview))throw new Error("WebView not initialized, too early to get a Uri");let e=this.webviewHost.webview.asWebviewUri(this.options.cwd).toString(),t=this.options.scripts.map(s=>this.webviewHost.webview.asWebviewUri(s)),n=this.webviewHost.webview.asWebviewUri(this.options.rootPath).toString(),i="false";return`<!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
                <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https: http: blob: ${this.webviewHost.webview.cspSource}; default-src 'unsafe-inline' 'unsafe-eval' data: https: http: blob: ${this.webviewHost.webview.cspSource};">
                <meta name="theme-color" content="#000000">
                <meta name="theme" content="${rt.GeneratedThemeName}"/>
                <title>VS Code Python React UI</title>
                <base href="${e}${e.endsWith("/")?"":"/"}"/>
                </head>
            <body>
                <noscript>You need to enable JavaScript to run this app.</noscript>
                <div id="root"></div>
                <script type="text/javascript">
                    // Public path that will be used by webpack.
                    window.__PVSC_Public_Path = "${n}/";
                    function resolvePath(relativePath) {
                        if (relativePath && relativePath[0] == '.' && relativePath[1] != '.') {
                            return "${e}" + relativePath.substring(1);
                        }

                        return "${e}" + relativePath;
                    }
                    function forceTestMiddleware() {
                        return ${i};
                    }
                <\/script>
                ${t.map(s=>`<script type="text/javascript" src="${s}"><\/script>`).join(`
`)}
            </body>
        </html>`}async load(){var e;try{(e=this.webviewHost)!=null&&e.webview&&((await Promise.all(this.options.scripts.map(n=>this.fs.exists(n)))).every(n=>n===!0)?(this.webviewHost.webview.html=await this.generateLocalReactHtml(),this.postLoad(this.webviewHost)):this.webviewHost.webview.html=C.badWebPanelFormatString(this.options.scripts.join(", ")))}catch(t){b.error(`Error Loading WebviewPanel: ${t}`),this.loadFailedEmitter.fire()}}};var Kj=class extends dS{get panel(){return this.webviewHost}get panelOptions(){return this.options}constructor(e,t,n,i=[]){super(e,t,n,i)}async show(e){await this.loadPromise,this.panel&&(e?this.panel.visible||this.panel.reveal(this.panel.viewColumn,e):this.panel.active||this.panel.reveal(this.panel.viewColumn,e))}close(){this.panel&&this.panel.dispose()}get viewColumn(){var e;return(e=this.panel)==null?void 0:e.viewColumn}isVisible(){return this.panel?this.panel.visible:!1}isActive(){return this.panel?this.panel.active:!1}setTitle(e){this.panelOptions.title=e,this.panel&&(this.panel.title=e)}createWebview(e){return eA.window.createWebviewPanel(this.panelOptions.title.toLowerCase().replace(" ",""),this.panelOptions.title,{viewColumn:this.panelOptions.viewColumn,preserveFocus:!0},{retainContextWhenHidden:!0,enableFindWidget:!0,...e})}postLoad(e){this.disposableRegistry.push(e.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(e.webview.onDidReceiveMessage(t=>{this.panelOptions.listener.onMessage(t.type,t.payload)})),this.disposableRegistry.push(e.onDidChangeViewState(t=>{this.panelOptions.listener.onChangeViewState(this)})),this.panelOptions.listener.onChangeViewState(this)}},pS=class{constructor(e,t,n){this.disposableRegistry=e;this.fs=t;this.context=n}async create(e){let t=[eA.Uri.file(BE(this.context.extensionPath,"temp"))];return Array.isArray(e.additionalPaths)&&t.push(...e.additionalPaths),new Kj(this.fs,this.disposableRegistry,e,t)}};pS=E([(0,fS.injectable)(),I(0,(0,fS.inject)(ie)),I(1,(0,fS.inject)(xt)),I(2,(0,fS.inject)(st))],pS);d();var sD=$(te()),NX=require("vscode");var Fj=class extends dS{constructor(t,n,i,o=[]){super(t,n,i,o);this.panelOptions=i;this._onDidChangeVisibility=new NX.EventEmitter}get visible(){return this.webviewHost?this.webviewHost.visible:!1}get onDidChangeVisibility(){return this._onDidChangeVisibility.event}createWebview(t){throw new Error("Webview Views must be passed in an initial view")}postLoad(t){this.disposableRegistry.push(t.onDidDispose(()=>{this.webviewHost=void 0,this.panelOptions.listener.dispose()})),this.disposableRegistry.push(t.webview.onDidReceiveMessage(n=>{this.panelOptions.listener.onMessage(n.type,n.payload)})),this.disposableRegistry.push(t.onDidChangeVisibility(()=>{this._onDidChangeVisibility.fire()})),this._onDidChangeVisibility.fire()}},mS=class{constructor(e,t){this.disposableRegistry=e;this.fs=t}async create(e){return new Fj(this.fs,this.disposableRegistry,e)}};mS=E([(0,sD.injectable)(),I(0,(0,sD.inject)(ie)),I(1,(0,sD.inject)(xt))],mS);d();var hS=$(te());d();var sit=Symbol("IReservedPythonNamedProvider"),ait=Symbol("IInterpreterPackages"),RX=Symbol("IWorkspaceInterpreterTracker");var Hl=class{constructor(e){this.workspaceInterpreterTracker=e;Hl.isActiveWorkspaceInterpreter=this.isActiveWorkspaceInterpreterImpl.bind(this)}activate(){var e;(e=this.workspaceInterpreterTracker)==null||e.activate()}isActiveWorkspaceInterpreterImpl(e,t){var n,i;return(i=(n=this.workspaceInterpreterTracker)==null?void 0:n.isActiveWorkspaceInterpreter(e,t))!=null?i:!1}};Hl.isActiveWorkspaceInterpreter=()=>!1,Hl=E([(0,hS.injectable)(),I(0,(0,hS.inject)(RX)),I(0,(0,hS.optional)())],Hl);function AX(r){r.addSingleton(xt,uS),r.addSingleton(f1,sS),r.addSingleton(OI,JI),r.addSingleton(Me,UI),r.addSingleton(my,aS),r.addSingleton(Bl,Bl),pX(r),nQ(r),mX(r),r.addSingleton(We,Vt),r.addSingleton(We,Hl),r.add(m1,mS),r.add(LI,pS)}d();d();var Ait=Symbol("IKernelLauncher"),$d=Symbol("IRawNotebookSupportedService"),MX=Symbol("IRawKernelSessionFactory");d();var aD=$(te()),Uj=require("vscode");d();var tA=require("vscode");var Lr;(n=>{let r=Uu(new tA.EventEmitter);n.onDidChangeNotebookCellExecutionState=r.event;function t(i,o,s){if(o!==1||!s){r.fire({cell:i,state:o});return}let a=Uu(tA.workspace.onDidChangeNotebookDocument(l=>{var u,p;if(l.notebook!==i.notebook)return;let c=l.cellChanges.find(f=>f.cell===i);((p=(u=c==null?void 0:c.cell)==null?void 0:u.executionSummary)==null?void 0:p.executionOrder)===s&&(a.dispose(),r.fire({cell:i,state:1}))}))}n.changeCellState=t})(Lr||(Lr={}));var tv=class{constructor(e,t){this.disposableRegistry=e;this.kernelProvider=t;this.lastExecutedCellPerKernel=new WeakMap;this.kernelsStartedSuccessfully=new WeakSet}activate(){this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this,this.disposableRegistry),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry)}onDidStartKernel(e){this.kernelsStartedSuccessfully.add(e),Lr.onDidChangeNotebookCellExecutionState(t=>{t.cell.notebook===e.notebook&&this.kernelProvider.get(t.cell.notebook)===e&&this.lastExecutedCellPerKernel.set(e,t.cell)})}async onKernelStatusChanged({kernel:e}){this.kernelsStartedSuccessfully.has(e)&&(e.disposed||e.disposing||!e.session||(e.session.kind==="localRaw"&&e.status==="dead"&&(Uj.window.showErrorMessage(C.kernelDiedWithoutError(ut(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e)),e.session.kind!=="localRaw"&&e.status==="autorestarting"&&(Uj.window.showErrorMessage(C.kernelDiedWithoutErrorAndAutoRestarting(ut(e.kernelConnectionMetadata))).then(y,y),await this.endCellAndDisplayErrorsInCell(e))))}async endCellAndDisplayErrorsInCell(e){let t=this.lastExecutedCellPerKernel.get(e);if(Yr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),!!t)return Yf(t,e.controller,C.kernelCrashedDueToCodeInCurrentOrPreviousCell,!1)}};E([In()],tv.prototype,"onKernelStatusChanged",1),tv=E([(0,aD.injectable)(),I(0,(0,aD.inject)(ie)),I(1,(0,aD.inject)(He))],tv);d();d();var UX=$(te());d();var Na=$(te());d();var cm=class extends ot{constructor(e){super("jupyterinstall",e)}};var Kr=require("vscode");d();var rA=class extends wi{constructor(e){super("timeout",C.rawKernelStartFailedDueToTimeout(ut(e)),e)}};d();var gS=class extends tu{constructor(t,n,i,o){super(t,i,o);this.stdErr=n}};d();var nA=class extends wi{constructor(e){super("timeout",C.rawKernelStartFailedDueToTimeoutWaitingForPort(ut(e)),e)}};d();var vS=class extends wi{constructor(t=-1,n,i){super("kerneldied",C.kernelDied(n.trim()),i);this.exitCode=t;this.stdErr=n}};d();d();var Iot=Symbol("IModuleInstaller"),Sot=Symbol("IPythonInstallation"),_ot=Symbol("IInstallationChannelManager"),Eot=Symbol("IProductService"),Cot=Symbol("IProductPathService");var wot=Symbol("IInstaller");function Wj(r){switch(r){case 18:return"jupyter";case 20:return"notebook";case 23:return"pandas";case 19:return"ipykernel";case 22:return"nbconvert";case 21:return"kernelspec";case 27:return"pip";case 28:return"ensurepip";default:throw new Error(`Product ${r} cannot be installed as a Python Module.`)}}d();var Pi=new Map;Pi.set(18,"jupyter");Pi.set(20,"notebook");Pi.set(19,"ipykernel");Pi.set(22,"nbconvert");Pi.set(21,"kernelspec");Pi.set(23,"pandas");Pi.set(27,"pip");Pi.set(28,"ensurepip");d();var lD=class extends wi{constructor(t,n){super("noipykernel",C.kernelInvalid(ut(n)),n);this.reason=t}};d();var um=class extends tu{constructor(e){super(C.kernelDiedWithoutError(ut(e)),void 0,e)}};d();var OX=require("vscode"),Ir=class{constructor(e){this._event=new OX.EventEmitter;this._disableUI=e}get disableUI(){return this._disableUI}set disableUI(e){let t=this._disableUI!==e;this._disableUI=e,t&&this._event.fire()}get onDidChangeDisableUI(){return this._event.event}dispose(){this._event.dispose()}};d();var oA=class extends ot{constructor(e){super("jupyterexpiredcert",e)}};d();var dm=class extends ot{constructor(t){super("invalidremotejupyterserverurihandle","Server handle not in list of known handles");this.serverProviderHandle=t}};d();var pm=Symbol("IInterpreterService");d();var sA=class extends ot{constructor(t,n,i){super("windowsLongPathNotEnabled",i);this.product=t;this.interpreter=n;this.originalMessage=i}};d();var cD=class extends ot{constructor(t,n,i){super("jupyternotebooknotinstalled",t+(n?`
${n}`:""));this.interpreter=i}};d();var LX=new Map;function aA(r,e){LX.set(qt(r),e)}function yS(r,e,t){let n=e.jupyterCollections.find(i=>i.extensionId===r.extensionId&&i.id===r.id);return LX.get(qt(r))||(n==null?void 0:n.label)||t||`${r.id}:${r.handle}`}var IS=class{constructor(e,t,n,i,o,s,a){this.dependencyManager=e;this.configuration=t;this.kernelDependency=n;this.serverUriStorage=i;this.jupyterUriProviderRegistration=o;this.fs=s;this.interpreterService=a;this.handledErrors=new WeakSet;this.handledKernelErrors=new WeakSet}async handleError(e){var t;if(b.warn("DataScience Error",e),e=ti.unwrap(e),!this.handledErrors.has(e)){if(this.handledErrors.add(e),e instanceof cm)await((t=this.dependencyManager)==null?void 0:t.installMissingDependencies(e));else if(e instanceof Fs)await VR(this.configuration,e.message);else if(e instanceof oA)await jR(this.configuration,e.message);else if(!xi(e))if(e instanceof rA||e instanceof nA)Kr.window.showErrorMessage(e.message).then(y,y);else if(e instanceof gS||e instanceof vS||e instanceof cD||e instanceof Op)Kr.window.showErrorMessage(bS(e)).then(y,y);else if(e instanceof fo&&Pn())Kr.window.showErrorMessage(C.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl)).then(y,y);else if(e instanceof fo){let n=await this.handleJupyterServerConnectionError(e,void 0);Kr.window.showErrorMessage(n).then(y,y)}else if(e instanceof Qf){let n=await this.handleJupyterServerUriProviderError(e,void 0);Kr.window.showErrorMessage(n).then(y,y)}else{let n=FX(e.message||e.toString());Kr.window.showErrorMessage(n).then(y,y)}}}async getErrorMessageForDisplayInCell(e,t,n){var i;if(e=ti.unwrap(e),xi(e)||b.error("Error in execution (get message for cell)",e),e instanceof um)return"";if(e instanceof lD)return Vj(e.kernelConnectionMetadata)||e.message;if(e instanceof cm)return F_e(e)||e.message;if(e instanceof fo&&!Pn())return e.message;if(e instanceof fo&&Pn())return C.jupyterNotebookRemoteConnectFailedWeb(e.baseUrl);if(xi(e))return"";if(e instanceof sA){let o=typeof e.product=="string"?e.product:Pi.get(e.product)||`${e.product}`,s=ju(e.interpreter)||e.interpreter.id||"",a=Zi(e.interpreter),l=ye(a==null?void 0:a.executable.uri),c=s?` ${s} (${l})`:l;return C.packageNotInstalledWindowsLongPathNotEnabledError(o,c)}else{if((e instanceof gS||e instanceof vS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&!await this.fs.exists(e.kernelConnectionMetadata.interpreter.uri))return C.failedToStartKernelDueToMissingPythonEnv(ju(e.kernelConnectionMetadata.interpreter)||Es(e.kernelConnectionMetadata.interpreter)||ye(e.kernelConnectionMetadata.interpreter.uri));if((e instanceof gS||e instanceof vS)&&(e.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||e.kernelConnectionMetadata.kind==="startUsingPythonInterpreter")&&e.kernelConnectionMetadata.interpreter&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(e.kernelConnectionMetadata,void 0,!0))return Vj(e.kernelConnectionMetadata)||e.message;if(e instanceof wi||e instanceof tu){let[o,s]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(n),BL(e.kernelConnectionMetadata.interpreter)]),a=Jm(Kr.workspace.workspaceFolders||[],e,ut(e.kernelConnectionMetadata),s,o.map(l=>l.uri));if(a){if(a.reason==="moduleNotFound"&&["ipykernel_launcher","ipykernel"].includes(a.moduleName))return Vj(e.kernelConnectionMetadata)||e.message;let l=[a.message];return a.moreInfoLink&&l.push(Ue.clickHereForMoreInfoWithHtml(a.moreInfoLink)),tr(e.kernelConnectionMetadata)&&a.reason==="moduleNotFound"&&!["ipykernel_launcher","ipykernel"].includes(a.moduleName)&&await this.addErrorMessageIfPythonArePossiblyOverridingPythonModules(l,n),l.join(`
`)}}else{if(e instanceof fo)return this.handleJupyterServerConnectionError(e,t);if(e instanceof Qf)return this.handleJupyterServerUriProviderError(e,t);if(e instanceof dm){let o=((i=Kr.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:i.packageJSON.displayName)||e.serverProviderHandle.extensionId;return bS(C.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(o),t)}}}return bS(e,t)}async handleJupyterServerUriProviderError(e,t){var o;let n=await yS(e.serverProviderHandle,this.jupyterUriProviderRegistration),i=((o=e.originalError)==null?void 0:o.message)||e.message;return bS(C.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerConnectionError(e,t){let n=await yS(e.serverProviderHandle,this.jupyterUriProviderRegistration,e.baseUrl),i=e.originalError.message||"";return bS(C.remoteJupyterConnectionFailedWithServerWithError(n,i),t)}async handleJupyterServerProviderConnectionError(e,t){let n=new Kr.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i&&(i.find(o=>o.id===e.handle)||await this.serverUriStorage.remove(e).catch(y)),!0}catch(i){return!1}finally{n.dispose()}}async handleKernelError(e,t,n,i,o){var s,a;if(xi(e)||b.warn(`Kernel Error, context = ${t}`,e),e=ti.unwrap(e),xi(e))return this.sendKernelTelemetry(e,t,i,"cancelled"),1;if(e instanceof lD)if(b.warn(`Jupyter Kernel Dependency Error, reason=${e.reason}`,e),this.sendKernelTelemetry(e,t,i,e.category),e.reason===4&&this.kernelDependency){let l=new Kr.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new Ir(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else return e.reason;else{if((t==="start"||t==="restart")&&e instanceof cm)return this.sendKernelTelemetry(e,t,i,e.category),(this.dependencyManager?await this.dependencyManager.installMissingDependencies(e):2)===0?0:1;if(e instanceof fo||e instanceof Qf||e instanceof dm){this.sendKernelTelemetry(e,t,i,e.category);let l=e instanceof dm?"":e instanceof fo?e.originalError.message||"":((s=e.originalError)==null?void 0:s.message)||e.message,c=e.serverProviderHandle.extensionId,u=e.serverProviderHandle.id,p=this.jupyterUriProviderRegistration.jupyterCollections.find(S=>S.extensionId===c&&S.id==u);if(!p||await this.handleJupyterServerProviderConnectionError(e.serverProviderHandle,p))return 3;let f=e instanceof fo?e.baseUrl:"",m=yS(e.serverProviderHandle,this.jupyterUriProviderRegistration,f),h=e instanceof dm?((a=Kr.extensions.getExtension(e.serverProviderHandle.extensionId))==null?void 0:a.packageJSON.displayName)||e.serverProviderHandle.extensionId:"",g=o==="jupyterExtension"?[C.selectDifferentKernel]:[];switch(await Kr.window.showErrorMessage(e instanceof dm?C.remoteJupyterServerProvidedBy3rdPartyExtensionNoLongerValid(h):C.remoteJupyterConnectionFailedWithServer(m),{detail:l,modal:!0},C.removeRemoteJupyterConnectionButtonText,C.changeRemoteJupyterConnectionButtonText,...g)){case C.removeRemoteJupyterConnectionButtonText:return await this.serverUriStorage.remove(e.serverProviderHandle).catch(y),1;case C.changeRemoteJupyterConnectionButtonText:return 1;case C.selectDifferentKernel:return 3}return 1}else if(e instanceof Fs){this.sendKernelTelemetry(e,t,i,e.category);let l=C.jupyterSelfCertEnable,c=C.jupyterSelfCertClose;return Kr.window.showErrorMessage(C.jupyterSelfCertFail(e.message),l,c).then(u=>{u===l?(J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),this.configuration.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Kr.ConfigurationTarget.Workspace).catch(y)):u===c&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}).then(y,y),2}else{if((t==="start"||t==="restart")&&n.kind==="startUsingPythonInterpreter"&&this.interpreterService&&!await this.fs.exists(n.interpreter.uri))return this.sendKernelTelemetry(e,t,i,"pythonEnvironmentMissing"),Kr.window.showErrorMessage(C.failedToStartKernelDueToMissingPythonEnv(ju(n.interpreter)||Es(n.interpreter)||ye(n.interpreter.uri))).then(y,y),this.interpreterService.refreshInterpreters(!0).catch(y),2;if((t==="start"||t==="restart")&&this.kernelDependency&&!await this.kernelDependency.areDependenciesInstalled(n,void 0,!0)){this.sendKernelTelemetry(e,t,i,"noipykernel");let l=new Kr.CancellationTokenSource;try{let c=o==="3rdPartyExtension";return this.kernelDependency.installMissingDependencies({resource:i,kernelConnection:n,ui:new Ir(!1),token:l.token,ignoreCache:!0,cannotChangeKernels:c})}finally{l.dispose()}}else{let[l,c]=await Promise.all([this.getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(i),BL(n.interpreter)]),u=Jm(Kr.workspace.workspaceFolders||[],e,ut(n),c,l.map(p=>p.uri));return this.sendKernelTelemetry(e,t,i,u==null?void 0:u.reason),u?this.showMessageWithMoreInfo(u.message,u==null?void 0:u.moreInfoLink).catch(y):this.showMessageWithMoreInfo(bS(e,t)).catch(y),2}}}}sendKernelTelemetry(e,t,n,i){this.handledKernelErrors.has(e)||(this.handledKernelErrors.add(e),t==="start"&&Yr(n,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:!1,failureCategory:i},e))}async showMessageWithMoreInfo(e,t){e.includes(Q.ViewJupyterOutput)||(e=`${e} 
${C.viewJupyterLogForFurtherInfo}`);let n=t?[Ue.learnMore]:[];await Kr.window.showErrorMessage(e,...n).then(i=>{i===Ue.learnMore&&t&&Kr.env.openExternal(Kr.Uri.parse(t))})}};IS=E([I(0,(0,Na.inject)(Kz)),I(0,(0,Na.optional)()),I(1,(0,Na.inject)(Me)),I(2,(0,Na.inject)(CI)),I(2,(0,Na.optional)()),I(3,(0,Na.inject)(hr)),I(4,(0,Na.inject)(ur)),I(5,(0,Na.inject)(xt)),I(6,(0,Na.inject)(pm)),I(6,(0,Na.optional)())],IS);var L_e={restart:C.failedToRestartKernel,start:C.failedToStartKernel,interrupt:C.failedToInterruptKernel,execution:""};function bS(r,e){r=typeof r=="string"?r:ti.unwrap(r);let t=e?L_e[e]:"",n="";return r instanceof cD?n=C.jupyterNotebookNotInstalledOrNotFound(r.interpreter):r instanceof ot?n=t8(r.stdErr)||r.stdErr||r.message:n=typeof r=="string"?r:r.message,FX(t,n)}function K_e(r){var t,n;return((n=(t=new RegExp(/\[([^\[]+)\]\((.*)\)/).exec(r))==null?void 0:t.length)!=null?n:0)>0}function FX(r="",e=""){r&&e.startsWith(r.substring(0,r.length-1))&&(r="");let t=[r,e].map(n=>n.trim()).filter(n=>n.length>0).join(` 
`);return!K_e(t)&&t.length&&t.indexOf("command:jupyter.viewOutput")===-1?`${t.endsWith(".")?t:t+"."} 
${C.viewJupyterLogForFurtherInfo}`:t}function Vj(r){var a,l,c,u;if(r.kind==="connectToLiveRemoteKernel"||r.kind==="startUsingRemoteKernelSpec"||!r.interpreter)return;let e=ju(r.interpreter)||lt(r.interpreter.uri),t=Pi.get(19),n=Wj(19),i=`${XO(lt(r.interpreter.uri))} -m pip install ${n} -U --force-reinstall`;if(r.interpreter&&Zr(r.interpreter)==="Conda"){let p=Zi(r.interpreter);(a=p==null?void 0:p.environment)!=null&&a.name?i=`conda install -n ${(l=p==null?void 0:p.environment)==null?void 0:l.name} ${n} --update-deps --force-reinstall`:(c=p==null?void 0:p.environment)!=null&&c.folderUri&&(i=`conda install -p ${lt((u=p==null?void 0:p.environment)==null?void 0:u.folderUri)} ${n} --update-deps --force-reinstall`)}else r.interpreter&&Zr(r.interpreter)==="Unknown"&&(i=`${XO(lt(r.interpreter.uri))} -m pip install ${n} -U --user --force-reinstall`);let o=C.libraryRequiredToLaunchJupyterKernelNotInstalledInterpreter(e,Pi.get(19)),s=C.installPackageInstructions(t,i);return o+`
`+s}function F_e(r){let e=`${Pi.get(18)} ${Ue.and} ${Pi.get(20)}`,t=[18,20].map(Wj).join(" "),n=`python -m pip install ${t} -U
or
conda install ${t} -U`,i=C.installPackageInstructions(e,n);return r.message+`
`+i+`
`+Ue.clickHereForMoreInfoWithHtml("https://aka.ms/installJupyterForVSCode")}var SS=class extends IS{async addErrorMessageIfPythonArePossiblyOverridingPythonModules(e,t){}async getFilesInWorkingDirectoryThatCouldPotentiallyOverridePythonModules(e){return[]}};SS=E([(0,UX.injectable)()],SS);d();var WX=$(te());var rv=class{async ensureKernelIsUsable(e,t,n,i,o){b.debug("Check if a kernel is usable")}};E([I(1,GL("id")),I(2,GL("disableUI")),I(3,L7())],rv.prototype,"ensureKernelIsUsable",1),rv=E([(0,WX.injectable)()],rv);d();var uD=$(te());var VX=require("vscode");var _S=class{constructor(e,t){this.liveKernelConnectionTracker=e;this.providerRegistration=t}async isValid(e){if(!this.liveKernelConnectionTracker.wasKernelUsed(e))return!1;let t=await this.providerRegistration.jupyterCollections.find(i=>i.extensionId===e.serverProviderHandle.extensionId&&i.id===e.serverProviderHandle.id);if(!t)return b.warn(`Extension ${e.serverProviderHandle.extensionId} may have been uninstalled for provider ${e.serverProviderHandle.id}, handle ${e.serverProviderHandle.handle}`),!1;let n=new VX.CancellationTokenSource;try{let i=await Promise.resolve(t.serverProvider.provideJupyterServers(n.token));return i?i.map(o=>o.id).includes(e.serverProviderHandle.handle)?!0:(b.warn(`Hiding remote kernel ${e.id} for ${t.id} as the remote Jupyter Server ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}:${e.serverProviderHandle.handle} is no longer available`),!1):!1}catch(i){return b.warn(`Failed to fetch remote servers from ${e.serverProviderHandle.extensionId}:${e.serverProviderHandle.id}`,i),!1}finally{n.dispose()}}};_S=E([(0,uD.injectable)(),I(0,(0,uD.inject)(Xg)),I(1,(0,uD.inject)(ur))],_S);d();var jX=$(te());var ES=class{async getOrStartServer(e){throw new Error("Invalid Operation in Web")}};ES=E([(0,jX.injectable)()],ES);d();var mu=require("vscode"),nv=$(te());var CS=class extends Vr{constructor(t,n){super();this._onDidLoad=this._register(new mu.EventEmitter);this._onDidChangeUri=this._register(new mu.EventEmitter);this._onDidRemoveUris=this._register(new mu.EventEmitter);this._onDidAddUri=this._register(new mu.EventEmitter);this._all=[];n.push(this),this.newStorage=this._register(new jj(t))}get onDidLoad(){return this._onDidLoad.event}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}get all(){return this.updateStore(),this._all}hookupStorageEvents(){this.storageEventsHooked||(this.storageEventsHooked=!0,this._register(this.newStorage.onDidAdd(t=>this._onDidAddUri.fire(t),this)),this._register(this.newStorage.onDidChange(t=>this._onDidChangeUri.fire(t),this)),this._register(this.newStorage.onDidRemove(t=>this._onDidRemoveUris.fire(t),this)))}updateStore(){this.hookupStorageEvents();let t=this._all;return this._all=this.newStorage.getAll(),(t.length!==this._all.length||JSON.stringify(this._all)!==JSON.stringify(t))&&this._onDidLoad.fire(),this._all}async clear(){this.hookupStorageEvents(),await this.newStorage.clear(),this._all=[],this._onDidLoad.fire()}async add(t,n){var o;this.hookupStorageEvents(),b.ci(`setUri: ${t.id}.${t.handle}`);let i={time:(o=n==null?void 0:n.time)!=null?o:Date.now(),displayName:"",provider:t};await this.newStorage.add(i),this.updateStore()}async update(t){this.hookupStorageEvents(),await this.newStorage.update(t),this.updateStore()}async remove(t){this.hookupStorageEvents(),await this.newStorage.remove(t),this.updateStore()}};CS=E([(0,nv.injectable)(),I(0,(0,nv.inject)(_t)),I(0,(0,nv.named)(sr)),I(1,(0,nv.inject)(ie))],CS);var jj=class{constructor(e){this.memento=e;this._onDidChangeUri=new mu.EventEmitter;this._onDidRemoveUris=new mu.EventEmitter;this._onDidAddUri=new mu.EventEmitter;this.updatePromise=Promise.resolve();this.mementoKey=`MEMENTO_KEY_FOR_STORING_USED_JUPYTER_PROVIDERS_${mu.env.machineId}`}get onDidChange(){return this._onDidChangeUri.event}get onDidRemove(){return this._onDidRemoveUris.event}get onDidAdd(){return this._onDidAddUri.event}dispose(){this._onDidAddUri.dispose(),this._onDidChangeUri.dispose(),this._onDidRemoveUris.dispose()}async add(e){return this.updatePromise=this.updatePromise.then(async()=>{let t=this.getAll(),n=t.find(a=>qt(a.provider)===qt(e.provider)),o=[{displayName:e.displayName||(n==null?void 0:n.displayName)||qt(e.provider),serverHandle:e.provider,time:e.time}].concat(t.sort((a,l)=>l.time-a.time).filter(a=>qt(a.provider)!==qt(e.provider)).map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}))),s=o.splice(hi.JupyterServerUriListMax);if(await this.memento.update(this.mementoKey,o),n||this._onDidAddUri.fire(e),s.length){let a=s.map(l=>({provider:l.serverHandle,time:l.time,displayName:l.displayName||""}));this._onDidRemoveUris.fire(a.map(l=>l.provider))}this._onDidChangeUri.fire()}).catch(y)}async update(e){let n=this.getAll().find(o=>o.provider.id===e.id&&o.provider.handle===e.handle),i={provider:e,time:Date.now(),displayName:(n==null?void 0:n.displayName)||""};await this.add(i)}async remove(e){await(this.updatePromise=this.updatePromise.then(async()=>{let t=!1;try{let n=this.getAll();if(n.length===0)return;let i=n.filter(s=>s.provider.id!==e.id||s.provider.handle!==e.handle),o=n.filter(s=>s.provider.id===e.id&&s.provider.handle===e.handle);if(i.length===0)await this.clear();else if(o.length){let s=i.map(a=>({displayName:a.displayName,serverHandle:a.provider,time:a.time}));t=!0,await this.memento.update(this.mementoKey,s),this._onDidRemoveUris.fire(o.map(a=>a.provider))}}finally{t||this._onDidRemoveUris.fire([e])}}).catch(t=>b.error(`Failed to remove Server handle ${JSON.stringify(e)}`,t)))}getAll(){let e=this.memento.get(this.mementoKey,[]),t=[];return e.forEach(async n=>{let i=qt(n.serverHandle),o={time:n.time,displayName:n.displayName||i,provider:n.serverHandle};t.push(o)}),t}async clear(){let e=this.getAll();await this.memento.update(this.mementoKey,[]),e.length&&this._onDidRemoveUris.fire(e.map(t=>t.provider))}};d();var fm=$(te());var lA="removeKernelUrisAndSessionsUsedByResources",wS=class{constructor(e,t,n){this.disposables=e;this.uriStorage=t;this.memento=n;this.usedRemoteKernelServerIdsAndSessions={}}activate(){this.usedRemoteKernelServerIdsAndSessions=this.memento.get(lA,{}),this.uriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}wasKernelUsed(e){let t=qt(e.serverProviderHandle);return t in this.usedRemoteKernelServerIdsAndSessions&&typeof e.kernelModel.id=="string"&&e.kernelModel.id in this.usedRemoteKernelServerIdsAndSessions[t]}trackKernelIdAsUsed(e,t,n){let i=qt(t);this.usedRemoteKernelServerIdsAndSessions[i]=this.usedRemoteKernelServerIdsAndSessions[i]||{},this.usedRemoteKernelServerIdsAndSessions[i][n]=this.usedRemoteKernelServerIdsAndSessions[i][n]||[];let o=this.usedRemoteKernelServerIdsAndSessions[i][n];o.includes(e.toString())||(o.push(e.toString()),this.memento.update(lA,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}trackKernelIdAsNotUsed(e,t,n){let i=qt(t);if(!(i in this.usedRemoteKernelServerIdsAndSessions)||!(n in this.usedRemoteKernelServerIdsAndSessions[i]))return;let o=this.usedRemoteKernelServerIdsAndSessions[i][n];!Array.isArray(o)||!o.includes(e.toString())||(o.splice(o.indexOf(e.toString()),1),o.length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i][n],Object.keys(this.usedRemoteKernelServerIdsAndSessions[i]).length===0&&delete this.usedRemoteKernelServerIdsAndSessions[i],this.memento.update(lA,this.usedRemoteKernelServerIdsAndSessions).then(y,y))}onDidRemoveServers(e){e.forEach(t=>{let n=qt(t);delete this.usedRemoteKernelServerIdsAndSessions[n],this.memento.update(lA,this.usedRemoteKernelServerIdsAndSessions).then(y,y)})}};wS=E([(0,fm.injectable)(),I(0,(0,fm.inject)(ie)),I(1,(0,fm.inject)(hr)),I(2,(0,fm.inject)(_t)),I(2,(0,fm.named)(sr))],wS);d();var qX=$(te()),GX=$(HX());d();var JX=require("vscode");function Bj(r){return class extends r{constructor(...n){super(...n);this._onAnyMessage=new JX.EventEmitter;this.onAnyMessage=this._onAnyMessage.event;this.msgChain=Promise.resolve(),this.sendChain=Promise.resolve(),this.receiveHooks=[],this.sendHooks=[]}patchSuperEmit(n){super.emit=n}send(n,i){this.sendHooks?this.sendChain=this.sendChain.then(()=>Promise.all(this.sendHooks.map(o=>o(n,i)))).then(()=>super.send(n,i)):super.send(n,i)}handleEvent(n,i,...o){return i==="message"&&this.receiveHooks.length?(this.msgChain=this.msgChain.then(()=>Promise.all(this.receiveHooks.map(s=>s(o[0])))).then(()=>n(i,...o)).catch(s=>b.error(`Exception while handling messages: ${s}`)),!0):n(i,...o)}emit(n,...i){return this.handleEvent((o,...s)=>super.emit(o,...s),n,...i)}addReceiveHook(n){this.receiveHooks.push(n)}removeReceiveHook(n){this.receiveHooks=this.receiveHooks.filter(i=>i!==n)}addSendHook(n){this.sendHooks.push(n)}removeSendHook(n){this.sendHooks=this.sendHooks.filter(i=>i!==n)}}}d();var js=new Map;var DS=class{getRequestCtor(e,t,n){class i extends Request{constructor(s,a){super(s,a);let l=this.headers;if(n){let c=n();Object.keys(c).forEach(f=>l.append(f,c[f].toString())),l.set("Content-Type","application/json");let p=l.append.bind(l);l.append=(f,m)=>{f.toLowerCase()!=="authorization"&&p(f,m)}}e&&this.headers.append("Cookie",e)}}return i}wrapWebSocketCtor(e){class t extends Bj(e){constructor(o,s){super(o,s);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let a,l=/.*\/kernels\/(.*)\/.*/.exec(o);l&&l.length>1&&(this.kernelId=l[1]),this.kernelId?(js.set(this.kernelId,this),this.onclose=()=>{a&&this.timer!==a&&clearInterval(a),js.get(this.kernelId)===this&&js.delete(this.kernelId)}):b.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener&&this.addEventListener("open",this.boundOpenHandler)}openHandler(){let o=this.onmessage;this.onmessage=s=>{this.handleEvent((a,...l)=>{let c={data:l[0],type:a.toString(),target:this};return o(c),!0},"message",s.data)},this.removeEventListener("open",this.boundOpenHandler)}}return t}getWebsocketCtor(e,t,n){class i extends Bj(GX.default){constructor(a,l){super(a,l);this.timer=0;this.boundOpenHandler=this.openHandler.bind(this);let c,u=/.*\/kernels\/(.*)\/.*/.exec(a);u&&u.length>1&&(this.kernelId=u[1]),this.kernelId?(js.set(this.kernelId,this),this.onclose=()=>{c&&this.timer!==c&&clearInterval(c),js.get(this.kernelId)===this&&js.delete(this.kernelId)}):b.error("KernelId not extracted from Kernel WebSocket URL"),this.addEventListener("open",this.boundOpenHandler)}openHandler(){let a=this.onmessage;this.onmessage=l=>{this.handleEvent((c,...u)=>{let p={data:u[0],type:c.toString(),target:this};return a(p),!0},"message",l.data)},this.removeEventListener("open",this.boundOpenHandler)}}return i}getFetchMethod(){return fetch}getHeadersCtor(){return Headers}getRequestInit(){return{cache:"no-store"}}};DS=E([(0,qX.injectable)()],DS);d();var Hs=$(te());d();var Bs=require("vscode");d();var U_e=["/bin/sh","/bin/bash","/bin/zsh"];function YX(r,e){let t=(r.argv||[]).some(n=>(n=n.toLowerCase(),U_e.some(i=>n.includes(i))));J("DATASCIENCE.KERNEL_SPEC_LANGUAGE",void 0,{language:r.language,kind:e,usesShell:t})}d();d();var PS="remoteKernelSpecCache.json";var W_e=2e3,uA=class extends lc{constructor(t,n,i,o,s,a,l,c,u,p){super();this.id=t;this.displayName=n;this.env=i;this.cachedRemoteKernelValidator=o;this.kernelProvider=a;this.serverProviderHandle=l;this.jupyterConnection=c;this.fs=u;this.context=p;this._status="idle";this._onDidChangeStatus=new Bs.EventEmitter;this.onDidChangeStatus=this._onDidChangeStatus.event;this.promiseMonitor=new tI;this.kernelIdsToHide=new Set;this.kind="remote";this.cache=[];this._onDidChangeKernels=new Bs.EventEmitter;this.onDidChangeKernels=this._onDidChangeKernels.event;this._onDidChange=new Bs.EventEmitter;this.onDidChange=this._onDidChange.event;this.cacheFile=Bs.Uri.joinPath(p.globalStorageUri,PS),this.cacheKey=qt(l),this._register(s.registerKernelFinder(this)),this._register(this._onDidChangeKernels.event(()=>this._onDidChange.fire(),this)),this._register(this._onDidChangeKernels),this._register(this._onDidChange),this._register(this._onDidChangeStatus),this._register(this.promiseMonitor)}get status(){return this._status}set status(t){this._status!==t&&(this._status=t,this._onDidChangeStatus.fire())}get lastError(){return this._lastError}get kernels(){return this.cache}get items(){return this.kernels}get title(){return this.displayName}dispose(){var t,n;super.dispose(),(t=this._cacheUpdateCancelTokenSource)==null||t.dispose(),(n=this.kernelDisposeDelayTimer)==null||n.dispose()}async activate(){this.promiseMonitor.onStateChange(()=>{this.status=this.promiseMonitor.isComplete?"idle":"discovering"}),this.loadCache().then(y,y),this._register(this.kernelProvider.onDidStartKernel(t=>{Ot(t.kernelConnectionMetadata)&&this.updateCache().then(y,y)},this)),this._register(this.kernelProvider.onDidDisposeKernel(t=>{var n;if(t&&Ot(t.kernelConnectionMetadata)){(n=this.kernelDisposeDelayTimer)==null||n.dispose();let i=setTimeout(()=>{this.updateCache().then(y,y)},W_e);return this.kernelDisposeDelayTimer=new Bs.Disposable(()=>clearTimeout(i)),i}},this))}async refresh(){await this.loadCache(!0,!0)}getListOfKernelsWithCachedConnection(t,n=!1){return(!this.cachedConnection||n)&&(this.cachedConnection=this.getRemoteConnectionInfo(t)),this.cachedConnection.then(i=>i?(this.cachedConnection=Promise.resolve(i),this.listKernelsFromConnection(i)):Promise.resolve([])).catch(i=>this.isDisposed?Promise.reject(i):n?(this.cachedConnection=void 0,Promise.reject(i)):this.getListOfKernelsWithCachedConnection(t,!0))}async loadCache(t=!1,n=!1){b.ci(`Remote Kernel Finder load cache Server: ${this.id}`);let i=(async()=>{let o=t?[]:await this.getFromCache(),s=[];if(!t&&Array.isArray(o)&&o.length>0)s=o,this.updateCache().then(y,y),this.loadCache(!0).then(y,y);else try{s=await this.getListOfKernelsWithCachedConnection(n),this._lastError=void 0}catch(a){a instanceof Bs.CancellationError||(b.error("UniversalRemoteKernelFinder: Failed to get kernels without cache",a),this._lastError=a,this._onDidChange.fire())}await this.writeToCache(s)})();this.promiseMonitor.push(i),await i}async updateCache(){let t=(async()=>{var o;let n=[];(o=this._cacheUpdateCancelTokenSource)==null||o.dispose();let i=new Bs.CancellationTokenSource;this._cacheUpdateCancelTokenSource=i;try{n=await this.getListOfKernelsWithCachedConnection(!1)}catch(s){b.warn(`Could not fetch kernels from the ${this.kind} server, falling back to cache: ${s}`),n=await this.getFromCache(i.token),n=n.filter(a=>a.kind==="connectToLiveRemoteKernel")}i.token.isCancellationRequested||await this.writeToCache(n)})();this.promiseMonitor.push(t),await t}async getRemoteConnectionInfo(t=!0){let n=[];return t&&n.push(Vt.createProgressReporter(void 0,C.connectingToJupyter)),this.jupyterConnection.createConnectionInfo(this.serverProviderHandle).finally(()=>me(n))}async getFromCache(t){try{if(t!=null&&t.isCancellationRequested)throw new Bs.CancellationError;let n=this.cache;(!n||n.length===0)&&(n=await this.getCacheContents());let i=[],o=Promise.all(n.map(async s=>{await this.isValidCachedKernel(s)&&i.push(s)}));return await Us(t,o),i}catch(n){b.error("UniversalRemoteKernelFinder: Failed to get from cache",n)}return[]}async getCacheContents(){try{let t=await this.fs.readFile(this.cacheFile),n=JSON.parse(t);if(n.extensionVersion!==this.env.extensionVersion)return[];let i=n.data[this.cacheKey]||[];return Array.isArray(i)?i.map(o=>Xc.fromJSON(o)):[]}catch(t){return[]}}async listKernelsFromConnection(t){let n=[];try{let i=Xf.create(t.settings);n.push({dispose:()=>Kg(i)});let[o,s,a,l]=await Promise.all([i.getRunningKernels(),i.getKernelSpecs(),i.getRunningSessions(),ez(t.serverProviderHandle)]),c=s.map(f=>(YX(f,"remote"),Ux.create({kernelSpec:f,id:QR(f,void 0,l),baseUrl:t.baseUrl,serverProviderHandle:t.serverProviderHandle})));return[...a.map(f=>{var D,P;let m=f.kernel,h=m.last_activity?new Date(Date.parse(m.last_activity.toString())):new Date,g=m.connections?parseInt(m.connections.toString(),10):0,v=o.find(M=>{var x;return M.id===((x=f.kernel)==null?void 0:x.id)})||{},S=s.find(M=>{var x;return M.name===((x=f.kernel)==null?void 0:x.name)})||{};return Fx.create({kernelModel:{...f.kernel,...S,...v,name:((D=f.kernel)==null?void 0:D.name)||"",lastActivityTime:h,numberOfConnections:g,model:f},baseUrl:t.baseUrl,id:((P=f.kernel)==null?void 0:P.id)||"",serverProviderHandle:t.serverProviderHandle})}).filter(f=>!this.kernelIdsToHide.has(f.kernelModel.id||"")),...c]}catch(i){throw b.error(`Error fetching kernels from ${t.baseUrl} (${t.displayName}):`,i),i}finally{await Promise.all(n.map(i=>i.dispose().catch(y)))}}async writeToCache(t){try{b.trace(`UniversalRemoteKernelFinder: Writing ${t.length} remote kernel connection metadata to cache`);let n=this.cache,i=new Map(n.map(f=>[f.id,f])),o=new Map(t.map(f=>[f.id,f])),s=t.filter(f=>!i.has(f.id)),a=t.filter(f=>i.has(f.id)&&!fB(f,i.get(f.id))),l=n.filter(f=>!o.has(f.id)),c=this.cacheKey;this.cache=n.filter(f=>o.has(f.id)).concat(s),this.cache.forEach(f=>{let m=o.get(f.id);f!==m&&m.kind==="connectToLiveRemoteKernel"&&f.kind==="connectToLiveRemoteKernel"&&f.updateModel(m.kernelModel)});let u=t.map(f=>f.toJSON()),p={extensionVersion:this.env.extensionVersion,data:{}};try{let f=await this.fs.readFile(this.cacheFile),m=JSON.parse(f);m.extensionVersion===this.env.extensionVersion&&(p=m)}catch(f){}p.data[c]=u,await this.fs.createDirectory(this.context.globalStorageUri).then(()=>this.fs.writeFile(this.cacheFile,JSON.stringify(p))).catch(f=>{b.error("Failed to cache the remote kernels.",f)}),(s.length||a.length||l.length)&&this._onDidChangeKernels.fire({removed:l})}catch(n){b.error("UniversalRemoteKernelFinder: Failed to write to cache",n)}}async isValidCachedKernel(t){switch(t.kind){case"startUsingRemoteKernelSpec":return!1;case"connectToLiveRemoteKernel":return this.cachedRemoteKernelValidator.isValid(t)}}};var dA=require("vscode");var zd=class{constructor(e,t,n,i,o,s,a,l,c,u){this.serverUriStorage=e;this.env=t;this.cachedRemoteKernelValidator=n;this.kernelFinder=i;this.kernelProvider=o;this.jupyterConnection=s;this.disposables=a;this.fs=l;this.context=c;this.jupyterServerProviderRegistry=u;this.serverFinderMapping=new Map;this.handledProviders=new WeakSet;this.mappedProviders=new WeakSet;this.mappedServers=new Set}activate(){this.serverUriStorage.onDidAdd(e=>this.validateAndCreateFinder(e),this,this.disposables),this.serverUriStorage.onDidChange(this.buildListOfFinders,this,this.disposables),this.serverUriStorage.onDidLoad(this.handleProviderChanges,this,this.disposables),this.serverUriStorage.onDidLoad(this.buildListOfFinders,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderHandleChanges,this,this.disposables),this.serverUriStorage.onDidRemove(this.urisRemoved,this,this.disposables),this.jupyterServerProviderRegistry.onDidChangeCollections(this.handleProviderChanges,this,this.disposables),this.buildListOfFinders(),this.handleProviderChanges().catch(y)}buildListOfFinders(){this.serverUriStorage.all.map(e=>this.validateAndCreateFinder(e).catch(y))}handleProviderHandleChanges(){this.jupyterServerProviderRegistry.jupyterCollections.forEach(e=>{this.handledProviders.has(e)||(this.handledProviders.add(e),e.serverProvider.onDidChangeServers&&e.serverProvider.onDidChangeServers(this.buildListOfFinders,this,this.disposables))}),this.buildListOfFinders()}async handleProviderChanges(){if(!this.serverUriStorage.all.length)return;let e=new dA.CancellationTokenSource;this.disposables.push(e),await Promise.all(this.jupyterServerProviderRegistry.jupyterCollections.map(t=>{let n=t.serverProvider;if(!(!n||this.mappedProviders.has(n)))return this.mappedProviders.add(n),n!=null&&n.onDidChangeServers&&(n==null||n.onDidChangeServers(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables)),this.serverUriStorage.onDidLoad(()=>this.lookForServersInCollectionAndRemoveOldServers(t),this,this.disposables),this.lookForServersInCollectionAndRemoveOldServers(t).catch(y)})),e.dispose()}async lookForServersInCollectionAndRemoveOldServers(e){if(!this.serverUriStorage.all.length)return;let t=new Set(this.serverUriStorage.all.map(o=>qt(o.provider))),n=e.serverProvider;if(!n)return;let i=new dA.CancellationTokenSource;try{let o=await Promise.resolve(n.provideJupyterServers(i.token)),s=new Set;(o||[]).forEach(a=>{let l={extensionId:e.extensionId,handle:a.id,id:e.id},c=qt(l);s.add(c),aA(l,a.label),!(this.mappedServers.has(c)||!t.has(c))&&(this.mappedServers.add(c),this.createRemoteKernelFinder(l,a.label))}),this.serverFinderMapping.forEach((a,l)=>{a.serverProviderHandle.extensionId===e.extensionId&&a.serverProviderHandle.id===e.id&&!s.has(qt(a.serverProviderHandle))&&(a.dispose(),this.serverFinderMapping.delete(l))})}catch(o){b.error(`Failed to get servers for Collection ${e.id} in ${e.extensionId}`,o)}finally{i.dispose()}}async validateAndCreateFinder(e){let t=qt(e.provider);if(this.serverFinderMapping.has(t))return;let n=new dA.CancellationTokenSource,i=async()=>{var c;let s=this.jupyterServerProviderRegistry.jupyterCollections.find(u=>u.extensionId===e.provider.extensionId&&u.id===e.provider.id);if(!s||!s.serverProvider)return;let a=await Promise.resolve(s.serverProvider.provideJupyterServers(n.token)),l=(c=a==null?void 0:a.find(u=>u.id===e.provider.handle))==null?void 0:c.label;l&&this.createRemoteKernelFinder(e.provider,l)},o=async()=>{var a;let s=await((a=this.jupyterServerProviderRegistry.jupyterCollections.find(l=>l.extensionId===e.provider.extensionId&&l.extensionId===nc&&l.id===e.provider.id))==null?void 0:a.label);s&&this.createRemoteKernelFinder(e.provider,s)};await Promise.all([i().catch(y),o().catch(y)]),n.dispose()}getOrCreateRemoteKernelFinder(e,t){let n=qt(e);if(!this.serverFinderMapping.has(n)){let i=new uA(`remote-${n}`,t,this.env,this.cachedRemoteKernelValidator,this.kernelFinder,this.kernelProvider,e,this.jupyterConnection,this.fs,this.context);this.disposables.push(i),this.serverFinderMapping.set(n,i),i.activate().then(y,y)}return this.serverFinderMapping.get(n)}createRemoteKernelFinder(e,t){this.getOrCreateRemoteKernelFinder(e,t)}urisRemoved(e){e.forEach(t=>{let n=qt(t),i=this.serverFinderMapping.get(n);i&&i.dispose(),this.serverFinderMapping.delete(n)})}dispose(){this.serverFinderMapping.forEach(e=>e.dispose())}};E([In("Handle Jupyter Provider Changes")],zd.prototype,"handleProviderChanges",1),E([In("Check Servers in Jupyter Server Provider")],zd.prototype,"lookForServersInCollectionAndRemoveOldServers",1),E([In("Failed to create a Remote Kernel Finder")],zd.prototype,"validateAndCreateFinder",1),zd=E([(0,Hs.injectable)(),I(0,(0,Hs.inject)(hr)),I(1,(0,Hs.inject)(OI)),I(2,(0,Hs.inject)(u1)),I(3,(0,Hs.inject)(ui)),I(4,(0,Hs.inject)(He)),I(5,(0,Hs.inject)(vn)),I(6,(0,Hs.inject)(ie)),I(7,(0,Hs.inject)(xt)),I(8,(0,Hs.inject)(st)),I(9,(0,Hs.inject)(ur))],zd);d();var mm=$(te());d();var yA=require("vscode");var bA=$(iv());var gu=$(te());d();var pA=class extends ot{constructor(t){super("localjupyterserverconnection",C.jupyterNotebookFailure(t.message||t.toString()));this.originalError=t}};d();function tZ(r){if(bn()){let e=r;if(e&&e._futures){let t=e._futures;t.forEach&&t.forEach(n=>{n._status!==void 0&&(n._status|=4)})}e&&e._reconnectLimit&&(e._reconnectLimit=0)}}var TS=class extends ti{constructor(e){super(e.message,e)}};d();var fD=require("vscode");d();var ov=class extends wi{constructor(e){super("invalidkernel",C.kernelInvalid(ut(e)),e)}};d();var fA=class extends wi{constructor(e){super("timeout",C.jupyterLaunchTimedOut,e)}};async function mA(r,e,t,n,i){var a;if(!t.kernel)throw new ov(r);let o=Vt.reportProgress(e,C.waitingForJupyterSessionToBeIdle),s=[];o&&s.push(o);try{b.trace(`Waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`);let l=ke();i.onCancellationRequested(()=>l.reject(new fD.CancellationError),void 0,s);let c=(m,h)=>{b.trace(`Got status ${h} in waitForIdleOnSession`),h=="idle"&&l.resolve(h)};(a=t.kernel.statusChanged)==null||a.connect(c),s.push(new fD.Disposable(()=>ea(()=>{var m,h;return(h=(m=t.kernel)==null?void 0:m.statusChanged)==null?void 0:h.disconnect(c)}))),t.kernel.status=="idle"&&l.resolve(t.kernel.status);let u=ke(),p=()=>u.resolve("");t.disposed.connect(p,u),s.push(new fD.Disposable(()=>ea(()=>t.disposed.disconnect(p,u)))),u.promise.catch(y),l.promise.catch(y);let f=await bo(n,"",l.promise,u.promise);if(t.isDisposed)throw b.error("Session disposed while waiting for session to be idle."),new ov(r);if(b.trace(`Finished waiting for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),f=="idle")return;throw b.error(`Shutting down after failing to wait for idle on (kernel): ${t.kernel.id} -> ${t.kernel.status}`),new fA(r)}catch(l){throw b.ci("Error waiting for idle",l),l}finally{me(s)}}d();var vA=require("vscode");d();var hu=$(Ki()),Gj=require("vscode");var hA=class extends lc{constructor(t,n){super();this.kind=t;this.session=n;this.propertyChanged=new hu.Signal(this);this.kernelChanged=new hu.Signal(this);this.statusChanged=new hu.Signal(this);this.connectionStatusChanged=new hu.Signal(this);this.iopubMessage=new hu.Signal(this);this.unhandledMessage=new hu.Signal(this);this.anyMessage=new hu.Signal(this);this.disposed=new hu.Signal(this);this.didShutdown=this._register(new Gj.EventEmitter);this._onDidKernelSocketChange=this._register(new Gj.EventEmitter);n.propertyChanged.connect(this.onPropertyChanged,this),n.kernelChanged.connect(this.onKernelChanged,this),n.statusChanged.connect(this.onStatusChanged,this),n.connectionStatusChanged.connect(this.onConnectionStatusChanged,this),n.iopubMessage.connect(this.onIOPubMessage,this),n.unhandledMessage.connect(this.onUnhandledMessage,this),n.anyMessage.connect(this.onAnyMessage,this),this._register({dispose:()=>{this.session.propertyChanged.disconnect(this.onPropertyChanged,this),this.session.kernelChanged.disconnect(this.onKernelChanged,this),this.session.statusChanged.disconnect(this.onStatusChanged,this),this.session.connectionStatusChanged.disconnect(this.onConnectionStatusChanged,this),this.session.iopubMessage.disconnect(this.onIOPubMessage,this),this.session.unhandledMessage.disconnect(this.onUnhandledMessage,this),this.session.anyMessage.disconnect(this.onAnyMessage,this)}})}get id(){return this.session.id}get path(){return this.session.path}get name(){return this.session.name}get type(){return this.session.type}get serverSettings(){return this.session.serverSettings}get model(){return this.session.model}get kernel(){return this.isDisposed||!this.session.kernel?null:this.session.kernel}get onDidShutdown(){return this.didShutdown.event}get kernelId(){var t,n;return((n=(t=this.session)==null?void 0:t.kernel)==null?void 0:n.id)||""}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}dispose(){this.isDisposed||(super.dispose(),this.statusChanged.emit("dead"),this.disposed.emit(),hu.Signal.disconnectAll(this))}async restart(){var t,n,i;await((t=this.session.kernel)==null?void 0:t.restart()),this.initializeKernelSocket(),b.info(`Restarted ${(i=(n=this.session)==null?void 0:n.kernel)==null?void 0:i.id}`)}initializeKernelSocket(){var n,i,o,s,a,l;if(!this.session.kernel)throw new Error("Kernel not initialized in Session");let t={kernel:this.session.kernel,options:{clientId:this.session.kernel.clientId,id:this.session.kernel.id,model:{...this.session.kernel.model},userName:this.session.kernel.username},socket:js.get(this.session.kernel.id)};JSON.stringify((n=this.previousKernelSocketInformation)==null?void 0:n.kernel.model)===JSON.stringify(t.kernel.model)&&((i=this.previousKernelSocketInformation)==null?void 0:i.kernel)===t.kernel&&((o=this.previousKernelSocketInformation)==null?void 0:o.kernel.id)===t.kernel.id&&((s=this.previousKernelSocketInformation)==null?void 0:s.socket)===t.socket||(this.previousKernelSocketInformation=t,(a=this.session.kernel)==null||a.connectionStatusChanged.disconnect(this.onKernelConnectionStatusHandler,this),(l=this.session.kernel)==null||l.connectionStatusChanged.connect(this.onKernelConnectionStatusHandler,this),this._onDidKernelSocketChange.fire())}onPropertyChanged(t,n){this.propertyChanged.emit(n)}onKernelChanged(t,n){this.kernelChanged.emit(n)}onStatusChanged(t,n){this.statusChanged.emit(n);let i=this.status;b.ci(`Server Status = ${i}`)}onConnectionStatusChanged(t,n){this.connectionStatusChanged.emit(n)}onIOPubMessage(t,n){this.iopubMessage.emit(n)}onUnhandledMessage(t,n){b.warn(`Unhandled message found: ${n.header.msg_type}`),this.unhandledMessage.emit(n)}onAnyMessage(t,n){this.anyMessage.emit(n)}setPath(t){return this.session.setPath(t)}setName(t){return this.session.setName(t)}setType(t){return this.session.setType(t)}changeKernel(t){return this.session.changeKernel(t)}onKernelConnectionStatusHandler(t,n){b.ci(`Server Kernel Status = ${n}`)}};var gA=class extends hA{constructor(t,n,i,o,s){super(tr(i)?"localJupyter":"remoteJupyter",t);this.resource=n;this.kernelConnectionMetadata=i;this.kernelService=o;this.creator=s;this.isShuttingDown=!1;this.initializeKernelSocket()}get status(){var t,n;return this.isDisposed?"dead":(t=this.session)!=null&&t.kernel?this.session.kernel.status:(b.ci(`Kernel status not started because real session is ${this.session?"defined":"undefined"} & real kernel is ${(n=this.session)!=null&&n.kernel?"defined":"undefined"}`),"unknown")}dispose(){var t,n;(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!1).finally(()=>super.dispose())}async waitForIdle(t,n){try{await mA(this.kernelConnectionMetadata,this.resource,this.session,t,n)}catch(i){throw b.ci("Error waiting for idle",i),await this.shutdown().catch(y),i}}async restart(){let t=[],n=new vA.CancellationTokenSource;this.restartToken=n;let i=new Ir(!1);t.push(i),t.push(n);try{await this.validateLocalKernelDependencies(n.token,i),await super.restart()}finally{me(t)}}async validateLocalKernelDependencies(t,n){var i;if(!(!((i=this.kernelConnectionMetadata)!=null&&i.interpreter)||!tr(this.kernelConnectionMetadata)||!this.kernelService)){if(t.isCancellationRequested)throw new vA.CancellationError;await this.kernelService.ensureKernelIsUsable(this.resource,this.kernelConnectionMetadata,n,t,this.creator==="3rdPartyExtension")}}async shutdown(){var t,n;return(t=this.restartToken)==null||t.cancel(),(n=this.restartToken)==null||n.dispose(),this.shutdownImplementation(!0)}async shutdownImplementation(t){var o;if(this.isDisposed||this.isShuttingDown)return;this.isShuttingDown=!0;let n=(new Error().stack||"").split(`
`).filter(s=>s.includes(Ye));b.trace(`Shutdown session - current session, called from 
 ${n.map(s=>`    ${s}`).join(`
`)}`);let i=`${(o=this.session.kernel)==null?void 0:o.id}, ${this.kernelConnectionMetadata.id}`;b.debug(`shutdownSession ${i} - start`);try{if(t||this.canShutdownSession())try{b.debug(`Session can be shutdown ${this.kernelConnectionMetadata.id}`),tZ(this.session.kernel),this.session.isDisposed||await bo(1e3,this.session.shutdown().catch(y))}catch(s){try{this.session.isDisposed||this.session.dispose()}catch(a){b.warn("Failures in disposing the session",a)}}finally{this.didShutdown.fire()}else b.debug(`Session cannot be shutdown ${this.kernelConnectionMetadata.id}`);try{this.session.isDisposed||this.session.dispose()}catch(s){b.warn("Failures in disposing the session",s)}super.dispose(),b.trace("Shutdown session -- complete")}catch(s){b.warn("Failures in disposing the session",s)}b.debug(`shutdownSession ${i} - shutdown complete`)}canShutdownSession(){return tr(this.kernelConnectionMetadata)?!0:this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"?!1:this.resource&&Kl(this.resource)==="interactive"?!0:!(this.resource&&Kl(this.resource)==="notebook"&&Ot(this.kernelConnectionMetadata))}};var Qd=class{constructor(e,t,n,i,o){this.jupyterNotebookProvider=e;this.jupyterConnection=t;this.asyncDisposables=n;this.kernelService=i;this.configService=o}async create(e){let t=[],n,i=()=>{e.ui.disableUI||n||(n=Vt.createProgressReporter(e.resource,Ot(e.kernelConnection)?C.connectingToJupyter:C.startingJupyter),t.push(n))};e.ui.disableUI&&e.ui.onDidChangeDisableUI(i,this,t),i();let o,s=[],a=this.configService.getSettings(e.resource).jupyterLaunchTimeout;try{o=Ot(e.kernelConnection)?await ms(e.token,this.jupyterConnection.createConnectionInfo(e.kernelConnection.serverProviderHandle)):await this.jupyterNotebookProvider.getOrStartServer({resource:e.resource,token:e.token,ui:e.ui}),await ms(e.token,this.validateLocalKernelDependencies(e));let l=Xf.create(o.settings);this.asyncDisposables.push({dispose:()=>Kg(l)}),s.push(l),await ms(e.token,this.validateRemoteServer(e,l));let c=await this.connectToOrCreateSession({...e,contentsManager:l.contentsManager,sessionManager:l.sessionManager,kernelManager:l.kernelManager,kernelSpecManager:l.kernelSpecManager,idleTimeout:a,connection:o});e.token.isCancellationRequested&&(await c.shutdown().catch(y),ea(()=>c.dispose())),Vd.throwIfCanceled(e.token),b.info(`Started session for kernel ${e.kernelConnection.kind}:${e.kernelConnection.id}`);let u=new gA(c,e.resource,e.kernelConnection,this.kernelService,e.creator),p=c.disposed,f=()=>{l.dispose(),p.disconnect(f)};this.asyncDisposables.push({dispose:()=>u.shutdown().finally(()=>u.dispose())}),c.disposed.connect(f);let m=u.onDidDispose(f);return this.asyncDisposables.push(m),u}catch(l){throw me(s),Ot(e.kernelConnection)?o?Fs.isSelfCertsError(l)?new Fs(o.baseUrl):eu.isSelfCertsExpiredError(l)?new eu(o.baseUrl):new fo(o.baseUrl,e.kernelConnection.serverProviderHandle,l):l:l instanceof ot?l:new pA(l)}finally{me(t)}}async validateRemoteServer(e,t){if(t.isDisposed)throw new nn;if(!tr(e.kernelConnection))try{await Promise.all([t.getRunningKernels(),t.getKernelSpecs()])}catch(n){throw b.error("Failed to fetch running kernels from remote server, connection may be outdated or remote server may be unreachable",n),new fo(e.kernelConnection.baseUrl,e.kernelConnection.serverProviderHandle,n)}}async validateLocalKernelDependencies(e){var t;if(e.token.isCancellationRequested)throw new yA.CancellationError;(t=e.kernelConnection)!=null&&t.interpreter&&tr(e.kernelConnection)&&this.kernelService&&await this.kernelService.ensureKernelIsUsable(e.resource,e.kernelConnection,e.ui,e.token,e.creator==="3rdPartyExtension")}async connectToOrCreateSession(e){var n;if(e.token.isCancellationRequested)throw new yA.CancellationError;let t;try{if(e.kernelConnection&&e.kernelConnection.kind==="connectToLiveRemoteKernel"&&e.kernelConnection.kernelModel.id&&e.kernelConnection.kernelModel.model){if(!e.kernelConnection.kernelModel.model)throw new Error("Kernel model not defined when connecting to an existing session");t=e.sessionManager.connectTo({...e.kernelConnection.kernelModel,model:e.kernelConnection.kernelModel.model}),await ms(e.token,fP(async()=>{var i;return((i=t.kernel)==null?void 0:i.connectionStatus)==="connected"||e.token.isCancellationRequested},e.idleTimeout,100))}else b.trace(`createNewKernelSession ${(n=e.kernelConnection)==null?void 0:n.id}`),t=await this.createNewSession(e),await mA(e.kernelConnection,e.resource,t,e.idleTimeout,e.token).catch(y);if(e.token.isCancellationRequested)throw new yA.CancellationError;return t}catch(i){let o=e.ui.disableUI?b.debug:b.error;throw i instanceof ot?(o("Failed to change kernel, re-throwing",i),i):(o("Failed to change kernel",i),new ov(e.kernelConnection))}}async createNewSession(e){var a,l,c,u,p,f;let t=(e.connection,e.resource,void 0),n=t==null?void 0:t.path,i=(u=(c=mz(e.kernelConnection))!=null?c:(l=(a=e.kernelSpecManager)==null?void 0:a.specs)==null?void 0:l.default)!=null?u:"",o;if(t!=null&&t.name)o=t.name;else{let m=e.resource?Zv(e.resource):"";o=`${e.resource?vi(e.resource,m):""}-${(0,bA.default)()}${m}`}let s={path:n||G_e(e.resource),kernel:{name:i},name:o,type:(((p=e.resource)==null?void 0:p.path)||"").toLowerCase().endsWith(".ipynb")?"notebook":"console"};try{let m=await ms(e.token,e.sessionManager.startNew(s,{kernelConnectionOptions:{handleComms:!0}}));if(!m.kernel)throw new TS(new Error("No kernel created"));return b.info(C.createdNewKernel(e.connection.baseUrl,((f=m==null?void 0:m.kernel)==null?void 0:f.id)||"")),m}catch(m){throw m instanceof TS?m:new TS(m)}}};Qd=E([(0,gu.injectable)(),I(0,(0,gu.inject)(a1)),I(1,(0,gu.inject)(vn)),I(2,(0,gu.inject)(Ya)),I(3,(0,gu.inject)(l1)),I(3,(0,gu.optional)()),I(4,(0,gu.inject)(Me))],Qd);function q_e(){return`${$f}${(0,bA.default)()}`}function G_e(r){let e=`${q_e()}${(0,bA.default)()}.ipynb`;return r?`${vi(r,".ipynb")}${e}`:`${C.defaultNotebookName}${e}`}var kS=class{constructor(e,t,n){this.rawKernelSupported=e;this.newRawKernelSessionFactory=t;this.newJupyterSessionFactory=n}async create(e){let t=e.kernelConnection;return this.rawKernelSupported.isSupported&&tr(t)&&this.newRawKernelSessionFactory?this.newRawKernelSessionFactory.create({...e,kernelConnection:t}):this.newJupyterSessionFactory.create(e)}};kS=E([(0,mm.injectable)(),I(0,(0,mm.inject)($d)),I(1,(0,mm.inject)(MX)),I(1,(0,mm.optional)()),I(2,(0,mm.inject)(Qd))],kS);d();var mD=Symbol("RemoteKernelFinderController");function rZ(r,e){r.addSingleton(jl,jl),r.addSingleton(l1,rv),r.addSingleton(hr,CS),r.addSingleton(Vx,kS),r.addSingleton(Qd,Qd),r.addSingleton(a1,ES),r.addSingleton(Qg,DS),r.addSingleton(vn,vn),r.addSingleton(Xg,wS),r.addBinding(Xg,We),r.addSingleton(u1,_S),r.addSingleton(xn,SS),r.addSingleton(mD,zd),r.addBinding(mD,We),r.addSingleton(ur,MI)}var vZ=$(te());d();var yn=$(te());d();var ji=require("vscode");var IA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.executions=new WeakMap;this.kernelsByNotebook=new WeakMap;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new ji.EventEmitter;this._onDidStartKernel=new ji.EventEmitter;this._onDidCreateKernel=new ji.EventEmitter;this._onDidDisposeKernel=new ji.EventEmitter;this._onKernelStatusChanged=new ji.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),ji.workspace.onDidCloseNotebookDocument(n=>this.disposeOldKernel(n),this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){let e=new Set;return ji.workspace.notebookDocuments.forEach(t=>{let n=this.get(t);n&&e.add(n)}),Array.from(e)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;if(Tn(e)){let i=ji.workspace.notebookDocuments.find(o=>o.uri.toString()===e.toString());return i?this.get(i):void 0}else return typeof e=="string"?(t=this.kernelsById.get(e))==null?void 0:t.kernel:(n=this.kernelsByNotebook.get(e))==null?void 0:n.kernel}getKernelExecution(e){return this.executions.get(e)}getInternal(e){return this.kernelsByNotebook.get(e)}async dispose(){b.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByNotebook.set(e,{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e){e.onDisposed(()=>{this.get(e.notebook)===e&&(this.kernelsByNotebook.delete(e.notebook),this.kernelsById.delete(e.id),b.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${ye(e.uri)}`)),this.pendingDisposables.delete(e)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByNotebook.get(e);t&&(b.debug(`Disposing kernel associated with ${ye(e.uri)}, isClosed=${e.isClosed}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>b.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByNotebook.delete(e)}handleServerRemoval(e){ji.workspace.notebookDocuments.forEach(t=>{let n=this.kernelsByNotebook.get(t);if(n){let i=n.options.metadata;(i.kind==="connectToLiveRemoteKernel"||i.kind==="startUsingRemoteKernelSpec")&&e.find(s=>s.id===i.serverProviderHandle.id&&s.handle===i.serverProviderHandle.handle)&&(this.kernelsByNotebook.delete(t),this.kernelsById.delete(n.kernel.id))}})}},SA=class{constructor(e,t){this.asyncDisposables=e;this.disposables=t;this.kernelsByUri=new Map;this.kernelsById=new Map;this.pendingDisposables=new Set;this._onDidRestartKernel=new ji.EventEmitter;this._onDidStartKernel=new ji.EventEmitter;this._onDidCreateKernel=new ji.EventEmitter;this._onDidDisposeKernel=new ji.EventEmitter;this._onKernelStatusChanged=new ji.EventEmitter;this.onKernelStatusChanged=this._onKernelStatusChanged.event;this.asyncDisposables.push(this),ji.workspace.onDidCloseNotebookDocument(n=>{b.debug(`Notebook document ${ye(n.uri)} got closed`),this.disposeOldKernel(n.uri)},this,t),t.push(this._onDidDisposeKernel),t.push(this._onDidRestartKernel),t.push(this._onKernelStatusChanged),t.push(this._onDidStartKernel),t.push(this._onDidCreateKernel)}get kernels(){return Array.from(this.kernelsByUri.values()).map(e=>e.kernel)}get onDidDisposeKernel(){return this._onDidDisposeKernel.event}get onDidRestartKernel(){return this._onDidRestartKernel.event}get onDidStartKernel(){return this._onDidStartKernel.event}get onDidCreateKernel(){return this._onDidCreateKernel.event}get(e){var t,n;return((t=this.kernelsByUri.get(e.toString()))==null?void 0:t.kernel)||((n=this.kernelsById.get(e.toString()))==null?void 0:n.kernel)}getInternal(e){return this.kernelsByUri.get(e.toString())}async dispose(){b.ci("Disposing all kernels from kernel provider");let e=Array.from(this.pendingDisposables.values());this.pendingDisposables.clear(),await Promise.all(e),await Promise.all(this.kernels.map(t=>t.dispose()))}storeKernel(e,t,n){this.kernelsByUri.set(e.toString(),{options:t,kernel:n}),this.kernelsById.set(n.id,{options:t,kernel:n}),this._onDidCreateKernel.fire(n)}deleteMappingIfKernelIsDisposed(e,t){t.onDisposed(()=>{this.get(e)===t&&(this.kernelsByUri.delete(e.toString()),this.kernelsById.delete(t.id),b.debug(`Kernel got disposed, hence there is no longer a kernel associated with ${ye(e)}`)),this.pendingDisposables.delete(t)},this,this.disposables)}disposeOldKernel(e){let t=this.kernelsByUri.get(e.toString());t&&(b.ci(`Disposing kernel associated with ${ye(e)}`),this.kernelsById.delete(t.kernel.id),this.pendingDisposables.add(t.kernel),t.kernel.dispose().catch(n=>b.warn("Failed to dispose old kernel",n)).finally(()=>this.pendingDisposables.delete(t.kernel)).catch(y)),this.kernelsByUri.delete(e.toString())}};d();var $j=$(iv()),Fr=require("vscode");d();async function hD(r,e){if(!r)return;let t=ja(r),[n,i]=G0.get(t)||[{resourceType:Kl(r),resourceHash:r?await Rt(r.toString()):void 0,kernelSessionId:await Rt(Date.now().toString()),capturedEnvVars:void 0,userExecutedCell:void 0,disableUI:void 0,kernelLanguage:void 0,kernelId:void 0,kernelSpecHash:void 0,isUsingActiveInterpreter:void 0,pythonEnvironmentType:void 0,pythonEnvironmentPath:void 0,pythonEnvironmentVersion:void 0,kernelConnectionType:void 0},{previouslySelectedKernelConnectionId:""}];typeof e.capturedEnvVars=="boolean"&&(n.capturedEnvVars=e.capturedEnvVars),e.userExecutedCell&&(n.userExecutedCell=!0),typeof e.disableUI=="boolean"&&(n.disableUI=e.disableUI);let o=e.kernelConnection;if(o){let s=o.id;i.previouslySelectedKernelConnectionId!==s&&(n.userExecutedCell=e.userExecutedCell,n.disableUI=e.disableUI),i.previouslySelectedKernelConnectionId&&i.previouslySelectedKernelConnectionId!==s&&(n.kernelSessionId=await Rt(Date.now().toString()));let a;switch(o.kind){case"connectToLiveRemoteKernel":a=o.kernelModel.language;break;case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":a=o.kernelSpec.language;break;case"startUsingPythonInterpreter":a=qe;break;default:break}let l="kernelSpec"in o&&o.kernelSpec.specFile?Rt(o.kernelSpec.specFile):Promise.resolve("");n.kernelLanguage=a,[n.kernelId,n.kernelSpecHash]=await Promise.all([Rt(o.id),l]),i.previouslySelectedKernelConnectionId=o.id;let c=o.interpreter;if(c){n.isUsingActiveInterpreter=Hl.isActiveWorkspaceInterpreter(r,c),n.pythonEnvironmentType=Zr(c);let[u,p]=await Promise.all([Rt(lt(Uc(c.uri))),Np(c)]);n.pythonEnvironmentPath=u,xW.set(n.pythonEnvironmentPath,c),p?n.pythonEnvironmentVersion=`${p.major}.${p.minor}.${p.micro}`:n.pythonEnvironmentVersion=void 0,DW(n)}n.kernelConnectionType=n.kernelConnectionType||(o==null?void 0:o.kind)}else i.previouslySelectedKernelConnectionId="";G0.set(t,[n,i])}async function Ra(r,e){await hD(r,{kernelConnection:e,userExecutedCell:!0})}var oZ=$(q1());d();var Yj="KERNEL_INFO",Y_e=1e3*60*60*24*2;async function iZ(r,e,t){var a;let n=[],i={banner:"",help_links:[],implementation:"",implementation_version:"",language_info:{name:"",version:""},protocol_version:"",status:"ok"};if(!r.kernel)return;(a=r.kernel)!=null&&a.info&&(n.push(r.kernel.info),r.kernel.info.then(l=>nZ(t,e,l)).catch(y));let o=r.kernel.requestKernelInfo().then(l=>l==null?void 0:l.content);if(n.push(o),o.then(l=>nZ(t,e,l)).catch(y),e.kind==="connectToLiveRemoteKernel"){let l=$_e(t,e);l?n.push(Promise.resolve(l)):n.push(oc(5e3).then(()=>i))}let s=await Promise.race(n);return s===i?b.warn("Failed to Kernel info in a timely manner, defaulting to empty info!"):b.trace("Got Kernel info"),s}async function nZ(r,e,t){if(!t||!Ot(e))return;let n=r.get(Yj,[]).filter(i=>Date.now()-i.age<Y_e).filter(i=>i.id!==e.id);n.push({id:e.id,age:Date.now(),info:t}),await r.update(Yj,n)}function $_e(r,e){var t;if(Ot(e))return(t=r.get(Yj,[]).find(n=>n.id===e.id))==null?void 0:t.info}d();var _A=class extends wi{constructor(e){super("kernelpromisetimeout",C.interruptingKernelFailed,e)}};var EA="e976ee50-99ed-4aba-9b6b-9dcd5634d07d:IPyWidgets:";function DA(r){let e=typeof r=="string"?r:"";return typeof r!="string"&&"content"in r&&"code"in r.content&&typeof r.content.code=="string"&&(e=r.content.code),!e.includes(EA)}function PA(r){var e,t,n,i;return r.status==="dead"||r.status==="terminating"&&!r.disposed&&!r.disposing||!r.disposed&&!r.disposing&&(((e=r.session)==null?void 0:e.status)=="unknown"||((n=(t=r.session)==null?void 0:t.kernel)==null?void 0:n.status)=="unknown")&&(((i=r.session.kernel)==null?void 0:i.isDisposed)||r.session.isDisposed)}function sZ(r){var e,t;return r.status==="dead"||r.status==="terminating"&&!r.isDisposed||!r.isDisposed&&(r.status=="unknown"||((e=r.kernel)==null?void 0:e.status)=="unknown")&&(((t=r.kernel)==null?void 0:t.isDisposed)||r.isDisposed)}var CA=class{constructor(e,t,n,i,o,s,a,l,c){this.id=e;this.uri=t;this.resourceUri=n;this.kernelConnectionMetadata=i;this.sessionCreator=o;this.kernelSettings=s;this.startupCodeProviders=a;this._creator=l;this.workspaceMemento=c;this.disposables=[];this._onIPyWidgetVersionResolved=new Fr.EventEmitter;this._onDidKernelSocketChange=new Fr.EventEmitter;this._onStatusChanged=new Fr.EventEmitter;this._onRestarted=new Fr.EventEmitter;this._onStarted=new Fr.EventEmitter;this._onDisposed=new Fr.EventEmitter;this.hookedSessionForEvents=new WeakSet;this.hooks=new Map;this.startCancellation=new Fr.CancellationTokenSource;this.startupUI=new Ir(!0);this.disposables.push(this._onStatusChanged),this.disposables.push(this._onRestarted),this.disposables.push(this._onStarted),this.disposables.push(this._onDisposed),this.disposables.push(this._onIPyWidgetVersionResolved),this.disposables.push(this._onDidKernelSocketChange),hD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,disableUI:this.startupUI.disableUI}).catch(y),this.startupUI.onDidChangeDisableUI(()=>{this.startupUI.disableUI||hD(this.resourceUri,{disableUI:!1}).catch(y)},this.disposables)}get ipywidgetsVersion(){return this._ipywidgetsVersion}get onIPyWidgetVersionResolved(){return this._onIPyWidgetVersionResolved.event}get onStatusChanged(){return this._onStatusChanged.event}get onRestarted(){return this._onRestarted.event}get onStarted(){return this._onStarted.event}get onDisposed(){return this._onDisposed.event}get creator(){return this._creator}get startedAtLeastOnce(){return this._startedAtLeastOnce}get info(){return this._info}get status(){var e,t;return this._jupyterSessionPromise&&!this._session?"starting":(t=(e=this._session)==null?void 0:e.status)!=null?t:this.isKernelDead?"dead":"unknown"}get disposed(){var e;return this._disposed===!0||((e=this._session)==null?void 0:e.isDisposed)===!0}get disposing(){return this._disposing===!0}get onDidKernelSocketChange(){return this._onDidKernelSocketChange.event}get session(){return this._session}get restarting(){return this._restartPromise||Promise.resolve()}addHook(e,t,n,i){let o=this.hooks.get(e)||new Set;this.hooks.set(e,o),t=n?t.bind(n):t,o.add(t);let s={dispose:()=>{o.delete(t)}};return i&&i.push(s),s}async start(e){return this.startCancellation.token.isCancellationRequested&&(this.startCancellation.dispose(),this.startCancellation=new Fr.CancellationTokenSource),this.startJupyterSession(e)}async interrupt(){let e=Promise.all(Array.from(this.hooks.get("willInterrupt")||new Set).map(n=>n()));b.info(`Interrupt requested ${ye(this.resourceUri||this.uri)}`);let t;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;b.info("Interrupt kernel execution"),n?(t=this._interruptPromise?await this._interruptPromise:await(this._interruptPromise=this.interruptExecution(n,e)),this._interruptPromise=void 0):(b.info("No kernel session to interrupt"),this._interruptPromise=void 0,t="success")}finally{await Promise.all(Array.from(this.hooks.get("interruptCompleted")||new Set).map(n=>n())).catch(y)}if(b.info(`Interrupt requested & sent for ${ye(this.uri)} in notebookEditor.`),t==="timeout"){let n=C.restartKernelAfterInterruptMessage(ut(this.kernelConnectionMetadata)),i=C.restartKernelMessageYes;await Fr.window.showInformationMessage(n,{modal:!0},i)===i&&await this.restart()}}async dispose(){if(b.info(`Dispose Kernel '${ye(this.uri)}' associated with '${ye(this.resourceUri)}'`),this._disposing=!0,this.disposingPromise)return this.disposingPromise;this._ignoreJupyterSessionDisposedErrors=!0,this.startCancellation.cancel();let e=async()=>{let t=[];t.push(Promise.all(Array.from(this.hooks.get("willCancel")||new Set).map(n=>n())).then(y).catch(y)),this._session=this._session?this._session:this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0,this._jupyterSessionPromise=void 0,this._session&&(t.push(Kg(this._session,this.disposables)),this._session=void 0),this._disposed=!0,this._onDisposed.fire(),this._onStatusChanged.fire("dead");try{await Promise.all(t)}finally{this.startCancellation.dispose(),me(this.disposables)}};this.disposingPromise=e(),await this.disposingPromise}async restart(){try{let e=Kl(this.resourceUri);b.info(`Restart requested ${ye(this.uri)}`),await Promise.all(Array.from(this.hooks.get("willRestart")||new Set).map(n=>n(this._jupyterSessionPromise))),this.startCancellation.cancel(),this.startCancellation.dispose();let t=new St;try{let n=this._jupyterSessionPromise?await this._jupyterSessionPromise.catch(()=>{}):void 0;n?(this._restartPromise||(this._restartPromise=n.restart(),this._restartPromise.finally(()=>this._restartPromise=void 0).catch(y)),await this._restartPromise,this.startCancellation=new Fr.CancellationTokenSource):await this.start(new Ir(!1)),Yr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},{resourceType:e})}catch(n){b.error(`Restart failed ${ye(this.uri)}`,n),this._ignoreJupyterSessionDisposedErrors=!0;let i=this._session;throw this._session=void 0,this._jupyterSessionPromise=void 0,Yr(this.resourceUri,"DATASCIENCE.NOTEBOOK_RESTART",{duration:t.elapsedTime},void 0,n),i&&await Kg(i,this.disposables),this._ignoreJupyterSessionDisposedErrors=!1,n}await this.initializeAfterStart(this._session),this._onRestarted.fire()}catch(e){throw b.error(`Failed to restart kernel ${ye(this.uri)}`,e),e}finally{Promise.all(Array.from(this.hooks.get("restartCompleted")||new Set).map(e=>e())).catch(y)}}async startJupyterSession(e=new Ir(!1)){if(this._startedAtLeastOnce=!0,e.disableUI||(this.startupUI.disableUI=!1),e.onDidChangeDisableUI(()=>{!e.disableUI&&this.startupUI.disableUI&&(this.startupUI.disableUI=!1)},this.disposables),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||Ra(this.resourceUri,this.kernelConnectionMetadata).catch(y)},this,this.disposables),this.disposing)throw new Fr.CancellationError;if(Vd.throwIfCanceled(this.startCancellation.token),!this._jupyterSessionPromise){let t=new St;this._jupyterSessionPromise=this.createJupyterSession();try{let n=await this._jupyterSessionPromise;return Yr(this.resourceUri,"DS_INTERNAL.PERCEIVED_JUPYTER_STARTUP_NOTEBOOK",{duration:t.elapsedTime}),n}catch(n){throw b.ci(`Failed to create Jupyter Session in Kernel.startNotebook for ${ye(this.uri)}`),this.startCancellation.cancel(),this._jupyterSessionPromise=void 0,n}}return this._jupyterSessionPromise}async interruptExecution(e,t){let n=ke(),i=new St,o=[],s=c=>{(c==="restarting"||c==="autorestarting")&&(b.warn("Kernel restarting during interrupt"),n.resolve(!0))},a=(c,u)=>s(u);return e.statusChanged.connect(a),o.push(new Fr.Disposable(()=>ea(()=>e.statusChanged.disconnect(a)))),e&&e.kernel&&(b.info(`Interrupting kernel: ${e.kernel.name}`),await Gv(this.kernelSettings.interruptTimeout,new _A(this.kernelConnectionMetadata),e.kernel.interrupt()).catch(c=>{b.warn(`Error during interrupt: ${c}`),n.resolve(!0)})),(async()=>{let c=ke();this.status==="busy"&&(this.onDisposed(()=>c.resolve("dead"),this,o),this.onStatusChanged(()=>this.status==="dead"?c.resolve("dead"):void 0,this,o));try{return await bo(this.kernelSettings.interruptTimeout,"timeout",t.then(()=>"success"),n.promise.then(()=>"restart"),c.promise)}catch(u){if(n.completed)return"restart";throw Yr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},void 0,u),u}finally{me(o)}})().then(c=>(Yr(this.resourceUri,"DATASCIENCE.NOTEBOOK_INTERRUPT",{duration:i.elapsedTime},{result:c}),c))}async createJupyterSession(){var i;let e=Fr.workspace.notebookDocuments.find(o=>o.uri.toString()===this.uri.toString()),t=e?(i=Bc(e))==null?void 0:i.jupyterSessionTelemetry():void 0;if(await hD(this.resourceUri,{kernelConnection:this.kernelConnectionMetadata,actionSource:this.creator,userExecutedCell:!this.startupUI.disableUI}),t==null||t.stop(),this.disposing)throw new Fr.CancellationError;Vd.throwIfCanceled(this.startCancellation.token);let n=[];try{b.info(`Starting Kernel ${Q_e(this,this.startupUI)}`),this.createProgressIndicator(n),this.isKernelDead=!1,this._onStatusChanged.fire("starting");let o=await this.sessionCreator.create({resource:this.resourceUri,ui:this.startupUI,kernelConnection:this.kernelConnectionMetadata,token:this.startCancellation.token,creator:this.creator});if(this.disposing)throw new Fr.CancellationError;if(Vd.throwIfCanceled(this.startCancellation.token),await this.initializeAfterStart(o),this.disposing)throw new Fr.CancellationError;return this.sendKernelStartedTelemetry(),this._session=o,this._onStarted.fire(),b.info("Kernel successfully started"),o}catch(o){if(this.startupUI.disableUI?b.trace(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o):!this.startCancellation.token&&!xi(o)&&b.error(`failed to create IJupyterKernelConnectionSession in kernel, UI Disabled = ${this.startupUI.disableUI}`,o),Vd.throwIfCanceled(this.startCancellation.token),o instanceof Op)throw o;let s=C.sessionStartFailedWithKernel(ut(this.kernelConnectionMetadata));throw ti.from(s+" "+("message"in o?o.message:o.toString()),o)}finally{me(n)}}sendKernelStartedTelemetry(){this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent&&this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent===this.startupUI.disableUI||this.startTelemetrySent&&!this.startupUI.disableUI||(this.uiWasDisabledWhenKernelStartupTelemetryWasLastSent=this.startupUI.disableUI===!0,this.startTelemetrySent=!0,Yr(this.resourceUri,"DATASCIENCE.NOTEBOOK_START",void 0,{disableUI:this.startupUI.disableUI}))}createProgressIndicator(e){let t=Vt.createProgressReporter(this.resourceUri,C.connectingToKernel(ut(this.kernelConnectionMetadata)),this.startupUI.disableUI);e.push(t),this.startupUI.disableUI&&this.startupUI.onDidChangeDisableUI(()=>{this.disposing||this.disposed||this.startupUI.disableUI||t.show&&t.show()},this,e)}async initializeAfterStart(e){var o;let t=Fr.workspace.notebookDocuments.find(s=>s.uri.toString()===this.uri.toString()),n=Bc(t),i=t?n==null?void 0:n.postKernelStartup():void 0;try{if(await Promise.all(Array.from(this.hooks.get("didStart")||new Set).map(l=>l(e,this.startCancellation.token).catch(y))),b.trace(`Started running kernel initialization for ${ye(this.uri)}`),!e){b.trace("Not running kernel initialization");return}if(!this.hookedSessionForEvents.has(e)){this.hookedSessionForEvents.add(e),e.onDidKernelSocketChange(c=>this._onDidKernelSocketChange.fire(c)),e.onDidDispose(()=>{if(b.ci(`Kernel got disposed as a result of session.onDisposed (1) ${ye(this.resourceUri||this.uri)}`),!this._ignoreJupyterSessionDisposedErrors){b.info(`Kernel got disposed as a result of session.onDisposed ${ye(this.resourceUri||this.uri)} & _ignoreJupyterSessionDisposedErrors = false.`);let c=this._session===e;this._jupyterSessionPromise=void 0,this._session=void 0,c&&(this.isKernelDead=!0,this._onStatusChanged.fire("dead"))}});let l=(c,u)=>this._onStatusChanged.fire(u);e.statusChanged.connect(l),this.disposables.push(new Fr.Disposable(()=>ea(()=>e.statusChanged.disconnect(l))))}if((o=e.kernel)==null||o.registerCommTarget(rt.DefaultCommTarget,y),this.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel")this.determineVersionOfIPyWidgets(e).catch(l=>b.error("Failed to determine IPyWidget version",l)),this.gatherInternalStartupCode().then(l=>this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"})).catch(l=>b.error("Failed to execute internal startup code",l));else{await this.determineVersionOfIPyWidgets(e);let l=await this.gatherInternalStartupCode();await this.executeSilently(e,l,{traceErrors:!0,traceErrorsMessage:"Error executing jupyter extension internal startup code"}),await this.executeSilently(e,this.getUserStartupCommands(),{traceErrors:!1})}i==null||i.stop();let s=n==null?void 0:n.kernelInfo();try{b.debug("Requesting Kernel info"),this._info=await iZ(e,this.kernelConnectionMetadata,this.workspaceMemento)}catch(l){b.warn("Failed to request KernelInfo",l)}s==null||s.stop();let a=n==null?void 0:n.kernelIdle();this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&(b.trace("End running kernel initialization, now waiting for idle"),await e.waitForIdle(this.kernelSettings.launchTimeout,this.startCancellation.token),b.trace("End running kernel initialization, session is idle")),a==null||a.stop()}finally{i==null||i.stop()}}async determineVersionOfIPyWidgets(e){var n;if(!Gt(this.kernelConnectionMetadata)){this._ipywidgetsVersion==UE,this._onIPyWidgetVersionResolved.fire(UE);return}let t=async()=>{let i=oZ.default`
        try:
            import ipywidgets as _VSCODE_ipywidgets
            print("${EA}" + _VSCODE_ipywidgets.__version__)
            del _VSCODE_ipywidgets
        except:
            pass
        `,o=await this.executeSilently(e,[i]).catch(s=>b.error("Failed to determine version of IPyWidgets",s));if(Array.isArray(o)){let s=o.some(c=>{var u;return(u=c.text||"")==null?void 0:u.toString().includes(`${EA}8.`)}),a=o.some(c=>{var u;return(u=c.text||"")==null?void 0:u.toString().includes(`${EA}7.`)}),l=this._ipywidgetsVersion=a?7:s?8:void 0;b.trace(`Determined IPyWidgets Version as ${l}`),this._ipywidgetsVersion==l,this._onIPyWidgetVersionResolved.fire(l)}else b.warn("Failed to determine IPyKernel Version",JSON.stringify(o))};if(await t(),!this._ipywidgetsVersion&&((n=this.session)!=null&&n.kernel)){let i=(o,s)=>{var l;if(s.direction==="send")return;let a=s.msg;a.content&&"data"in a.content&&a.content.data&&(a.content.data[yo]||"target_name"in a.content&&a.content.target_name===rt.DefaultCommTarget)&&(this._ipywidgetsVersion||(t().catch(y),(l=this.session)!=null&&l.kernel&&this.session.kernel.anyMessage.disconnect(i,this)))};this.session.kernel.anyMessage.connect(i,this)}}async gatherInternalStartupCode(){let e=[],t=await Promise.all(this.startupCodeProviders.sort((n,i)=>i.priority-n.priority).map(n=>n.getCode(this)));for(let n of t)e.push(...n);if(Gt(this.kernelConnectionMetadata)&&this.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"){let n=lt(this.resourceUri);n&&e.push(`__vsc_ipynb_file__ = "${n.replace(/\\/g,"\\\\")}"`),this.kernelSettings.enableExtendedPythonKernelCompletions||e.push(OE.DisableJedi),e.push(...z_e(this.getMatplotLibInitializeCode(),"Failed to initialize matplotlib startup code. Matplotlib might be missing."))}return e}getMatplotLibInitializeCode(){let e=[];if(this.kernelSettings.themeMatplotlibPlots){b.ci(`Initialize config for plots for ${ye(this.resourceUri||this.uri)}`);let t=OE.MatplotLibInit;b.trace(`Initialize matplotlib for ${ye(this.resourceUri||this.uri)}`),e.push(...at(t,{trim:!1}));let n=Fr.window.activeColorTheme.kind===Fr.ColorThemeKind.Dark;e.push(n?"matplotlib.style.use('dark_background')":`matplotlib.rcParams.update(${rt.MatplotLibDefaultParams})`)}return e}getUserStartupCommands(){let e=this.kernelSettings.runStartupCommands;if(Array.isArray(e)&&(e=e.join(`
`)),e){let t=e.replace(/\\n/g,`
`);return at(t,{trim:!1})}return[]}async executeSilently(e,t,n){if(t.join("").trim().length!==0){if(!e.kernel){b.trace(`Not executing startup as there is no session, code: ${t}`);return}return Vi(e.kernel,t.join(`
`),n)}}},wA=class extends CA{get creator(){return"3rdPartyExtension"}constructor(e,t,n,i,o,s,a){super(`3rdPartyKernel_${(0,$j.default)()}`,e,t,n,i,o,s,"3rdPartyExtension",a)}},xA=class extends CA{constructor(t,n,i,o,s,a,l,c){super((0,$j.default)(),n.uri,t,i,o,s,l,"jupyterExtension",c);this.notebook=n;this.controller=a}get creator(){return"jupyterExtension"}};function z_e(r,e){return!r||r.length===0||(r=r.map(t=>`    ${t}`),r.unshift("try:"),r.push("except:",`    print('${e}')`)),r}function Q_e(r,e){let t=r.kernelConnectionMetadata.interpreter,n=[];if(t){n.push(`Python Path: ${ye(t.uri)}`),n.push(t?Zr(t):"");let i=Bu(t);i&&n.push(`${i.major}.${i.minor}.${i.micro}`)}else(r.kernelConnectionMetadata.kind==="startUsingLocalKernelSpec"||r.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec")&&n.push(r.kernelConnectionMetadata.kernelSpec.display_name);return`(${n.filter(i=>i).join(", ")}) for '${ye(r.uri)}' (disableUI=${e.disableUI})`}d();function zj(r,e){return{get enableExtendedPythonKernelCompletions(){return r.getSettings(e).enableExtendedPythonKernelCompletions},get interruptTimeout(){return r.getSettings(e).jupyterInterruptTimeout},get launchTimeout(){return r.getSettings(e).jupyterLaunchTimeout},get runStartupCommands(){return r.getSettings(e).runStartupCommands},get themeMatplotlibPlots(){return r.getSettings(e).themeMatplotlibPlots}}}d();var sv=require("vscode");d();var Xj=require("vscode");d();var Qj=$(MV()),Mr=require("vscode");d();var TA=$(te()),aZ=require("vscode");var un=class{static dispose(){me(un.disposables)}constructor(e){e.push({dispose:()=>{un.dispose()}})}activate(){aZ.workspace.onDidChangeNotebookDocument(e=>{br(e.notebook)&&e.cellChanges.filter(t=>{var n;return((n=t.outputs)==null?void 0:n.length)===0}).map(t=>{var i;let n=un.cellToDisplayIdMapping.get(t.cell);n&&(un.cellToDisplayIdMapping.delete(t.cell),(i=un.displayIdCellOutputMappingPerDocument.get(e.notebook))==null||i.delete(n))})})}static trackOutputByDisplayId(e,t,n,i){let o=un.displayIdCellOutputMappingPerDocument.get(e.notebook);o||(o=new Map,un.displayIdCellOutputMappingPerDocument.set(e.notebook,o)),o.set(t,{outputContainer:n,cell:e,outputItems:i}),un.cellToDisplayIdMapping.set(e,t)}static getMappedOutput(e,t){let n=un.displayIdCellOutputMappingPerDocument.get(e);if(!n)return;let i=n.get(t);return i!=null&&i.cell.document.isClosed?void 0:i}};un.displayIdCellOutputMappingPerDocument=new WeakMap,un.cellToDisplayIdMapping=new WeakMap,un.disposables=[],un=E([(0,TA.injectable)(),I(0,(0,TA.inject)(ie))],un);var NS=new WeakMap;function Xd(r){if(r.parent_header&&"msg_id"in r.parent_header)return r.parent_header.msg_id}var vu=class vu{constructor(e,t,n,i,o,s,a,l){this.cell=e;this.controller=t;this.context=n;this.formatters=i;this.kernel=o;this.request=s;this._onErrorHandlingIOPubMessage=new Mr.EventEmitter;this.onErrorHandlingExecuteRequestIOPubMessage=this._onErrorHandlingIOPubMessage.event;this.outputsAreSpecificToAWidget=[];this.commIdsMappedToParentWidgetModel=new Map;this.disposables=[];this.prompts=new Set;this.ownedCommIds=new Set;this.commIdsMappedToWidgetOutputModels=new Set;this.ownedRequestMsgIds=new Set;this._completed=ke();this.gotIdleIOPubStatus=!1;this.gotShellReply=!1;this.streamsReAttachedToExecutingCell=!1;this._completed.promise.catch(y),this.executeRequestMessageId=l,this.ownedRequestMsgIds.add(l),Mr.workspace.onDidChangeNotebookDocument(c=>{var p;if(!br(c.notebook))return;let u=c.cellChanges.find(({cell:f})=>f===this.cell);u&&((p=u.outputs)==null?void 0:p.length)===0&&(this.clearLastUsedStreamOutput(),this.cellHasErrorsInOutput=!1)},this,this.disposables),this.execution=a,this.kernel.anyMessage.connect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.connect(this.onKernelIOPubMessage,this),s&&(s.onIOPub=()=>{this.cell.document.isClosed&&!this.completedExecution&&s.dispose()},s.onReply=c=>{if(this.cell.document.isClosed){s.dispose();return}this.handleReply(c)},s.onStdin=this.handleInputRequest.bind(this),s.done.finally(()=>{this.completedExecution=!0,this.endCellExecution()}).catch(y))}get hasErrorOutput(){return this.cellHasErrorsInOutput===!0}get completed(){return this._completed.promise}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution Message Handler disposed"),me(this.disposables),this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this.kernel.anyMessage.disconnect(this.onKernelAnyMessage,this),this.kernel.iopubMessage.disconnect(this.onKernelIOPubMessage,this),this._onErrorHandlingIOPubMessage.dispose())}endCellExecution(){this.prompts.forEach(e=>e.dispose()),this.prompts.clear(),this.request&&this.clearLastUsedStreamOutput(),this.execution=void 0,this._completed.resolve()}onKernelAnyMessage(e,{direction:t,msg:n}){if(this.cell.document.isClosed)return this.endCellExecution();let i=li();if(!this.request&&t==="recv"){let o=Xd(n);i.KernelMessage.isStatusMsg(n)&&n.content.execution_state==="idle"&&o===this.executeRequestMessageId&&(this.gotIdleIOPubStatus=!0),n.channel==="shell"&&o===this.executeRequestMessageId&&(this.gotShellReply=!0);let s=i.KernelMessage.isStatusMsg(n)&&n.content.execution_state!=="idle"&&o!==this.executeRequestMessageId;typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type;let a=o?o!==this.executeRequestMessageId&&!s:!1,l=typeof n.parent_header=="object"&&n.parent_header&&"msg_type"in n.parent_header&&n.parent_header.msg_type==="interrupt_request",c=this.gotIdleIOPubStatus&&this.gotShellReply,u=["kernel_info_reply","execute_input","execute_reply"],p="msg_type"in n&&typeof n.msg_type=="string"&&u.includes(n.msg_type);if(!this.completedExecution&&c)return this.completedExecution=!0,this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endCellExecution();if(!this.completedExecution&&(p||a)){this.endAbnormallyTimeout&&clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=setTimeout(()=>(this.completedExecution=!0,this.endAbnormallyTimeout=void 0,this.endCellExecution()),l?1e3:100),this.disposables.push(new Mr.Disposable(()=>{clearTimeout(this.endAbnormallyTimeout),this.endAbnormallyTimeout=void 0}));return}}t!=="send"||!this.completedExecution||i.KernelMessage.isCommMsgMsg(n)&&this.ownedCommIds.has(n.content.comm_id)&&this.ownedRequestMsgIds.add(n.header.msg_id)}onKernelIOPubMessage(e,t){if(this.cell.document.isClosed)return this.endCellExecution();if(!(!t.parent_header||!("msg_id"in t.parent_header)||!this.ownedRequestMsgIds.has(t.parent_header.msg_id)||t.channel!=="iopub"))try{this.handleIOPub(t)}catch(n){b.error("Failed to handle iopub message as a result of some comm message",t,n),!this.completedExecution&&!this.cell.document.isClosed&&this._onErrorHandlingIOPubMessage.fire(n)}}clearLastUsedStreamOutput(){this.lastUsedStreamOutput=void 0}createTemporaryTask(){var t,n;if(this.cell.document.isClosed)return;let e=NS.get(this.cell.notebook);return e||(this.previousResultsToRestore={...this.cell.executionSummary||{}},this.temporaryExecution=po.getOrCreate(this.cell,this.controller),(t=this.temporaryExecution)==null||t.start(),(n=this.previousResultsToRestore)!=null&&n.executionOrder&&this.temporaryExecution&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution)}endTemporaryTask(){var e,t,n;(e=this.previousResultsToRestore)!=null&&e.executionOrder&&this.execution&&(this.execution.executionOrder=this.previousResultsToRestore.executionOrder),this.previousResultsToRestore&&this.temporaryExecution?(this.previousResultsToRestore.executionOrder&&(this.temporaryExecution.executionOrder=this.previousResultsToRestore.executionOrder),this.temporaryExecution.end(this.previousResultsToRestore.success,(t=this.previousResultsToRestore.timing)==null?void 0:t.endTime)):(n=this.temporaryExecution)==null||n.end(void 0),this.previousResultsToRestore=void 0,this.temporaryExecution=void 0}handleIOPub(e){var n;this.startTime||(this.startTime=new Date().getTime(),(n=this.execution)==null||n.start(this.startTime),b.debug(`Kernel acknowledged execution of cell ${this.cell.index} @ ${this.startTime}`));let t=li();if(t.KernelMessage.isCommOpenMsg(e))this.handleCommOpen(e);else if(t.KernelMessage.isExecuteResultMsg(e))this.handleExecuteResult(e);else if(t.KernelMessage.isExecuteInputMsg(e))this.handleExecuteInput(e);else if(t.KernelMessage.isStatusMsg(e)){let i=e;this.handleStatusMessage(i)}else t.KernelMessage.isStreamMsg(e)?this.handleStreamMessage(e):t.KernelMessage.isDisplayDataMsg(e)?this.handleDisplayData(e):t.KernelMessage.isUpdateDisplayDataMsg(e)?this.handleUpdateDisplayDataMessage(e):t.KernelMessage.isClearOutputMsg(e)?this.handleClearOutput(e):t.KernelMessage.isErrorMsg(e)?this.handleError(e):t.KernelMessage.isCommOpenMsg(e)||(t.KernelMessage.isCommMsgMsg(e)?this.handleCommMsg(e):t.KernelMessage.isCommCloseMsg(e)||b.warn(`Unknown message ${e.header.msg_type} : hasData=${"data"in e.content}`));"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleCommOpen(e){var n;this.ownedCommIds.add(e.content.comm_id);let t=((n=e.content.data)==null?void 0:n.state)||void 0;e.content.target_name===rt.DefaultCommTarget&&t&&t._model_module==="@jupyter-widgets/output"&&this.commIdsMappedToWidgetOutputModels.add(e.content.comm_id)}handleCommMsg(e){let t=e.content.data;if(!(!t||t.method!=="update"||typeof t.state!="object")){if("msg_id"in t.state&&typeof t.state.msg_id=="string"){let n="msg_id"in e.parent_header?e.parent_header:void 0;(this.ownedRequestMsgIds.has(e.content.comm_id)||n&&this.ownedRequestMsgIds.has(n.msg_id))&&(t.state.msg_id?this.outputsAreSpecificToAWidget.push({handlingCommId:e.content.comm_id,msgIdsToSwallow:t.state.msg_id}):this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId===e.content.comm_id&&this.outputsAreSpecificToAWidget.pop())}else if("children"in t.state&&Array.isArray(t.state.children)&&this.ownedCommIds.has(e.content.comm_id)){let n="IPY_MODEL_";t.state.children.forEach(i=>{if(typeof i!="string")return b.warn("Came across a comm update message a child that isn't a string",i);if(!i.startsWith(n))return b.warn(`Came across a comm update message a child that start start with ${n}`,i);let o=i.substring(n.length);this.ownedCommIds.add(o),this.commIdsMappedToParentWidgetModel.set(o,e.content.comm_id)})}}}clearOutputIfNecessary(e){return this.clearOutputOnNextUpdateToOutput?(it(this.cell,"Clear cell output"),this.clearLastUsedStreamOutput(),e==null||e.clearOutput().then(y,y),this.clearOutputOnNextUpdateToOutput=!1,{previousValueOfClearOutputOnNextUpdateToOutput:!0}):{previousValueOfClearOutputOnNextUpdateToOutput:!1}}addToCellData(e,t){var l,c;if(e.data&&typeof e.data=="object"&&yo in e.data){let u=e.data[yo];if(u&&this.context.extensionMode===Mr.ExtensionMode.Test&&(u._vsc_test_cellIndex=this.cell.index),u&&"model_id"in u){let p=vu.modelIdsOwnedByCells.get(this.cell)||new Set;p.add(u.model_id),vu.modelIdsOwnedByCells.set(this.cell,p)}}let n=fs(e),i="transient"in e&&typeof e.transient=="object"&&e.transient&&"display_id"in e.transient&&typeof((l=e.transient)==null?void 0:l.display_id)=="string"?(c=e.transient)==null?void 0:c.display_id:void 0;if(this.cell.document.isClosed)return;it(this.cell,()=>`Update output with mimes ${n.items.map(u=>u.mime).toString()}`);let o=this.execution||this.createTemporaryTask();this.clearOutputIfNecessary(o),i&&un.trackOutputByDisplayId(this.cell,i,n,n.items),this.clearLastUsedStreamOutput(),it(this.cell,"Append output in addToCellData");let s=!0,a=Xd(t);if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a&&n.items.every(u=>this.canMimeTypeBeRenderedByWidgetManager(u)))s=!1;else if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===a){let u=this.updateJupyterOutputWidgetWithOutput({commId:this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId,outputToAppend:n},o);u!=null&&u.outputAdded&&(s=!1)}s&&(o==null||o.appendOutput([n]).then(y,y)),this.endTemporaryTask()}canMimeTypeBeRenderedByWidgetManager(e){let t=e.mime;if(t=="application/vnd.code.notebook.stderr"||t=="application/vnd.code.notebook.stdout"||t=="application/vnd.code.notebook.error")return!0;if(t===yo){let n=JSON.parse(new TextDecoder().decode(e.data));return!(typeof n.model_id=="string"&&this.commIdsMappedToWidgetOutputModels.has(n.model_id))}return!t.startsWith("application/vnd")}updateJupyterOutputWidgetWithOutput(e,t){let n=this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].handlingCommId:void 0,i="commId"in e?e.commId:n;if(!i)return;let o="outputToAppend"in e?e.outputToAppend:void 0,s=this.commIdsMappedToParentWidgetModel.get(i)||i,a=this.cell.notebook.getCells().find(v=>{var S;return(S=vu.modelIdsOwnedByCells.get(v))==null?void 0:S.has(s)});if(!a){b.warn(`Unable to find a cell that owns the model ${s}`);return}let l=a.outputs.find(v=>v.items.find(S=>{if(S.mime!==yo)return!1;try{return JSON.parse(new TextDecoder().decode(S.data)).model_id===s}catch(_){b.warn("Failed to deserialize the widget data",_)}return!1}));if(!l)return;let c=vu.outputsOwnedByWidgetModel.get(s)||new Set,p=("clearOutput"in e?e.clearOutput:!1)||(this.outputsAreSpecificToAWidget.length?this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput===!0:!1);this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!1);let f=a.outputs.slice().filter(v=>p?!c.has(v.id):!0),m=f.slice(0,f.indexOf(l)+1),h=f.slice(f.indexOf(l)+1);vu.outputsOwnedByWidgetModel.set(s,c),o&&c.add(o.id);let g=o?m.concat(o).concat(h):m.concat(h);return h.length===0&&o?t==null||t.appendOutput(o,a).then(y,y):p&&!o&&h.length===0||t==null||t.replaceOutput(g,a).then(y,y),{outputAdded:!0}}async handleInputRequest(e){if(e.content&&"prompt"in e.content){let t=new Mr.CancellationTokenSource;this.prompts.add(t);let n=e.content.password!==null&&e.content.password;await Mr.window.showInputBox({prompt:e.content.prompt?e.content.prompt.toString():"",ignoreFocusOut:!0,password:n},t.token).then(i=>{this.kernel.sendInputReply({value:i||"",status:"ok"})},y),this.prompts.delete(t)}}handleExecuteResult(e){this.addToCellData({output_type:"execute_result",data:e.content.data,metadata:e.content.metadata,transient:e.content.transient,execution_count:e.content.execution_count},e)}handleExecuteReply(e){let t=e.content;t.payload&&t.payload.forEach(n=>{n.source&&n.source==="set_next_input"&&"text"in n&&"replace"in n&&this.handleSetNextInput(n),n.data&&n.data.hasOwnProperty("text/plain")&&this.addToCellData({output_type:"stream",text:n.data["text/plain"].toString(),name:"stdout",metadata:{},execution_count:t.execution_count},e)})}handleSetNextInput(e){let t=new Mr.WorkspaceEdit;if(e.replace)t.replace(this.cell.document.uri,new Mr.Range(this.cell.document.lineAt(0).range.start,this.cell.document.lineAt(this.cell.document.lineCount-1).range.end),e.text);else{it(this.cell,"Create new cell after current");let n=new Mr.NotebookCellData(Mr.NotebookCellKind.Code,e.text,this.cell.document.languageId);n.outputs=[],n.metadata={};let i=Mr.NotebookEdit.insertCells(this.cell.index+1,[n]);t.set(this.cell.notebook.uri,[i])}Mr.workspace.applyEdit(t).then(y,y)}handleExecuteInput(e){e.content.execution_count&&this.execution&&(this.execution.executionOrder=e.content.execution_count)}handleStatusMessage(e){it(this.cell,`Kernel switching to ${e.content.execution_state}`)}handleStreamMessage(e){var o;if(Xd(e)&&this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow==Xd(e))return;it(this.cell,`Update streamed output, new output '${e.content.text.substring(0,100)}'`);let t=this.execution||this.createTemporaryTask(),n=e.content.name==="stdout"?Mr.NotebookCellOutputItem.stdout("").mime:Mr.NotebookCellOutputItem.stderr("").mime;!this.request&&!this.streamsReAttachedToExecutingCell&&!this.lastUsedStreamOutput&&this.cell.outputs.length&&this.cell.outputs[this.cell.outputs.length-1].items.length>=1&&this.cell.outputs[this.cell.outputs.length-1].items.every(s=>s.mime===n)&&(this.lastUsedStreamOutput={output:this.cell.outputs[0],stream:e.content.name}),this.streamsReAttachedToExecutingCell=!0;let{previousValueOfClearOutputOnNextUpdateToOutput:i}=this.clearOutputIfNecessary(t);if(((o=this.lastUsedStreamOutput)==null?void 0:o.stream)===e.content.name){let s=fs({output_type:"stream",name:e.content.name,text:e.content.text});it(this.cell,`Append output items '${e.content.text.substring(0,100)}`),t==null||t.appendOutputItems(s.items,this.lastUsedStreamOutput.output).then(y,y)}else if(i){let s=jc(e.content.text),a=fs({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Replace output with '${s.substring(0,100)}'`),t==null||t.replaceOutput([a]).then(y,y)}else{let s=ZG(jc(e.content.text)),a=fs({output_type:"stream",name:e.content.name,text:s});this.lastUsedStreamOutput={output:a,stream:e.content.name},it(this.cell,`Append new output '${s.substring(0,100)}'`),t==null||t.appendOutput([a]).then(y,y)}this.endTemporaryTask()}handleDisplayData(e){let t={output_type:"display_data",data:jx(e.content.data),metadata:e.content.metadata,transient:e.content.transient};this.addToCellData(t,e)}handleClearOutput(e){if(this.outputsAreSpecificToAWidget.length&&this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].msgIdsToSwallow===Xd(e)){if(e.content.wait)this.outputsAreSpecificToAWidget.length&&(this.outputsAreSpecificToAWidget[this.outputsAreSpecificToAWidget.length-1].clearOutputOnNextUpdateToOutput=!0);else{let t=this.execution||this.createTemporaryTask();this.updateJupyterOutputWidgetWithOutput({clearOutput:!0},t),this.endTemporaryTask()}return}if(e.content.wait)this.clearOutputOnNextUpdateToOutput=!0;else{let t=this.execution||this.createTemporaryTask();this.clearLastUsedStreamOutput(),t==null||t.clearOutput().then(y,y),this.endTemporaryTask()}}handleError(e){let t=e.content.traceback;b.ci(`Traceback for error ${t}`),this.formatters.forEach(i=>{t=i.format(this.cell,t)}),b.ci(`Traceback for error after formatting ${t}`);let n={output_type:"error",ename:e.content.ename,evalue:e.content.evalue,traceback:t};if(this.cell.notebook.notebookType!=="interactive"){let i=po.get(this.cell);i&&e.content.ename!=="KeyboardInterrupt"&&(i.errorInfo={message:`${e.content.ename}: ${e.content.evalue}`,location:pz(e.content.traceback,this.cell),uri:this.cell.document.uri,stack:e.content.traceback.join(`
`)})}this.addToCellData(n,e),this.cellHasErrorsInOutput=!0}handleReply(e){li().KernelMessage.isExecuteReplyMsg(e)&&(this.handleExecuteReply(e),"execution_count"in e.content&&typeof e.content.execution_count=="number"&&this.execution&&(this.execution.executionOrder=e.content.execution_count))}handleUpdateDisplayDataMessage(e){let t=e.content.transient.display_id;if(!t){b.warn("Update display data message received, but no display id",e.content);return}let n=un.getMappedOutput(this.cell.notebook,t);if(!n){b.trace("Update display data message received, but no output found to update",e.content);return}if(n.cell.document.isClosed){b.warn("Update display data message received, but output cell is closed",e.content);return}let i=KV(new Mr.NotebookCellOutput(n.outputItems,n.outputContainer.metadata)),o=fs({...i,data:e.content.data,metadata:e.content.metadata});if(n.outputItems.length===0&&o.items.length===0){b.trace("Update display data message received, but no output to update",e.content);return}let s=!1;if(n.outputItems.length===o.items.length){let l=!0;if((0,Qj.default)(n.outputContainer.metadata||{},o.metadata||{})||(s=!0,l=!1),l){for(let c=0;c<n.outputItems.length;c++)if(!(0,Qj.default)(n.outputItems[c],o.items[c])){l=!1;break}}if(l){b.trace("Update display data message received, but no output to update (data is the same)",e.content);return}}let a=this.execution||this.createTemporaryTask();if(it(this.cell,`Replace output items in display data ${o.items.length}`),s){let l=n.cell.outputs.map(c=>{let u=KV(c);return u.output_type==="display_data"&&"transient"in u&&u.transient&&typeof u.transient=="object"&&"display_id"in u.transient&&typeof u.transient.display_id=="string"&&u.transient.display_id===t?o:c});a==null||a.replaceOutput(l,n.cell).then(y,y),un.trackOutputByDisplayId(n.cell,t,o,o.items)}else a==null||a.replaceOutputItems(o.items,n.outputContainer).then(y,y),un.trackOutputByDisplayId(n.cell,t,n.outputContainer,o.items);this.endTemporaryTask()}};vu.modelIdsOwnedByCells=new WeakMap,vu.outputsOwnedByWidgetModel=new Map,E([In()],vu.prototype,"handleReply",1);var gD=vu;d();var hm=class extends Error{constructor(t){super(t.evalue||t.ename);this.ename=t.ename,this.evalue=t.evalue,this.traceback=t.traceback}};var kA=class{constructor(e,t){this.controller=e;this.requestListener=t}create(e,t,n,i){return Zj.fromCell(e,t,n,this.controller,this.requestListener,i)}},Zj=class r{constructor(e,t,n,i,o,s){this.cell=e;this.codeOverride=t;this.kernelConnection=n;this.controller=i;this.requestListener=o;this.resumeExecution=s;this.type="cell";this._result=ke();this.cancelHandled=!1;this.disposables=[];if(Xj.workspace.onDidCloseTextDocument(a=>{var l;if(a===this.cell.document){b.info(`Disposing request as the cell (${this.cell.index}) was deleted ${ye(this.cell.notebook.uri)}`);try{(l=this.request)==null||l.dispose()}catch(c){b.error(`Error during cell execution dispose: ${c}`)}this.started&&!this._completed&&this.completedDueToCancellation()}},this,this.disposables),this.canExecuteCell())this.execution=po.getOrCreate(e,this.controller,!(s!=null&&s.msg_id)),Gf.setCellState(e,2);else{let a=po.get(e);a&&(a.start(),a.end(void 0))}}get result(){return this._result.promise}get executionOrder(){return this._executionOrder}static fromCell(e,t,n,i,o,s){return new r(e,t,n,i,o,s)}async start(e){var t,n,i,o;if(this.session=e,(t=this.resumeExecution)!=null&&t.msg_id)return this.resume(e,this.resumeExecution);if(this.cancelHandled){it(this.cell,"Not starting as it was cancelled");return}if(it(this.cell,"Start execution"),b.ci(`Cell Exec contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return e.kind==="remoteJupyter"&&e.status==="unknown"&&(!e.kernel||e.kernel.isDisposed||e.isDisposed)?((i=this.execution)==null||i.start(),(o=this.execution)==null||o.clearOutput().then(y,y),this.completedWithErrors(new nn),this.result):this.started?(it(this.cell,"Cell has already been started yet CellExecution.Start invoked again"),b.error(`Cell has already been started yet CellExecution.Start invoked again ${this.cell.index}`),this.result):(this.started=!0,NS.set(this.cell.notebook,this.execution),Gf.setCellState(this.cell,3),this.execute(this.codeOverride||this.cell.document.getText().replace(/\r\n/g,`
`),e).catch(s=>this.completedWithErrors(s)).catch(y),this.result)}async resume(e,t){var n,i;if(this.cancelHandled){it(this.cell,"Not resuming as it was cancelled");return}if(!e.kernel)throw new Error("Kernel not available to resume execution");if(it(this.cell,"Start resuming execution"),b.ci(`Cell Exec (resuming) contents ${this.cell.document.getText().substring(0,50)}...`),!this.canExecuteCell()){(n=this.execution)==null||n.end(void 0),this.execution=void 0,this._result.resolve();return}return this.started?(b.error(`Cell has already been started yet CellExecution.resume invoked again ${this.cell.index}`),this.result):(this.started=!0,NS.set(this.cell.notebook,this.execution),(i=this.execution)==null||i.start(t.startTime),t.executionCount&&this.execution&&(this.execution.executionOrder=t.executionCount),Gf.setCellState(this.cell,3),this.cellExecutionHandler=this.requestListener.registerListenerForResumingExecution(this.cell,{kernel:e.kernel,cellExecution:this.execution,msg_id:t.msg_id}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(o=>{b.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,o),this.completedWithErrors(o.error)},this,this.disposables),this.cellExecutionHandler.completed.finally(()=>this.completedSuccessfully()).catch(y),this.result)}async cancel(e=!1){var t;if(!this.cancelHandled){if(this.cancelRequested=!0,this.started&&!e&&((t=this.execution)!=null&&t.started)){it(this.cell,"Cell is already running, waiting for it to finish or kernel to start"),await this.result.catch(y);return}this.cancelHandled||this._completed||(it(this.cell,"Execution cancelled"),this.cancelHandled=!0,this.completedDueToCancellation(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,it(this.cell,"Execution disposed"),me(this.disposables))}completedWithErrors(e,t,n=!0){var i,o;if(!this.cancelHandled){if(!this.disposed&&!this.cancelRequested?b.warn("Cell completed with errors",e):b.warn(`Cell completed with errors (${this.disposed?"disposed":"cancelled"})`),it(this.cell,"Completed with errors"),n){let s,a;if(e&&!(e instanceof ot)&&((i=e.message)!=null&&i.includes("Canceled future for execute_request message before replies were done"))&&this.session&&sZ(this.session)&&(e=new nn),e)if(!(e instanceof ot))s=e.message||e.name||e.stack;else{let l=Jm(Xj.workspace.workspaceFolders||[],e,ut(this.kernelConnection),y7(this.kernelConnection.interpreter));s=l==null?void 0:l.message}a=Sy(s||""),a&&((o=this.execution)==null||o.appendOutput(a).then(y,y))}this.endCellTask("failed",t),it(this.cell,"Completed with errors, & resolving"),this._result.reject(e)}}get isEmptyCodeCell(){return this.cell.document.getText().trim().length===0}completedSuccessfully(e){it(this.cell,"Completed successfully");let t="success";this.endCellTask("success",e),it(this.cell,`Completed successfully & resolving with status = ${t}`),this._result.resolve()}endCellTask(e,t=new Date().getTime()){var n,i,o,s,a;if(!this._completed){if(this._completed=!0,this.isEmptyCodeCell)this.execution&&(this.execution.executionOrder=void 0),(n=this.execution)==null||n.end(void 0);else if(e==="success"||e==="failed")this.endTime=t,(i=this.execution)==null||i.end(e==="success",this.endTime);else{try{(o=this.request)==null||o.dispose()}catch(l){}(s=this.execution)==null||s.end(void 0)}NS.get(this.cell.notebook)===this.execution&&NS.set(this.cell.notebook,void 0),this._executionOrder=(a=this.execution)==null?void 0:a.executionOrder,Gf.setCellState(this.cell,1),this.execution=void 0}}completedDueToCancellation(){it(this.cell,"Completed due to cancellation"),this.endCellTask("cancelled"),it(this.cell,"Cell cancelled & resolving"),this._result.resolve()}canExecuteCell(){return this.cell.document.languageId==="raw"?!1:!this.cell.document.isClosed}async execute(e,t){var o,s,a,l;if(!t.kernel)throw new Error("No kernel available to execute code");if(it(this.cell,"Send code for execution"),e.trim().length===0||this.cell.document.isClosed)return e.trim().length===0&&((s=this.execution)==null||s.start((o=this.resumeExecution)==null?void 0:o.startTime),(l=(a=this.execution)==null?void 0:a.clearOutput())==null||l.then(y,y)),it(this.cell,"Empty cell execution"),this.completedSuccessfully();let n={cellId:this.cell.document.uri.toString(),...Lf(this.cell).metadata},i=t.kernel;try{Lr.changeCellState(this.cell,3),b.trace(`Cell Index:${this.cell.index} sent to kernel`),this.request=i.requestExecute({code:e,silent:!1,stop_on_error:!1,allow_stdin:!0,store_history:!0},!1,n),this.request.done.then(y,y)}catch(c){return b.error(`Cell execution failed without request, for cell Index ${this.cell.index}`,c),this.completedWithErrors(c)}this.cellExecutionHandler=this.requestListener.registerListenerForExecution(this.cell,{kernel:i,cellExecution:this.execution,request:this.request}),this.cellExecutionHandler.onErrorHandlingExecuteRequestIOPubMessage(c=>{b.error(`Cell (index = ${this.cell.index}) execution completed with errors (2).`,c),this.completedWithErrors(c.error)},this,this.disposables);try{it(this.cell,"Wait for jupyter execution");let c=await this.request.done,u=new Date().getTime();it(this.cell,"Jupyter execution completed"),c.content.status==="error"?this.completedWithErrors(new hm(c.content),u,!1):this.completedSuccessfully(u),it(this.cell,"Executed successfully in executeCell")}catch(c){if(this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&b.error("Error in waiting for cell to complete",c),it(this.cell,"Some other execution error"),c&&c instanceof Error&&xi(c,!0)?this.completedWithErrors({message:c.message}):this.completedWithErrors(c)}}};d();var lZ=require("vscode");var NA=class{constructor(e,t,n,i){this.controller=e;this.context=t;this.formatters=n;this.notebook=i;this.disposables=[];this.messageHandlers=new WeakMap;lZ.workspace.onDidChangeNotebookDocument(o=>{o.notebook===this.notebook&&o.contentChanges.forEach(s=>s.removedCells.forEach(a=>{var l;return(l=this.messageHandlers.get(a))==null?void 0:l.dispose()}))},this,this.disposables)}dispose(){me(this.disposables),this.notebook&&this.notebook.getCells().forEach(e=>{var t;return(t=this.messageHandlers.get(e))==null?void 0:t.dispose()})}registerListenerForExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new gD(e,this.controller,this.context,this.formatters,t.kernel,t.request,t.cellExecution,t.request.msg.header.msg_id);return this.messageHandlers.set(e,n),n}registerListenerForResumingExecution(e,t){var i;(i=this.messageHandlers.get(e))==null||i.dispose();let n=new gD(e,this.controller,this.context,this.formatters,t.kernel,void 0,t.cellExecution,t.msg_id);return this.messageHandlers.set(e,n),n}};d();d();var RA=require("vscode");function yu(r,e,t){r!==Ye&&b.trace(`Execution Id:${e}. ${t}.`)}var cZ=new Map,RS=class r{constructor(e,t){this.code=e;this.extensionId=t;this.type="code";this._onDidEmitOutput=new RA.EventEmitter;this.onDidEmitOutput=this._onDidEmitOutput.event;this._onRequestSent=new RA.EventEmitter;this.onRequestSent=this._onRequestSent.event;this._onRequestAcknowledge=new RA.EventEmitter;this.onRequestAcknowledged=this._onRequestAcknowledge.event;this._done=ke();this.cancelHandled=!1;this.disposables=[];let n=cZ.get(t)||0;n+=1,cZ.set(t,n),this.executionId=`${t}-${n}`,this.disposables.push(this._onDidEmitOutput)}get done(){return this._done.promise}get result(){return this._done.promise}static fromCode(e,t){return new r(e,t)}async start(e){if(this.session=e,this.cancelHandled){yu(this.extensionId,this.executionId,"Not starting as it was cancelled");return}if(yu(this.extensionId,this.executionId,"Start Code execution"),b.ci(`Code Exec contents ${this.code.substring(0,50)}...`),!e.kernel||e.kernel.isDisposed||e.isDisposed){this._done.reject(new nn);return}if(this.started)return yu(this.extensionId,this.executionId,"Code has already been started yet CodeExecution.Start invoked again"),b.error(`Code has already been started yet CodeExecution.Start invoked again ${this.executionId}`),this.done;await this.execute(this.code.replace(/\r\n/g,`
`),e).catch(y)}async cancel(){var e,t,n;if(!(this.cancelHandled||this._completed)){if(this.cancelRequested=!0,this.started){yu(this.extensionId,this.executionId,"Code is already running, interrupting and waiting for it to finish or kernel to start");let i=(e=this.session)==null?void 0:e.kernel;i&&this.extensionId!==Ye&&await i.interrupt().catch(y),(t=this.request)==null||t.dispose(),await((n=this.request)==null?void 0:n.done.catch(y))}this.cancelHandled||this._completed||(yu(this.extensionId,this.executionId,"Execution cancelled"),this.cancelHandled=!0,this._done.resolve(),this.dispose())}}dispose(){this.disposed||(this.disposed=!0,this._completed||yu(this.extensionId,this.executionId,"Execution disposed"),me(this.disposables))}async execute(e,t){if(!t.kernel){let i=new Error("No kernel available to execute code");throw this._done.resolve(),i}yu(this.extensionId,this.executionId,"Send code for execution");let n=t.kernel;try{this.started=!0,this._onRequestSent.fire(),yu(this.extensionId,this.executionId,"Execution Request Sent to Kernel"),this.request=Iz(n,e,()=>this._onRequestAcknowledge.fire(),i=>this._onDidEmitOutput.fire(i)),this.request.done.then(y,y)}catch(i){b.error(`Code execution failed without request, for exec ${this.executionId}`,i),this._completed=!0,this._done.reject(i);return}try{let i=await this.request.done;this._completed=!0,i.content.status==="error"?(yu(this.extensionId,this.executionId,"Executed with errors"),this._done.reject(new hm(i.content))):(yu(this.extensionId,this.executionId,"Executed successfully"),this._done.resolve())}catch(i){if(this._completed=!0,this.cancelHandled)return;!this.disposed&&!this.cancelRequested&&b.error(`Error in waiting for code ${this.executionId} to complete`,i),this._done.reject(i)}}};var AA=class{constructor(e,t,n,i){this.session=e;this.executionFactory=t;this.metadata=n;this.resourceUri=i;this.queueOfItemsToExecute=[];this.cancelledOrCompletedWithErrors=!1;this.startedRunningCells=!1;this.disposables=[]}get queueOfCellsToExecute(){return this.queueOfItemsToExecute.filter(e=>e.type==="cell").map(e=>e)}get isEmpty(){return this.queueOfItemsToExecute.length===0}get failed(){return this.cancelledOrCompletedWithErrors}get queue(){return this.queueOfCellsToExecute.map(e=>e.cell)}dispose(){var e;this.disposables.forEach(t=>t.dispose()),(e=this.lastCellExecution)==null||e.dispose()}queueCell(e,t){this.enqueue({cell:e,codeOverride:t})}queueCode(e,t,n){return this.enqueue({code:e,extensionId:t,token:n})}enqueue(e){let t;if("cell"in e){let{cell:n,codeOverride:i}=e,o=this.queueOfCellsToExecute.find(a=>a.cell===n);if(o)return it(n,"Use existing cell execution"),o;let s=this.executionFactory.create(n,i,this.metadata);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),it(n,"User queued cell for execution")}else{let{code:n,extensionId:i,token:o}=e,s=RS.fromCode(n,i);t=s,this.disposables.push(s),this.queueOfItemsToExecute.push(s),this.disposables.push(Mg(o.onCancellationRequested)(()=>s.cancel()))}return this.startExecutingCells(),t}resumeCell(e,t){if(this.queueOfCellsToExecute.find(o=>o.cell===e)){it(e,"Use existing cell execution");return}let i=this.executionFactory.create(e,"",this.metadata,t);this.disposables.push(i),this.queueOfItemsToExecute.push(i),it(e,"User queued cell for execution"),this.startExecutingCells()}async cancel(e){var t;this.cancelledOrCompletedWithErrors=!0,b.debug("Cancel pending cells"),await Promise.all(this.queueOfItemsToExecute.map(n=>n.cancel(e))),(t=this.lastCellExecution)==null||t.dispose(),this.queueOfItemsToExecute.splice(0,this.queueOfItemsToExecute.length)}async cancelQueuedCells(){var e,t;this.cancelledOrCompletedWithErrors=!0,b.debug("Cancel pending cells"),await Promise.all(this.queueOfCellsToExecute.map(n=>n.cancel())),((e=this.lastCellExecution)==null?void 0:e.type)==="cell"&&((t=this.lastCellExecution)==null||t.dispose()),this.queueOfItemsToExecute.push(...this.queueOfItemsToExecute.filter(n=>n.type==="code"))}async waitForCompletion(e){let t=e?this.queueOfCellsToExecute.filter(n=>e===n.cell):this.queueOfItemsToExecute;await Promise.all(t.map(n=>n.result))}startExecutingCells(){this.startedRunningCells||this.start().catch(y),this.startedRunningCells=!0}async start(){try{await this.executeQueuedCells()}catch(e){b.error("Failed to execute cells in CellExecutionQueue",e),this.cancelledOrCompletedWithErrors=!0,await this.cancelQueuedCells()}}async executeQueuedCells(){var n,i,o;let e,t=await this.session;for(this.queueOfItemsToExecute.forEach(s=>s.type==="cell"&&it(s.cell,"Ready to execute"));this.queueOfItemsToExecute.length;){(n=this.lastCellExecution)==null||n.dispose();let s=this.queueOfItemsToExecute[0];this.lastCellExecution=s,s.type==="cell"&&it(s.cell,"Before Execute individual cell");let a=!0;try{s.type==="cell"&&s.cell.notebook.isClosed?e=!0:s.type==="cell"&&this.cancelledOrCompletedWithErrors||(a=await s.start(t).then(()=>!0).catch(()=>!1))}finally{s.type==="cell"&&it(s.cell,`After Execute individual cell ${a}`);let c=this.queueOfItemsToExecute.indexOf(s);c>=0&&this.queueOfItemsToExecute.splice(c,1),s.type==="cell"&&Lr.changeCellState(s.cell,1,s.executionOrder)}let l=!1;if(s.type==="cell"&&((o=(i=Lf(s.cell).metadata)==null?void 0:i.tags)!=null&&o.includes("raises-exception"))&&(l=!0),e||this.cancelledOrCompletedWithErrors||!a&&!l){this.cancelledOrCompletedWithErrors=!0;let c=[];if(this.cancelledOrCompletedWithErrors&&c.push("cancellation or failure in execution"),e&&c.push("Notebook being closed"),typeof a=="number"&&!a&&c.push("failure in cell execution"),c.length===0&&c.push("an unknown reason"),this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length===this.queueOfItemsToExecute.length){b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}else if(this.queueOfCellsToExecute.length>0&&this.queueOfCellsToExecute.length!==this.queueOfItemsToExecute.length)b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancelQueuedCells();else if(e){b.warn(`Cancel all remaining cells due to ${c.join(" or ")}`),await this.cancel();break}}if(t.status==="dead"||t.status==="terminating"){this.cancelledOrCompletedWithErrors=!0,b.warn("Cancel all remaining cells due to dead kernel"),await this.cancel();break}}}};var MA=class{constructor(e,t,n,i){this.kernel=e;this.notebook=i;this.disposables=[];this._visibleExecutionCount=0;this.documentExecutions=new WeakMap;this._onDidReceiveDisplayUpdate=new sv.EventEmitter;this.onDidReceiveDisplayUpdate=this._onDidReceiveDisplayUpdate.event;this.hookedSesions=new WeakSet;let o=new NA(e.controller,t,n,i);this.disposables.push(o),this.executionFactory=new kA(e.controller,o),Lr.onDidChangeNotebookCellExecutionState(s=>{var a;s.cell.notebook===e.notebook&&s.state===1&&((a=s.cell.executionSummary)!=null&&a.executionOrder)&&(this._visibleExecutionCount=Math.max(this._visibleExecutionCount,s.cell.executionSummary.executionOrder))}),e.onRestarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.onStarted(()=>this._visibleExecutionCount=0,this,this.disposables),e.addHook("willInterrupt",this.onWillInterrupt,this,this.disposables),e.addHook("willCancel",this.onWillCancel,this,this.disposables),e.addHook("willRestart",s=>this.onWillRestart(s),this,this.disposables),e.onStatusChanged(this.hookupIOPubHandler,this,this.disposables),e.onRestarted(this.hookupIOPubHandler,this,this.disposables),this.hookupIOPubHandler()}get executionCount(){return this._visibleExecutionCount}hookupIOPubHandler(){let e=this.kernel.session;if(!e||this.hookedSesions.has(e))return;this.hookedSesions.add(e);let t=(n,i)=>{var l;if(i.header.msg_type!=="update_display_data"&&i.header.msg_type!=="display_data")return;let o=i,s=(l=o.content.transient)==null?void 0:l.display_id;if(!s||!Ez(e,s))return;let a=fs({output_type:"display_data",data:o.content.data,metadata:o.content.metadata,transient:o.content.transient});this._onDidReceiveDisplayUpdate.fire(a)};e.iopubMessage.connect(t),this.disposables.push({dispose:()=>{e==null||e.iopubMessage.disconnect(t)}})}get pendingCells(){var e;return((e=this.documentExecutions.get(this.notebook))==null?void 0:e.queue)||[]}async resumeCellExecution(e,t){if(it(e,`NotebookKernelExecution.resumeCellExecution (start), ${ye(e.notebook.uri)}`),e.kind==sv.NotebookCellKind.Markup)return;await Ra(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata),Yr(this.kernel.resourceUri,"DATASCIENCE.RESUME_EXECUTE_CELL");let n=this.kernel.start(new Ir(!1)),i=this.getOrCreateCellExecutionQueue(e.notebook,n);i.resumeCell(e,t);let o=await i.waitForCompletion(e).then(()=>!0).catch(()=>!1);it(e,`NotebookKernelExecution.resumeCellExecution (completed), ${ye(e.notebook.uri)}`),b.trace(`Cell ${e.index} executed ${o?"successfully":"with an error"}`)}async executeCell(e,t){it(e,`NotebookKernelExecution.executeCell (1), ${ye(e.notebook.uri)}`);let n=new St;if(e.kind==sv.NotebookCellKind.Markup)return;it(e,`NotebookKernelExecution.executeCell, ${ye(e.notebook.uri)}`),await Ra(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let i=this.kernel.start(new Ir(!1));await this.kernel.restarting,it(e,`NotebookKernelExecution.executeCell (2), ${ye(e.notebook.uri)}`);let o=this.getOrCreateCellExecutionQueue(e.notebook,i);o.queueCell(e,t);let s=!0;try{await o.waitForCompletion(e)}catch(a){throw s=!1,a}finally{it(e,`NotebookKernelExecution.executeCell completed (3), ${ye(e.notebook.uri)}`),b.trace(`Cell ${e.index} executed ${s?"successfully":"with an error"}`),Yr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CELL",{duration:n.elapsedTime})}}async*executeCode(e,t,n,i){let o=new St;await Ra(this.kernel.resourceUri,this.kernel.kernelConnectionMetadata);let s=this.kernel.start(new Ir(!1));await this.kernel.restarting;let a=this.getOrCreateCellExecutionQueue(this.notebook,s),l;t===Ye?(l=RS.fromCode(e,t),s.then(h=>l.start(h))):l=a.queueCode(e,t,i),t!==Ye&&b.trace(`Queue code ${l.executionId} from ${t} after ${o.elapsedTime}ms:
${e}`);let c=!1,u=[];l.result.finally(()=>{c=!0,!i.isCancellationRequested&&b.debug(`Execution of code ${l.executionId} completed in ${o.elapsedTime}ms`),t!==Ye&&Yr(this.kernel.resourceUri,"DATASCIENCE.EXECUTE_CODE",{duration:o.elapsedTime},{extensionId:t}),me(u)}).catch(y);let p=Fu(l.result),f=[],m=ke();for(u.push(l.onRequestSent(()=>n.started.fire())),u.push(l.onRequestAcknowledged(()=>n.executionAcknowledged.fire())),l.onDidEmitOutput(h=>{f.push(h),m.resolve(),m=ke()},this,u),i.onCancellationRequested(()=>{c||b.debug(`Code execution cancelled by extension ${t}`)},this,u);;){await Promise.race([m.promise,p.promise]),c&&(m=ke());let h=this.kernel.session;for(;f.length;){let g=f.shift();h&&ZR(t,h,g),yield g}if(p.completed)break}}executeHidden(e){return this.kernel.start().then(n=>n.kernel?Vi(n.kernel,e):Promise.reject(new nn))}async onWillInterrupt(){let e=this.documentExecutions.get(this.notebook);!e&&this.kernel.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||(b.info("Interrupt kernel execution"),e&&(await e.cancel(),await e.waitForCompletion().catch(y)))}async onWillCancel(){let e=this.documentExecutions.get(this.notebook);e&&await e.cancel(!0)}async onWillRestart(e){let t=this.documentExecutions.get(this.notebook),n=e?await e.catch(()=>{}):void 0,i=t?t.cancel(!0).then(()=>t.waitForCompletion().catch(y)):Promise.resolve();n||(b.info("No kernel session to interrupt"),await i)}getOrCreateCellExecutionQueue(e,t){let n=this.documentExecutions.get(e);if(n&&!n.isEmpty&&!n.failed)return n;let i=new AA(t,this.executionFactory,this.kernel.kernelConnectionMetadata,this.kernel.resourceUri);return this.disposables.push(i),sv.workspace.onDidCloseNotebookDocument(async o=>{o===e&&(b.debug(`Cancel executions after closing notebook ${ye(o.uri)}`),(!i.failed||!i.isEmpty)&&await i.cancel(!0))},this,this.disposables),this.documentExecutions.set(e,i),i}};var AS=class extends IA{constructor(t,n,i,o,s,a,l,c,u){super(t,n);this.sessionCreator=i;this.configService=o;this.context=s;this.formatters=l;this.startupCodeProviders=c;this.workspaceStorage=u;n.push(a.onDidRemove(this.handleServerRemoval.bind(this)))}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=(t==null?void 0:t.notebookType)===vt?n.resourceUri:t.uri,s=zj(this.configService,o),a=t.uri.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?vt:It,l=new xA(o,t,n.metadata,this.sessionCreator,s,n.controller,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(u=>this._onKernelStatusChanged.fire({kernel:l,status:u}),this,this.disposables),this.executions.set(l,new MA(l,this.context,this.formatters,t)),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(l),l}};AS=E([(0,yn.injectable)(),I(0,(0,yn.inject)(Ya)),I(1,(0,yn.inject)(ie)),I(2,(0,yn.inject)(Vx)),I(3,(0,yn.inject)(Me)),I(4,(0,yn.inject)(st)),I(5,(0,yn.inject)(hr)),I(6,(0,yn.multiInject)(wI)),I(7,(0,yn.inject)(Ud)),I(8,(0,yn.inject)(_t)),I(8,(0,yn.named)(Cs))],AS);var MS=class extends SA{constructor(t,n,i,o,s,a){super(t,n);this.sessionCreator=i;this.configService=o;this.startupCodeProviders=s;this.workspaceStorage=a}getOrCreate(t,n){var c;let i=this.getInternal(t);if(i&&i.options.metadata.id===n.metadata.id)return i.kernel;this.disposeOldKernel(t);let o=t,s=zj(this.configService,o),a=t.path.endsWith(".interactive")||(c=n.resourceUri)!=null&&c.path.endsWith(".interactive")?vt:It,l=new wA(t,o,n.metadata,this.sessionCreator,s,this.startupCodeProviders.getProviders(a),this.workspaceStorage);return l.onRestarted(()=>this._onDidRestartKernel.fire(l),this,this.disposables),l.onDisposed(()=>this._onDidDisposeKernel.fire(l),this,this.disposables),l.onStarted(()=>this._onDidStartKernel.fire(l),this,this.disposables),l.onStatusChanged(u=>this._onKernelStatusChanged.fire({kernel:l,status:u}),this,this.disposables),this.asyncDisposables.push(l),this.storeKernel(t,n,l),this.deleteMappingIfKernelIsDisposed(t,l),l}};MS=E([(0,yn.injectable)(),I(0,(0,yn.inject)(Ya)),I(1,(0,yn.inject)(ie)),I(2,(0,yn.inject)(Vx)),I(3,(0,yn.inject)(Me)),I(4,(0,yn.inject)(Ud)),I(5,(0,yn.inject)(_t)),I(5,(0,yn.named)(Cs))],MS);d();var OA=$(te()),LS=require("vscode");var OS=class extends Vr{constructor(t){super();this._onDidChangeRegistrations=this._register(new LS.EventEmitter);this.onDidChangeRegistrations=this._onDidChangeRegistrations.event;this._finders=[];this.connectionFinderMapping=new Map;this._onDidChangeKernels=this._register(new LS.EventEmitter);this.onDidChangeKernels=this._onDidChangeKernels.event;this._status="idle";this._onDidChangeStatus=this._register(new LS.EventEmitter);t.push(this),this._register(this._onDidChangeStatus),this._register(this._onDidChangeRegistrations)}get status(){return this._status}set status(t){this._status!=t&&(this._status=t,this._onDidChangeStatus.fire())}get onDidChangeStatus(){return this._onDidChangeStatus.event}registerKernelFinder(t){this._finders.push(t);let n=()=>{this.status=this._finders.every(s=>s.status==="idle")?"idle":"discovering"};n();let i=this._register(new kn),o=()=>{let s=this._finders.findIndex(a=>a===t);s>=0&&this._finders.splice(s,1),i.dispose(),n(),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[],removed:[t]})};return i.add(t.onDidChangeStatus(n,this)),i.add(t.onDidChangeKernels(()=>this._onDidChangeKernels.fire())),i.add(t.onDidDispose(()=>o())),this._onDidChangeKernels.fire(),this._onDidChangeRegistrations.fire({added:[t],removed:[]}),new LS.Disposable(()=>o())}get kernels(){let t=[];this.connectionFinderMapping.clear();let n=new Set;this._finders.filter(o=>o.kind==="localPythonEnvironment").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.add(s.kernelSpec.specFile),t.push(s),this.connectionFinderMapping.set(s.id,o)})}),this._finders.filter(o=>o.kind==="localKernelSpec").forEach(o=>{o.kernels.forEach(s=>{(s.kind==="startUsingLocalKernelSpec"||s.kind==="startUsingPythonInterpreter")&&s.kernelSpec.specFile&&n.has(s.kernelSpec.specFile)||(t.push(s),this.connectionFinderMapping.set(s.id,o))})});let i=this._finders.filter(o=>o.kind==="remote");for(let o of i){let s=o.kernels;s.forEach(a=>{this.connectionFinderMapping.set(a.id,o)}),t.push(...s)}return t}getFinderForConnection(t){return this.connectionFinderMapping.get(t.id)}get registered(){return this._finders}};OS=E([(0,OA.injectable)(),I(0,(0,OA.inject)(ie))],OS);d();var av=$(te());var e9="Active_Kernel_Id_List",X_e=100,Js=class{constructor(e,t){this.globalMemento=e;this.crypto=t}async getPreferredRemoteKernelId(e){let t=this.globalMemento.get(e9,[]);if(t.length){let n=e.uri,i=await this.crypto.createHash(n.toString()),o=t.find(s=>s.fileHash===i);return b.trace(`Preferred Remote kernel for ${ye(n)} is ${o==null?void 0:o.kernelId}`),o==null?void 0:o.kernelId}}async clearPreferredRemoteKernelId(e){await this.updatePreferredRemoteKernelIdInternal(e)}async storePreferredRemoteKernelId(e,t){await this.updatePreferredRemoteKernelIdInternal(e,t)}async updatePreferredRemoteKernelIdInternal(e,t){let n=!1,i=JSON.parse(JSON.stringify(this.globalMemento.get(e9,[]))),o=await this.crypto.createHash(e.toString()),s=i.findIndex(a=>a.fileHash===o);for(s>=0&&(n=!0,i.splice(s,1)),t&&(n=!0,i.push({fileHash:o,kernelId:t}),b.trace(`Storing Preferred remote kernel for ${ye(e)} is ${t}`));i.length>X_e;)n=!0,i.shift();n&&await this.globalMemento.update(e9,i)}};Js=E([(0,av.injectable)(),I(0,(0,av.inject)(_t)),I(0,(0,av.named)(sr)),I(1,(0,av.inject)(fy))],Js);d();var Bi=Symbol("IJupyterVariables"),LA=Symbol("IKernelVariableRequester"),KA=Symbol("IJupyterVariablesProvider");d();var ep=$(te()),uZ=require("vscode");var lv=class{constructor(e,t,n){this.kernelVariables=t;this.debuggerVariables=n;this.refreshEventEmitter=new uZ.EventEmitter;e.push(n.refreshRequired(this.fireRefresh.bind(this))),e.push(t.refreshRequired(this.fireRefresh.bind(this)))}get refreshRequired(){return this.refreshEventEmitter.event}getAllVariableDiscriptions(e,t,n,i){return this.variableHandler.getAllVariableDiscriptions(e,t,n,i)}async getVariables(e,t){return this.variableHandler.getVariables(e,t)}async getFullVariable(e,t){return this.variableHandler.getFullVariable(e,t)}async getMatchingVariable(e,t,n){return this.variableHandler.getMatchingVariable(e,t,n)}async getDataFrameInfo(e,t,n,i){return this.variableHandler.getDataFrameInfo(e,t,n,i)}async getVariableValueSummary(e,t,n){return this.variableHandler.getVariableValueSummary(e,t,n)}async getDataFrameRows(e,t,n,i,o){return this.variableHandler.getDataFrameRows(e,t,n,i,o)}get variableHandler(){return this.debuggerVariables.active?this.debuggerVariables:this.kernelVariables}fireRefresh(){this.refreshEventEmitter.fire()}};E([Ar("DS_INTERNAL.VARIABLE_EXPLORER_FETCH_TIME")],lv.prototype,"getVariables",1),lv=E([(0,ep.injectable)(),I(0,(0,ep.inject)(ie)),I(1,(0,ep.inject)(Bi)),I(1,(0,ep.named)(rt.KERNEL_VARIABLES)),I(2,(0,ep.inject)(Bi)),I(2,(0,ep.named)(rt.DEBUGGER_VARIABLES))],lv);d();var cv=$(te()),tp=require("vscode");var KS=class{constructor(e,t,n,i){this.disposableRegistry=e;this.kernelProvider=t;this.serverUriStorage=n;this.jupyterUriProviderRegistration=i;this.kernelsStartedSuccessfully=new WeakSet;this.kernelDisposables=new WeakMap;this.kernelConnectionToKernelMapping=new WeakMap;this.kernelsRestarting=new WeakSet;this.kernelReconnectProgress=new WeakMap;this.lastExecutedCellPerKernel=new WeakMap}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposableRegistry),this.disposableRegistry.push(this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.kernelDisposables.get(e))==null||t.dispose(),this.kernelDisposables.delete(e),(n=this.kernelReconnectProgress.get(e))==null||n.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(this.kernelProvider.onDidRestartKernel(e=>{var t;(t=this.kernelReconnectProgress.get(e))==null||t.dispose(),this.kernelReconnectProgress.delete(e)},this)),this.disposableRegistry.push(Lr.onDidChangeNotebookCellExecutionState(e=>{if(!br(e.cell.notebook)||e.state!==1)return;let t=this.kernelProvider.get(e.cell.notebook);!t||this.lastExecutedCellPerKernel.get(t)!==e.cell||this.lastExecutedCellPerKernel.delete(t)}))}getKernelSpecificDisposables(e){let t=this.kernelDisposables.get(e)||new kn;return this.disposableRegistry.push(t),this.kernelDisposables.set(e,t),t}onDidStartKernel(e){var n,i,o;if(this.kernelsStartedSuccessfully.has(e)||!((n=e.session)!=null&&n.kernel))return;let t=this.getKernelSpecificDisposables(e);t.add(Lr.onDidChangeNotebookCellExecutionState(s=>{s.cell.notebook===e.notebook&&this.kernelProvider.get(s.cell.notebook)===e&&s.state===3&&this.lastExecutedCellPerKernel.set(e,s.cell)},this)),this.kernelsStartedSuccessfully.add(e),this.kernelConnectionToKernelMapping.set(e.session.kernel,e),(o=(i=e.session)==null?void 0:i.kernel)==null||o.connectionStatusChanged.connect(this.onKernelStatusChanged,this),t.add(e.addHook("willRestart",async()=>{var s;(s=this.kernelReconnectProgress.get(e))==null||s.dispose(),this.kernelReconnectProgress.delete(e),this.kernelsRestarting.add(e)},this)),t.add(e.onRestarted(()=>this.kernelsRestarting.delete(e),this))}onKernelStatusChanged(e,t){var i,o,s,a;let n=this.kernelConnectionToKernelMapping.get(e);if(n&&!this.kernelsRestarting.has(n))switch(t){case"connected":{(i=this.kernelReconnectProgress.get(n))==null||i.dispose(),this.kernelReconnectProgress.delete(n);return}case"disconnected":{this.kernelReconnectProgress.has(n)&&((o=this.kernelReconnectProgress.get(n))==null||o.dispose(),this.kernelReconnectProgress.delete(n),(s=this.onKernelDisconnected(n))==null||s.catch(y));return}case"connecting":this.kernelReconnectProgress.has(n)||(a=this.onKernelConnecting(n))==null||a.catch(y);return;default:return}}async onKernelConnecting(e){let t=this.getKernelSpecificDisposables(e),n=ke(),i=new tp.Disposable(()=>n.resolve());if(this.kernelReconnectProgress.set(e,i),Ot(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata))return;let o=C.automaticallyReconnectingToAKernelProgressMessage(ut(e.kernelConnectionMetadata));tp.window.withProgress({location:tp.ProgressLocation.Notification,title:o},async()=>n.promise).then(y,y),t.add(i)}async onKernelDisconnected(e){var n;if(e.disposed||e.disposing||(Yr(e.resourceUri,"DATASCIENCE.KERNEL_CRASH"),Ot(e.kernelConnectionMetadata)&&await this.handleRemoteServerShutdown(e,e.kernelConnectionMetadata)))return;let t=tr(e.kernelConnectionMetadata)?C.kernelDisconnected(ut(e.kernelConnectionMetadata)):C.remoteJupyterConnectionFailedWithServer(e.kernelConnectionMetadata.baseUrl);tp.window.showErrorMessage(t).then(y,y);try{let i=this.lastExecutedCellPerKernel.get(e);if(!i||i.document.isClosed||i.notebook.isClosed||((n=i.executionSummary)==null?void 0:n.success)===!1)return;await Yf(i,e.controller,t,!1)}finally{await e.dispose()}}async handleRemoteServerShutdown(e,t){var o;let n=this.jupyterUriProviderRegistration.jupyterCollections.find(s=>s.extensionId===t.serverProviderHandle.extensionId&&s.id===t.serverProviderHandle.id);if(!n)return!1;let i=new tp.CancellationTokenSource;try{return(await Promise.resolve(n.serverProvider.provideJupyterServers(i.token))||[]).map(l=>l.id).includes(t.serverProviderHandle.handle)?!1:(await this.serverUriStorage.remove(t.serverProviderHandle),(o=this.kernelReconnectProgress.get(e))==null||o.dispose(),this.kernelReconnectProgress.delete(e),!0)}catch(s){return!1}finally{i.dispose()}}};KS=E([(0,cv.injectable)(),I(0,(0,cv.inject)(ie)),I(1,(0,cv.inject)(He)),I(2,(0,cv.inject)(hr)),I(3,(0,cv.inject)(ur))],KS);d();var dZ=$(te());var FS=class{isTrusted(e){return!0}};FS=E([(0,dZ.injectable)()],FS);d();var US=Symbol("ITrustedKernelPaths");d();var vD=$(te());var pZ=require("vscode");var WS=class{constructor(e,t){this.kernelProvider=e;this.disposables=[];this.restartProgress=new WeakMap;this.interruptProgress=new WeakMap;t.push(this)}dispose(){me(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.kernelProvider.onDidDisposeKernel(e=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables)}onDidCreateKernel(e){e.addHook("willRestart",async()=>{var n;(n=this.restartProgress.get(e))==null||n.dispose();let t=Vt.createProgressReporter(e.resourceUri,C.restartingKernelStatus(`: ${ut(e.kernelConnectionMetadata)}`));this.restartProgress.set(e,t)},this,this.disposables),e.addHook("restartCompleted",async()=>{var t,n;(t=this.restartProgress.get(e))==null||t.dispose(),(n=this.interruptProgress.get(e))==null||n.dispose()},this,this.disposables),e.addHook("willInterrupt",async()=>{let t=new kn,n=setTimeout(()=>{t.isDisposed||t.add(Vt.createProgressReporter(e.resourceUri,C.interruptKernelStatus(ut(e.kernelConnectionMetadata))))},1e3);t.add(new pZ.Disposable(()=>clearTimeout(n))),this.interruptProgress.set(e,t)},this,this.disposables),e.addHook("interruptCompleted",async()=>{var t;return(t=this.interruptProgress.get(e))==null?void 0:t.dispose()},this,this.disposables)}};WS=E([(0,vD.injectable)(),I(0,(0,vD.inject)(He)),I(1,(0,vD.inject)(ie))],WS);d();var yD=$(te()),t9=require("vscode");var VS=class{constructor(e,t){this.kernelFinder=t;this.disposables=[];e.push(this)}dispose(){me(this.disposables)}activate(){this.startRefresh()}startRefresh(){if(!this.refreshedOnceBefore){if(this.kernelFinder.status==="discovering")return this.displayProgressIndicator();this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="discovering"&&this.displayProgressIndicator()},this,this.disposables)}}displayProgressIndicator(){let e=Date.now().toString();b.debug(`Start refreshing Kernel Picker (${e})`);let t=t9.notebooks.createNotebookControllerDetectionTask(It),n=t9.notebooks.createNotebookControllerDetectionTask(vt);this.disposables.push(t),this.disposables.push(n),this.kernelFinder.onDidChangeStatus(()=>{this.kernelFinder.status==="idle"&&(b.debug(`End refreshing Kernel Picker (${e})`),t.dispose(),n.dispose())},this,this.disposables)}};VS=E([(0,yD.injectable)(),I(0,(0,yD.inject)(ie)),I(1,(0,yD.inject)(ui))],VS);d();var BS=$(te());var Z_e=1e3,jS=class{constructor(e,t,n){this.serverStorage=e;this.kernelProvider=t;this.disposables=[];this.timeouts=new Set;this.kernelSpecificUpdates=new WeakMap;n.push(this)}dispose(){me(this.disposables),me(Array.from(this.timeouts.values()))}activate(){this.disposables.push(Lr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this))}onDidChangeNotebookCellExecutionState(e){let t=this.kernelProvider.get(e.cell.notebook);if(!t)return;let n=t.kernelConnectionMetadata;if(!Ot(n))return;let i=this.kernelSpecificUpdates.get(t)||new ic(Z_e);this.kernelSpecificUpdates.set(t,i),i.trigger(()=>{t.disposed||t.disposing||this.serverStorage.update(n.serverProviderHandle).catch(y)})}};jS=E([(0,BS.injectable)(),I(0,(0,BS.inject)(hr)),I(1,(0,BS.inject)(He)),I(2,(0,BS.inject)(ie))],jS);d();var fZ=$(te());var HS=class{async installMissingDependencies(e){return 1}async areDependenciesInstalled(e,t,n){return!1}};HS=E([(0,fZ.injectable)()],HS);d();var mZ=$(te());var JS=class{constructor(){this.providers=new Map}getProviders(e){return(this.providers.get(e)||[]).slice()}register(e,t){this.providers.set(t,this.providers.get(t)||[]),this.providers.get(t).push(e)}};JS=E([(0,mZ.injectable)()],JS);d();var uv=$(te());var gZ=require("vscode");var hZ=1e3*60*60*24*2,Jl=class extends Vr{constructor(t,n,i,o){super();this.serverStorage=n;this.context=i;this.fs=o;this.executedCells=new WeakMap;this.chainedPromises=Promise.resolve();i.globalStorageUri,t.push(this),this.storageFile=gZ.Uri.joinPath(this.context.globalStorageUri,"lastExecutedRemoteCell.json")}activate(){this._register(this.serverStorage.onDidRemove(this.onDidRemoveServers,this))}async getLastTrackedCellExecution(t,n){var s;if(t.isUntitled||!Ot(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;if(this.staleState&&this.staleState[t.uri.toString()])return this.staleState[t.uri.toString()];let i=await this.getStorageFile(),o={};try{let a=await this.fs.readFile(i);o=JSON.parse(a.toString()),this.staleState=o}catch(a){return}return o[t.uri.toString()]}trackCellExecution(t,n){if(!Ot(n.kernelConnectionMetadata)||t.document.isUntitled)return;this.executedCells.delete(t);let i=[],o=(a,l)=>{var c,u;if(l.direction==="send"){let p=l.msg;if(p.header.msg_type==="execute_request"&&p.metadata&&typeof p.metadata=="object"&&p.metadata&&"cellId"in p.metadata&&typeof p.metadata.cellId=="string"&&p.metadata.cellId===t.document.uri.toString()){let f=p.header.msg_id;this.executedCells.set(t,{msg_id:f,kernelId:((u=(c=n.session)==null?void 0:c.kernel)==null?void 0:u.id)||"",cellIndex:t.index})}}else if(l.direction==="recv"){let p=l.msg,f=this.executedCells.get(t);if(f!=null&&f.msg_id&&Xd(p)===f.msg_id){if(!f.startTime){f.startTime=new Date().getTime();try{f.startTime=new Date(p.header.date).getTime()}catch(m){}this.executedCells.set(t,f)}"execution_count"in p.content&&typeof p.content.execution_count=="number"&&!f.executionCount&&f.executionCount!==p.content.execution_count&&(f.executionCount=p.content.execution_count,this.executedCells.set(t,f),this.trackLastExecution(t,n,f),me(i))}}},s=()=>{let a=n.session;a&&(a.anyMessage.connect(o),i.push({dispose:()=>ea(()=>{var l;return(l=a.anyMessage)==null?void 0:l.disconnect(o)})}))};n.onStarted(()=>s(),i),n.session&&s()}deleteTrackedCellExecution(t,n){var i;t.notebook.isUntitled||!Ot(n.kernelConnectionMetadata)||!((i=n.session)!=null&&i.id)||(this.chainedPromises=this.chainedPromises.finally(async()=>{let o={};try{let a=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));o=JSON.parse(a.toString())}catch(a){return}let s=t.notebook.uri.toString();o[s].cellIndex===t.index&&(delete o[s],this.staleState=o,await this.fs.writeFile(this.storageFile,JSON.stringify(o)))}))}getStorageFile(){return this.ensureStorageExistsPromise=this.ensureStorageExistsPromise||(async()=>(await this.fs.createDirectory(this.context.globalStorageUri),this.storageFile))(),this.ensureStorageExistsPromise}trackLastExecution(t,n,i){var s,a,l,c;if(!i.executionCount||!i.msg_id||!i.startTime||!Ot(n.kernelConnectionMetadata)||!((s=n.session)!=null&&s.id))return;let o={cellIndex:t.index,executionCount:i.executionCount,kernelId:((l=(a=n.session)==null?void 0:a.kernel)==null?void 0:l.id)||"",msg_id:i.msg_id,serverId:qt(n.kernelConnectionMetadata.serverProviderHandle),sessionId:(c=n.session)==null?void 0:c.id,startTime:i.startTime};this.chainedPromises=this.chainedPromises.finally(async()=>{let u={};try{let f=await this.getStorageFile().then(()=>this.fs.readFile(this.storageFile));u=JSON.parse(f.toString())}catch(f){}let p=t.notebook.uri.toString();u[p]=o,this.removeOldItems(u),this.staleState=u,await this.fs.writeFile(this.storageFile,JSON.stringify(u))})}onDidRemoveServers(t){t.length!==0&&(this.chainedPromises=this.chainedPromises.finally(async()=>{await this.getStorageFile();let n={};try{let s=await this.fs.readFile(this.storageFile);n=JSON.parse(s.toString())}catch(s){}let i=!1,o=new Set(t.map(s=>qt(s)));Object.keys(n).forEach(s=>{let a=n[s];(o.has(a.serverId)||Date.now()-a.startTime>hZ)&&(delete n[s],i=!0)}),i&&(this.removeOldItems(n),this.staleState=n,await this.fs.writeFile(this.storageFile,JSON.stringify(n)))}))}removeOldItems(t){Object.keys(t).forEach(n=>{let i=t[n];i&&Date.now()-i.startTime>hZ&&delete t[n]})}};Jl=E([(0,uv.injectable)(),I(0,(0,uv.inject)(ie)),I(1,(0,uv.inject)(hr)),I(2,(0,uv.inject)(st)),I(3,(0,uv.inject)(xt))],Jl);d();var GS=$(te());var bD=require("vscode");var qS=class{constructor(e,t,n){this.serverUriStorage=e;this.registrations=t;this.disposables=n}activate(){this.disposables.push(bD.commands.registerCommand(Q.ClearSavedJupyterUris,async()=>{await this.serverUriStorage.clear().catch(y),await Promise.all(this.registrations.jupyterCollections.filter(e=>e.id.startsWith("_builtin")||e.extensionId===Ye).map(async e=>{if(!e.serverProvider||!e.serverProvider.removeJupyterServer)return;let t=new bD.CancellationTokenSource,n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await Promise.all((n||[]).map(i=>e.serverProvider.removeJupyterServer(i).catch(y)))})).catch(y),await bD.commands.executeCommand("dataScience.ClearUserProviderJupyterServerCache").then(y,y)},this))}};qS=E([(0,GS.injectable)(),I(0,(0,GS.inject)(hr)),I(1,(0,GS.inject)(ur)),I(2,(0,GS.inject)(ie))],qS);d();var FA=$(te());var YS=class{constructor(e){this.registry=e;this.priority=0}activate(){this.registry.register(this,It),this.registry.register(this,vt)}async getCode(e){return Gt(e.kernelConnectionMetadata)?[Sz]:[]}};YS=E([(0,FA.injectable)(),I(0,(0,FA.inject)(Ud))],YS);var ID=class{constructor(){this.isSupported=!1}};ID=E([(0,vZ.injectable)()],ID);function yZ(r,e){r.addSingleton($d,ID),Zb("isInsiderExtension",jv()?"true":"false");let t=r.get(Eo);Zb("isPythonExtensionInstalled",t.isPythonExtensionInstalled?"true":"false");let n=r.get($d);Zb("rawKernelSupported",n.isSupported?"true":"false"),r.addSingleton(Ud,JS),r.addSingleton(Bi,lv,rt.ALL_VARIABLES),r.addSingleton(We,tv),r.addSingleton(We,VS),r.addSingleton(We,WS),r.addSingleton(We,KS),r.addSingleton(We,jS),r.addSingleton(He,AS),r.addSingleton(US,FS),r.addSingleton(Yg,MS),r.addSingleton(Js,Js),r.addSingleton(ui,OS),r.addSingleton(CI,HS),r.addSingleton(We,qS),r.addSingleton(Jl,Jl),r.addBinding(Jl,We),rZ(r,e),r.addSingleton(We,un),r.addSingleton(We,YS)}d();d();var $S=$(te()),pv=require("vscode");var dv=class{constructor(e,t,n){this.disposables=e;this.controllerRegistration=t;this.preferredRemoteKernelIdProvider=n}activate(){pv.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebook,this,this.disposables),pv.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebook(e))}async onDidOpenNotebook(e){if(!br(e))return;let t=await this.preferredRemoteKernelIdProvider.getPreferredRemoteKernelId(e);if(!t)return;let n=()=>{let o=this.controllerRegistration.getSelected(e),s=this.controllerRegistration.registered.find(a=>a.id===t);return s&&(o==null?void 0:o.id)!==s.id?(this.switchKernel(e,s.connection).catch(y),!0):!1};if(n())return;let i=this.controllerRegistration.onDidChange(o=>{o.added.length&&n()&&i.dispose()},this,this.disposables);this.controllerRegistration.onControllerSelected(o=>{o.notebook===e&&i.dispose()},this,this.disposables)}async switchKernel(e,t){b.debug(`Using notebook.selectKernel to force remote kernel for ${ye(e.uri)} to ${t.id}`),await pv.commands.executeCommand("notebook.selectKernel",{id:t.id,extension:Ye}),await fP(async()=>{var i;if(((i=pv.window.activeNotebookEditor)==null?void 0:i.notebook)===e){let o=this.controllerRegistration.getSelected(e);if((o==null?void 0:o.connection.id)===t.id)return o.restoreConnection(e).catch(y),!0}return!1},2e3,100)?b.debug(`Successfully switched remote kernel for ${ye(e.uri)} to ${t.id}`):b.warn(`Failed to switch remote kernel for ${ye(e.uri)} to ${t.id}`)}};E([In()],dv.prototype,"onDidOpenNotebook",1),dv=E([(0,$S.injectable)(),I(0,(0,$S.inject)(ie)),I(1,(0,$S.inject)(kt)),I(2,(0,$S.inject)(Js))],dv);d();var zS=$(te()),vm=require("vscode");d();var bZ=Symbol("IServiceManager"),Ur=Symbol("IServiceContainer");d();var vs=require("vscode");d();function bu(r){if(typeof r!="string")throw new TypeError(`Expected a \`string\`, got \`${typeof r}\``);var e=SZ();let t=e;return t.default&&(t=t.default),r.replace(t(),"")}d();d();var _D=$(te()),DZ=require("vscode");d();var r9=$(iv()),CZ=require("vscode");d();function _Z(r){if(!r||!Array.isArray(r)||r.length===0)return;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=Array.apply(null,new Uint8Array(n.buffer));e.push({...n,byteLength:n.byteLength,byteOffset:n.byteOffset,buffer:i})}else e.push([...new Uint8Array(n)])}return e}function EZ(r){if(!Array.isArray(r)||r.length===0)return r;let e=[];for(let t=0;t<r.length;t+=1){let n=r[t];if("buffer"in n&&"byteOffset"in n){let i=new Uint8Array(n.buffer).buffer,o=new DataView(i,n.byteOffset,n.byteLength);e.push(o)}else{let i=new Uint8Array(n).buffer;e.push(i)}}return e}var SD=new WeakMap;function wZ(r,e){let t=SD.get(r);t&&(t.targets.add(e),t.registerCommTarget(e))}function xZ(r,e){var t,n,i;(i=(n=(t=SD.get(r))==null?void 0:t.targets)==null?void 0:n.delete)==null||i.call(n,e)}var UA=class{constructor(e,t){this.kernelProvider=e;this.document=t;this.commTargetsRegistered=new Set;this.pendingTargetNames=new Set;this._postMessageEmitter=new CZ.EventEmitter;this.messageHooks=new Map;this.pendingHookRemovals=new Map;this.messageHookRequests=new Map;this.disposables=[];this.disposed=!1;this.pendingMessages=[];this.subscribedToKernelSocket=!1;this.waitingMessageIds=new Map;this.outputWidgetIds=new Set;this.isUsingIPyWidgets=!1;this.pendingTargetNames.add("jupyter.widget"),e.onDidStartKernel(i=>{i.notebook===t&&this.initialize()},this,this.disposables),this.mirrorSend=this.mirrorSend.bind(this),this.onKernelSocketMessage=this.onKernelSocketMessage.bind(this);let n=rV();this.deserialize=n.deserialize}get postMessage(){return this._postMessageEmitter.event}dispose(){for(this.disposed=!0;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}receiveMessage(e){switch(e.message){case"IPyWidgets_logMessage":{let t=e.payload;t.category==="error"?b.error(`Widget Error: ${t.message}`):b.trace(`Widget Message: ${t.message}`);break}case"IPyWidgets_Ready":this.sendKernelOptions(),this.initialize();break;case"IPyWidgets_msg":this.sendRawPayloadToKernelSocket(e.payload);break;case"IPyWidgets_binary_msg":this.sendRawPayloadToKernelSocket(EZ(e.payload)[0]);break;case"IPyWidgets_msg_received":this.onKernelSocketResponse(e.payload);break;case"IPyWidgets_registerCommTarget":this.registerCommTarget(e.payload);break;case"IPyWidgets_RegisterMessageHook":this.registerMessageHook(e.payload);break;case"IPyWidgets_RemoveMessageHook":this.possiblyRemoveMessageHook(e.payload);break;case"IPyWidgets_MessageHookResult":this.handleMessageHookResponse(e.payload);break;case"IPyWidgets_iopub_msg_handled":this.iopubMessageHandled(e.payload);break;default:break}}sendRawPayloadToKernelSocket(e){this.pendingMessages.push(e),this.sendPendingMessages()}registerCommTarget(e){this.pendingTargetNames.add(e),this.initialize()}initialize(){this.jupyterLab||(this.jupyterLab=li());let e=this.getKernel();e&&(this.subscribeToKernelSocket(e),this.registerCommTargets(e))}raisePostMessage(e,t){this._postMessageEmitter.fire({message:e,payload:t})}subscribeToKernelSocket(e){var n;if(this.subscribedToKernelSocket||!e.session)return;this.subscribedToKernelSocket=!0,this.subscribeToKernelSocketImpl(e);let t=(n=e.session.kernel)==null?void 0:n.id;e.session.onDidKernelSocketChange(()=>{var i,o;this.subscribeToKernelSocketImpl(e,t),t=((o=(i=e.session)==null?void 0:i.kernel)==null?void 0:o.id)||""})}subscribeToKernelSocketImpl(e,t){var s,a,l,c,u;let n=t?js.get(t):void 0;if(n==null||n.removeReceiveHook(this.onKernelSocketMessage),n==null||n.removeSendHook(this.mirrorSend),this.kernelWasConnectedAtLeastOnce){for(;this.pendingMessages.length;)this.pendingMessages.shift();this.waitingMessageIds.forEach(p=>p.resultPromise.resolve()),this.waitingMessageIds.clear(),this.messageHookRequests.forEach(p=>p.resolve(!1)),this.messageHookRequests.clear(),this.messageHooks.clear(),this.sendRestartKernel()}if(!((a=(s=e.session)==null?void 0:s.kernel)!=null&&a.id)||!js.get((c=(l=e.session)==null?void 0:l.kernel)==null?void 0:c.id))return;SD.has(e.session.kernel)||SD.set(e.session.kernel,{targets:new Set,registerCommTarget:p=>{this.raisePostMessage("IPyWidgets_registerCommTarget",p)}}),this.kernelWasConnectedAtLeastOnce=!0;let i=(u=e.session.kernel)==null?void 0:u.id,o=i?js.get(i):void 0;o==null||o.addReceiveHook(this.onKernelSocketMessage),o==null||o.addSendHook(this.mirrorSend),this.sendKernelOptions(),this.registerCommTargets(e),this.sendPendingMessages()}sendKernelOptions(){var e,t,n,i,o,s,a,l,c,u,p,f,m,h;(t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel&&this.raisePostMessage("IPyWidgets_kernelOptions",{id:((o=(i=(n=this.kernel)==null?void 0:n.session)==null?void 0:i.kernel)==null?void 0:o.id)||"",clientId:((l=(a=(s=this.kernel)==null?void 0:s.session)==null?void 0:a.kernel)==null?void 0:l.clientId)||"",userName:((p=(u=(c=this.kernel)==null?void 0:c.session)==null?void 0:u.kernel)==null?void 0:p.username)||"",model:((h=(m=(f=this.kernel)==null?void 0:f.session)==null?void 0:m.kernel)==null?void 0:h.model)||{id:"",name:""}})}async mirrorSend(e,t){if(typeof e=="string"&&e.includes("shell")&&e.includes("execute_request")){let n=this.deserialize(e);if(n.channel==="shell"&&n.header.msg_type==="execute_request"){if(!DA(n))return;let i=this.mirrorExecuteRequest(n);this.isUsingIPyWidgets&&await i}}}sendRestartKernel(){this.raisePostMessage("IPyWidgets_onRestartKernel",void 0)}mirrorExecuteRequest(e){let t=ke();return this.waitingMessageIds.set(e.header.msg_id,{startTime:Date.now(),resultPromise:t}),this.raisePostMessage("IPyWidgets_mirror_execute",{id:e.header.msg_id,msg:e}),t.promise}messageNeedsFullHandle(e){var t,n,i,o;return e.channel==="iopub"&&((t=e.header)==null?void 0:t.msg_type)==="comm_msg"&&((i=(n=e.content)==null?void 0:n.data)==null?void 0:i.method)==="update"&&this.outputWidgetIds.has((o=e.content)==null?void 0:o.comm_id)}iopubMessageHandled(e){let t=e.id;this.fullHandleMessage&&this.fullHandleMessage.id===t&&(this.fullHandleMessage.promise.resolve(),this.fullHandleMessage=void 0)}async onKernelSocketMessage(e){var o,s,a,l,c,u,p,f,m;let t=(0,r9.default)(),n=ke();if(this.waitingMessageIds.set(t,{startTime:Date.now(),resultPromise:n}),typeof e=="string"?DA(e)&&this.raisePostMessage("IPyWidgets_msg",{id:t,data:e}):this.raisePostMessage("IPyWidgets_binary_msg",{id:t,data:_Z([e])}),typeof e!="string"||e.includes(yo)||e.includes(rt.DefaultCommTarget)||e.includes("comm_open")||e.includes("comm_close")||e.includes("comm_msg")){let h=this.deserialize(e);if(!DA(h))return;h&&h.content&&h.content.data&&(h.content.data[yo]||h.content.target_name===rt.DefaultCommTarget)&&(this.isUsingIPyWidgets=!0);let g=((o=h.header)==null?void 0:o.msg_type)==="comm_open"&&((l=(a=(s=h.content)==null?void 0:s.data)==null?void 0:a.state)==null?void 0:l._model_module)==="@jupyter-widgets/output"&&((p=(u=(c=h.content)==null?void 0:c.data)==null?void 0:u.state)==null?void 0:p._model_name)==="OutputModel",v=((f=h.header)==null?void 0:f.msg_type)==="comm_close"&&this.outputWidgetIds.has((m=h.content)==null?void 0:m.comm_id);g?this.outputWidgetIds.add(h.content.comm_id):v?this.outputWidgetIds.delete(h.content.comm_id):this.messageNeedsFullHandle(h)&&(this.fullHandleMessage={id:h.header.msg_id,promise:ke()},await n.promise,await this.fullHandleMessage.promise.promise,this.fullHandleMessage=void 0)}}onKernelSocketResponse(e){let t=this.waitingMessageIds.get(e.id);t&&(this.waitingMessageIds.delete(e.id),t.resultPromise.resolve())}sendPendingMessages(){var e,t,n;if((t=(e=this.kernel)==null?void 0:e.session)!=null&&t.kernel)for(;this.pendingMessages.length;)try{let i=this.pendingMessages[0],o=typeof i=="string"?JSON.parse(i):this.deserialize(i);(n=o.buffers)!=null&&n.length&&(o.buffers=o.buffers.map(s=>s instanceof DataView?s.buffer:s)),o.channel==="control"?this.kernel.session.kernel.sendControlMessage(o):this.kernel.session.kernel.sendShellMessage(o),this.pendingMessages.shift()}catch(i){b.error("Failed to send message to Kernel",i);return}}registerCommTargets(e){var t,n,i;for(;this.pendingTargetNames.size>0;){let s=Array.from([...this.pendingTargetNames.values()]).shift();if(s){if(this.commTargetsRegistered.has(s))return;b.trace(`Registering commtarget ${s}`),this.commTargetsRegistered.add(s),this.pendingTargetNames.delete(s),(t=e.session)!=null&&t.kernel&&s!==rt.DefaultCommTarget&&!((i=(n=SD.get(e.session.kernel))==null?void 0:n.targets)!=null&&i.has(s))&&e.session.kernel.registerCommTarget(s,y)}}}getKernel(){var e,t;return this.document&&!((e=this.kernel)!=null&&e.session)&&(this.kernel=this.kernelProvider.get(this.document),(t=this.kernel)==null||t.onDisposed(()=>this.kernel=void 0)),this.kernel&&!this.kernelRestartHandlerAttached&&(this.kernelRestartHandlerAttached=!0,this.disposables.push(this.kernel.onRestarted(this.handleKernelRestarts,this))),this.kernel}async handleKernelRestarts(){var e;this.disposed||this.commTargetsRegistered.size===0||!((e=this.kernel)!=null&&e.session)||(Array.from(this.commTargetsRegistered.keys()).forEach(t=>{this.commTargetsRegistered.delete(t),this.pendingTargetNames.add(t)}),this.subscribeToKernelSocket(this.kernel),this.registerCommTargets(this.kernel))}registerMessageHook(e){var t,n;try{if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&!this.messageHooks.has(e)){let i=this.messageHookCallback.bind(this);this.messageHooks.set(e,i),this.kernel.session.kernel.registerMessageHook(e,i)}}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e,type:"IPyWidgets_RegisterMessageHook"})}}possiblyRemoveMessageHook(e){try{e.lastHookedMsgId?this.pendingHookRemovals.set(e.lastHookedMsgId,e.hookMsgId):this.removeMessageHook(e.hookMsgId)}finally{this.raisePostMessage("IPyWidgets_ExtensionOperationHandled",{id:e.hookMsgId,type:"IPyWidgets_RemoveMessageHook"})}}removeMessageHook(e){var t,n;if((n=(t=this.kernel)==null?void 0:t.session)!=null&&n.kernel&&this.messageHooks.has(e)){let i=this.messageHooks.get(e);this.messageHooks.delete(e),this.kernel.session.kernel.removeMessageHook(e,i)}}async messageHookCallback(e){let t=ke(),n=(0,r9.default)(),i=e.parent_header.msg_id;if(this.messageHooks.has(i)?(this.messageHookRequests.set(n,t),this.raisePostMessage("IPyWidgets_MessageHookCall",{requestId:n,parentId:i,msg:e})):t.resolve(!0),this.pendingHookRemovals.has(e.header.msg_id)){let o=this.pendingHookRemovals.get(e.header.msg_id);this.pendingHookRemovals.delete(e.header.msg_id),this.removeMessageHook(o)}return t.promise}handleMessageHookResponse(e){let t=this.messageHookRequests.get(e.requestId);t&&(this.messageHookRequests.delete(e.requestId),t.resolve(e.msgType.includes("comm")?!0:e.result))}};var n9=class{constructor(e,t){this.baseMulticaster=e;this.oldMessages=t;this._postMessageEmitter=new DZ.EventEmitter;this.disposables=[];e.postMessage(this.raisePostMessage,this,this.disposables)}get postMessage(){return this._postMessageEmitter.event}dispose(){for(;this.disposables.length;){let e=this.disposables.shift();e==null||e.dispose()}}initialize(){return this.baseMulticaster.initialize()}receiveMessage(e){this.baseMulticaster.receiveMessage(e)}raisePostMessage(e){this.oldMessages.forEach(t=>{this._postMessageEmitter.fire(t)}),this.oldMessages=[],this._postMessageEmitter.fire(e)}},rp=class{constructor(e,t){this.kernelProvider=t;this.messageDispatchers=new WeakMap;this.messagesPerNotebook=new WeakMap;this.disposed=!1;this.disposables=[];e.push(this),t.onDidDisposeKernel(this.trackDisposingOfKernels,this,e)}dispose(){var e;for(this.disposed=!0;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}create(e){let t=this.messageDispatchers.get(e);t||(t=new UA(this.kernelProvider,e),this.messageDispatchers.set(e,t),this.disposables.push(t.postMessage(o=>this.onMessage(o,e),this)));let n=[];e&&this.messagesPerNotebook.get(e)&&(n=this.messagesPerNotebook.get(e)||[]);let i=new n9(t,n);return this.disposables.push(i),i}trackDisposingOfKernels(e){if(this.disposed)return;let t=e.notebook,n=this.messageDispatchers.get(t);this.messageDispatchers.delete(t),n==null||n.dispose()}onMessage(e,t){t&&(this.messagesPerNotebook.set(t,this.messagesPerNotebook.get(t)||[]),(e.message==="IPyWidgets_kernelOptions"||e.message==="IPyWidgets_registerCommTarget")&&this.messagesPerNotebook.get(t).push(e))}};rp=E([(0,_D.injectable)(),I(0,(0,_D.inject)(ie)),I(1,(0,_D.inject)(He))],rp);d();var kZ=require("vscode");d();var PZ=require("vscode");var fv=class fv extends Vr{constructor(t,n,i,o,s,a){super();this.kernel=t;this.localResourceUriConverter=n;this.configurationSettings=i;this.sourceProviderFactory=o;this.isWebViewOnline=s;this.cdnScriptProvider=a;this.id="all";this.scriptProviders=this.sourceProviderFactory.getProviders(this.kernel,this.localResourceUriConverter),this.scriptProviders.forEach(l=>this._register(l)),this.monitorKernel()}get configuredScriptSources(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}async getBaseUrl(){let t=this.scriptProviders.find(n=>n.getBaseUrl);if(t)return t.getBaseUrl()}async getWidgetScriptSources(){let t=[];return await Promise.all(this.scriptProviders.map(async n=>{n.getWidgetScriptSources&&t.push(...await n.getWidgetScriptSources())})),t}async getWidgetScriptSource(t,n){let i=await this.isWebViewOnline,o=this.scriptProviders.slice(),s={moduleName:t};for(;o.length;){let a=o.shift();if(!a)continue;let l=await a.getWidgetScriptSource(t,n,i);if(l.scriptUri){s=l;break}else b.warn(`Widget Script Source not found for ${t}@${n} from ${a.id}`)}return this.sendTelemetryForWidgetModule(t,n,"",s.source).catch(y),s.scriptUri?b.trace(`Script source for Widget ${t}@${n} was found from source ${s.source} and ${s.scriptUri}`):b.error(`Script source for Widget ${t}@${n} not found in ${this.scriptProviders.map(a=>a.id).join(", ")}`),s}async sendTelemetryForWidgetModule(t,n,i,o){let s=`${t}.${t}@${n}`;if(fv.trackedWidgetModuleNames.has(s))return;fv.trackedWidgetModuleNames.add(s);let a=t.toLowerCase().startsWith("@jupyter-widgets"),l=o==="cdn"||a||await this.cdnScriptProvider.isOnCDN(t),c=l?t.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0,u=l?i.replace(/\//g,"_").replace(/\\/g,"_").replace(/@/g,"_at_"):void 0;J("DS_INTERNAL.IPYWIDGET_USED_BY_USER",void 0,{hashedName:await Rt(t),moduleName:c,modelName:u,source:o,moduleVersion:l?n:void 0,cdnSearched:this.configuredScriptSources.length>0})}monitorKernel(){this.hookKernelEvents(),this._register(this.kernel.onStarted(this.hookKernelEvents,this)),this._register(this.kernel.onRestarted(this.hookKernelEvents,this)),this._register(this.kernel.onDidKernelSocketChange(()=>this.hookKernelEvents(),this))}hookKernelEvents(){var n;let t=(n=this.kernel.session)==null?void 0:n.kernel;t&&(t.anyMessage.connect(this.onAnyMessage,this),this._register(new PZ.Disposable(()=>t.anyMessage.disconnect(this.onAnyMessage,this))))}onAnyMessage(t,n){var i,o,s,a;if(n.direction==="recv"&&n.msg.header.msg_type==="comm_open"){let c=n.msg.content.data;(i=c.state)!=null&&i._model_module&&c.state._model_name&&this.sendTelemetryForWidgetModule((o=c.state)==null?void 0:o._model_module,((s=c.state)==null?void 0:s._model_module_version)||"",(a=c.state)==null?void 0:a._model_name).catch(y)}}};fv.trackedWidgetModuleNames=new Set,E([In()],fv.prototype,"sendTelemetryForWidgetModule",1),E([In()],fv.prototype,"onAnyMessage",1);var VA=fv;d();var jA=class{constructor(e,t){this.isWebExtension=e;this.converter=t}async asWebviewUri(e){return this.isWebExtension?e:this.converter(e)}};d();var i9=class{constructor(e,t){this.uri=e;this.value=t}};function tEe(r){return Array.isArray(r)}var rEe,mv=class mv{constructor(e,t){this[rEe]="ResourceMap";if(e instanceof mv)this.map=new Map(e.map),this.toKey=t!=null?t:mv.defaultToKey;else if(tEe(e)){this.map=new Map,this.toKey=t!=null?t:mv.defaultToKey;for(let[n,i]of e)this.set(n,i)}else this.map=new Map,this.toKey=e!=null?e:mv.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new i9(e,t)),this}get(e){var t;return(t=this.map.get(this.toKey(e)))==null?void 0:t.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t!="undefined"&&(e=e.bind(t));for(let[,n]of this.map)e(n.value,n.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(rEe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}};mv.defaultToKey=e=>e.toString();var Iu=mv,nEe,BA=class{constructor(e,t){this[nEe]="ResourceSet";!e||typeof e=="function"?this._map=new Iu(e):(this._map=new Iu(t),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,t){this._map.forEach((n,i)=>e.call(t,i,i,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(nEe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var iEe,TZ=class{constructor(){this[iEe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=0){let n=this._map.get(e);if(n)return t!==0&&this.touch(n,t),n.value}set(e,t,n=0){let i=this._map.get(e);if(i)i.value=t,n!==0&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case 0:this.addItemLast(i);break;case 1:this.addItemFirst(i);break;case 2:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.key,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}values(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:n.value,done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}entries(){let e=this,t=this._state,n=this._head,i={[Symbol.iterator](){return i},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(n){let o={value:[n.key,n.value],done:!1};return n=n.next,o}else return{value:void 0,done:!0}}};return i}[(iEe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};var HA=class{constructor(e,t,n,i,o,s){this.document=e;this.kernelProvider=t;this.configurationSettings=i;this.sourceProviderFactory=o;this.cdnScriptProvider=s;this.postEmitter=new kZ.EventEmitter;this.disposables=[];this.isWebViewOnline=ke();this.widgetSources=new Map;this.pendingModuleRequests=new Map;this.uriTranslationRequests=new Iu;this.uriConverter=new jA(Pn(),a=>(this.uriTranslationRequests.has(a)||this.uriTranslationRequests.set(a,ke()),this.postEmitter.fire({message:"ConvertUriForUseInWebViewRequest",payload:a}),this.uriTranslationRequests.get(a).promise)),this.isWebViewOnline.promise.catch(y),n.push(this),this.kernelProvider.onDidStartKernel(a=>{a.notebook===this.document&&this.initialize()},this,this.disposables)}get postMessage(){return this.postEmitter.event}dispose(){var e;for(;this.disposables.length;)(e=this.disposables.shift())==null||e.dispose()}onMessage(e,t){if(e==="ConvertUriForUseInWebViewResponse"){let n=t;n&&this.uriTranslationRequests.has(n.request)&&this.uriTranslationRequests.get(n.request).resolve(n.response)}else if(e==="IPyWidgets_Ready")this.sendBaseUrl(),this.sendWidgetScriptSources().catch(y);else if(e==="IPyWidgets_IsOnline"){let n=t.isOnline;this.isWebViewOnline.resolve(n)}else e==="IPyWidgets_WidgetScriptSourceRequest"&&t&&this.onRequestWidgetScript(t).catch(y)}initialize(){var e;this.jupyterLab||(this.jupyterLab=li()),this.kernel||(this.kernel=this.kernelProvider.get(this.document)),(e=this.kernel)!=null&&e.session&&(this.scriptProvider&&!this.scriptProvider.isDisposed||(this.scriptProvider=new VA(this.kernel,this.uriConverter,this.configurationSettings,this.sourceProviderFactory,this.isWebViewOnline.promise,this.cdnScriptProvider),this.kernel.onDisposed(()=>this.dispose()),this.handlePendingRequests(),this.sendBaseUrl(),b.trace("IPyWidgetScriptSource.initialize")))}sendBaseUrl(){this.scriptProvider&&this.scriptProvider.getBaseUrl().then(e=>{e&&this.postEmitter.fire({message:"IPyWidgets_BaseUrl_Response",payload:e.toString()})}).catch(e=>b.error("Failed to get baseUrl",e))}async sendWidgetScriptSources(){if(this.scriptProvider&&!this.allWidgetScriptsSent)try{(await this.scriptProvider.getWidgetScriptSources()).forEach(t=>{var n;((n=this.widgetSources.get(t.moduleName))==null?void 0:n.source)!=="cdn"&&this.widgetSources.set(t.moduleName,t),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:t})})}catch(e){b.warn("Failed to fetch script sources",e)}finally{this.allWidgetScriptsSent=!0}}async onRequestWidgetScript(e){let{moduleName:t,moduleVersion:n,requestId:i}=e;if(b.trace(`\x1B[32mFetch Script for ${JSON.stringify(e)}`),await this.sendWidgetSource(t,n,i).catch(o=>b.error("Failed to send widget sources upon ready",o)),this.scriptProvider&&!this.allWidgetScriptsSent)try{await this.sendWidgetScriptSources()}finally{this.sendWidgetSource(t,n,i).catch(o=>b.error("Failed to send widget sources upon ready",o))}}async sendWidgetSource(e,t="*",n){var o;if(!e||e.startsWith("@jupyter"))return;if(!this.kernel||!this.scriptProvider){this.pendingModuleRequests.set(e,{moduleVersion:t,requestId:n});return}let i={moduleName:e,requestId:n};try{b.trace(`\x1B[32mFetch Script for ${e}`),i=await this.scriptProvider.getWidgetScriptSource(e,t),((o=this.widgetSources.get(i.moduleName))==null?void 0:o.source)!=="cdn"&&this.widgetSources.set(i.moduleName,i)}catch(s){b.error("Failed to get widget source due to an error",s),J("DS_INTERNAL.IPYWIDGET_DISCOVERY_ERRORED")}finally{b.trace(`\x1B[32mScript for ${e}, is ${i.scriptUri} from ${i.source}`),this.postEmitter.fire({message:"IPyWidgets_WidgetScriptSource_Response",payload:i})}}handlePendingRequests(){let e=Array.from(this.pendingModuleRequests.keys());for(;e.length;){let t=e.shift();if(t){let{moduleVersion:n,requestId:i}=this.pendingModuleRequests.get(t);this.pendingModuleRequests.delete(t),this.sendWidgetSource(t,n,i).catch(o=>b.error(`Failed to send WidgetScript for ${t}`,o))}}}};d();var qA=Symbol("IWidgetScriptSourceProviderFactory"),NZ=Symbol("INbExtensionsPathProvider"),GA=Symbol("IIPyWidgetScriptManagerFactory"),Cbt=Symbol("IIPyWidgetScriptManager");d();var hv=$(te()),gs=require("vscode");var MZ="https://unpkg.com/",s9="https://cdn.jsdelivr.net/npm/",YA="IPYWidgetCDNConfigured",RZ="IPYWidgetNotFoundOnCDN",AZ="IPYWidgetNoNetWorkAccess";function oEe(r,e,t){let n=e,i="index",o=e.indexOf("/");return o!==-1&&e[0]==="@"&&(o=e.indexOf("/",o+1)),o!==-1&&(i=e.substr(o+1),n=e.substr(0,o)),r===s9&&(t.startsWith("^")&&(t=t.slice(1)),i.endsWith(".js")||(i=i.concat(".js"))),`${r}${n}@${t}/dist/${i}`}function sEe(r){switch(r){case"unpkg.com":return MZ;case"jsdelivr.com":return s9;default:break}}var ql=class{constructor(e,t){this.globalMemento=e;this.configurationSettings=t;this.id="cdn";this.cache=new Map;this.isOnCDNCache=new Map;this.notifiedUserAboutWidgetScriptNotFound=new Set}get cdnProviders(){return this.configurationSettings.getSettings(void 0).widgetScriptSources}dispose(){this.cache.clear()}async isOnCDN(e){let t=`MODULE_VERSION_ON_CDN_${e}`;if(this.isOnCDNCache.has(t))return this.isOnCDNCache.get(t);if(this.globalMemento.get(t,!1))return!0;let n=(async()=>{let i=new pu,o=Fu(i.exists(`${MZ}${e}`)),s=Fu(i.exists(`${s9}${e}`));return await Promise.race([o.promise,s.promise]),o.value||s.value?!0:(await Promise.all([o.promise,s.promise]),!!(o.value||s.value))})();return n.then(i=>{if(i)return this.globalMemento.update(t,!0)}).then(y,y),this.isOnCDNCache.set(t,n),n}async getWidgetScriptSource(e,t,n){if(n===!1)return b.ci(`Webview is offline, cannot use CDN for ${e}`),this.warnIfNoAccessToInternetFromWebView(e).catch(y),{moduleName:e};if(this.cdnProviders.length===0&&this.globalMemento.get(YA,!1))return b.ci("No CDN providers and user configured CDN"),{moduleName:e};let i=this.getModuleKey(e,t);return this.cache.get(i)||this.cache.set(i,this.getWidgetScriptSourceImplementation(e,t)),this.cache.get(i)}async generateDownloadUri(e,t,n){let i=sEe(n);if(i)return oEe(i,e,t)}getModuleKey(e,t){return`${e}${t}`}async getWidgetScriptSourceImplementation(e,t){if(b.trace(`\x1B[32mSearching for Widget Script ${e}#${t} using cdns ${this.cdnProviders.join(" ")}`),await this.configureWidgets(),this.cdnProviders.length===0)return{moduleName:e};let i=(await Promise.all(this.cdnProviders.map(o=>this.getValidUri(e,t,o)))).find(o=>o);return i?(b.trace(`\x1B[32mWidget Script ${e}#${t} found at URI: ${i}`),{moduleName:e,scriptUri:i,source:"cdn"}):(b.error(`Widget Script ${e}#${t} was not found on on any cdn`),this.handleWidgetSourceNotFound(e,t).catch(y),{moduleName:e})}async getValidUri(e,t,n){try{let i=await this.generateDownloadUri(e,t,n),o=new pu;if(i&&await o.exists(i))return i}catch(i){b.trace(`Failed downloading ${e}:${t} from ${n}`);return}}async warnIfNoAccessToInternetFromWebView(e){if(this.globalMemento.get(AZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await gs.window.showWarningMessage(C.cdnWidgetScriptNotAccessibleWarningMessage(e,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.moreInfo)){case Ue.doNotShowAgain:return this.globalMemento.update(AZ,!0);case Ue.moreInfo:return gs.env.openExternal(gs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));default:}}async configureWidgets(){if(this.cdnProviders.length!==0||this.globalMemento.get(YA,!1))return;if(this.configurationPromise)return this.configurationPromise.promise;this.configurationPromise=ke(),J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN");let e=await gs.window.showInformationMessage(C.useCDNForWidgetsNoInformation,{modal:!0},Ue.ok,Ue.doNotShowAgain,Ue.moreInfo),t="dismissed";switch(e){case Ue.ok:{t="ok",await Promise.all([this.updateScriptSources(["jsdelivr.com","unpkg.com"]),this.globalMemento.update(YA,!0)]);break}case Ue.doNotShowAgain:{t="doNotShowAgain",await Promise.all([this.updateScriptSources([]),this.globalMemento.update(YA,!0)]);break}case Ue.moreInfo:{gs.env.openExternal(gs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break}default:t=e===Ue.cancel?"cancel":"dismissed";break}J("DS_INTERNAL.IPYWIDGET_PROMPT_TO_USE_CDN_SELECTION",void 0,{selection:t}),this.configurationPromise.resolve()}async updateScriptSources(e){let t="widgetScriptSources";await this.configurationSettings.updateSetting(t,e,void 0,gs.ConfigurationTarget.Global)}async handleWidgetSourceNotFound(e,t){if(this.globalMemento.get(RZ,!1)||this.notifiedUserAboutWidgetScriptNotFound.has(e)||this.cdnProviders.length===0)return;switch(this.notifiedUserAboutWidgetScriptNotFound.add(e),await gs.window.showWarningMessage(C.widgetScriptNotFoundOnCDNWidgetMightNotWork(e,t,JSON.stringify(this.cdnProviders)),Ue.ok,Ue.doNotShowAgain,Ue.reportThisIssue)){case Ue.doNotShowAgain:return this.globalMemento.update(RZ,!0);case Ue.reportThisIssue:return gs.env.openExternal(gs.Uri.parse("https://aka.ms/CreatePVSCDataScienceIssue"));default:}}};ql=E([(0,hv.injectable)(),I(0,(0,hv.inject)(_t)),I(0,(0,hv.named)(sr)),I(1,(0,hv.inject)(Me))],ql);var ED=class{constructor(e,t){this.document=e;this.serviceContainer=t;this.cachedMessages=[];this.postEmitter=new vs.EventEmitter;this.attachedWebviews=new WeakSet;this.modulesForWhichWeHaveDisplayedWidgetErrorMessage=new Set;this.queuedMessages=[];this.disposables=this.serviceContainer.get(ie),this.jupyterOutput=this.serviceContainer.get(Hm,Hv),this.configService=this.serviceContainer.get(Me),this.initialize()}get postMessage(){return this.listeningToPostMessageEvent=!0,this.postEmitter.event}dispose(){var e,t;this.cachedMessages=[],(e=this.ipyWidgetMessageDispatcher)==null||e.dispose(),(t=this.ipyWidgetScriptSource)==null||t.dispose()}attach(e){if(this.attachedWebviews.has(e))return;this.attachedWebviews.add(e),this.postMessage(i=>{if(b.ci(`\x1B[32mWidget Coordinator sent ${i.message}`),i.message==="ConvertUriForUseInWebViewRequest")this.onMessage(e,"ConvertUriForUseInWebViewResponse",{request:i.payload,response:e.asWebviewUri(i.payload)});else{if(!this.readyMessageReceived){this.queuedMessages.push({type:i.message,payload:i.payload});return}this.sendPendingWebViewMessages(e),e.postMessage({type:i.message,payload:i.payload}).then(y,y)}},this,this.disposables);let t=ke(),n=async()=>{let i=new St;if(!t.completed){let s=[],a=this.serviceContainer.get(He),l=ke();a.get(this.document)?l.resolve(a.get(this.document)):a.onDidCreateKernel(u=>{u.notebook===this.document&&l.resolve(u)},this,s);let c=await l.promise;c&&(Gt(c.kernelConnectionMetadata)?c.ipywidgetsVersion?t.completed||t.resolve(c.ipywidgetsVersion):c.onIPyWidgetVersionResolved(()=>{c.ipywidgetsVersion&&(t.completed||t.resolve(c.ipywidgetsVersion),me(s))},this,s):t.completed||t.resolve(UE)),s.length&&this.disposables.push(...s)}let o=await t.promise;b.trace(`Version of IPyWidgets ${o} determined after ${i.elapsedTime/1e3}s`),e.postMessage({type:"IPyWidgets_Reply_Widget_Version",payload:o}).then(y,y)};e.onDidReceiveMessage(async i=>{b.ci(`\x1B[32mWidget Coordinator received ${i.type}`),this.onMessage(e,i.type,i.payload),i.type==="IPyWidgets_Request_Widget_Version"&&await n(),i.type==="IPyWidgets_Window_Alert"&&vs.window.showInformationMessage(i.message),i.type==="IPyWidgets_Window_Open"&&vs.env.openExternal(vs.Uri.parse(i.url)),i.type==="IPyWidgets_Ready"&&(b.trace("Web view is ready to receive widget messages"),this.readyMessageReceived=!0,this.sendPendingWebViewMessages(e))},this,this.disposables),e.postMessage({type:"IPyWidgets_IsReadyRequest",payload:void 0}).then(y,y),n().catch(y)}onMessage(e,t,n){t==="ipywidget_load_success"?this.sendLoadSucceededTelemetry(n).catch(y):t==="ipywidget_load_failure"?this.handleWidgetLoadFailure(e,n).catch(y):t==="ipywidget_widget_version_not_supported"?this.sendUnsupportedWidgetVersionFailureTelemetry(n).catch(y):t==="ipywidget_render_failure"?this.sendRenderFailureTelemetry(n):t==="ipywidget_unhandled_kernel_message"&&this.handleUnhandledMessage(n),this.getIPyWidgetMessageDispatcher().receiveMessage({message:t,payload:n}),this.getIPyWidgetScriptSource().onMessage(t,n)}sendPendingWebViewMessages(e){if(this.readyMessageReceived)for(;this.queuedMessages.length;)e.postMessage(this.queuedMessages.shift()).then(y,y)}initialize(){this.getIPyWidgetScriptSource().initialize(),this.getIPyWidgetMessageDispatcher().initialize()}async sendLoadSucceededTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_LOAD_SUCCESS",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}async handleWidgetLoadFailure(e,t){try{let n=t.error.toString(),i=this.configService.getSettings(void 0).widgetScriptSources,o=i.length>0,s=`${t.moduleName}:${t.moduleVersion}`;if(!t.isOnline)n=C.loadClassFailedWithNoInternet(t.moduleName,t.moduleVersion),vs.window.showErrorMessage(n).then(y,y);else if(!o&&!this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.has(s)){this.modulesForWhichWeHaveDisplayedWidgetErrorMessage.add(s);let a=Ue.moreInfo,l=C.enableCDNForWidgetsButton;n=C.enableCDNForWidgetsSetting(t.moduleName,t.moduleVersion),vs.window.showErrorMessage(n,{modal:!0},l,a).then(c=>{switch(c){case a:vs.env.openExternal(vs.Uri.parse("https://aka.ms/PVSCIPyWidgets"));break;case l:this.enableCDNForWidgets(e).catch(y);break;default:break}},y)}b.error(`Widget load failure ${n}`,i,t),J("DS_INTERNAL.IPYWIDGET_LOAD_FAILURE",0,{isOnline:t.isOnline,moduleHash:await Rt(t.moduleName),moduleVersion:t.moduleVersion,timedout:t.timedout})}catch(n){}}async enableCDNForWidgets(e){await vs.commands.executeCommand(Q.EnableLoadingWidgetsFrom3rdPartySource),await e.postMessage({type:"IPyWidgets_AttemptToDownloadFailedWidgetsAgain"})}async sendUnsupportedWidgetVersionFailureTelemetry(e){try{J("DS_INTERNAL.IPYWIDGET_WIDGET_VERSION_NOT_SUPPORTED_LOAD_FAILURE",0,{moduleHash:await Rt(e.moduleName),moduleVersion:e.moduleVersion})}catch(t){}}sendRenderFailureTelemetry(e){try{b.error("Error rendering a widget: ",e),J("DS_INTERNAL.IPYWIDGET_RENDER_FAILURE")}catch(t){}}handleUnhandledMessage(e){if(e.header.msg_type!=="status")try{if(e.header.msg_type==="error"){let t=e;t.content.traceback=t.content.traceback.map(bu)}b.trace(`Unhandled widget kernel message: ${e.header.msg_type} ${e.content}`),this.jupyterOutput.appendLine(C.unhandledMessage(e.header.msg_type,JSON.stringify(e.content))),J("DS_INTERNAL.IPYWIDGET_UNHANDLED_MESSAGE",void 0,{msg_type:e.header.msg_type})}catch(t){}}getIPyWidgetMessageDispatcher(){return this.ipyWidgetMessageDispatcher||(this.ipyWidgetMessageDispatcher=this.serviceContainer.get(rp).create(this.document),this.disposables.push(this.ipyWidgetMessageDispatcher.postMessage(this.cacheOrSend,this))),this.ipyWidgetMessageDispatcher}getIPyWidgetScriptSource(){return this.ipyWidgetScriptSource||(this.ipyWidgetScriptSource=new HA(this.document,this.serviceContainer.get(He),this.serviceContainer.get(ie),this.serviceContainer.get(Me),this.serviceContainer.get(qA),this.serviceContainer.get(ql)),this.disposables.push(this.ipyWidgetScriptSource.postMessage(this.cacheOrSend,this))),this.ipyWidgetScriptSource}cacheOrSend(e){if(!this.listeningToPostMessageEvent){b.ci("\x1B[32mQueuing messages (no listeners)"),this.cachedMessages.push(e);return}this.cachedMessages.forEach(t=>this.postEmitter.fire(t)),this.cachedMessages=[],this.postEmitter.fire(e)}};E([In()],ED.prototype,"enableCDNForWidgets",1);var a9=class{constructor(e,t){this.editor=e;this.pendingMessages=[];this.disposables=[];this._onDidReceiveMessage=new vm.EventEmitter;this.changeController(t)}get controller(){if(!this._controller)throw new Error("No controller defined");return this._controller.controller}changeController(e){var t,n;((t=this._controller)==null?void 0:t.id)!==e.id&&((n=this.controllerMessageHandler)==null||n.dispose(),this._controller=e,this.controllerMessageHandler=e.onDidReceiveMessage(i=>{var o;i.editor===this.editor&&((o=this.controller)==null?void 0:o.id)===e.id&&(this.eventHandlerListening?(this.sendPendingMessages(),this._onDidReceiveMessage.fire(i.message)):this.pendingMessages.push(i.message))},this,this.disposables))}dispose(){me(this.disposables)}get onDidReceiveMessage(){return this.eventHandlerListening=!0,setTimeout(()=>this.sendPendingMessages(),0),this._onDidReceiveMessage.event}postMessage(e){return this.controller.postMessage(e,this.editor)}asWebviewUri(e){return this.controller.asWebviewUri(e)}sendPendingMessages(){if(this.pendingMessages.length){let e=this.pendingMessages.shift();for(;e;)this._onDidReceiveMessage.fire(e),e=this.pendingMessages.shift()}}},gm=class{constructor(e,t,n){this.serviceContainer=e;this.disposableRegistry=t;this.controllerManager=n;this.messageCoordinators=new WeakMap;this.notebookDisposables=new WeakMap;this.notebookCommunications=new WeakMap;this.notebookEditors=new WeakMap}activate(){vm.window.onDidChangeVisibleNotebookEditors(this.onDidChangeVisibleNotebookEditors,this,this.disposableRegistry),vm.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebookDocument,this,this.disposableRegistry),this.controllerManager.onControllerSelected(this.onDidSelectController,this,this.disposableRegistry)}onDidSelectController(e){let t=this.messageCoordinators.get(e.notebook);t&&(this.messageCoordinators.delete(e.notebook),vm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>{let i=this.notebookCommunications.get(n);this.notebookCommunications.delete(n),i&&i.controller!==e.controller.controller&&(this.notebookCommunications.delete(n),i&&i.dispose())}),t==null||t.dispose()),vm.window.visibleNotebookEditors.filter(n=>n.notebook===e.notebook).forEach(n=>this.initializeNotebookCommunication(n,e.controller))}initializeNotebookCommunication(e,t){if(e.notebook.isClosed||!br(e.notebook))return;let n=e.notebook;if(!t){b.trace(`No controller, hence notebook communications cannot be initialized for editor ${ye(e.notebook.uri)}`);return}if(this.notebookCommunications.has(e))return;let i=new a9(e,t);this.addNotebookDisposables(n,[i]),this.notebookCommunications.set(e,i);let o=this.messageCoordinators.get(n);o||(o=new ED(n,this.serviceContainer),this.messageCoordinators.set(n,o)),o.attach(i)}addNotebookDisposables(e,t){let n=this.notebookDisposables.get(e)||[];n.push(...t),this.notebookDisposables.set(e,n)}async onDidChangeVisibleNotebookEditors(e){e.forEach(t=>{let n=this.controllerManager.getSelected(t.notebook);this.initializeNotebookCommunication(t,n)})}onDidCloseNotebookDocument(e){var n;let t=this.notebookEditors.get(e)||[];me(this.notebookDisposables.get(e)||[]),t.forEach(i=>{var o;return(o=this.notebookCommunications.get(i))==null?void 0:o.dispose()}),(n=this.messageCoordinators.get(e))==null||n.dispose(),this.messageCoordinators.delete(e)}};gm=E([(0,zS.injectable)(),I(0,(0,zS.inject)(Ur)),I(1,(0,zS.inject)(ie)),I(2,(0,zS.inject)(kt))],gm);d();var ym=$(te());var QS=class{constructor(e,t,n,i,o){this.disposables=e;this.kernelProvider=t;this.controllers=n;this.liveKernelTracker=i;this.preferredRemoteKernelIdProvider=o}activate(){this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables),this.controllers.onControllerSelectionChanged(this.onNotebookControllerSelectionChanged,this,this.disposables)}onNotebookControllerSelectionChanged({selected:e,notebook:t,controller:n}){t.isClosed||(n.connection.kind==="connectToLiveRemoteKernel"&&n.connection.kernelModel.id&&(e?this.liveKernelTracker.trackKernelIdAsUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id):this.liveKernelTracker.trackKernelIdAsNotUsed(t.uri,n.connection.serverProviderHandle,n.connection.kernelModel.id)),tr(n.connection)&&this.preferredRemoteKernelIdProvider.clearPreferredRemoteKernelId(t.uri).catch(y))}onDidStartKernel(e){if(!e.resourceUri)return;let t=e.resourceUri;if(e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")return;let n=e.kernelConnectionMetadata.serverProviderHandle,i=()=>{var s,a;let o=(a=(s=e.session)==null?void 0:s.kernel)==null?void 0:a.id;!e.disposed&&!e.disposing&&o&&(b.debug(`Updating preferred kernel for remote notebook ${o}`),this.preferredRemoteKernelIdProvider.storePreferredRemoteKernelId(t,o).catch(y),this.liveKernelTracker.trackKernelIdAsUsed(t,n,o))};i(),e.onDidKernelSocketChange(i,this,this.disposables)}};QS=E([(0,ym.injectable)(),I(0,(0,ym.inject)(ie)),I(1,(0,ym.inject)(He)),I(2,(0,ym.inject)(kt)),I(3,(0,ym.inject)(Xg)),I(4,(0,ym.inject)(Js))],QS);d();var vv=$(te());var OZ=require("vscode");var gv=class{constructor(e,t,n,i){this.disposables=e;this.uriStorage=t;this.controllers=n;this.serverProviderRegistry=i;this.handledServerProviderChanges=new WeakSet}activate(){this.serverProviderRegistry.jupyterCollections.forEach(e=>this.checkExpiredServersInJupyterCollection(e)),this.serverProviderRegistry.onDidChangeCollections(({added:e,removed:t})=>{e.forEach(n=>this.checkExpiredServersInJupyterCollection(n)),t.forEach(n=>this.removeControllersBelongingToDisposedProvider(n.extensionId,n.id))},this,this.disposables)}async checkExpiredServersInJupyterCollection(e){!this.handledServerProviderChanges.has(e.serverProvider)&&e.serverProvider.onDidChangeServers&&(this.handledServerProviderChanges.add(e.serverProvider),e.serverProvider.onDidChangeServers(()=>this.checkExpiredServersInJupyterCollection(e).catch(y),this,this.disposables));let t=new OZ.CancellationTokenSource;this.disposables.push(t);try{let n=await Promise.resolve(e.serverProvider.provideJupyterServers(t.token));await this.removeControllersAndUriStorageBelongingToInvalidServers(e.extensionId,e.id,(n||[]).map(i=>i.id))}finally{t.dispose()}}async removeControllersAndUriStorageBelongingToInvalidServers(e,t,n){let i=this.uriStorage.all;await Promise.all(i.filter(o=>o.provider.extensionId===e&&o.provider.id===t).map(async o=>{n.includes(o.provider.handle)||await this.uriStorage.remove(o.provider)})),this.controllers.registered.forEach(o=>{let s=o.connection;tr(s)||s.serverProviderHandle.extensionId!==e||s.serverProviderHandle.id!==t||n.includes(s.serverProviderHandle.handle)||(b.warn(`Deleting controller ${o.id} as it is associated with a server Id that has been removed`),o.dispose())})}removeControllersBelongingToDisposedProvider(e,t){this.controllers.registered.forEach(n=>{let i=n.connection;tr(i)||i.serverProviderHandle.extensionId!==e||i.serverProviderHandle.id!==t||(b.warn(`Deleting controller ${n.id} as it is associated with a Provider Id that has been removed`),n.dispose())})}};E([In("Failed to check what servers were shutdown in Controller Watcher")],gv.prototype,"checkExpiredServersInJupyterCollection",1),gv=E([(0,vv.injectable)(),I(0,(0,vv.inject)(ie)),I(1,(0,vv.inject)(hr)),I(2,(0,vv.inject)(kt)),I(3,(0,vv.inject)(ur))],gv);d();d();var ZS=$(te());d();var LZ=require("vscode");var $A=class{constructor(e,t,n,i,o,s){this.label=e;this._description=t;this.detail=n;this.category=i;this.serverDisplayName=o;this.getDescription=s;this._onDidChange=new LZ.EventEmitter;this.onDidChange=this._onDidChange.event}get description(){var e;return((e=this.getDescription)==null?void 0:e.call(this))||this._description}set description(e){this._description=e}dispose(){this._onDidChange.dispose()}triggerChange(){this._onDidChange.fire(this)}};function KZ(r){switch(r.kind){case"connectToLiveRemoteKernel":return C.kernelCategoryForJupyterSession;case"startUsingRemoteKernelSpec":return C.kernelCategoryForRemoteJupyterKernel;default:return l9(r)}}function l9(r){switch(r.kind){case"startUsingLocalKernelSpec":return C.kernelCategoryForJupyterKernel;case"startUsingPythonInterpreter":{if(zg(r.kernelSpec)==="registeredByNewVersionOfExtForCustomKernelSpec")return C.kernelCategoryForJupyterKernel;switch(Zr(r.interpreter)){case"Conda":return kp(r.interpreter)?C.kernelCategoryForCondaWithoutPython:C.kernelCategoryForConda;case"PipEnv":return C.kernelCategoryForPipEnv;case"Poetry":return C.kernelCategoryForPoetry;case"Pyenv":return C.kernelCategoryForPyEnv;case"Venv":case"VirtualEnv":case"VirtualEnvWrapper":return C.kernelCategoryForVirtual;default:return C.kernelCategoryForGlobal}}default:return""}}var XS=class{constructor(e,t,n){this.platform=e;this.jupyterUriProviderRegistration=t;this.disposables=n;this.details=new Map}getDisplayData(e){if(!this.details.get(e.id)){let i=ut(e),o=hz(e,this.platform);e.kind==="connectToLiveRemoteKernel"&&(o=UV(e));let s=e.kind==="connectToLiveRemoteKernel"?()=>UV(e):void 0,a=l9(e),l=new $A(i,o,"",a,void 0,s);this.disposables.push(l),this.details.set(e.id,l)}let t=this.details.get(e.id);if(this.details.set(e.id,t),e.kind==="connectToLiveRemoteKernel"||e.kind==="startUsingRemoteKernelSpec"){let i=yS(e.serverProviderHandle,this.jupyterUriProviderRegistration,C.kernelDefaultRemoteDisplayName);t.serverDisplayName!==i&&(t.serverDisplayName=i,t.triggerChange())}let n=KZ(e);return t.category!==n&&(t.category=n,t.triggerChange()),t}};XS=E([(0,ZS.injectable)(),I(0,(0,ZS.inject)(hs)),I(1,(0,ZS.inject)(ur)),I(2,(0,ZS.inject)(ie))],XS);d();var np=$(te()),ip=require("vscode");d();var bm=$(te()),WZ=require("vscode");d();var FZ=require("vscode");function zA(r){var e;try{return vz(xa(r))||((e=r.getCells().find(n=>n.kind===FZ.NotebookCellKind.Code))==null?void 0:e.document.languageId)}catch(t){b.warn("Failed to determine language of first cell",t)}}var UZ="DATASCIENCE.LAST_SAVED_CELL_LANGUAGE",qs=class{constructor(e,t,n){this.disposables=e;this.globalMemento=t;this.pythonExtensionChecker=n}getPreferredLanguage(e){var i,o;let t=((i=e==null?void 0:e.language_info)==null?void 0:i.name)||((o=e==null?void 0:e.kernelspec)==null?void 0:o.language)||this.lastSavedNotebookCellLanguage,n=this.pythonExtensionChecker.isPythonExtensionInstalled?qe:"plaintext";return Vc(t||n)}activate(){WZ.workspace.onDidSaveNotebookDocument(this.onDidSaveNotebookDocument,this,this.disposables)}getSupportedLanguages(e){if(Gt(e))return sB;{let t=Vc(Zc(e)||"");return t&&lB.includes(t.toLowerCase())?[t,"raw"]:[]}}get lastSavedNotebookCellLanguage(){return this.globalMemento.get(UZ)}async onDidSaveNotebookDocument(e){if(!br(e))return;let t=zA(e);t&&t!==this.lastSavedNotebookCellLanguage&&await this.globalMemento.update(UZ,t)}};E([In("Saving last saved cell language")],qs.prototype,"onDidSaveNotebookDocument",1),qs=E([(0,bm.injectable)(),I(0,(0,bm.inject)(ie)),I(1,(0,bm.inject)(_t)),I(1,(0,bm.named)(sr)),I(2,(0,bm.inject)(Eo))],qs);d();function VZ(r){let e={kernelSpecCount:0,localKernelSpecCount:0,remoteKernelSpecCount:0,kernelInterpreterCount:0,kernelLiveCount:0};r.forEach(t=>{switch(t.kind){case"connectToLiveRemoteKernel":e.kernelLiveCount+=1;break;case"startUsingRemoteKernelSpec":e.localKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingLocalKernelSpec":e.remoteKernelSpecCount+=1,e.kernelSpecCount+=1;break;case"startUsingPythonInterpreter":{e.kernelInterpreterCount+=1;break}default:break}}),J("DS_INTERNAL.KERNEL_COUNT",{...e})}d();var jt=require("vscode");d();var Su=require("vscode");d();async function jZ(r,e,t){let n=`${await eI({uri:t})}#${Pi.get(e)}`;await r.update(n,void 0)}d();var Wo=Symbol("INotebookEditorProvider");d();var BZ=require("vscode");async function HZ(r,e){let t=e==null?void 0:e.findNotebookEditor(r);return t?BZ.commands.executeCommand("notebook.selectKernel",{notebookEditor:t}):(b.error("Unable to select kernel as the Notebook document could not be identified"),!1)}d();var JZ=require("vscode");var QA=class extends tu{constructor(e){super(C.failedToStartAnUntrustedKernelSpec(ut(e),e.kernelSpec.specFile?ye(JZ.Uri.file(e.kernelSpec.specFile)):""),void 0,e)}};var $r=class $r{static async switchController(e,t){let i=t.get(Wo).findNotebookEditor(e),o=t.get(kt),s,a=ke(),l=o.onControllerSelected(u=>a.resolve(u.controller));return await HZ(e,t.get(Wo))&&i&&(s=await a.promise),l.dispose(),s?{controller:s.controller,metadata:s.connection}:void 0}static async notifyAndRestartDeadKernel(e){let t=await Su.window.showErrorMessage(C.cannotRunCellKernelIsDead(ut(e.kernelConnectionMetadata)),{modal:!0},C.showJupyterLogs,C.restartKernel),n=!1;switch(t){case C.restartKernel:{await e.restart(),n=!0;break}case C.showJupyterLogs:Su.commands.executeCommand(Q.ViewJupyterOutput).then(y,y)}return n}static async handleKernelError(e,t,n,i,o,s,a,l){let c=e.get(_t,sr),u=e.get(xn);a.interpreter&&n==="start"&&jZ(c,19,a.interpreter.uri).catch(y);let p=await u.handleKernelError(t,n,a,i,l),f=tr(a),m=e.tryGet($d);switch((m==null?void 0:m.isSupported)&&f&&n==="start"&&Yr(i,"DS_INTERNAL.RAWKERNEL_SESSION_NO_IPYKERNEL",{reason:p}),o.dispose().catch(y),p){case 1:case 2:throw t;case 3:{let g=await $r.switchController(i,e);if(!g)throw t;s=g.controller,a=g.metadata;break}}return{controller:s,metadata:a}}static convertContextToFunction(e,t){switch(e){case"start":case"execution":return n=>n.start(t);case"interrupt":return n=>n.interrupt();case"restart":return n=>n.restart()}}static async verifyKernelState(e,t,n,i,o,s,a){let{kernel:l,deadKernelAction:c}=await i;if(PA(l)){if(this.deleteKernelInfo(t,i),c==="deadKernelWasNoRestarted")throw new um(l.kernelConnectionMetadata);return c==="deadKernelWasRestarted"?l:$r.wrapKernelMethod(l.kernelConnectionMetadata,"start",o,e,t,n,a,s)}return l}static async wrapKernelMethod(e,t,n,i,o,s,a,l=()=>void 0){var f,m,h,g;let c=this.getKernelInfo(o);if(!s.disableUI&&(c!=null&&c.options.disableUI)&&(c.options.disableUI=!1),!s.disableUI&&(c!=null&&c.kernel.resolved)&&((m=(f=c==null?void 0:c.kernel.value)==null?void 0:f.kernel)!=null&&m.disposed||(g=(h=c==null?void 0:c.kernel.value)==null?void 0:h.kernel)!=null&&g.disposing)&&(this.deleteKernelInfo(o),c=void 0),c&&t!=="restart"&&t!=="interrupt")return $r.verifyKernelState(i,o,s,c.kernel.promise,n,l,a);b.debug(`${t} the kernel, options.disableUI=${s.disableUI} for ${ye("notebook"in o?o.notebook.uri:o.resource)}`);let u=$r.wrapKernelMethodImpl(e,t,i,o,s,n,l),p=Fu(u);return p.promise.catch(y),u.then(v=>{v.kernel.onDisposed(()=>{this.deleteKernelInfo(o,p.promise)},void 0,a)}).catch(()=>{this.deleteKernelInfo(o,p.promise)}),this.setKernelInfo(o,p,s),$r.verifyKernelState(i,o,s,p.promise,n,l,a)}static getKernelInfo(e){return"notebook"in e?$r.connectionsByNotebook.get(e.notebook):$r.connectionsByUri.get(e.resource.toString())}static setKernelInfo(e,t,n){"notebook"in e?$r.connectionsByNotebook.set(e.notebook,{kernel:t,options:n}):$r.connectionsByUri.set(e.resource.toString(),{kernel:t,options:n})}static deleteKernelInfo(e,t){var n,i;if(!t){"notebook"in e?$r.connectionsByNotebook.delete(e.notebook):$r.connectionsByUri.delete(e.resource.toString());return}"notebook"in e&&((n=$r.connectionsByNotebook.get(e.notebook))==null?void 0:n.kernel.promise)===t?$r.connectionsByNotebook.delete(e.notebook):e.resource&&((i=$r.connectionsByUri.get(e.resource.toString()))==null?void 0:i.kernel.promise)===t&&$r.connectionsByUri.delete(e.resource.toString())}static verifyWeCanStartKernel(e,t){if(!tr(e)||!e.kernelSpec.specFile)return;if(!t.get(US).isTrusted(Su.Uri.file(e.kernelSpec.specFile)))throw new QA(e)}static async wrapKernelMethodImpl(e,t,n,i,o,s,a){let l=n.get(He),c=n.get(Yg),u,p=$r.convertContextToFunction(t,o),f=t,m="controller"in i?i.controller:void 0;for(t==="start"&&$r.verifyWeCanStartKernel(e,n);u===void 0;){if("notebook"in i&&i.notebook.isClosed)throw new Su.CancellationError;u="notebook"in i?l.getOrCreate(i.notebook,{metadata:e,controller:m||i.controller,resourceUri:i.resource}):c.getOrCreate(i.resource,{metadata:e,resourceUri:i.resource});try{if(t!=="restart"&&PA(u)&&!o.disableUI){let h=await $r.notifyAndRestartDeadKernel(u);return{kernel:u,deadKernelAction:h?"deadKernelWasRestarted":"deadKernelWasNoRestarted"}}else{if(a(f,u),await p(u),"notebook"in i&&i.notebook.isClosed)throw new Su.CancellationError;PA(u)&&!o.disableUI&&f!=="interrupt"&&await $r.notifyAndRestartDeadKernel(u)}}catch(h){if(xi(h)||b.warn(`Error occurred while trying to ${f} the kernel, options.disableUI=${o.disableUI}`,h),o.disableUI)throw h;if("notebook"in i&&i.notebook.isClosed)throw new Su.CancellationError;let g=await $r.handleKernelError(n,h,f,i.resource,u,m,e,s);if(m=g.controller,e=g.metadata,p=v=>v.start(o),f="start",s==="3rdPartyExtension")throw h;u=void 0}}return{kernel:u}}static async connectToNotebookKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return $r.wrapKernelMethod(e,"start",s,t,n,i,o,a)}static async connectToKernel(e,t,n,i,o,s="jupyterExtension",a=()=>void 0){return $r.wrapKernelMethod(e,"start",s,t,n,i,o,a)}};$r.connectionsByNotebook=new WeakMap,$r.connectionsByUri=new Map;var Aa=$r;d();var yv=class{constructor(e){this.controller=e}get id(){return this.controller.id}createNotebookCellExecution(e){return this.controller.createNotebookCellExecution(e)}};d();var ZA=require("vscode");var XA=class extends Vr{constructor(t,n,i){super();this.kernel=t;this.controller=n;this.notebook=i}initialize(){let t=this.kernel,n=this.controller,i=this.notebook;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"||t.status!=="busy"&&t.status!=="unknown"||!n.createNotebookExecution)return;this._register(ZA.workspace.onDidCloseNotebookDocument(s=>{s===i&&this.dispose()},this)),this._register(n.onDidChangeSelectedNotebooks(s=>{s.notebook===i&&s.selected===!1&&this.dispose()},this)),this._register(t.onStatusChanged(s=>{s!=="busy"&&s!=="unknown"&&this.dispose()},this));let o=n.createNotebookExecution(i);o.start(),this._register(new ZA.Disposable(()=>o.end()))}};var eM=class r{constructor(e,t,n,i,o,s,a,l,c,u,p){this.kernelConnection=e;this._viewType=n;this.kernelProvider=i;this.context=o;this.languageService=a;this.configuration=l;this.extensionChecker=c;this.serviceContainer=u;this.displayDataProvider=p;this._onNotebookControllerSelectionChanged=new jt.EventEmitter;this._onConnecting=new jt.EventEmitter;this.pendingCellAdditions=new WeakMap;this._onDidDispose=new jt.EventEmitter;this.disposables=[];this.notebookKernels=new WeakMap;this.isDisposed=!1;this.runningCellExecutions=new WeakMap;this.associatedDocuments=new WeakMap;this.restoredConnections=new WeakSet;var f;uY(e.id,(f=e.interpreter)==null?void 0:f.id),s.push(this),this._onNotebookControllerSelected=new jt.EventEmitter,this.displayData=this.displayDataProvider.getDisplayData(this.connection),this.controller=jt.notebooks.createNotebookController(t,n,this.displayData.label,this.handleExecution.bind(this),this.getRendererScripts()),this.displayData.onDidChange(this.updateDisplayData,this,this.disposables),this.updateDisplayData(),this.controller.interruptHandler=this.handleInterrupt.bind(this),this.controller.supportsExecutionOrder=!0,this.controller.supportedLanguages=this.languageService.getSupportedLanguages(e),this.controller.onDidChangeSelectedNotebooks(this.onDidChangeSelectedNotebooks,this,this.disposables),jt.workspace.onDidCloseNotebookDocument(m=>{this.associatedDocuments.delete(m)},this,this.disposables)}get id(){return this.controller.id}get label(){return this.controller.label}get connection(){return this.kernelConnection}get viewType(){return this._viewType}get onNotebookControllerSelected(){return this._onNotebookControllerSelected.event}get onNotebookControllerSelectionChanged(){return this._onNotebookControllerSelectionChanged.event}get onConnecting(){return this._onConnecting.event}get onDidReceiveMessage(){return this.controller.onDidReceiveMessage}get onDidDispose(){return this._onDidDispose.event}isAssociatedWithDocument(e){return this.associatedDocuments.has(e)}static create(e,t,n,i,o,s,a,l,c,u,p,f){let m=new r(e,t,n,i,o,s,a,l,c,u,p);try{m.controller.variableProvider=f}catch(h){b.warn("Failed to attach variable provider",h)}return m}async restoreConnection(e){var u;if(this.restoredConnections.has(e))return;this.restoredConnections.add(e);let t=await this.connectToKernel(e,new Ir(!0));if(this.kernelConnection.kind==="connectToLiveRemoteKernel"){let p=new XA(t,this.controller,e);this.disposables.push(p),p.initialize()}let n=this.kernelProvider.getKernelExecution(t),o=await this.serviceContainer.get(Jl).getLastTrackedCellExecution(e,t);if(!((u=t.session)!=null&&u.kernel)||n.pendingCells.length||!o||e.cellCount<o.cellIndex||e.cellAt(o.cellIndex).kind!==jt.NotebookCellKind.Code)return;let s=!1,a=[],l,c=(p,f)=>{if(!(f.direction==="send"||s)&&Xd(f.msg)===o.msg_id){if("msg_type"in f.msg&&f.msg.msg_type==="status"&&"execution_state"in f.msg.content&&f.msg.content.execution_state==="idle")return;s=!0,n.resumeCellExecution(e.cellAt(o.cellIndex),{msg_id:o.msg_id,startTime:o.startTime,executionCount:o.executionCount}).catch(y),me(a)}};t.session.kernel.anyMessage.connect(c),l=new jt.Disposable(()=>{ea(()=>{var p,f;return(f=(p=t.session)==null?void 0:p.kernel)==null?void 0:f.anyMessage.disconnect(c)})}),a.push(l),this.disposables.push(l)}updateConnection(e){e.kind!=="connectToLiveRemoteKernel"&&(this.controller.label=ut(e))}asWebviewUri(e){return this.controller.asWebviewUri(e)}postMessage(e,t){let n=e&&"message"in e?e.message:"";return b.ci(`\x1B[32mPosting message to Notebook UI ${n}`),this.controller.postMessage(e,t)}setPendingCellAddition(e,t){if(this.viewType!==vt)throw new Error("setPendingCellAddition only applies to the Interactive Window");this.pendingCellAdditions.set(e,t)}dispose(){if(this.isDisposed)return;let e=jt.workspace.notebookDocuments.filter(t=>this.associatedDocuments.has(t)).map(t=>t.uri.toString());b.debug(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""}`),b.ci(`Disposing controller ${this.id} associated with connection ${this.connection.id} ${e.length?"and documents "+e.join(", "):""} called from ${new Error("").stack}`),this.isDisposed=!0,this._onNotebookControllerSelected.dispose(),this._onNotebookControllerSelectionChanged.dispose(),this._onConnecting.dispose(),this.controller.dispose(),this._onDidDispose.fire(),this._onDidDispose.dispose(),me(this.disposables)}updateDisplayData(){this.controller.label=this.displayData.label;let e=this.connection.kind==="connectToLiveRemoteKernel"?"":this.displayData.description;this.controller.description=e,this.displayData.serverDisplayName&&(this.controller.description=e?`${e} (${this.displayData.serverDisplayName})`:this.displayData.serverDisplayName)}async handleExecution(e,t){if(e.length<1)return;let n=Bc(t);n==null||n.cellExecutionCount(e.length);let i=n==null?void 0:n.preExecuteCellTelemetry();this.pendingCellAdditions.has(t)&&await this.pendingCellAdditions.get(t),e=e.filter(o=>o.index<0?(b.warn(`Attempting to run a cell with index ${o.index}, kind ${o.kind}, text = ${o.document.getText()}`),!1):!0),jt.workspace.isTrusted&&(b.debug(`Handle Execution of Cells ${e.map(o=>o.index)} for ${ye(t.uri)}`),await Ra(t.uri,this.connection),i==null||i.stop(),await Promise.all(e.map(o=>this.executeCell(t,o))))}async onDidChangeSelectedNotebooks(e){var n,i;if(b.ci(`NotebookController selection event called for notebook ${e.notebook.uri.toString()} & controller ${this.connection.kind}:${this.id}. Selected ${e.selected} `),this.associatedDocuments.has(e.notebook)&&e.selected)return;if(!e.selected){let o=this.kernelProvider.get(e.notebook);(o==null?void 0:o.kernelConnectionMetadata.id)===this.kernelConnection.id&&(b.info(`Disposing kernel ${this.kernelConnection.id} for notebook ${ye(e.notebook.uri)} due to selection of another kernel or closing of the notebook`),o.dispose().catch(y)),this.associatedDocuments.delete(e.notebook),this._onNotebookControllerSelectionChanged.fire(e);return}if(!br(e.notebook)&&e.notebook.notebookType!==vt||!jt.workspace.isTrusted)return;(i=Bc(e.notebook))==null||i.kernelSelected(this.kernelConnection.id,(n=this.kernelConnection.interpreter)==null?void 0:n.id),aEe(this.kernelConnection);let t=ke();b.ci(`Controller ${this.connection.kind}:${this.id} associated with nb ${ye(e.notebook.uri)}`),this.associatedDocuments.set(e.notebook,t.promise),await this.onDidSelectController(e.notebook),await this.updateCellLanguages(e.notebook),this._onNotebookControllerSelected.fire({notebook:e.notebook,controller:this}),this._onNotebookControllerSelectionChanged.fire(e),b.debug("Controller selection change completed"),t.resolve()}async updateCellLanguages(e){let t=this.controller.supportedLanguages;if(!t||(t==null?void 0:t.length)===0)return;let i=Gt(this.kernelConnection)?qe:t[0];await Promise.all(e.getCells().filter(o=>o.kind===jt.NotebookCellKind.Code).map(async o=>{t.includes(o.document.languageId)||await jt.languages.setTextDocumentLanguage(o.document,i).then(y,y)}))}getRendererScripts(){return this.context.extensionMode===jt.ExtensionMode.Development||this.context.extensionMode===jt.ExtensionMode.Test?[new jt.NotebookRendererScript(jt.Uri.joinPath(this.context.extensionUri,"dist","webviews","webview-side","widgetTester","widgetTester.js"))]:[]}handleInterrupt(e){b.debug(`VS Code interrupted kernel for ${ye(e.uri)}`),e.getCells().forEach(t=>it(t,"Cell cancellation requested")),jt.commands.executeCommand(Q.InterruptKernel,{notebookEditor:{notebookUri:e.uri}}).then(y,t=>b.error("Failed to interrupt",t))}createCellExecutionIfNecessary(e,t){let n=this.runningCellExecutions.get(e.notebook);if(!n||n.cell===e){n==null||n.end(void 0,void 0),n=po.getOrCreate(e,t,!0),this.runningCellExecutions.set(e.notebook,n);let i=n.end.bind(n);n.end=(o,s)=>{this.runningCellExecutions.delete(e.notebook),i(o,s)}}return n}async executeCell(e,t,n){var f;let i=new kn,o=i.add(new jt.CancellationTokenSource);i.add(jt.workspace.onDidCloseNotebookDocument(m=>m===e?o.cancel():void 0));let s=this.createCellExecutionIfNecessary(t,new yv(this.controller)),a="start",l,c=new yv(this.controller),u=!1,p=this.serviceContainer.get(Jl);try{if(l=await this.connectToKernel(e,new Ir(!1)),l.disposing)throw new jt.CancellationError;let m=(f=Bc(e))==null?void 0:f.executeCell();m&&i.add(new jt.Disposable(()=>m.stop())),u=!0,l&&l.controller.id!==c.id&&(c=l.controller,s=this.createCellExecutionIfNecessary(t,l.controller)),a="execution",l.controller.id===this.id&&this.updateKernelInfoInNotebookWhenAvailable(l,e),p.trackCellExecution(t,l);let g=this.kernelProvider.getKernelExecution(l).executeCell(t,n);return g.then(()=>{if(l&&!ME.isExiting)return p.deleteTrackedCellExecution(t,l)}).catch(y),await g}catch(m){if(m instanceof hm)return;xi(m)||b.error("Error in execution",m),u||(s.start(),s.clearOutput(t).then(y,y));let h=this.serviceContainer.get(xn);m=ti.unwrap(m);let g=xi(m)||m instanceof um;await Yf(t,c,await h.getErrorMessageForDisplayInCell(m,a,e.uri),g)}finally{i.dispose()}}async connectToKernel(e,t){var i;let n=(i=Bc(e))==null?void 0:i.startKernel();return this._onConnecting.fire(),Aa.connectToNotebookKernel(this.kernelConnection,this.serviceContainer,{resource:e.uri,notebook:e,controller:this.controller},t,this.disposables).finally(()=>n==null?void 0:n.stop())}updateKernelInfoInNotebookWhenAvailable(e,t){if(this.notebookKernels.get(t)===e)return;this.notebookKernels.set(t,e);let n=[];jt.workspace.onDidCloseNotebookDocument(s=>{s===t&&me(n)},this,n);let i=e.onDisposed(()=>me(n)),o=e.onStatusChanged(async()=>{e.disposed||!e.info||this.associatedDocuments.has(t)&&(await qZ(t,e.kernelConnectionMetadata,e.info),e.info.status==="ok"&&me(n))});n.push({dispose:()=>o.dispose()}),n.push({dispose:()=>i==null?void 0:i.dispose()})}async onDidSelectController(e){let t=this.connection,n=this.kernelProvider.get(e);if(n&&bz(n.kernelConnectionMetadata,t)){b.info("Switch kernel did not change kernel.");return}if(Yr(e.uri,"DS_INTERNAL.SWITCH_KERNEL"),n&&jt.window.visibleNotebookEditors.filter(s=>s.notebook===e).forEach(s=>this.postMessage({message:"IPyWidgets_onKernelChanged",payload:void 0},s)),await qZ(e,t),e.notebookType===vt)return;let i=this.kernelProvider.getOrCreate(e,{metadata:t,controller:this.controller,resourceUri:e.uri});if(b.debug(`KernelProvider switched kernel to id = ${i.kernelConnectionMetadata.id}`),Gt(this.kernelConnection)&&!this.extensionChecker.isPythonExtensionInstalled)return;let o=this.serviceContainer.get(US);!this.configuration.getSettings(void 0).disableJupyterAutoStart&&tr(this.kernelConnection)&&this.kernelConnection.kernelSpec.specFile&&o.isTrusted(jt.Uri.file(this.kernelConnection.kernelSpec.specFile))&&this.connectToKernel(e,new Ir(!0))}};async function qZ(r,e,t){let n=xa(r)||{},{changed:i}=await dz(n,e,t);i&&await XG(r,n)}async function aEe(r){let e=await Np(r.interpreter,!0),t=(e==null?void 0:e.major)||0,n=(e==null?void 0:e.minor)||0;!e||t>=4||t<=0||n<=-1||r.kind!=="startUsingLocalKernelSpec"&&r.kind!=="startUsingPythonInterpreter"||(t<3||t===3&&n<=5)&&jt.window.showWarningMessage(C.warnWhenSelectingKernelWithUnSupportedPythonVersion,Ue.learnMore).then(i=>{if(i===Ue.learnMore)return GI("https://aka.ms/jupyterUnSupportedPythonKernelVersions")},y)}var e_=class{constructor(e,t,n,i,o,s){this.disposables=e;this.pythonEnvFilter=t;this.extensionChecker=n;this.serviceContainer=i;this.serverUriStorage=o;this.kernelFinder=s;this.registeredControllers=new Map;this.changeEmitter=new ip.EventEmitter;this.registeredMetadatas=new Map;this.selectedEmitter=new ip.EventEmitter;this.selectionChangedEmitter=new ip.EventEmitter;this.selectedControllers=new WeakMap;this._activeInterpreterControllerIds=new Set}get onDidChange(){return this.changeEmitter.event}get registered(){return[...this.registeredControllers.values()]}get all(){return this.metadatas}get metadatas(){return[...this.registeredMetadatas.values()]}get onControllerSelected(){return this.selectedEmitter.event}get onControllerSelectionChanged(){return this.selectionChangedEmitter.event}activate(){this.kernelFinder.onDidChangeKernels(()=>this.loadControllers(),this,this.disposables),this.kernelFinder.registered.forEach(e=>this.monitorDeletionOfConnections(e)),this.kernelFinder.onDidChangeRegistrations(e=>e.added.forEach(t=>this.monitorDeletionOfConnections(t)),this,this.disposables),this.pythonEnvFilter.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeFilter,this,this.disposables),this.serverUriStorage.onDidChange(this.onDidChangeUri,this,this.disposables),this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables),this.onDidChange(({added:e})=>{e.forEach(t=>{t.onNotebookControllerSelectionChanged(n=>{!n.selected&&this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(b.warn(`Removing controller ${t.id} for ${t.connection.kind} from kernel list`),t.dispose())},this,this.disposables)})},this,this.disposables),ip.workspace.onDidOpenNotebookDocument(this.onDidOpenNotebookDocument,this,this.disposables),ip.workspace.notebookDocuments.forEach(e=>this.onDidOpenNotebookDocument(e).catch(y)),this.loadControllers()}loadControllers(){this.controllersPromise=this.loadControllersImpl(),VZ(this.registered.map(e=>e.connection)),b.ci(`Providing notebook controllers with length ${this.registered.length}.`)}get loaded(){return this.controllersPromise}async onDidOpenNotebookDocument(e){e.notebookType!==It&&e.notebookType!==vt||ip.workspace.isTrusted}async loadControllersImpl(){let e=this.kernelFinder.kernels;this.createNotebookControllers(e),Array.from(this.registered).filter(n=>{let i=e.some(o=>o.id===n.connection.id)||Ji&&this._activeInterpreterControllerIds.has(n.id);return!i&&n.connection.kind==="connectToLiveRemoteKernel"?!0:this.canControllerBeDisposed(n)?(i||b.debug(`Controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}' is no longer a valid`),!i):!1}).forEach(n=>{b.warn(`Disposing old controller ${n.connection.kind}:'${n.id}' for view = '${n.viewType}'`),n.dispose()})}createNotebookControllers(e){if(e.length!==0)try{this.batchAdd(e,[It,vt])}catch(t){if(!xi(t,!0))throw t}}async monitorDeletionOfConnections(e){let t=e.onDidChangeKernels(({removed:n})=>{let i=new Set((n||[]).map(o=>o.id));this.registered.filter(o=>i.has(o.connection.id)).forEach(o=>{b.warn(`Deleting controller ${o.id} as it is associated with a connection that has been deleted ${o.connection.kind}:${o.id}`),o.dispose()})},this,this.disposables);this.kernelFinder.onDidChangeRegistrations(n=>{n.removed.includes(e)&&t.dispose()})}onDidChangeUri(){this.onDidChangeFilter()}async onDidRemoveServers(e){e.forEach(t=>{this.registered.forEach(n=>{Ot(n.connection)&&n.connection.serverProviderHandle.id===t.id&&n.connection.serverProviderHandle.handle===t.handle&&(b.warn(`Deleting controller ${n.id} as it is associated with a connection that has been removed`),n.dispose())})}),this.onDidChangeFilter()}onDidChangeFilter(){this.all.filter(t=>!this.isFiltered(t)).forEach(t=>this.addOrUpdate(t,[It,vt])),this.registered.forEach(t=>{this.isFiltered(t.connection)&&this.canControllerBeDisposed(t)&&(b.warn(`Deleting controller ${t.id} as it is associated with a connection that has been hidden`),t.dispose())})}batchAdd(e,t){let n=[];e.forEach(i=>{let{added:o}=this.addImpl(i,t,!1);n.push(...o)}),n.length&&this.changeEmitter.fire({added:n,removed:[]})}trackActiveInterpreterControllers(e){e.forEach(t=>this._activeInterpreterControllerIds.add(t.id))}canControllerBeDisposed(e){return!this._activeInterpreterControllerIds.has(e.id)&&!this.isControllerAttachedToADocument(e)}getSelected(e){return this.selectedControllers.get(e)}addOrUpdate(e,t){let{added:n,existing:i}=this.addImpl(e,t,!0);return n.concat(i)}addImpl(e,t,n){let i=[],o=[];b.ci(`Create Controller for ${e.kind} and id '${e.id}' for view ${t.join(", ")}`);try{t.map(s=>{let a=this.getControllerId(e,s);return this.registeredMetadatas.set(e.id,e),[a,s]}).filter(([s])=>{let a=this.registeredControllers.get(s);return a?(a.updateConnection(e),o.push(a),b.ci(`Found existing controller '${a.id}', not creating a new one just updating it`),!1):this.isFiltered(e)?(b.ci(`Existing controller '${s}' will be excluded as it is filtered`),!1):(b.ci(`Existing controller not found for '${s}', hence creating a new one`),!0)}).forEach(([s,a])=>{let l=eM.create(e,s,a,this.serviceContainer.get(He),this.serviceContainer.get(st),this.disposables,this.serviceContainer.get(qs),this.serviceContainer.get(Me),this.extensionChecker,this.serviceContainer,this.serviceContainer.get(NI),this.serviceContainer.get(KA)),c=[];l.onDidDispose(()=>{b.ci(`Deleting controller '${l.id}' associated with view ${a} from registration as it was disposed`),this.registeredControllers.delete(l.id),c.forEach(u=>u.dispose())},this,this.disposables),this.disposables.push(l),this.registeredControllers.set(l.id,l),i.push(l),l.onNotebookControllerSelected(u=>{var p;b.ci(`Controller ${(p=u.controller)==null?void 0:p.id} selected for ${u.notebook.uri.toString()}`),this.selectedControllers.set(u.notebook,u.controller),this.selectedEmitter.fire(u)},this,c),l.onNotebookControllerSelectionChanged(u=>this.selectionChangedEmitter.fire({...u,controller:l}),this,c)}),n&&i.length&&this.changeEmitter.fire({added:i,removed:[]})}catch(s){if(xi(s,!0))return{added:i,existing:o};b.error(`Failed to create notebook controller for ${e.id}`,s)}return{added:i,existing:o}}get(e,t){let n=this.getControllerId(e,t);return this.registeredControllers.get(n)}isFiltered(e){return!1}getControllerId(e,t){return t===It?e.id:`${e.id}${Nz}`}isControllerAttachedToADocument(e){return ip.workspace.notebookDocuments.some(t=>e.isAssociatedWithDocument(t))}};e_=E([(0,np.injectable)(),I(0,(0,np.inject)(ie)),I(1,(0,np.inject)(Gd)),I(2,(0,np.inject)(Eo)),I(3,(0,np.inject)(Ur)),I(4,(0,np.inject)(hr)),I(5,(0,np.inject)(ui))],e_);d();d();var Im=$(te());d();var GZ=require("vscode"),CD=class{constructor(e,t){this.id="remote";if(e.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&e.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage of this class, can only be used with remtoe kernels");this.kernelConnection=e.kernelConnectionMetadata,this.scriptManager=t.getOrCreate(e)}dispose(){}async getBaseUrl(){return GZ.Uri.parse(this.kernelConnection.baseUrl)}async getWidgetScriptSource(e){let n=(await this.getWidgetScriptSources()).find(i=>i.moduleName.toLowerCase()===e.toLowerCase());if(!n&&e.includes("/")){let i=await this.getBaseUrl();return{moduleName:e,scriptUri:`${i.toString()}${e}`,source:"remote"}}return n||{moduleName:e}}async getWidgetScriptSources(){let e=await this.scriptManager.getWidgetModuleMappings();return e&&Object.keys(e).length?await Promise.all(Object.keys(e).map(async n=>({moduleName:n,scriptUri:e[n].toString(),source:"remote"}))):[]}};CD.validUrls=new Map;var t_=class{constructor(e,t,n){this.configurationSettings=e;this.globalMemento=t;this.widgetScriptManagerFactory=n}getProviders(e,t){let n=[];switch(n.push(new ql(this.globalMemento,this.configurationSettings)),e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":n.push(new CD(e,this.widgetScriptManagerFactory));break}return n}};t_=E([(0,Im.injectable)(),I(0,(0,Im.inject)(Me)),I(1,(0,Im.inject)(_t)),I(1,(0,Im.named)(sr)),I(2,(0,Im.inject)(GA))],t_);d();var Iv=$(te());d();var bv=require("vscode");d();var d9=require("vscode");var see=$(iee());var oee=["require.config({","requirejs?.config({","window.requirejs?.config({","requirejs.config({",'["require"].config({',"['require'].config({",'["requirejs"].config({',"['requirejs'].config({",'["require"]["config"]({',"['require']['config']({",'["requirejs"]["config"]({',"['requirejs']['config']({"];async function dEe(r,e,t){let n=[...oee],i=await Rt(e),o=0,s;for(;o<=0&&n.length&&(s=n.pop(),!!s);)o=t.indexOf(s);if(o<0){let f=[...oee].map(m=>m.substring(0,m.length-2));for(;o<=0&&f.length&&(s=f.pop(),!!s);)o=t.indexOf(s)}if(o<0){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigStart"});return}let a=t.indexOf(")",o);if(a<=0||!s){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"couldNotLocateRequireConfigEnd"});return}let l=t.indexOf("{",o),c=t.substring(l,a);c=(0,see.default)(c,{language:"javascript"}),c=at(c,{trim:!0,removeEmptyEntries:!0}).join("");let u=c.split("{")[c.split("{").length-1].split("}")[0].split(",").map(f=>f.trim()).filter(f=>f.length&&f.includes(":")),p={};if(u.forEach(f=>{let m=f.split(":"),h=WE(m[0].replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim(),g=WE(f.substring(f.indexOf(":")+1).replace(/\\r/g,"").replace(/\\n/g,"").trim()).trim();p[h]=g.startsWith("http")?d9.Uri.parse(g):d9.Uri.joinPath(r,g)}),!p||!Object.keys(p).length){J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",void 0,{widgetFolderNameHash:i,failed:!0,patternUsedToRegisterRequireConfig:s,failure:"noRequireConfigEntries"});return}return J("DS_INTERNAL.IPYWIDGET_EXTENSIONJS_INFO",{requireEntryPointCount:Object.keys(p).length},{widgetFolderNameHash:i,patternUsedToRegisterRequireConfig:s}),p}var iM=class{constructor(e){this.kernel=e;this.disposables=[];e.onRestarted(this.onKernelRestarted,this,this.disposables)}dispose(){me(this.disposables)}async getWidgetModuleMappings(){return this.widgetModuleMappings||(this.widgetModuleMappings=this.getWidgetModuleMappingsImpl()),this.widgetModuleMappings}onKernelRestarted(){this.widgetModuleMappings=void 0}async getConfigFromWidget(e,t,n){let i=await this.getWidgetScriptSource(t);try{let o=await dEe(e,n,i);if(!o){let s=`Failed to extract require.config from widget for ${n} from ${ye(t)}`;Ji&&(s+=`with contents ${i}`),b.warn(s)}return o}catch(o){b.error(`Failed to extract require.config entry for ${n} from ${ye(t)}`,o)}}async getWidgetModuleMappingsImpl(){let e=new St,[t,n]=await Promise.all([this.getWidgetEntryPoints(),this.getNbExtensionsParentPath()]);if(!n)return;let o=(await Promise.all(t.map(s=>this.getConfigFromWidget(n,s.uri,s.widgetFolderName)))).reduce((s,a)=>Object.assign(s||{},a),{});return o&&Object.keys(o).length&&(delete o["jupyter-js-widgets"],delete o["@jupyter-widgets/base"],delete o["@jupyter-widgets/controls"],delete o["@jupyter-widgets/output"]),J("DS_INTERNAL.IPYWIDGET_DISCOVER_WIDGETS_NB_EXTENSIONS",{duration:e.elapsedTime},{type:tr(this.kernel.kernelConnectionMetadata)?"local":"remote"}),o&&Object.keys(o).length?o:void 0}};var oM=class extends iM{constructor(t,n,i,o){super(t);this.context=n;this.fs=i;this.connection=o;if(t.kernelConnectionMetadata.kind!=="connectToLiveRemoteKernel"&&t.kernelConnectionMetadata.kind!=="startUsingRemoteKernelSpec")throw new Error("Invalid usage, can only be used for remote kernels");this.kernelConnection=t.kernelConnectionMetadata,this.getWidgetEntryPoints().catch(y)}getBaseUrl(){return this.getNbExtensionsParentPath()}async getNbExtensionsParentPath(){return bv.Uri.parse(this.kernelConnection.baseUrl)}onKernelRestarted(){this.widgetEntryPointsPromise=void 0,super.onKernelRestarted()}async getWidgetEntryPoints(){return this.widgetEntryPointsPromise||(this.widgetEntryPointsPromise=this.getWidgetEntryPointsImpl()),this.widgetEntryPointsPromise}getCodeToExecute(){return this.code||(this.code=this.fs.readFile(bv.Uri.joinPath(this.context.extensionUri,"pythonFiles","printJupyWidgetEntryPoints.py"))),this.code}async getWidgetEntryPointsImpl(){var s;if(!Gt(this.kernelConnection))return[];let t=await this.getCodeToExecute();if(!((s=this.kernel.session)!=null&&s.kernel))return b.ci("No Kernel session to get list of widget entry points"),[];let n=[];n.push(Vi(this.kernel.session.kernel,t,{traceErrors:!0,traceErrorsMessage:"Failed to get widget entry points from remote kernel"})),!Ji&&this.context.extensionMode===bv.ExtensionMode.Production&&n.push(oc(1e4).then(()=>[])),n.forEach(a=>a.catch(y));let i=await Promise.race(n);if(i.length===0)return b.ci("Unable to get widget entry points, no outputs after running the code"),[];let o=i[0];if(o.output_type!=="stream"||o.name!=="stdout")return b.ci("Unable to get widget entry points, no stream/stdout outputs after running the code"),[];try{return b.trace(`Widget Outputs include, ${o.text}`),o.text.trim().substring(1).slice(0,-1).split(",").map(l=>WE(l.trim()).replace(/\\\\/g,"/").replace(/\\/g,"/")).map(l=>({uri:bv.Uri.joinPath(bv.Uri.parse(this.kernelConnection.baseUrl),"nbextensions",l),widgetFolderName:ki(l)}))}catch(a){return b.error(`Failed to parse output to get list of IPyWidgets, output is ${o.text}`,a),[]}}async getWidgetScriptSource(t){let n=this.getWidgetScriptSourceUsingHttpClient(t),i=this.getWidgetScriptSourceUsingFetch(t),o=n.catch(()=>i);return o.catch(s=>{n.catch(a=>b.error(`Failed to download widget script source from ${t.toString(!0)}`,a)),b.error(`Failed to download widget script source from ${t.toString(!0)}`,s)}),o}async getWidgetScriptSourceUsingHttpClient(t){let n=t.toString(!0),o=await new pu().downloadFile(n);if(o.status===200)return o.text();throw new Error(`Error downloading from ${n}: ${o.statusText}`)}async getWidgetScriptSourceUsingFetch(t){let n=await this.connection.createConnectionInfo(this.kernelConnection.serverProviderHandle),i=t.toString(!0),s=await new pu(n.settings.fetch).downloadFile(i);if(s.status===200)return s.text();throw new Error(`Error downloading from ${i} using custom fetch: ${s.statusText}`)}};var r_=class{constructor(e,t,n,i){this.context=e;this.fs=t;this.disposables=n;this.connection=i;this.managers=new WeakMap}getOrCreate(e){if(!this.managers.has(e))if(e.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel"||e.kernelConnectionMetadata.kind==="startUsingRemoteKernelSpec"){let t=new oM(e,this.context,this.fs,this.connection);this.managers.set(e,t),e.onDisposed(()=>t.dispose(),this,this.disposables)}else throw new Error("Cannot enumerate Widget Scripts using local kernels on the Web");return this.managers.get(e)}};r_=E([(0,Iv.injectable)(),I(0,(0,Iv.inject)(st)),I(1,(0,Iv.inject)(xt)),I(2,(0,Iv.inject)(ie)),I(3,(0,Iv.inject)(vn))],r_);d();var aee=$(te()),lee=require("vscode");var n_=class{async getNbExtensionsParentPath(e){switch(e.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":case"startUsingRemoteKernelSpec":return lee.Uri.parse(e.kernelConnectionMetadata.baseUrl);default:return}}};n_=E([(0,aee.injectable)()],n_);d();var sM=$(te()),Gl=require("vscode");var Ma=class{constructor(e){this.disposables=[];e.push(this)}dispose(){me(this.disposables)}activate(){let e=new ic(1e3);this.disposables.push(e),Gl.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>this.onDidChangeNotebookDocument(t))},this,this.disposables)}onDidChangeNotebookDocument(e){br(e.notebook)&&e.cellChanges.some(t=>t.outputs&&t.outputs.some(n=>n.items&&n.items.some(i=>i.mime===yo)))&&this.checkRendererExtensionVersion()}checkRendererExtensionVersion(){if(!Gl.workspace.isTrusted)return;let e=Gl.extensions.getExtension(Jv);if(!e){this.displayNotInstalledMessage();return}let t=e.packageJSON.version;if(!t){this.displayUpdateMessage();return}let n=t.split("."),i=parseInt(n[0],10),o=parseInt(n[1],10),s=parseInt(n[2],10);(i<1||i===1&&o===0&&s<15)&&this.displayUpdateMessage()}displayNotInstalledMessage(){Ma.messageDisplayed||(Ma.messageDisplayed=!0,Gl.window.showInformationMessage(C.rendererExtensionRequired,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Gl.commands.executeCommand("extension.open",Jv).then(y,y)}).then(y,y))}displayUpdateMessage(){Ma.messageDisplayed||(Ma.messageDisplayed=!0,Gl.window.showInformationMessage(C.rendererExtension1015Required,{modal:!0},Ue.bannerLabelYes).then(e=>{e===Ue.bannerLabelYes&&Gl.commands.executeCommand("extension.open",Jv).then(y,y)}).then(y,y))}};Ma.messageDisplayed=!1,Ma=E([(0,sM.injectable)(),I(0,(0,sM.inject)(ie))],Ma);function cee(r,e){r.addSingleton(rp,rp),r.addSingleton(qA,t_),r.addSingleton(GA,r_),r.addSingleton(NZ,n_),r.addSingleton(ql,ql),r.addSingleton(We,Ma)}d();var _m=$(te()),zr=require("vscode");var i_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.kernelFinder=t;this.notebookEditorProvider=n;this.kernelDependency=i;this.localDisposables=[];this.providerMappings=new Map;this.kernelSpecsSourceRegistered=!1;o.push(this)}dispose(){me(this.localDisposables)}activate(){if(!Pn()){this.localDisposables.push(zr.notebooks.registerKernelSourceActionProvider(It,{provideNotebookKernelSourceActions:()=>[{label:C.localPythonEnvironments,documentation:zr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]})),this.localDisposables.push(zr.notebooks.registerKernelSourceActionProvider(vt,{provideNotebookKernelSourceActions:()=>[{label:C.localPythonEnvironments,documentation:zr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerPythonEnv"),command:"jupyter.kernel.selectLocalPythonEnvironment"}]}));let t=[],n=new zr.EventEmitter;this.localDisposables.push(zr.notebooks.registerKernelSourceActionProvider(It,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t})),this.localDisposables.push(zr.notebooks.registerKernelSourceActionProvider(vt,{onDidChangeNotebookKernelSourceActions:n.event,provideNotebookKernelSourceActions:()=>t}));let i=()=>{this.kernelSpecsSourceRegistered||this.kernelFinder.kernels.some(o=>gz(o))&&(this.kernelSpecsSourceRegistered=!0,t=[{label:C.localKernelSpecs,documentation:zr.Uri.parse("https://aka.ms/vscodeJupyterExtKernelPickerJupyterKernels"),command:"jupyter.kernel.selectLocalKernelSpec"}],n.fire())};i(),this.kernelFinder.onDidChangeKernels(()=>i(),this,this.localDisposables),this.localDisposables.push(zr.commands.registerCommand("jupyter.kernel.selectLocalKernelSpec",this.onSelectLocalKernel.bind(this,"localKernelSpec"),this)),this.localDisposables.push(zr.commands.registerCommand("jupyter.kernel.selectLocalPythonEnvironment",this.onSelectLocalKernel.bind(this,"localPythonEnvironment"),this))}this.localDisposables.push(zr.commands.registerCommand("jupyter.kernel.selectJupyterServerKernel",this.onSelectRemoteKernel,this)),nt.instance.get(ur).onDidChangeCollections(this.registerUriCommands,this,this.localDisposables),this.registerUriCommands()}registerUriCommands(){let e=nt.instance.get(ur),t=new Set;e.jupyterCollections.map(n=>{let i=`${n.extensionId}:${n.id}`;if(n.id===aP||(t.add(i),this.providerMappings.has(i)))return;let o=zr.notebooks.registerKernelSourceActionProvider(It,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]}),s=zr.notebooks.registerKernelSourceActionProvider(vt,{provideNotebookKernelSourceActions:()=>[{get label(){return n.label},get documentation(){return n.documentation},command:{command:"jupyter.kernel.selectJupyterServerKernel",arguments:[n.extensionId,n.id],title:n.label}}]});this.localDisposables.push(o),this.localDisposables.push(s),this.providerMappings.set(i,{disposables:[o,s],provider:n})}),this.providerMappings.forEach(({disposables:n},i)=>{t.has(i)||(me(n),this.providerMappings.delete(i))})}async onSelectLocalKernel(e,t){var n;if(t=t||((n=zr.window.activeNotebookEditor)==null?void 0:n.notebook),!!t)if(e==="localPythonEnvironment"){let o=await nt.instance.get(i1).selectLocalKernel(t);return this.getSelectedController(t,o)}else{let o=await nt.instance.get(Rz).selectLocalKernel(t);return this.getSelectedController(t,o)}}async onSelectRemoteKernel(e,t,n){var l,c,u;if(n=n||((l=zr.window.activeNotebookEditor)==null?void 0:l.notebook),!n&&zr.window.activeTextEditor&&(n=(c=this.notebookEditorProvider.findNotebookEditor(zr.window.activeTextEditor.document.uri))==null?void 0:c.notebook),!n)return;let i=`${e}:${t}`,o=(u=this.providerMappings.get(i))==null?void 0:u.provider;if(!o)return;let a=await nt.instance.get(n1).selectRemoteKernel(n,o);return this.getSelectedController(n,a)}async getSelectedController(e,t){var o;if(!t)return;let n=this.controllerRegistration.addOrUpdate(t,[e.notebookType]);if(!Array.isArray(n)||n.length===0){b.warn(`No controller created for selected kernel connection ${t.kind}:${t.id}`);return}Ra(e.uri,t).finally(()=>Yr(e.uri,"DS_INTERNAL.SWITCH_KERNEL",void 0,{newKernelPicker:!0})).catch(y),(o=n.find(s=>s.viewType===e.notebookType))==null||o.controller.updateNotebookAffinity(e,zr.NotebookControllerAffinity.Preferred);let i=n[0];return await this.onControllerSelected(e,i),i.controller.id}async onControllerSelected(e,t){if(aY(e),tr(t.connection)&&Gt(t.connection)&&kp(t.connection.interpreter)&&!Pn()){let n=[];try{let i=new zr.CancellationTokenSource;n.push(i);let o=new Ir(!1);n.push(o),await this.kernelDependency.installMissingDependencies({resource:e.uri,kernelConnection:t.connection,token:i.token,ui:o,cannotChangeKernels:!0,ignoreCache:!0,installWithoutPrompting:!0})}catch(i){b.error(`Failed to install missing dependencies for Conda kernel ${t.connection.id}`,i)}finally{me(n)}}}};i_=E([(0,_m.injectable)(),I(0,(0,_m.inject)(kt)),I(1,(0,_m.inject)(ui)),I(2,(0,_m.inject)(Wo)),I(3,(0,_m.inject)(CI)),I(4,(0,_m.inject)(ie))],i_);d();var _u=$(te()),pi=require("vscode");d();var Gs=require("vscode");var p9=class{constructor(e){this.label=e}},aM=class extends p9{constructor(t,n){super(t);this.sortKey=n;this.kind=Gs.QuickPickItemKind.Separator}},lM=class extends Vr{constructor(t,n,i,o,s,a){super();this.provider=t;this.createQuickPickItem=n;this.getCategory=i;this.options=o;this.createErrorQuickPickItem=s;this._title=a;this.categories=new Map;this.quickPickItems=[];this.previouslyEnteredValue="";this.commands=new Set;this._placeholder="";this.quickPickItemMap=new WeakSet;this.errorQuickPickItemMap=new WeakSet}set recommended(t){var i;let n=((i=this._recommended)==null?void 0:i.id)!==(t==null?void 0:t.id);this._recommended=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get recommended(){return this._recommended}set placeholder(t){this.quickPick&&(this.quickPick.placeholder=t),this._placeholder=t}get placeholder(){return this._placeholder}set selected(t){let n=this._selected!==t;this._selected=t,n&&this.quickPick&&this.rebuildQuickPickItems(this.quickPick)}get selected(){return this._selected}createQuickPick(){let t=[],n={iconPath:new Gs.ThemeIcon("refresh"),tooltip:Ue.refresh},i=this.quickPick=Gs.window.createQuickPick();return t.push(i),this.quickPickItems=[],i.placeholder=this.placeholder,i.matchOnDescription=!0,i.buttons=this.options.supportsBack?[Gs.QuickInputButtons.Back,n]:[n],i.ignoreFocusOut=!0,i.busy=!0,i.value=this.previouslyEnteredValue,i.onDidChangeValue(o=>this.previouslyEnteredValue=o,this,t),i.onDidHide(()=>me(t),this,t),i.title=this._title||C.kernelPickerSelectKernelFromRemoteTitleWithoutName,this.provider.then(o=>{this.resolvedProvider=o,this._title||(i.title=C.kernelPickerSelectKernelFromRemoteTitle(o.title)),i.busy=o.status==="discovering",o.onDidChange(()=>this.updateQuickPickItems(i,o),this,t),i.onDidTriggerButton(async a=>{a===n&&(i.busy=!0,await o.refresh().catch(y),this.updateQuickPickItems(i,o),i.busy=!1)},this,t);let s;o.onDidChangeStatus(()=>{switch(s&&clearTimeout(s),o.status){case"discovering":i.busy=!0;break;case"idle":s=setTimeout(()=>i.busy=!1,500),t.push(new Gs.Disposable(()=>s&&clearTimeout(s)));break}},this,t),uee(o.items.map(a=>this.toQuickPickItem(a)),(a,l)=>dee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{let l=this.connectionToCategory(a[0].item);this.quickPickItems.push(l),a.sort((c,u)=>c.label.localeCompare(u.label)),this.quickPickItems.push(...a),this.categories.set(l,new Set(a))}),this.updateQuickPickItems(i,o)}).catch(o=>b.error(`Failed to get quick pick items for ${i.title}`,o)),t.forEach(o=>this._register(o)),{quickPick:i,disposables:t}}isCommandQuickPickItem(t){return this.commands.has(t)}addCommand(t,n){let i=t;return i.execute=n,this.commands.add(i),this.quickPick&&this.rebuildQuickPickItems(this.quickPick),{dispose:()=>{this.commands.delete(i)}}}async selectItem(t){for(;!t.isCancellationRequested;){let{quickPick:n,disposables:i}=this.createQuickPick();n.show();try{this.previouslySelectedItem=void 0;let o=await new Promise((s,a)=>{n.onDidChangeSelection(l=>{if(l.length){let c=l[0];this.isSelectorQuickPickItem(c)?s(c.item):this.isCommandQuickPickItem(c)?s(c):this.isErrorQuickPickItem(c)}}),n.onDidTriggerButton(l=>l===Gs.QuickInputButtons.Back?s($e.back):void 0,this,i),n.onDidHide(()=>s(void 0),this,i)});if(t.isCancellationRequested||!o)return;if(o instanceof $e)return o===$e.back?$e.back:void 0;if(o&&"label"in o&&this.isCommandQuickPickItem(o)){this.previouslySelectedItem=o;let s=await o.execute();if(!s||s===$e.back)continue;return s instanceof $e,s}return o||void 0}finally{me(i)}}}updateQuickPickItems(t,n){let i=new Map(t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>[a.item.id,a.item])),o=new Map(n.items.map(a=>[a.id,a]));this.quickPickItems=this.quickPickItems.map(a=>{if(this.isSelectorQuickPickItem(a)){let l=i.get(a.item.id);if(l&&l!==a.item)return this.toQuickPickItem(l);let c=o.get(a.item.id);if(c){let u=this.toQuickPickItem(c);if(JSON.stringify({...a,item:""})!==JSON.stringify({...u,item:""}))return this.toQuickPickItem(c)}}return a});let s=n.items.filter(a=>!i.has(a.id)).map(a=>this.toQuickPickItem(a));this.removeOutdatedQuickPickItems(t,n),uee(s,(a,l)=>dee(this.getCategory(a.item,this),this.getCategory(l.item,this))).forEach(a=>{a.sort((u,p)=>u.label.localeCompare(p.label));let l=this.connectionToCategory(a[0].item),c=this.quickPickItems.find(u=>u.kind===Gs.QuickPickItemKind.Separator&&u.label===l.label);if(c){let u=this.quickPickItems.indexOf(c),p=this.categories.get(c),f=new Map(Array.from(p).map(g=>[g.item.id,g])),m=p.size;a.forEach(g=>{let v=f.get(g.item.id);v&&p.delete(v),p.add(g)});let h=Array.from(p);h.sort((g,v)=>g.label.localeCompare(v.label)),this.quickPickItems.splice(u+1,m,...h)}else{let u=this.quickPickItems.filter(m=>m instanceof aM).map((m,h)=>[m,h]);u.push([l,-1]),u.sort((m,h)=>m[0].sortKey.localeCompare(h[0].sortKey));let p=u.findIndex(m=>m[1]===-1),f=0;p>0&&(f=u.length===p+1?this.quickPickItems.length:u[p+1][1]),a.sort((m,h)=>m.label.localeCompare(h.label)),this.quickPickItems.splice(f,0,l,...a),this.categories.set(l,new Set(a))}}),this.rebuildQuickPickItems(t)}rebuildQuickPickItems(t){var p;let n=this.recommended?this.toQuickPickItem(this.recommended):void 0,i=[];n&&i.push({label:C.recommendedItemCategoryInQuickPick,kind:Gs.QuickPickItemKind.Separator},n);let o=n;o=this.selected?this.quickPickItems.filter(f=>this.isSelectorQuickPickItem(f)).map(f=>f).find(f=>{var m;return f.item.id===((m=this.selected)==null?void 0:m.id)}):o;let s=this.quickPickItems.filter(f=>{var m;return!this.isSelectorQuickPickItem(f)||f.item.id!==((m=n==null?void 0:n.item)==null?void 0:m.id)}),a=t.activeItems.length?t.activeItems[0]:void 0;o&&a&&(this.isSelectorQuickPickItem(a)?a.item.id!==o.item.id&&(o=void 0):o=void 0);let l=(p=this.resolvedProvider)!=null&&p.lastError?this.toErrorQuickPickItem(this.resolvedProvider.lastError):void 0,c=[].concat(Array.from(this.commands.values())).concat(i).concat(s).concat(l?[l]:[]),u=o?[o]:t.activeItems.length?[t.activeItems[0]]:[];if(u.length&&!c.includes(u[0])){let f=u[0],m=this.isSelectorQuickPickItem(f)&&c.find(h=>this.isSelectorQuickPickItem(h)&&h.item.id===f.item.id);m?u[0]=m:u.length=0}t.items=c,t.activeItems=u,!t.activeItems.length&&this.previouslySelectedItem&&c.includes(this.previouslySelectedItem)&&(t.activeItems=[this.previouslySelectedItem])}isErrorQuickPickItem(t){return this.errorQuickPickItemMap.has(t)}toErrorQuickPickItem(t){if(!this.createErrorQuickPickItem)return;let n=this.createErrorQuickPickItem(t,this);return this.errorQuickPickItemMap.add(n),n}isSelectorQuickPickItem(t){return this.quickPickItemMap.has(t)}toQuickPickItem(t){let n=this.createQuickPickItem(t,this);return n.item=t,this.quickPickItemMap.add(n),n}removeOutdatedQuickPickItems(t,n){let i=t.items.filter(a=>this.isSelectorQuickPickItem(a)).map(a=>a).map(a=>a.item.id),o=new Map(n.items.map(a=>[a.id,a])),s=i.filter(a=>!o.has(a));if(s.length){let a=[];this.categories.forEach((l,c)=>{l.forEach(u=>{s.includes(u.item.id)&&(l.delete(u),a.push(u))}),l.size||(a.push(c),this.categories.delete(c))}),this.quickPickItems=this.quickPickItems.filter(l=>!a.includes(l)),this.rebuildQuickPickItems(t)}}connectionToCategory(t){let n=this.getCategory(t,this);return new aM(n.label,n.sortKey||n.label)}};function uee(r,e){let t=[],n;for(let i of r.slice(0).sort(e))!n||e(n[0],i)!==0?(n=[i],t.push(n)):n.push(i);return t}function dee(r,e){return(r.sortKey||r.label).localeCompare(e.sortKey||e.label,void 0,{sensitivity:"accent"})}d();var cM=require("vscode");d();function pee(r){return Ni()==="Windows"?_s(r).toUpperCase():_s(r)}function fee(r,e){return e.endsWith(qi)||(e+=qi),r.endsWith(qi)||(r+=qi),pee(r).startsWith(pee(e))}var o_=class{constructor(e){this.jupyterConnection=e;this.disposables=[]}dispose(){me(this.disposables)}async findPreferredRemoteKernelConnection(e,t,n){return this.findPreferredRemoteKernelConnectionImpl(e,t,n,!1)}async findPreferredRemoteKernelConnectionImpl(e,t,n,i){var l;let o=await nt.instance.get(Js).getPreferredRemoteKernelId(e),s=async()=>{let c=t.kernels.find(p=>p.kind==="connectToLiveRemoteKernel"&&p.id===o);if(c)return c;if(t.status==="idle")return;let u=await new Promise(p=>t.onDidChangeKernels(()=>{let f=t.kernels.find(m=>m.kind==="connectToLiveRemoteKernel"&&m.id===o);f&&p(f),(t.status==="idle"||n.isCancellationRequested)&&p(void 0)},this,this.disposables));if(u)return u};if(o){let c=await s();if(c||i)return c}let a=(l=t.kernels.find(c=>Ot(c)))==null?void 0:l.serverProviderHandle;if(a){let c=await this.jupyterConnection.createConnectionInfo(a),u=(e.uri,void 0),p=u&&t.kernels.find(f=>Ot(f)&&f.kind==="connectToLiveRemoteKernel"&&f.kernelModel.model&&f.kernelModel.model.path===u.path&&f.kernelModel.model.name===u.name);if(p)return p}return this.findPreferredKernelSpecConnection(e,t,n,i)}async findPreferredLocalKernelSpecConnection(e,t,n){return this.findPreferredKernelSpecConnection(e,t,n,!1)}async findPreferredKernelSpecConnection(e,t,n,i){var u;let o=xa(e),s=(u=o==null?void 0:o.kernelspec)==null?void 0:u.name,a=()=>{let p=s?t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.name===s):[];if(p.length||i)return p;let f=zA(e);if(f)return t.kernels.filter(m=>(m.kind==="startUsingLocalKernelSpec"||m.kind==="startUsingRemoteKernelSpec")&&m.kernelSpec.language&&(m.kernelSpec.language===f||Vc(m.kernelSpec.language)===Vc(f)))},l=a();if(Array.isArray(l)&&l.length)return i&&l.length>1?void 0:l[0];if(t.status==="idle")return;let c=[];return new Promise(p=>t.onDidChangeKernels(()=>{if(n.isCancellationRequested)return p(void 0);let f=a();if(Array.isArray(f)&&f.length)return i&&f.length>1?p(void 0):p(f[0]);t.status==="idle"&&p(void 0)},this,this.disposables)).finally(()=>me(c))}async findPreferredPythonKernelConnection(e,t,n){return this.findPreferredPythonKernelConnectionImpl(e,t,n)}async findPreferredPythonKernelConnectionImpl(e,t,n){t=t||nt.instance.get(ui).registered.find(c=>c.kind==="localPythonEnvironment");let i=nt.instance.get(pm),o=f9(e,t);if(o)return o;let s=await i.getActiveInterpreter(e.uri);if(!s)return;let a=()=>{if(!n.isCancellationRequested)return t.kernels.filter(c=>c.kind==="startUsingPythonInterpreter").map(c=>c).find(c=>c.interpreter.id===s.id)},l=a();if(l)return l;if(t.status==="discovering")return await new Promise(c=>{t.onDidChangeStatus(()=>t.status==="idle"&&c(),this,this.disposables),t.onDidChangeKernels(()=>(f9(e,t)||a())&&c(),this,this.disposables)}),f9(e,t)||a()}};function f9(r,e){var i,o;let t=((i=cM.workspace.getWorkspaceFolder(r.uri))==null?void 0:i.uri)||(((o=cM.workspace.workspaceFolders)==null?void 0:o.length)===1?cM.workspace.workspaceFolders[0].uri:void 0),n=mee(ey(r.uri),e);if(n)return n;if(t)return mee(t,e)}function mee(r,e){let n=e.kernels.filter(a=>a.kind==="startUsingPythonInterpreter").map(a=>a).filter(a=>{var l,c,u;return fee(((u=(c=(l=Zi(a.interpreter))==null?void 0:l.environment)==null?void 0:c.folderUri)==null?void 0:u.fsPath)||a.interpreter.uri.fsPath,r.fsPath)}),i=n.find(a=>{var l;return Zr(a.interpreter)==="Venv"&&((l=Es(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(i)return i;let o=n.find(a=>{var l;return Zr(a.interpreter)==="Conda"&&((l=Es(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});if(o)return o;let s=n.find(a=>{var l;return((l=Es(a.interpreter))==null?void 0:l.toLowerCase())===".venv"});return s||(n.length?n[0]:void 0)}function uM(r){return r===Ye||r===Bv}var s_=class{constructor(e,t,n,i,o,s,a){this.kernelFinder=e;this.serverUriStorage=t;this.serverSelector=n;this.jupyterConnection=i;this.displayDataProvider=o;this.kernelFinderController=s;this.jupyterServerRegistry=a;this.localDisposables=[]}async selectRemoteKernel(e,t){var o,s,a,l;if(e.notebookType!==It&&e.notebookType!==vt)return;this.localDisposables.forEach(c=>c.dispose()),this.localDisposables=[],(o=this.cancellationTokenSource)==null||o.cancel(),(s=this.cancellationTokenSource)==null||s.dispose(),this.cancellationTokenSource=new pi.CancellationTokenSource;let n=new rD,i={disposables:[],notebook:e};try{if(await n.run(this.getRemoteServersFromProvider.bind(this,t,this.cancellationTokenSource.token),i)===$e.cancel||((a=i.selection)==null?void 0:a.type)==="userPerformedSomeOtherAction")throw new pi.CancellationError;if(this.cancellationTokenSource.token.isCancellationRequested){me(i.disposables);return}if(((l=i.selection)==null?void 0:l.type)==="connection")return i.selection.connection}finally{me(i.disposables)}}async getRemoteServersFromProvider(e,t,n,i){var D;let o=this.kernelFinder.registered.filter(P=>P.kind==="remote"),s=[],a=[],l=[],c=(D=this.jupyterServerRegistry.jupyterCollections.find(P=>P.extensionId===e.extensionId&&P.id===e.id))==null?void 0:D.serverProvider,u=c!=null&&c.provideJupyterServers?Promise.resolve(c.provideJupyterServers.bind(c)(t)).then(P=>P||[]):Promise.resolve([]),p=new Set,f=await u,m=new Set(f.map(P=>P.id));if(o.filter(P=>P.serverProviderHandle.id===e.id).filter(P=>m.has(P.serverProviderHandle.id)).map(P=>{let M=this.serverUriStorage.all.find(x=>qt(x.provider)===qt(P.serverProviderHandle));p.add(qt(P.serverProviderHandle)),l.push({server:P,time:M==null?void 0:M.time})}),l.sort((P,M)=>!P.time&&!M.time?P.server.displayName.localeCompare(M.server.displayName):!P.time&&M.time?1:P.time&&!M.time||(P.time||0)>(M.time||0)?-1:1),l.filter(({time:P})=>(P||0)>0).forEach(({server:P,time:M})=>{s.push({type:"finder",kernelFinderInfo:P,idAndHandle:P.serverProviderHandle,label:P.displayName,description:M?C.jupyterServerLastConnectionForQuickPickDescription(new Date(M)):void 0,buttons:c!=null&&c.removeJupyterServer&&uM(e.extensionId)?[{iconPath:new pi.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),l.filter(({time:P})=>!P).forEach(({server:P})=>{s.push({type:"finder",kernelFinderInfo:P,idAndHandle:P.serverProviderHandle,label:P.displayName,buttons:c!=null&&c.removeJupyterServer&&uM(e.extensionId)?[{iconPath:new pi.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),f.sort((P,M)=>P.label.localeCompare(M.label)).forEach(P=>{let M=qt({extensionId:e.extensionId,id:e.id,handle:P.id});p.has(M)||s.push({type:"jupyterServer",label:P.label,idAndHandle:{extensionId:e.extensionId,id:e.id,handle:P.id},server:P,buttons:c!=null&&c.removeJupyterServer&&uM(e.extensionId)?[{iconPath:new pi.ThemeIcon("close"),tooltip:C.removeRemoteJupyterServerEntryInQuickPick}]:[]})}),e.commandProvider){let P=(await Promise.resolve(e.commandProvider.provideCommands(void 0,t))||[]).map(M=>({...M,provider:e,type:"uriProviderQuickPick",command:M}));s.length>0&&P.length&&a.push({label:"",kind:pi.QuickPickItemKind.Separator}),a.push(...P)}let h=s.concat(a),g=new pi.EventEmitter,v=h.length===1&&"command"in h[0]&&h[0].command.canBeAutoSelected?h[0]:void 0;if(c){let P=h.filter(M=>"type"in M);P.length===1&&P.every(M=>M.type!=="uriProviderQuickPick")?v=P[0]:P.every(M=>M.type==="uriProviderQuickPick")&&P.filter(M=>M.picked).length===1&&(v=h.filter(M=>M.picked)[0])}let S,_;if(v)_=v;else{let{quickPick:P,selection:M}=n.showLazyLoadQuickPick({items:h,placeholder:e.extensionId===Ye||e.extensionId===Bv?C.enterOrSelectRemoteJupyterPlaceholder:C.selectRemoteJupyterPlaceholder,title:C.quickPickTitleForSelectionOfJupyterServer,supportBackInFirstStep:!0,onDidTriggerItemButton:async x=>{if("type"in x.item&&(x.item.type==="finder"||x.item.type==="jupyterServer")){let A=x.item.idAndHandle.handle,j=f.find(re=>re.id===A);c!=null&&c.removeJupyterServer&&j&&uM(e.extensionId)&&(P.busy=!0,this.serverUriStorage.remove({extensionId:e.extensionId,id:e.id,handle:A}).catch(y),await c.removeJupyterServer(j),P.busy=!1,h.splice(h.indexOf(x.item),1),g.fire(h.concat([])))}},onDidChangeItems:g.event});P.onDidChangeValue(async x=>{var R;if(!((R=e.commandProvider)!=null&&R.provideCommands))return;let A=[];s.length>0&&A.push({label:"",kind:pi.QuickPickItemKind.Separator});let re=(await Promise.resolve(e.commandProvider.provideCommands(x,t))||[]).map(Z=>({...Z,provider:e,type:"uriProviderQuickPick",command:Z}));P.items=s.concat(A).concat(re)},this),S=P,_=await M}if(!t.isCancellationRequested&&_&&"type"in _)switch(_.type){case"finder":{let P=await this.selectRemoteKernelFromPicker(i.notebook,Promise.resolve(_.kernelFinderInfo),t).catch(M=>b.error("Failed to select a kernel",M));if(P&&P===$e.back){if(_===v)throw $e.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!P||P instanceof $e)throw new pi.CancellationError;i.selection={type:"connection",connection:P};return}case"jupyterServer":{let P=(async()=>{let x={id:e.id,handle:_.server.id,extensionId:e.extensionId};return e.extensionId.toLowerCase()===nc.toLowerCase()&&await ms(t,this.serverSelector.addJupyterServer(x)),this.kernelFinderController.getOrCreateRemoteKernelFinder(x,_.server.label)})(),M=await this.selectRemoteKernelFromPicker(i.notebook,P,t).catch(x=>b.error("Failed to select a kernel",x));if(M&&M===$e.back){if(_===v)throw $e.back;return this.getRemoteServersFromProvider(e,t,n,i)}if(!M||M instanceof $e)throw new pi.CancellationError;i.selection={type:"connection",connection:M};return}case"uriProviderQuickPick":{let P=pi.notebooks.createNotebookControllerDetectionTask(It);try{S&&(S.busy=!0);let M=await this.selectRemoteServerFromRemoteKernelFinder(_,i,t);return S&&(S.busy=!1),M}catch(M){if(M===$e.back&&!v)return this.getRemoteServersFromProvider(e,t,n,i);throw M}finally{P.dispose()}}default:break}}async selectRemoteServerFromRemoteKernelFinder(e,t,n){var a;if(!((a=e.provider.commandProvider)!=null&&a.handleCommand)||n.isCancellationRequested)return;let i=await Promise.resolve(e.provider.commandProvider.handleCommand(e.command,n));if(!i)throw $e.back;if(n.isCancellationRequested)throw new pi.CancellationError;let o=(async()=>{let l={id:e.provider.id,handle:i.id,extensionId:e.provider.extensionId};return l.extensionId.toLowerCase()===nc.toLowerCase()&&await ms(n,this.serverSelector.addJupyterServer(l)),this.kernelFinderController.getOrCreateRemoteKernelFinder(l,i.label)})(),s=await this.selectRemoteKernelFromPicker(t.notebook,o,n).catch(l=>b.error("Failed to select a kernel",l));if(s&&s===$e.back)throw $e.back;if(!s||s instanceof $e)throw new pi.CancellationError;t.selection={type:"connection",connection:s}}async selectRemoteKernelFromPicker(e,t,n){let i,o=u=>{let p=this.displayDataProvider.getDisplayData(u);return{label:`${u===i?"$(star-full) ":""}${p.label}`,description:p.description,detail:p.detail}},s=u=>({label:this.displayDataProvider.getDisplayData(u).category||"Other"}),a=u=>({label:C.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickLabel,detail:C.failedToFetchKernelSpecsRemoteErrorMessageForQuickPickDetail}),l=new lM(t,o,s,{supportsBack:!0},a),c=new o_(this.jupyterConnection);return t.then(u=>c.findPreferredRemoteKernelConnection(e,u,n)).then(u=>{i=u,(u==null?void 0:u.kind)==="startUsingRemoteKernelSpec"&&(l.recommended=u),l.selected=u}).catch(u=>b.error("Failed to determine preferred remote kernel",u)),l.selectItem(n)}};s_=E([(0,_u.injectable)(),I(0,(0,_u.inject)(ui)),I(1,(0,_u.inject)(hr)),I(2,(0,_u.inject)(jl)),I(3,(0,_u.inject)(vn)),I(4,(0,_u.inject)(NI)),I(5,(0,_u.inject)(mD)),I(6,(0,_u.inject)(ur))],s_);function hee(r,e){r.addSingleton(kt,e_),r.addBinding(kt,We),r.addSingleton(NI,XS),r.addSingleton(n1,s_),r.addSingleton(We,i_),cee(r,e)}d();var xD=$(te()),Sv=require("vscode");d();var a_=Symbol("IJupyterDebugService"),Em=Symbol("INotebookDebuggingManager");var dM=Symbol("IDebugLocationTrackerFactory"),pM=Symbol("IDebugLocationTracker");var l_=class{constructor(e,t){this.debuggingManager=e;this.disposables=t}activate(){this.disposables.push(Sv.commands.registerCommand(Q.RunByLine,this.runByLine,this)),this.disposables.push(Sv.commands.registerCommand(Q.RunByLineNext,this.runByLineNext,this)),this.disposables.push(Sv.commands.registerCommand(Q.RunByLineStop,this.runByLineStop,this)),this.disposables.push(Sv.commands.registerCommand(Q.RunAndDebugCell,this.runAndDebugCell,this))}async runByLine(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUNBYLINE"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(0,e)}async runByLineNext(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineNext(e)}async runByLineStop(e){e!=null||(e=this.getCellFromActiveEditor()),e&&this.debuggingManager.runByLineStop(e)}async runAndDebugCell(e){J("DATASCIENCE.DEBUGGING.CLICKED_RUN_AND_DEBUG_CELL"),e!=null||(e=this.getCellFromActiveEditor()),e&&await this.debuggingManager.tryToStartDebugging(1,e)}getCellFromActiveEditor(){let e=Sv.window.activeNotebookEditor;if(e){let t=e.selections[0];if(t)return e.notebook.cellAt(t.start)}}dispose(){this.disposables.forEach(e=>e.dispose())}};l_=E([(0,xD.injectable)(),I(0,(0,xD.inject)(Em)),I(1,(0,xD.inject)(ie))],l_);d();var Yl=$(te());var DD=require("vscode");d();var m9=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]);function mM(r){var e;return{name:(e=r.evaluateName)!=null?e:r.name,type:r.type,count:0,shape:"",size:0,supportsDataExplorer:m9.has(r.type||""),value:r.value,truncated:!0,frameId:r.variablesReference}}function hM(r){let e=r.index,t=r.columns;return{data:r.data.map((o,s)=>{let a={index:e[s]};return t.forEach((l,c)=>{a[l]=o[c]}),a})}}d();var h9=require("vscode"),c_=class{constructor(e){this._sessionId=e;this.topMostFrameId=0;this.sequenceNumbersOfRequestsPendingResponses=new Set;this.waitingForStackTrace=!1;this.debugLocationUpdatedEvent=new h9.EventEmitter;this.sessionEndedEmitter=new h9.EventEmitter;this.DebugLocation=void 0}get sessionId(){return this._sessionId}get sessionEnded(){return this.sessionEndedEmitter.event}get debugLocationUpdated(){return this.debugLocationUpdatedEvent.event}get debugLocation(){return this._debugLocation}onDidSendMessage(e){var t,n;if(this.isResponseForRequestToFetchAllFrames(e)){let i=(t=e.body)==null?void 0:t.stackFrames[0];this.topMostFrameId=i==null?void 0:i.id,this.sequenceNumbersOfRequestsPendingResponses.delete(e.request_seq),this.waitingForStackTrace&&(this.DebugLocation={lineNumber:i==null?void 0:i.line,fileName:this.normalizeFilePath((n=i==null?void 0:i.source)==null?void 0:n.path),column:i.column},this.waitingForStackTrace=!1)}this.isStopEvent(e)&&(this.waitingForStackTrace=!0),this.isContinueEvent(e)&&(this.DebugLocation=void 0,this.waitingForStackTrace=!1)}onWillStopSession(){this.sessionEndedEmitter.fire(this)}onWillReceiveMessage(e){this.isRequestToFetchAllFrames(e)&&this.sequenceNumbersOfRequestsPendingResponses.add(e.seq)}set DebugLocation(e){let t=this._debugLocation;this._debugLocation=e,this._debugLocation!==t&&this.debugLocationUpdatedEvent.fire()}normalizeFilePath(e){return process.platform!=="win32"?e.replace(/\\/g,"/"):e}isStopEvent(e){return e.type==="event"&&e.event==="stopped"}isContinueEvent(e){if(e.type==="event"){if(e.event==="continue")return!0}else if(e.type==="response"&&e.command==="continue")return!0;return!1}isResponseForRequestToFetchAllFrames(e){var t;return e.type==="response"&&e.command==="stackTrace"&&((t=e.body)==null?void 0:t.stackFrames[0])&&this.sequenceNumbersOfRequestsPendingResponses.has(e.request_seq)}isRequestToFetchAllFrames(e){return e.type==="request"&&e.command==="stackTrace"&&(e.arguments.startFrame===0||e.arguments.startFrame===void 0)}};var pEe=new Set(["In","Out","exit","quit"]),gM=100,u_=class extends c_{constructor(t,n,i,o,s,a){super(void 0);this.debugService=t;this.debuggingManager=n;this.configService=i;this.varScriptGenerator=o;this.dfScriptGenerator=s;this.kernelProvider=a;this.refreshEventEmitter=new DD.EventEmitter;this.lastKnownVariables=[];this.importedGetVariableInfoScriptsIntoKernel=new Set;this.watchedNotebooks=new Map;this.debuggingStarted=!1;this.currentVariablesReference=0;this.currentSeqNumsForVariables=new Set;this.debuggingManager.onDoneDebugging(()=>this.refreshEventEmitter.fire(),this)}get refreshRequired(){return this.refreshEventEmitter.event}get active(){return(this.debugService.activeDebugSession!==void 0||this.activeNotebookIsDebugging())&&this.debuggingStarted}getAllVariableDiscriptions(){throw new Error("Method not implemented.")}async getVariables(t,n){n&&this.watchKernel(n);let i=n&&this.kernelProvider.getKernelExecution(n),o={executionCount:i?i.executionCount:t.executionCount,pageStartIndex:0,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(this.active){let s=t.sortColumn,a=(u,p)=>{let f=u[s]?u[s]:"",m=p[s]?p[s]:"";return t.sortAscending?f.localeCompare(m,void 0,{sensitivity:"base"}):m.localeCompare(f,void 0,{sensitivity:"base"})};this.lastKnownVariables.sort(a);let l=t.startIndex?t.startIndex:0,c=t.pageSize?t.pageSize:gM;o.pageStartIndex=l;for(let u=l;u<l+c&&u<this.lastKnownVariables.length;u+=1){let p=this.lastKnownVariables[u].truncated?await this.getFullVariable(this.lastKnownVariables[u]):this.lastKnownVariables[u];this.lastKnownVariables[u]=p,o.pageResponse.push(p)}o.totalCount=this.lastKnownVariables.length}return o}async getMatchingVariable(t,n){if(this.active){let i=this.lastKnownVariables.find(o=>o.name===t);return i&&(n!=null&&n.resourceUri)&&Zv(n==null?void 0:n.resourceUri).toLowerCase()===".ipynb"&&J("DATASCIENCE.RUN_BY_LINE_VARIABLE_HOVER"),i}}async getVariableValueSummary(t){}async getDataFrameInfo(t,n,i,o){var m;if(!this.active)return t;o&&(t=await this.getFullVariable(t)),n&&this.watchKernel(n);let s=t.name;i&&(s=`${t.name}${i}`);let{cleanupCode:a,initializeCode:l,code:c}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!0,variableName:s}),u=await this.evaluate({code:c,cleanupCode:a,initializeCode:l,frameId:t.frameId}),p=n==null?void 0:n.notebook,f=p?rr(p.uri.path):"";return!f&&((m=this.debugLocation)!=null&&m.fileName)&&(f=rr(this.debugLocation.fileName)),u?{...t,...JSON.parse(u.result),maximumRowChunkSize:gM,fileName:f}:t}async getDataFrameRows(t,n,i,o,s){if(i-n>gM)throw new Error(`Debugger cannot provide more than ${gM} rows at once`);if(!this.debugService.activeDebugSession||t.columns===void 0)return{data:[]};o&&this.watchKernel(o);let a=t.name;s&&(a=`${t.name}${s}`);let{cleanupCode:l,initializeCode:c,code:u}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!0,variableName:a,startIndex:n,endIndex:i}),p=await this.evaluate({code:u,cleanupCode:l,initializeCode:c,frameId:t.frameId});return hM(JSON.parse(p.result))}onWillReceiveMessage(t){super.onWillReceiveMessage(t),t.type==="request"&&t.command==="variables"&&t.arguments&&this.currentVariablesReference===t.arguments.variablesReference&&this.currentSeqNumsForVariables.add(t.seq)}onDidSendMessage(t){var n;if(super.onDidSendMessage(t),t.type==="response"&&t.command==="initialize")this.debuggingStarted=!0;else if(t.type==="event"&&t.event==="stopped"&&this.activeNotebookIsDebugging())this.handleNotebookVariables(t).catch(y);else if(t.type==="response"&&t.command==="scopes"&&t.body&&t.body.scopes){let o=t.body.scopes[0].variablesReference;o!==this.currentVariablesReference&&(this.currentVariablesReference=o,this.currentSeqNumsForVariables.clear())}else if(t.type==="response"&&t.command==="variables"&&t.body)this.currentSeqNumsForVariables.has(t.request_seq)&&this.updateVariables(void 0,t),this.monkeyPatchDataViewableVariables(t);else if(t.type==="event"&&t.event==="terminated"){this.lastKnownVariables=[],this.topMostFrameId=0,this.debuggingStarted=!1,this.refreshEventEmitter.fire();let i=(n=this.debugService.activeDebugSession)==null?void 0:n.id;i&&this.importedGetVariableInfoScriptsIntoKernel.delete(i)}}watchKernel(t){var i;let n=(i=t.notebook)==null?void 0:i.uri.toString();if(n&&!this.watchedNotebooks.has(n)){let o=[];o.push(t.onRestarted(this.resetImport.bind(this,n))),o.push(t.onDisposed(()=>{this.resetImport(n),o.forEach(s=>s.dispose()),this.watchedNotebooks.delete(n)})),this.watchedNotebooks.set(n,o)}}resetImport(t){this.importedGetVariableInfoScriptsIntoKernel.delete(t)}async evaluate({code:t,cleanupCode:n,frameId:i,initializeCode:o}){if(this.debugService.activeDebugSession){i=this.topMostFrameId||i;let s={frameId:i,context:"repl",format:{rawString:!0}};b.debug(`Evaluating in debugger : ${this.debugService.activeDebugSession.id}: ${t}`);try{o&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:o});let a=await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:t});if(a&&a.result!=="None")return a;b.error(`Cannot evaluate ${t}`);return}finally{n&&await this.debugService.activeDebugSession.customRequest("evaluate",{...s,expression:n})}}throw Error("Debugger is not active, cannot evaluate.")}async getFullVariable(t){let{initializeCode:n,code:i,cleanupCode:o}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!0,variableName:t.name}),s=await this.evaluate({code:i,initializeCode:n,cleanupCode:o,frameId:t.frameId});return s&&s.result?{...t,truncated:!1,...JSON.parse(s.result)}:t}monkeyPatchDataViewableVariables(t){t.body.variables.forEach(n=>{n.type&&m9.has(n.type)&&(n.__vscodeVariableMenuContext="viewableInDataViewer")})}updateVariables(t,n){var s;let i=this.configService.getSettings(t).variableExplorerExclude?(s=this.configService.getSettings().variableExplorerExclude)==null?void 0:s.split(";"):[],o=n.body.variables.filter(a=>!(!a.name||!a.type||!a.value||i&&i.includes(a.type)||a.name.startsWith("_")||pEe.has(a.name)||a.type==="NoneType"));this.lastKnownVariables=o.map(a=>mM(a)),this.refreshEventEmitter.fire()}activeNotebookIsDebugging(){let t=DD.window.activeNotebookEditor;return!!t&&this.debuggingManager.isDebugging(t.notebook)}async handleNotebookVariables(t){var o;let n=(o=DD.window.activeNotebookEditor)==null?void 0:o.notebook,i=t.body.threadId;if(n){let s=this.debuggingManager.getDebugSession(n);if(s){let a=await s.customRequest("stackTrace",{threadId:i,startFrame:0,levels:1});if(a&&a.stackFrames[0]){let l=a.stackFrames[0],c=this.debuggingManager.getDebugMode(n),u;if(c===0){let p=this.debuggingManager.getDebugCell(n);l.source&&p&&l.source.path===p.document.uri.toString()&&(u=await s.customRequest("scopes",{frameId:l.id}))}else{let p=rr(n.uri.toString());l.source&&l.source.path&&l.source.path.includes(p)&&(u=await s.customRequest("scopes",{frameId:l.id}))}u&&(u.scopes.forEach(p=>{s.customRequest("variables",{variablesReference:p.variablesReference}).then(y,y)}),this.refreshEventEmitter.fire())}}}}};u_=E([(0,Yl.injectable)(),I(0,(0,Yl.inject)(a_)),I(0,(0,Yl.named)(rt.MULTIPLEXING_DEBUGSERVICE)),I(1,(0,Yl.inject)(Em)),I(2,(0,Yl.inject)(Me)),I(3,(0,Yl.inject)(hy)),I(4,(0,Yl.inject)(gy)),I(5,(0,Yl.inject)(He))],u_);d();var op=$(te()),Cm=require("vscode");d();var gee=require("vscode"),gr=class{constructor(e){this.name=e}get value(){return this.lastValue}async set(e){this.lastValue!==e&&(this.lastValue=e,await gee.commands.executeCommand("setContext",this.name,this.lastValue))}};d();var _ee=require("vscode");d();var PD=(o=>(o[o.Unknown=0]="Unknown",o[o.Ok=1]="Ok",o[o.Outdated=2]="Outdated",o[o.NotInstalled=3]="NotInstalled",o[o.ControllerNotSelected=4]="ControllerNotSelected",o))(PD||{});async function vee(r){var o,s;let e="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",t=`import builtins
import ipykernel
builtins.print("${e}" + ipykernel.__version__ + "${e}")`,n=await r.executeHidden(t),i=/^(\d+)\.\d+\.\d+$/;for(let a of n){if(a.output_type!=="stream")continue;let l=(s=(o=a.text)==null?void 0:o.toString().trim())!=null?s:"";if(!l.includes(e))continue;let c=l.split(e)[1].trim().match(i);if(c){let u=c[1];return Number(u)>=6?1:2}}return 0}function TD(r){let e=r;if(typeof e.__notebookUri=="undefined"||typeof e.__mode=="undefined"||(e.__mode===1||e.__mode===2||e.__mode===0)&&typeof e.__cellIndex=="undefined")throw new Error("Invalid launch configuration")}function yee(r){if(TD(r),r.__mode!==2)throw new Error("Invalid launch configuration")}function vM(r,e){switch(r.type){case"event":let t=r;switch(t.event){case"output":e(t.body);break;case"loadedSource":e(t.body);break;case"breakpoint":e(t.body.breakpoint);break;default:break}break;case"request":let n=r;switch(n.command){case"setBreakpoints":let o=n.arguments,s=o.breakpoints;if(s&&s.length){let a=s[0].line;s.forEach(c=>{e(c,{...o.source})});let l={source:o.source,line:a};e(l),o.source=l.source}break;case"breakpointLocations":e(n.arguments);break;case"source":e(n.arguments);break;case"gotoTargets":e(n.arguments);break;default:break}break;case"response":let i=r;if(i.success&&i.body)switch(i.command){case"stackTrace":i.body.stackFrames.forEach(o=>{e(o)});break;case"loadedSources":i.body.sources.forEach(o=>{let s={source:o};e(s),o.path=s.source.path});break;case"scopes":i.body.scopes.forEach(o=>{e(o)});break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;case"setBreakpoints":i.body.breakpoints.forEach(o=>{e(o)});break;default:break}break}}function bee(r){return/~\d+\\/.test(r)}function Iee(r,e){return new RegExp(r.replace(/\\/g,"\\\\").replace(/~\d+\\\\/g,"[^\\\\]+\\\\"),"i").test(e)}async function _v(r,e){let t=`import debugpy
debugpy.debug_this_thread()`;await r.executeHidden(t),await e.dumpAllCells()}function See(r){return!!r.header&&r.header.msg_type==="debug_event"}function kD(r){return r.includes("Frame skipped from debugging during step-in")}function g9(r){return r.event==="debugpyAttach"}var yM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){b.debug(`[Debug-Cell] ${e}: ${t}`)}async willSendEvent(e){return g9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&kD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){e.command==="configurationDone"&&(await _v(this.execution,this.debugAdapter),_ee.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y))}};d();var ND=class{constructor(e,t,n,i){this.mode=e;this.debugAdapter=t;this.debugCell=n;this.serviceContainer=i;this.debuggingManager=this.serviceContainer.get(Em)}trace(e,t){b.debug(`[Debug-Restart] ${e}: ${t}`)}error(e,t){b.error(`[Debug-Restart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Handling restart request"),setTimeout(()=>{this.debugAdapter.disconnect().then(()=>(this.trace("restart","doRestart"),this.debuggingManager.tryToStartDebugging(this.mode,this.debugCell,!0))).catch(t=>{this.error("restart",`Error restarting: ${t}`)})},0),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};d();var RD=require("vscode");var bM=class{constructor(e,t,n,i){this.debugAdapter=e;this.debugCell=t;this.execution=n;this.settings=i;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUNBYLINE")}continue(){if(typeof this.lastPausedThreadId!="number"){b.debug("No paused thread, can't do RBL"),this.stop();return}this.debugAdapter.stepIn(this.lastPausedThreadId).then(y,y)}stop(){b.ci("RunbylineController::stop()"),this.execution.executeHidden("pass").then(y,y),this.debugAdapter.disconnect().then(y,y)}getMode(){return this.debugAdapter.getConfiguration().__mode}async willSendEvent(e){return e.event==="stopped"&&(this.lastPausedThreadId=e.body.threadId,await this.handleStoppedEvent(this.lastPausedThreadId))?(this.trace("intercepted","handled stop event"),!0):e.event==="output"&&kD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){b.ci(`willSendRequest: ${e.command}`),e.command==="configurationDone"&&await this.initializeExecute()}async handleStoppedEvent(e){return await this.shouldStepIn(e)?(this.debugAdapter.stepIn(e).then(y,y),!0):!1}async shouldStepIn(e){var n;let t=await this.debugAdapter.stackTrace({threadId:e,startFrame:0,levels:1});if(t&&t.stackFrames[0]){let i=t.stackFrames[0],o=new RD.Position(i.line,i.column);return(n=this.lastPausePosition)!=null&&n.isEqual(o)?(this.trace("intercept","working around duplicate stop event"),!0):(this.lastPausePosition=o,!!i.source&&i.source.path!==this.debugCell.document.uri.toString())}return!1}trace(e,t){b.debug(`[Debug-RBL] ${e}: ${t}`)}async initializeExecute(){await _v(this.execution,this.debugAdapter);let e=at(this.debugCell.document.getText(),{trim:!1,removeEmptyEntries:!1}),t=[];if(Lg(e,()=>void 0,(n,i)=>{n.trim().length!==0&&t.push(i)}),t.sort(),t.length!==0){let n={line:t[0]+1};await this.debugAdapter.setBreakpoints({source:{name:rr(this.debugCell.notebook.uri.path),path:this.debugCell.document.uri.toString()},breakpoints:[n],sourceModified:!1}),this.settings.getSettings(this.debugCell.notebook.uri).showVariableViewWhenDebugging&&RD.commands.executeCommand(Q.OpenVariableView).then(y,y)}RD.commands.executeCommand("notebook.cell.execute",{ranges:[{start:this.debugCell.index,end:this.debugCell.index+1}],document:this.debugCell.notebook.uri}).then(y,y)}};d();var d_=class{constructor(e,t,n){this.document=e;this.config=t;this.session=n}};d();var fi=require("vscode");var p_=class{constructor(e,t,n){this.kernelProvider=e;this.controllerRegistration=t;this.serviceContainer=n;this.notebookToDebugger=new Map;this.notebookToDebugAdapter=new Map;this.notebookInProgress=new Set;this.disposables=[];this._doneDebugging=new fi.EventEmitter}activate(){this.disposables.push(fi.debug.onDidTerminateDebugSession(this.endSession.bind(this)),fi.workspace.onDidCloseNotebookDocument(async e=>{let t=this.notebookToDebugger.get(e);t&&(await fi.debug.stopDebugging(t.session),this.onDidStopDebugging(e))}))}getDebugCell(e){var t;return(t=this.notebookToDebugAdapter.get(e))==null?void 0:t.debugCell}get onDoneDebugging(){return this._doneDebugging.event}dispose(){this.disposables.forEach(e=>e.dispose())}isDebugging(e){return this.notebookToDebugger.has(e)}getDebugSession(e){let t=this.notebookToDebugger.get(e);if(t)return t.session}getDebugAdapter(e){return this.notebookToDebugAdapter.get(e)}onDidStopDebugging(e){}async startDebuggingConfig(e,t){b.ci(`Attempting to start debugging with config ${JSON.stringify(e)}`);try{await fi.debug.startDebugging(void 0,e,t)}catch(n){b.error(`Can't start debugging (${n})`),fi.window.showErrorMessage(C.cantStartDebugging).then(y,y)}}trackDebugAdapter(e,t){this.notebookToDebugAdapter.set(e,t),this.disposables.push(t.onDidEndSession(this.endSession.bind(this)))}async endSession(e){b.info(`Ending debug session ${e.id}`),this._doneDebugging.fire();for(let[t,n]of this.notebookToDebugger.entries())if(n&&e.id===n.session.id){this.notebookToDebugger.delete(t),this.notebookToDebugAdapter.delete(t),this.onDidStopDebugging(t);break}}getDebuggerByUri(e){for(let[t,n]of this.notebookToDebugger.entries())if(e===t)return n}async ensureKernelIsRunning(e){let t=this.controllerRegistration.getSelected(e),n=this.kernelProvider.get(e);return t&&(!n||n&&n.status==="unknown")&&(n=await Aa.connectToNotebookKernel(t.connection,this.serviceContainer,{notebook:e,controller:t.controller,resource:e.uri},new Ir(!1),this.disposables,"jupyterExtension")),n}findEditorForCell(e){let t=e.notebook.uri.toString();return fi.window.visibleNotebookEditors.find(n=>n.notebook.uri.toString()===t)}async checkIpykernelAndPrompt(e,t=!0){let n=this.findEditorForCell(e);if(!n)return fi.window.showErrorMessage(C.noNotebookToDebug).then(y,y),0;let i=await this.checkForIpykernel6(n.notebook);switch(i){case 3:break;case 2:case 0:{this.promptInstallIpykernel6().then(y,y);break}case 4:if(t)return await fi.commands.executeCommand("notebook.selectKernel",{notebookEditor:n}),await this.checkIpykernelAndPrompt(e,!1)}return i}async checkForIpykernel6(e){var t,n;try{let i=this.kernelProvider.get(e);if(!i){let l=this.controllerRegistration.getSelected(e);if(!l)return 4;i=this.kernelProvider.getOrCreate(e,{metadata:l.connection,controller:l==null?void 0:l.controller,resourceUri:e.uri})}let o=i.kernelConnectionMetadata;if(Ot(o)){if(o.kind==="startUsingRemoteKernelSpec"&&((t=o.kernelSpec.metadata)!=null&&t.debugger))return 1;if(o.kind==="connectToLiveRemoteKernel"&&((n=o.kernelModel.metadata)!=null&&n.debugger))return 1}let s=this.kernelProvider.getKernelExecution(i),a=await vee(s);return J("DATASCIENCE.DEBUGGING.IPYKERNEL6_STATUS",void 0,{status:a===1?"installed":"notInstalled"}),a}catch(i){b.error("Debugging: Could not check for ipykernel 6",i)}return 0}async promptInstallIpykernel6(){await fi.window.showInformationMessage(C.needIpykernel6,{modal:!0},C.setup)===C.setup?(J("DATASCIENCE.DEBUGGING.CLICKED_ON_SETUP"),fi.env.openExternal(fi.Uri.parse("https://github.com/microsoft/vscode-jupyter/wiki/Setting-Up-Run-by-Line-and-Debugging-for-Notebooks"))):J("DATASCIENCE.DEBUGGING.CLOSED_MODAL")}};d();d();var $l=require("vscode");d();var IM=class{constructor(e){this.debugAdapter=e}trace(e,t){b.debug(`[Debug-Reset] ${e}: ${t}`)}async willSendRequest(e){e.command==="attach"&&(this.trace("attach","Continuing paused kernel threads if needed"),(await this.debugAdapter.debugInfo()).stoppedThreads.forEach(n=>this.debugAdapter.continueDirect(n)))}};var f_=class{constructor(e,t,n,i,o,s){this.session=e;this.notebookDocument=t;this.jupyterSession=n;this.kernel=i;this.platformService=o;this.debugService=s;this.fileToCell=new Map;this.sendMessage=new $l.EventEmitter;this.endSession=new $l.EventEmitter;this.disposables=[];this.delegates=[];this.onDidSendMessage=this.sendMessage.event;this.onDidEndSession=this.endSession.event;this.disconnected=!1;var l;b.ci("Creating kernel debug adapter for debugging notebooks");let a=this.session.configuration;TD(a),this.configuration=a,this.debugCell=t.cellAt(a.__cellIndex),this.addDebuggingDelegates([new IM(this)]),(l=this.jupyterSession.kernel)==null||l.iopubMessage.connect(this.onIOPubMessage,this),this.disposables.push(new $l.Disposable(()=>{var c;return(c=this.jupyterSession.kernel)==null?void 0:c.iopubMessage.disconnect(this.onIOPubMessage,this)})),this.kernel&&(this.kernel.addHook("willRestart",()=>this.disconnect(),this,this.disposables),this.kernel.addHook("interruptCompleted",()=>this.disconnect(),this,this.disposables),this.disposables.push(this.kernel.onDisposed(()=>{this.disconnected||($l.debug.stopDebugging(this.session).then(y,y),this.disconnect().catch(y),J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"onKernelDisposed"}))}))),this.disposables.push(Lr.onDidChangeNotebookCellExecutionState(c=>{this.configuration.__cellIndex===c.cell.index&&c.state===1&&!this.disconnected&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"normally"}),this.disconnect().catch(y))},this,this.disposables)),this.disposables.push($l.workspace.onDidChangeNotebookDocument(c=>{c.contentChanges.forEach(u=>{u.removedCells.forEach(p=>{p===this.debugCell&&this.disconnect().catch(y)})})},this,this.disposables)),this.disposables.push(this.debugService.onDidTerminateDebugSession(c=>{(c===this.session||c===this.session)&&this.disconnect().catch(y)}))}addDebuggingDelegates(e){this.delegates.push(...e)}trace(e,t){b.debug(`[Debug] ${e}: ${t}`)}async onIOPubMessage(e,t){var n,i;if(b.ci(`Debug IO Pub message: ${JSON.stringify(t)}`),See(t)){this.trace("event",JSON.stringify(t));for(let o of(n=this.delegates)!=null?n:[])if(await((i=o==null?void 0:o.willSendEvent)==null?void 0:i.call(o,t.content)))return;this.sendMessage.fire(t.content)}}handleMessage(e){this.handleClientMessageAsync(e).catch(y)}async handleClientMessageAsync(e){var t,n;try{if(b.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(e,void 0," ")}`),e.type==="request"&&e.command==="setBreakpoints"){let i=e.arguments;if(i.source&&i.source.path&&i.source.path.indexOf("vscode-notebook-cell:")===0){let o=this.notebookDocument.getCells().find(s=>s.document.uri.toString()===i.source.path);o&&await this.dumpCell(o.index)}}if(e.type==="request")for(let i of(t=this.delegates)!=null?t:[]){let o=await((n=i==null?void 0:i.willSendRequest)==null?void 0:n.call(i,e));if(o){this.trace("response",JSON.stringify(o)),this.sendMessage.fire(o);return}}await this.sendMessageToJupyterSession(e)}catch(i){b.error(`KernelDebugAdapter::handleMessage failure: ${i}`)}}getConfiguration(){return this.configuration}stepIn(e){return this.session.customRequest("stepIn",{threadId:e})}async debugInfo(){return await this.session.customRequest("debugInfo")}continueDirect(e){if(!this.jupyterSession.kernel)throw new nn;this.jupyterSession.kernel.requestDebug({seq:0,type:"request",command:"continue",arguments:{threadId:e}})}async disconnect(){var e;if(!this.disconnected){if(this.disconnected=!0,this.debugService.activeDebugSession===this.session||((e=this.debugService.activeDebugSession)==null?void 0:e.id)===this.session.id)try{await Promise.all([this.deleteDumpedFiles().catch(t=>b.warn("Error deleting temporary debug files.",t)),this.session.customRequest("disconnect",{restart:!1})])}catch(t){b.error("Failed to disconnect debug session",t)}this.endSession.fire(this.session)}}dispose(){this.disposables.forEach(e=>e.dispose())}stackTrace(e){return this.session.customRequest("stackTrace",e)}setBreakpoints(e){return this.session.customRequest("setBreakpoints",e)}async dumpAllCells(){await Promise.all(this.notebookDocument.getCells().map(async e=>{e.kind===$l.NotebookCellKind.Code&&await this.dumpCell(e.index)}))}lookupCellByLongName(e){if(this.platformService.isWindows){e=_s(e);for(let[t,n]of this.fileToCell.entries())if(bee(t)&&Iee(t,e))return n}}async sendMessageToJupyterSession(e){if(this.jupyterSession.isDisposed||this.jupyterSession.status==="dead"||!this.jupyterSession.kernel){b.info(`Skipping sending message ${e.type} because session is disposed`);return}if(this.trace("to kernel",JSON.stringify(e)),e.type==="request"){let t=await this.sendRequestToJupyterSession(e);t&&this.sendMessage.fire(t)}else if(e.type==="response"){vM(e,this.translateRealLocationToDebuggerLocation.bind(this));let t=e;return this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command},!0).done}else b.error(`Unknown message type to send ${e.type}`)}async sendRequestToJupyterSession(e){var s,a;if(vM(e,this.translateRealLocationToDebuggerLocation.bind(this)),!this.jupyterSession.kernel)throw new nn;this.trace("to kernel, mapped",JSON.stringify(e));let t=e,o=(await this.jupyterSession.kernel.requestDebug({seq:t.seq,type:"request",command:t.command,arguments:t.arguments},!0).done).content;vM(o,this.translateDebuggerLocationToRealLocation.bind(this));for(let l of(s=this.delegates)!=null?s:[])await((a=l==null?void 0:l.willSendResponse)==null?void 0:a.call(l,o));return this.trace("response",JSON.stringify(o)),o}translateDebuggerLocationToRealLocation(e,t){var n,i;if(t=(n=e==null?void 0:e.source)!=null?n:t,t&&t.path){let o=(i=this.fileToCell.get(t.path))!=null?i:this.lookupCellByLongName(t.path);o&&(t.name=rr(o.path),t.path=o.toString())}}async deleteDumpedFiles(){let e=this.getDumpFilesForDeletion();if(this.jupyterSession.kernel&&e.length){let n=`import os as _VSCODE_os
_VSCODE_fileList = [${e.map(i=>'"'+i.replace(/\\/g,"\\\\")+'"').join(",")}]
for file in _VSCODE_fileList:
    try:
        _VSCODE_os.remove(file)
    except:
        pass
del _VSCODE_fileList
del _VSCODE_os`;await Vi(this.jupyterSession.kernel,n,{traceErrors:!0,traceErrorsMessage:"Error deleting temporary debugging files"})}}};var SM=class extends f_{constructor(){super(...arguments);this.cellToFile=new Map}async dumpCell(t){let n=this.notebookDocument.cellAt(t);try{let i=await this.session.customRequest("dumpCell",{code:n.document.getText().replace(/\r\n/g,`
`)}),o=_s(i.sourcePath);this.fileToCell.set(o,n.document.uri),this.cellToFile.set(n.document.uri.toString(),o)}catch(i){b.error(i)}}translateRealLocationToDebuggerLocation(t){let n=t.source;if(n&&n.path){let i=this.cellToFile.get(n.path);i&&(n.path=i)}}getDumpFilesForDeletion(){return Array.from(this.cellToFile.values())}};var m_=class extends p_{constructor(t,n,i,o,s,a){super(t,n,a);this.configurationService=i;this.platform=o;this.debugService=s;this.notebookToRunByLineController=new Map;this.runByLineCells=new gr(Sr.RunByLineCells),this.runByLineDocuments=new gr(Sr.RunByLineDocuments),this.debugDocuments=new gr(Sr.DebugDocuments)}activate(){super.activate(),this.disposables.push(Cm.debug.registerDebugAdapterDescriptorFactory($L,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){let n=this.notebookToRunByLineController.get(t);return n==null?void 0:n.getMode()}onDidStopDebugging(t){super.onDidStopDebugging(t),this.notebookToRunByLineController.delete(t),this.updateRunByLineContextKeys(),this.updateDebugContextKey()}updateRunByLineContextKeys(){let t=[],n=[];this.notebookToRunByLineController.forEach(i=>{t.push(i.debugCell.document.uri),n.push(i.debugCell.notebook.uri)}),this.runByLineCells.set(t).catch(y),this.runByLineDocuments.set(n).catch(y)}updateDebugContextKey(){let t=new BA;this.notebookToDebugAdapter.forEach((n,i)=>t.add(i.uri)),this.notebookInProgress.forEach(n=>t.add(n.uri)),this.debugDocuments.set(Array.from(t.values())).catch(y)}async tryToStartDebugging(t,n,i=!1){if(b.info(`Starting debugging with mode ${t}`),!i){let o=await this.checkIpykernelAndPrompt(n);if(o!==1){b.info(`Ipykernel check failed: ${PD[o]}`);return}}(t===0||t===1)&&await this.startDebuggingCell(t,n)}runByLineNext(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&n.debugCell.document.uri.toString()===t.document.uri.toString()&&n.continue()}runByLineStop(t){let n=this.notebookToRunByLineController.get(t.notebook);n&&(J("DATASCIENCE.DEBUGGING.ENDED_SESSION",void 0,{reason:"withKeybinding"}),n.stop())}async startDebuggingCell(t,n){let i=n.notebook,o=this.configurationService.getSettings(i.uri),s={type:$L,name:rr(i.uri.toString()),request:"attach",justMyCode:t===1?o.debugJustMyCode:!0,__mode:t,__cellIndex:n.index,__notebookUri:i.uri.toString()},a=t===0?{suppressDebugStatusbar:!0,suppressDebugToolbar:!0,suppressDebugView:!0,suppressSaveBeforeStart:!0}:{suppressSaveBeforeStart:!0};return this.startDebuggingConfig(s,a)}async createDebugAdapterDescriptor(t){let n=t.configuration;TD(n);let i=n.__notebookUri,o=Cm.workspace.notebookDocuments.find(s=>s.uri.toString()===i);if(!o){b.info(`Cannot start debugging. Notebook ${i} not found.`);return}if(this.notebookInProgress.has(o)){b.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(o)){b.info("Cannot start debugging. Already debugging this notebook document.");return}this.notebookToDebugger.set(o,new d_(o,n,t));try{return this.notebookInProgress.add(o),this.updateDebugContextKey(),await this.doCreateDebugAdapterDescriptor(n,t,o)}finally{this.notebookInProgress.delete(o),this.updateDebugContextKey()}}async doCreateDebugAdapterDescriptor(t,n,i){let o=await this.ensureKernelIsRunning(i);if(o!=null&&o.session){let s=new SM(n,i,o.session,o,this.platform,this.debugService);if(t.__mode===0&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new bM(s,a,this.kernelProvider.getKernelExecution(o),this.configurationService);s.addDebuggingDelegates([l,new ND(0,s,a,this.serviceContainer)]),this.notebookToRunByLineController.set(i,l),this.updateRunByLineContextKeys()}else if(t.__mode===1&&typeof t.__cellIndex=="number"){let a=i.cellAt(t.__cellIndex),l=new yM(s,a,this.kernelProvider.getKernelExecution(o));s.addDebuggingDelegates([l,new ND(1,s,a,this.serviceContainer)])}return this.trackDebugAdapter(i,s),this.updateDebugContextKey(),new Cm.DebugAdapterInlineImplementation(s)}else Cm.window.showInformationMessage(C.kernelWasNotStarted).then(y,y)}};m_=E([(0,op.injectable)(),I(0,(0,op.inject)(He)),I(1,(0,op.inject)(kt)),I(2,(0,op.inject)(Me)),I(3,(0,op.inject)(hs)),I(4,(0,op.inject)(mo)),I(5,(0,op.inject)(Ur))],m_);d();var AD=$(te()),Eee=require("vscode");var h_=class{constructor(e,t){this.disposableRegistry=t;this.activeTrackers=new WeakMap;this.activeTrackersById=new Map;this.updatedEmitter=new Eee.EventEmitter;t.push(e.registerDebugAdapterTrackerFactory("python",this))}createDebugAdapterTracker(e){let t=new c_(e.id);return this.activeTrackers.set(e,t),this.activeTrackersById.set(e.id,t),t.sessionEnded(()=>{this.activeTrackers.delete(e),this.activeTrackersById.delete(e.id)},this,this.disposableRegistry),t.debugLocationUpdated(this.onLocationUpdated,this,this.disposableRegistry),this.onLocationUpdated(),t}get updated(){return this.updatedEmitter.event}getLocation(e){let t=this.activeTrackers.get(e)||this.activeTrackersById.get(e.id);if(t)return t.debugLocation}onLocationUpdated(){this.updatedEmitter.fire()}};h_=E([(0,AD.injectable)(),I(0,(0,AD.inject)(mo)),I(1,(0,AD.inject)(ie))],h_);d();var Eu=$(te()),Ev=require("vscode");var g_=class{constructor(e,t,n){this.vscodeDebugService=t;this.jupyterDebugService=n;this.sessionChangedEvent=new Ev.EventEmitter;this.sessionStartedEvent=new Ev.EventEmitter;this.sessionTerminatedEvent=new Ev.EventEmitter;this.sessionCustomEvent=new Ev.EventEmitter;e.push(t.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(t.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(t.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(t.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))),n&&(e.push(n.onDidTerminateDebugSession(this.endedDebugSession.bind(this))),e.push(n.onDidStartDebugSession(this.startedDebugSession.bind(this))),e.push(n.onDidChangeActiveDebugSession(this.changedDebugSession.bind(this))),e.push(n.onDidReceiveDebugSessionCustomEvent(this.gotCustomEvent.bind(this))))}get activeDebugSession(){return this.activeService.activeDebugSession}get activeDebugConsole(){return this.activeService.activeDebugConsole}get breakpoints(){return this.activeService.breakpoints}get onDidChangeActiveDebugSession(){return this.sessionChangedEvent.event}get onDidStartDebugSession(){return this.sessionStartedEvent.event}get onDidReceiveDebugSessionCustomEvent(){return this.sessionCustomEvent.event}get onDidTerminateDebugSession(){return this.sessionTerminatedEvent.event}get onDidChangeBreakpoints(){return this.activeService.onDidChangeBreakpoints}get onBreakpointHit(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.onBreakpointHit}startRunByLine(e){if(this.lastStartedService=this.jupyterDebugService,!this.jupyterDebugService)throw new Error("No jupyter debugger service");return this.jupyterDebugService.startRunByLine(e)}registerDebugConfigurationProvider(e,t){let n=this.vscodeDebugService.registerDebugConfigurationProvider(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugConfigurationProvider(e,t);return this.combineDisposables(n,i)}return n}registerDebugAdapterTrackerFactory(e,t){let n=this.vscodeDebugService.registerDebugAdapterTrackerFactory(e,t);if(this.jupyterDebugService){let i=this.jupyterDebugService.registerDebugAdapterTrackerFactory(e,t);return this.combineDisposables(n,i)}return n}startDebugging(e,t,n){return this.lastStartedService=this.vscodeDebugService,this.vscodeDebugService.startDebugging(e,t,n)}addBreakpoints(e){return this.activeService.addBreakpoints(e)}removeBreakpoints(e){return this.activeService.removeBreakpoints(e)}getStack(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.getStack();throw new Error("Requesting jupyter specific stack when not debugging.")}step(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.step();throw new Error("Requesting jupyter specific step when not debugging.")}continue(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.continue();throw new Error("Requesting jupyter specific step when not debugging.")}requestVariables(){if(!this.jupyterDebugService)throw new Error("No jupyter debugger service");if(this.lastStartedService===this.jupyterDebugService)return this.jupyterDebugService.requestVariables();throw new Error("Requesting jupyter specific variables when not debugging.")}stop(){this.jupyterDebugService&&this.lastStartedService===this.jupyterDebugService?this.jupyterDebugService.stop():Ev.commands.executeCommand("workbench.action.debug.stop").then(y,y)}get activeService(){return this.lastStartedService?this.lastStartedService:this.vscodeDebugService}combineDisposables(e,t){return{dispose:()=>{e.dispose(),t.dispose()}}}endedDebugSession(e){this.sessionTerminatedEvent.fire(e),this.lastStartedService=void 0}startedDebugSession(e){this.sessionStartedEvent.fire(e)}changedDebugSession(e){this.sessionChangedEvent.fire(e)}gotCustomEvent(e){this.sessionCustomEvent.fire(e)}};g_=E([(0,Eu.injectable)(),I(0,(0,Eu.inject)(ie)),I(1,(0,Eu.inject)(mo)),I(2,(0,Eu.optional)()),I(2,(0,Eu.inject)(a_)),I(2,(0,Eu.named)(rt.RUN_BY_LINE_DEBUGSERVICE))],g_);d();var v9=$(iv()),wv=$(te());d();var v_=Symbol("IFileConverter"),wm=Symbol("IExportBase"),Xkt=Symbol("IExport"),xm=Symbol("IExportUtil");function fEe(){return`${$f}${(0,v9.default)()}`}function mEe(r){let e=`${fEe()}${(0,v9.default)()}.ipynb`;return r?`${vi(r,".ipynb")}${e}`:`${C.defaultNotebookName}${e}`}var Cv=class{constructor(e,t,n,i){this.kernelProvider=e;this.fs=t;this.jupyterConnection=n;this.exportUtil=i}async export(e,t,n,i){}async executeCommand(e,t,n,i,o){var _;let s=this.kernelProvider.get(e);if(!s||(s.session||await s.start(new Ir(!1)),!((_=s.session)!=null&&_.kernel)))return;let a=s.kernelConnectionMetadata,l=s.resourceUri;if(!Ot(a)||l)return;let c=s.session.kernel,p=(await this.jupyterConnection.createConnectionInfo(a.serverProviderHandle)).settings,f=li(),m=new f.ContentsManager({serverSettings:p}),h=await this.exportUtil.getContent(e),g="";switch(n){case"html":g=".html";break;case"pdf":g=".pdf";break;case"python":g=".py";break}let v=await this.createBackingFile(l,m);if(!v)return;await m.save(v.filePath,{content:JSON.parse(h),type:"notebook"}).catch(y);let S;try{let D=await this.getCWD(s);S=(await m.newUntitled({type:"file",ext:g})).path;let M=`${D}/${v.filePath}`,x=await Vi(c,`!jupyter nbconvert ${M} --to ${n} --output ${rr(S)}`),A=this.parseStreamOutput(x);if(this.isExportFailed(A))throw new Error(A||`Failed to export to ${n}`);if(A&&b.debug(A),n==="pdf"){let j=await m.get(S,{type:"file",format:"base64",content:!0}),R=await this.b64toBlob(j.content,"application/pdf").arrayBuffer();await this.fs.writeFile(t,new Uint8Array(R))}else{let j=await m.get(S,{type:"file",format:"text",content:!0});await this.fs.writeFile(t,j.content)}}finally{S&&await m.delete(S),await v.dispose(),await m.delete(v.filePath).catch(y),m.dispose()}}async createBackingFile(e,t){let n,i={type:"notebook"},o=mEe(e);try{n=await t.newUntitled(i);let s=ki(n.path);n=await t.rename(n.path,s.length&&s!=="."?`${s}/${o}`:o)}catch(s){b.error(`Backing file not supported: ${s}`)}if(n){let s=n.path;return{filePath:s,dispose:()=>t.delete(s)}}}async getContents(e,t,n){return await n.get(e,{type:"file",format:t,content:!0})}b64toBlob(e,t){t=t||"";let n=512;e=e.replace(/^[^,]+,/,""),e=e.replace(/\s/g,"");let i=atob(e),o=[];for(let a=0;a<i.length;a+=n){let l=i.slice(a,a+n),c=new Array(l.length);for(let p=0;p<l.length;p++)c[p]=l.charCodeAt(p);let u=new Uint8Array(c);o.push(u)}return new Blob(o,{type:t})}isExportFailed(e){return e?/Traceback \(most recent call last\)/g.exec(e):!0}parseStreamOutput(e){if(e.length===0)return;let t=e[0];return t.name!=="stdout"&&t.output_type!=="stream"?void 0:jc(t.text).trim()}async getCWD(e){var i;if(!((i=e.session)!=null&&i.kernel))throw new nn;let t=await Vi(e.session.kernel,"import os;os.getcwd();");if(t.length===0)return;let n=t[0];if(n.output_type==="execute_result")return n.data["text/plain"]}};E([yX("PerformingExport")],Cv.prototype,"executeCommand",1),Cv=E([(0,wv.injectable)(),I(0,(0,wv.inject)(He)),I(1,(0,wv.inject)(xt)),I(2,(0,wv.inject)(vn)),I(3,(0,wv.inject)(xm))],Cv);d();var Cee=$(te());d();var y_=require("vscode");d();var MD=require("vscode");var hEe={PDF:["pdf"]},gEe={HTML:["html","htm"]},vEe={Python:["py"]},ap=class{async showDialog(e,t,n){let i={},o;switch(e){case"python":i=vEe,o=".py";break;case"pdf":o=".pdf",i=hEe;break;case"html":o=".html",i=gEe;break;case"ipynb":o=".ipynb";let l=C.exportDialogFilter;i[l]=["ipynb"];break;default:return}let s=n||!t?n||"":`${rr(t.path,Cp(t.path))}${o}`,a={defaultUri:await this.getDefaultUri(t,s),saveLabel:C.exportButtonTitle,filters:i};return MD.window.showSaveDialog(a)}async getDefaultUri(e,t){if(e&&e.scheme==="untitled"&&Pn())return;if(!e||e.scheme==="file"||e.scheme==="untitled"||e.scheme==="vscode-interactive"){let i=nt.instance.get(f1);return MD.Uri.file(BE(await i.computeWorkingDirectory(e),t))}let n=BE(ki(e.path),t);return MD.Uri.parse(`${e.scheme}://${n}`).with({authority:e.authority})}};var _M=class{async getContent(e){let t=y_.extensions.getExtension("vscode.ipynb");if(!t)throw new Error("Unable to export notebook as the built-in vscode.ipynb extension is currently unavailable.");t.isActive||await t.activate();let i=e.getCells().map(s=>{let a=new y_.NotebookCellData(s.kind,s.document.getText(),s.document.languageId);return a.metadata=s.metadata,a.mime=s.mime,a.outputs=[...s.outputs],a}),o=new y_.NotebookData(i);return o.metadata=JSON.parse(JSON.stringify(e.metadata)),t.exports.exportNotebook(o)}async getTargetFile(e,t,n){return await new ap().showDialog(e,t,n)}};var b_=class extends _M{};b_=E([(0,Cee.injectable)()],b_);d();var __=$(te());d();var PM=$(te()),TM=require("vscode");d();var lp=require("vscode");var EM=class{constructor(){this.fs=nt.instance.get(xt)}async openFile(e,t,n=!1){if(e==="python")await this.openPythonFile(t,n),J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:!0});else{let i=await this.askOpenFile(t,n);J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,successful:!0,opened:i})}}async openPythonFile(e,t){let n;if(t)n=await lp.window.showTextDocument(e);else{let i=await this.fs.readFile(e);await this.fs.delete(e);let o=await lp.workspace.openTextDocument({language:qe,content:i});n=await lp.window.showTextDocument(o)}await n.edit(i=>{i.insert(new lp.Position(n.document.lineCount,0),`
`)})}async askOpenFile(e,t){let n=C.openExportFileYes,i=C.openExportFileNo,o=[n,i];return await lp.window.showInformationMessage(C.openExportedFileMessage,...o).then(a=>a)===n?(t?lp.window.showTextDocument(e).then(y,y):GI(e.toString()),!0):!1}};d();var CM=class{async export(e,t,n,i){await nt.instance.get(wm).executeCommand(e,t,"python",n,i)}};d();var wM=class{async export(e,t,n,i){await nt.instance.get(wm).executeCommand(e,t,"pdf",n,i)}};d();var xM=class{async export(e,t,n,i){await nt.instance.get(wm).executeCommand(e,t,"html",n,i)}};d();var y9=require("vscode");var DM=class{constructor(){this.fs=nt.instance.get(xt),this.configuration=nt.instance.get(Me),this.platform=nt.instance.get(hs)}async writeFile(e,t){await this.fs.writeFile(e,t)}getEOL(){return this.platform.isWindows?`\r
`:`
`}async export(e,t,n){if(n.isCancellationRequested)return;let i=this.exportDocument(e);await this.writeFile(t,i)}exportDocument(e){return e.getCells().filter(t=>{var n;return!((n=t.metadata)!=null&&n.isInteractiveWindowMessageCell)}).reduce((t,n)=>t+this.exportCell(n),"")}exportCell(e){if(e.document.lineCount){let t=this.cellMarker(e),n=this.getEOL();switch(e.kind){case y9.NotebookCellKind.Code:return`${t}${n}${this.exportCodeCell(e)}${n}${n}`;case y9.NotebookCellKind.Markup:return`${t} [markdown]${n}${this.exportMarkdownCell(e)}${n}${n}`}}return""}exportCodeCell(e){let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1}),n=this.configuration.getSettings(e.notebook.uri).pythonExportMethod==="commentMagics";return pI(t,this.getEOL(),n?yEe:void 0).join("")}exportMarkdownCell(e){let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1});return pI(t,this.getEOL(),bEe).join("")}cellMarker(e){var n;let t=this.configuration.getSettings(e.notebook.uri);return(n=e.metadata.interactiveWindowCellMarker)!=null?n:t.defaultCellMarker}};function yEe(r){return/^\s*!/.test(r)||/^\s*%/.test(r)?`# ${r}`:r}function bEe(r){return`# ${r}`}var I_=class{constructor(e,t,n){this.exportUtil=e;this.progressReporter=t;this.configuration=n}async importIpynb(e){let t=this.progressReporter.createProgressIndicator(C.importingIpynb,!0);try{let n=await TM.workspace.openNotebookDocument(e);await this.exportImpl("python",n,void 0,t.token)}finally{t.dispose()}}async export(e,t,n,i){let o=this.progressReporter.createProgressIndicator(C.exportingToFormat(e.toString()),!0);try{await this.exportImpl(e,t,n,o.token,i)}finally{o.dispose()}if(o.token.isCancellationRequested){J("DATASCIENCE.EXPORT_NOTEBOOK_AS",void 0,{format:e,cancelled:!0});return}}async exportImpl(e,t,n,i,o){try{let s=await this.exportUtil.getTargetFile(e,t.uri,n);if(!s)return;await this.performExport(e,t,s,i,o)}catch(s){b.error("Export failed",s),J("DATASCIENCE.EXPORT_NOTEBOOK_AS_FAILED",void 0,{format:e}),e==="pdf"&&b.error(C.exportToPDFDependencyMessage),this.showExportFailed(C.exportFailedGeneralMessage)}}async performExport(e,t,n,i,o){e==="python"&&this.configuration.getSettings(t.uri).pythonExportMethod!=="nbconvert"?await this.performPlainExport(e,t,n,i):await this.performNbConvertExport(t,e,n,o,i),n&&this.openExportedFile(e,n).catch(y)}async openExportedFile(e,t){await new EM().openFile(e,t,!0).catch(y)}async performPlainExport(e,t,n,i){if(n)switch(e){case"python":await new DM().export(t,n,i);break}return n}async performNbConvertExport(e,t,n,i,o){try{return await this.exportToFormat(e,n,t,i,o)}finally{}}async exportToFormat(e,t,n,i,o){switch(n){case"python":return new CM().export(e,t,i,o);case"pdf":return new wM().export(e,t,i,o);case"html":return new xM().export(e,t,i,o);default:break}}showExportFailed(e){TM.window.showErrorMessage(`${C.failedExportMessage} ${e}`)}};I_=E([I(0,(0,PM.inject)(xm)),I(1,(0,PM.inject)(Bl)),I(2,(0,PM.inject)(Me))],I_);var S_=class extends I_{constructor(t,n,i){super(t,n,i);this.exportUtil=t}};S_=E([(0,__.injectable)(),I(0,(0,__.inject)(xm)),I(1,(0,__.inject)(Bl)),I(2,(0,__.inject)(Me))],S_);d();var LD=$(te()),xv=require("vscode");d();var OD=require("vscode");var b9=new WeakMap;async function Cu(r,e){let t=r;if(r.isClosed)return!0;let n=b9.has(t)?b9.get(t):Promise.resolve(),i=ke(),o=n.finally(async()=>{let s=new OD.WorkspaceEdit,a=e(s);Yv(a)&&await a,await OD.workspace.applyEdit(s).then(l=>i.resolve(l),l=>i.reject(l))}).catch(y);return b9.set(t,o),i.promise}var E_=class{constructor(e,t){this.disposables=e;this.controllerRegistration=t}activate(){this.controllerRegistration.onControllerSelected(this.onDidChangeNotebookController,this,this.disposables)}async onDidChangeNotebookController(e){let t=e.notebook,n=e.controller.connection;if(!br(t))return;let i=xv.window.visibleNotebookEditors.find(u=>u.notebook===t);if(!i)return;let o=t.getCells().filter(u=>u.kind===xv.NotebookCellKind.Code&&u.document.getText().trim().length===0),s=t.getCells().filter(u=>u.kind===xv.NotebookCellKind.Code).length;if(o.length===0||o.length!==s)return;let a,l=n.kind;switch(n.kind){case"connectToLiveRemoteKernel":{a=n.kernelModel.language;break}case"startUsingRemoteKernelSpec":case"startUsingLocalKernelSpec":{a=n.kernelSpec.language;break}case"startUsingPythonInterpreter":{a=qe;break}default:{b.error(`Unsupported kernel kind encountered ${l}`);return}}if(!a)return;let c=Vc(a);Cu(i.notebook,async()=>{await o.map(async u=>{if(c.toLowerCase()!==u.document.languageId)return xv.languages.setTextDocumentLanguage(u.document,c).then(y,y)})}).then(y,y)}};E_=E([(0,LD.injectable)(),I(0,(0,LD.inject)(ie)),I(1,(0,LD.inject)(kt))],E_);d();var zl=$(te()),_r=require("vscode");var C_=class{constructor(e,t,n,i,o,s,a,l){this.disposableRegistry=e;this.languageService=t;this.configurationService=n;this.kernelProvider=i;this.controllerRegistration=o;this.errorHandler=s;this.notebookEditorProvider=a;this.serviceContainer=l;this.kernelInterruptedDontAskToRestart=!1;this.pendingRestartInterrupt=new WeakMap}register(){this.disposableRegistry.push(_r.commands.registerCommand(Q.NotebookEditorRemoveAllCells,()=>this.removeAllCells())),this.disposableRegistry.push(_r.commands.registerCommand(Q.NotebookEditorRunAllCells,()=>this.runAllCells())),this.disposableRegistry.push(_r.commands.registerCommand(Q.NotebookEditorAddCellBelow,()=>this.addCellBelow())),this.disposableRegistry.push(_r.commands.registerCommand(Q.RestartKernelAndRunUpToSelectedCell,()=>this.restartKernelAndRunUpToSelectedCell())),this.disposableRegistry.push(_r.commands.registerCommand(Q.RestartKernel,e=>{var t;return e&&"notebookEditor"in e?this.restartKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernel(e).catch(y)})),this.disposableRegistry.push(_r.commands.registerCommand(Q.InterruptKernel,e=>{var t;return this.interruptKernel((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)})),this.disposableRegistry.push(_r.commands.registerCommand(Q.RestartKernelAndRunAllCells,e=>{var t;e&&"notebookEditor"in e?this.restartKernelAndRunAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri).catch(y):this.restartKernelAndRunAllCells(e).catch(y)}))}runAllCells(){_r.window.activeNotebookEditor&&_r.commands.executeCommand("notebook.execute").then(y,y)}addCellBelow(){_r.window.activeNotebookEditor&&_r.commands.executeCommand("notebook.cell.insertCodeCellBelow").then(y,y)}removeAllCells(){var n;let e=(n=_r.window.activeNotebookEditor)==null?void 0:n.notebook;if(!e)return;let t=this.languageService.getPreferredLanguage(xa(e));Cu(e,i=>{let o=_r.NotebookEdit.replaceCells(new _r.NotebookRange(0,e.cellCount),[new _r.NotebookCellData(_r.NotebookCellKind.Code,"",t)]);i.set(e.uri,[o])}).then(y,y)}async interruptKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=_r.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;b.debug(`Command interrupted kernel for ${ye(n.uri)}`);let i=this.kernelProvider.get(n);if(!i){b.info("Interrupt requested & no kernel.");return}await this.wrapKernelMethod("interrupt",i)}async restartKernelAndRunAllCells(e){await this.restartKernel(e),this.runAllCells()}async restartKernelAndRunUpToSelectedCell(){let e=this.notebookEditorProvider.activeNotebookEditor;e&&(await this.restartKernel(e.notebook.uri),_r.commands.executeCommand("notebook.cell.execute",{ranges:[{start:0,end:e.selection.end}],document:e.notebook.uri}).then(y,y))}async restartKernel(e){var o;let t=e!=null?e:(o=this.notebookEditorProvider.activeNotebookEditor)==null?void 0:o.notebook.uri,n=_r.workspace.notebookDocuments.find(s=>s.uri.toString()===(t==null?void 0:t.toString()));if(n===void 0)return;let i=this.kernelProvider.get(n);if(i)if(b.debug(`Restart kernel command handler for ${ye(n.uri)}`),await this.shouldAskForRestart(n.uri)){let s=C.restartKernelMessage,a=C.restartKernelMessageYes,l=C.restartKernelMessageDontAskAgain,c=await _r.window.showInformationMessage(s,{modal:!0},a,l);c===l?(await this.disableAskForRestart(n.uri),this.wrapKernelMethod("restart",i).catch(y)):c===a&&this.wrapKernelMethod("restart",i).catch(y)}else this.wrapKernelMethod("restart",i).catch(y)}async wrapKernelMethod(e,t){let n=t.notebook,i=this.pendingRestartInterrupt.get(t);if(i)return i;let o=(async()=>{let s=this.kernelProvider.getKernelExecution(t).pendingCells[0],a=this.controllerRegistration.getSelected(n);try{if(!a)throw new Error("No kernel associated with the notebook");await Aa.wrapKernelMethod(a.connection,e,t.creator,this.serviceContainer,{resource:t.resourceUri,notebook:n,controller:a.controller},new Ir(!1),this.disposableRegistry)}catch(l){s?await Yf(s,t.controller,await this.errorHandler.getErrorMessageForDisplayInCell(l,e,t.resourceUri),!1):_r.window.showErrorMessage(l.toString()).then(y,y)}})();return o.finally(()=>{this.pendingRestartInterrupt.get(t)===o&&this.pendingRestartInterrupt.delete(t)}).catch(y),this.pendingRestartInterrupt.set(t,o),o}async shouldAskForRestart(e){if(this.kernelInterruptedDontAskToRestart)return!1;let t=this.configurationService.getSettings(e);return t&&t.askForKernelRestart===!0}async disableAskForRestart(e){this.configurationService.getSettings(e)&&this.configurationService.updateSetting("askForKernelRestart",!1,void 0,_r.ConfigurationTarget.Global).catch(y)}};C_=E([(0,zl.injectable)(),I(0,(0,zl.inject)(ie)),I(1,(0,zl.inject)(qs)),I(2,(0,zl.inject)(Me)),I(3,(0,zl.inject)(He)),I(4,(0,zl.inject)(kt)),I(5,(0,zl.inject)(xn)),I(6,(0,zl.inject)(Wo)),I(7,(0,zl.inject)(Ur))],C_);d();var wee=$(te()),Dm=require("vscode");var w_=class{constructor(){this.providers=new Set}registerEmbedNotebookProvider(e){this.providers.add(e)}findNotebookEditor(e){var o;let t=e?ja(e,!0):"false",n=Kl(e)==="notebook"?Dm.workspace.notebookDocuments.find(s=>ja(s.uri,!0)===t):void 0,i=n&&((o=Dm.window.activeNotebookEditor)==null?void 0:o.notebook)===n?Dm.window.activeNotebookEditor:void 0;if(i)return i;for(let s of this.providers){let a=s.findNotebookEditor(e);if(a)return a}}get activeNotebookEditor(){var e,t;return this.findNotebookEditor((e=Dm.window.activeNotebookEditor)==null?void 0:e.notebook.uri)||this.findNotebookEditor((t=Dm.window.activeTextEditor)==null?void 0:t.document.uri)}findAssociatedNotebookDocument(e){let t=Ni()==="Windows",n=Dm.workspace.notebookDocuments.find(i=>t?i.uri.path.toLowerCase()===e.path.toLowerCase():i.uri.path===e.path);if(n)return n;for(let i of this.providers){let o=i.findAssociatedNotebookDocument(e);if(o)return o}}};w_=E([(0,wee.injectable)()],w_);d();var kM=$(te()),D_=require("vscode");var x_=class{constructor(e){this.sentMimeTypes=new Set;this.disposables=[];e.push(this)}activate(){this.isTelemetryDisabled=k0(),D_.workspace.onDidOpenNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),D_.workspace.onDidCloseNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),D_.workspace.onDidSaveNotebookDocument(this.onDidOpenCloseDocument,this,this.disposables),Lr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables),this.disposables.push(N0(e=>this.isTelemetryDisabled=e))}dispose(){me(this.disposables)}async onDidChangeNotebookCellExecutionState(e){!br(e.cell.notebook)||this.isTelemetryDisabled||e.state!==1||this.checkCell(e.cell,"onExecution")}onDidOpenCloseDocument(e){!br(e)||this.isTelemetryDisabled||e.getCells().forEach(t=>this.checkCell(t,"onOpenCloseOrSave"))}checkCell(e,t){if(e.kind===D_.NotebookCellKind.Markup||e.document.languageId==="raw")return;let n=e.notebook.notebookType===It?"notebook":"interactive";e.outputs.map(i=>i.items.map(o=>o.mime)).flat().map(i=>this.sendTelemetry(i,t,n))}sendTelemetry(e,t,n){let i=`${e}-${t}`;this.sentMimeTypes.has(i)||(this.sentMimeTypes.add(i),e=e.replace(/\//g,"_").replace(/\\/g,"_"),J("DS_INTERNAL.CELL_OUTPUT_MIME_TYPE",void 0,{mimeType:e,when:t,resourceType:n}))}};x_=E([(0,kM.injectable)(),I(0,(0,kM.inject)(ie))],x_);d();var NM=$(te());var IEe=/(;32m[ ->]*?)(\d+)(.*)/g,P_=class{constructor(e){this.configurationService=e}format(e,t){return e.notebook.notebookType!==It?t:t.map(n=>this.modifyTracebackFrameIPython(e,n))}modifyTracebackFrameIPython(e,t){var o;let n=this.configurationService.getSettings(e.document.uri);return((o=n==null?void 0:n.formatStackTraces)!=null?o:!1)&&/^[Cell|Input|File].*?\n.*/.test(t)?this.modifyTracebackFrameIPython8(e,t):t}modifyTracebackFrameIPython8(e,t){t=t.replace(/\u001b\[4\dm/g,""),t=t.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),t=t.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(s,a,l,c)=>(c=c.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${a}${l}${c}
`)),b.ci(`Trace frame to match: ${t}`);let n=(s,a)=>{let l=s.replace(IEe,(u,p,f,m)=>{let h=parseInt(f,10);return`${p}<a href='${e.document.uri.toString()}?line=${h-1}'>${h}</a>${m}`}),c=C.cellAtFormat(lt(e.document.uri),e.index+1);return l.replace(/.*?\n/,`\x1B[1;32m${c}\x1B[0m line \x1B[0;36m${a}
`)},i=/^Input.*?\[.*32mIn\s+\[(\d+).*?0;36m(.*?)\n.*/.exec(t);if(i&&i.length>1)return n(t,i[2]);let o=/Cell.*?\[.*32mIn\s*\[(\d+)\]\,\s+line\s+([(\d+)])(.*?)\n.*/gm.exec(t);return o&&o.length>1?n(t,o[2]):t}};P_=E([(0,NM.injectable)(),I(0,(0,NM.inject)(Me))],P_);function xee(r,e){hee(r,e),r.addSingleton(We,dv),r.addSingleton(Wo,w_),r.addSingleton(We,gv),r.addSingleton(wI,P_),r.addSingleton(gm,gm),r.addBinding(gm,We),r.addSingleton(We,QS),r.addSingleton(my,C_),r.addSingleton(qs,qs),r.addBinding(qs,We),r.addSingleton(We,E_),r.addSingleton(Em,m_,void 0,[We]),r.addSingleton(a_,g_,rt.MULTIPLEXING_DEBUGSERVICE),r.addSingleton(pM,h_,void 0,[dM]),r.addSingleton(Bi,u_,rt.DEBUGGER_VARIABLES),r.addSingleton(We,l_),r.addSingleton(We,x_),r.addSingleton(wm,Cv),r.addSingleton(v_,S_),r.addSingleton(xm,b_)}d();d();var Fn=$(te()),Ge=require("vscode");d();var Pm=Symbol("IDataScienceCodeLensProvider"),RM=Symbol("ICodeWatcher"),AM=Symbol("ICodeLensFactory"),M1t=Symbol("IGeneratedCodeStore"),Oa=Symbol("IGeneratedCodeStorageFactory"),T_=Symbol("ICodeGeneratorFactory");d();var Dee=Symbol("IInteractiveWindowDebugger"),ys=Symbol("IInteractiveWindowProvider"),MM=Symbol("IInteractiveControllerHelper"),OM=Symbol("IInteractiveWindowDebuggingManager");d();var LM=require("vscode");async function KM(r){let e=await LM.workspace.openNotebookDocument(r);await LM.window.showNotebookDocument(e)}d();var La=require("vscode");d();var Vo=class{constructor(e){this.codeMatchRegEx=this.createRegExp(e?e.codeRegularExpression:void 0,LE.PythonCellMarker),this.markdownMatchRegEx=this.createRegExp(e?e.markdownRegularExpression:void 0,LE.PythonMarkdownCellMarker),this.codeExecRegEx=new RegExp(`${this.codeMatchRegEx.source}(.*)`),this.markdownExecRegEx=new RegExp(`${this.markdownMatchRegEx.source}(.*)`),this.defaultCellMarker=e!=null&&e.defaultCellMarker?e.defaultCellMarker:"# %%"}isCell(e){return this.isCode(e)||this.isMarkdown(e)}isMarkdown(e){return this.markdownMatchRegEx.test(e.trim())}isCode(e){return this.codeMatchRegEx.test(e.trim())||e.trim()===this.defaultCellMarker}getCellType(e){return this.isMarkdown(e)?"markdown":"code"}isEmptyCell(e){return this.stripFirstMarker(e).trim().length===0}stripFirstMarker(e){let t=at(e,{trim:!1,removeEmptyEntries:!1});return t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0]))?t.slice(1).join(`
`):e}stripFirstMarkerNoConcat(e){return e.length>0&&(this.isCode(e[0])||this.isMarkdown(e[0]))?e.slice(1):e}getFirstMarker(e){let t=at(e,{trim:!1,removeEmptyEntries:!1});if(t.length>0&&(this.isCode(t[0])||this.isMarkdown(t[0])))return t[0]}createRegExp(e,t){try{if(e)return new RegExp(e)}catch(n){}return t}};d();var Ys=require("vscode");function Pee(r,e){let t=ut(r);return t?e==1?C.restartingKernelCustomHeader(t):C.startingNewKernelCustomHeader(t):e==1?C.restartingKernelHeader:C.startingNewKernelHeader}function Tee(r,e){let t=ut(r);return e==1?C.restartedKernelHeader(t||""):C.connectedKernelHeader(t||"")}function KD(r){var e;return r.kind===Ys.NotebookCellKind.Markup&&((e=r.metadata)==null?void 0:e.isInteractiveWindowMessageCell)===!0}var FM=class{constructor(e,t){this.notebookDocument=e;this.isDeleted=!1;if(e.cellCount){let n=e.cellAt(e.cellCount);KD(n)&&(this.sysInfoCellPromise=Promise.resolve(n),this.sysInfoCellPromise=this.updateMessage(t))}this.sysInfoCellPromise===void 0&&(this.sysInfoCellPromise=this.createCell(t))}async createCell(e){let t;return await Cu(this.notebookDocument,n=>{let i=new Ys.NotebookCellData(Ys.NotebookCellKind.Markup,e,KE);i.metadata={isInteractiveWindowMessageCell:!0},t=this.notebookDocument.cellCount;let o=Ys.NotebookEdit.insertCells(t,[i]);n.set(this.notebookDocument.uri,[o])}),t=t!=null?t:this.notebookDocument.cellCount-1,this.notebookDocument.cellAt(t)}async updateMessage(e){let t=await this.sysInfoCellPromise;return await Cu(this.notebookDocument,n=>{if(t.index>=0&&!this.isDeleted&&KD(t)){n.replace(t.document.uri,new Ys.Range(0,0,t.document.lineCount,0),e),n.set(this.notebookDocument.uri,[Ys.NotebookEdit.updateCellMetadata(t.index,{isInteractiveWindowMessageCell:!0})]);return}}),t}async deleteCell(){this.isDeleted=!0;let e=await this.sysInfoCellPromise;await Cu(this.notebookDocument,t=>{if(e.index>=0&&KD(e)){let n=Ys.NotebookEdit.deleteCells(new Ys.NotebookRange(e.index,e.index+1));t.set(this.notebookDocument.uri,[n]);return}})}};function UM(r){return/^#\s*!/.test(r)?/^#\s*!\s*%%?/.test(r)?r.replace(/^#\s*!\s*/,""):r.replace(/^#\s*/,""):r}function kee(r){return new La.NotebookCellData(La.NotebookCellKind.Code,r.join(`
`),"python")}function Nee(r){return new La.NotebookCellData(La.NotebookCellKind.Markup,q0(r).join(`
`),"markdown")}function _Ee(r,e,t){let n=at(e,{trim:!1}),i=n[0];if(new Vo(r).isMarkdown(i)){let s=-1;return Lg(n,(a,l)=>void 0,(a,l)=>{a&&a.length>0&&s===-1&&(s=t?l:-1)}),s>=0?[Nee(n.slice(0,s)),kee(n.slice(s))]:[Nee(n)]}else return[kee(n)]}function Ree(r,e){let t=new Vo(e);for(let n=0;n<r.lineCount;n+=1){let i=r.lineAt(n);if(t.isCell(i.text))return!0}return!1}function FD(r,e){let t=new Vo(e),n=[];for(let i=0;i<r.lineCount;i+=1){let o=r.lineAt(i);if(t.isCell(o.text)){if(n.length>0){let s=n[n.length-1];s.range=new La.Range(s.range.start,r.lineAt(i-1).range.end)}n.push({range:o.range,cell_type:t.getCellType(o.text)})}}if(n.length>=1){let i=r.lineAt(r.lineCount-1),o=n[n.length-1];o.range=new La.Range(o.range.start,i.range.end)}return n}function I9(r,e){let t=FD(r,e);return Array.prototype.concat(...t.map(n=>{let i=r.getText(n.range);return _Ee(e,i,!1)}))}function Aee(r){return r.getCells().filter(e=>!KD(e)).map(e=>{let t=at(e.document.getText(),{trim:!1,removeEmptyEntries:!1});e.metadata.interactiveWindowCellMarker!==void 0&&t.unshift(e.metadata.interactiveWindowCellMarker+`
`);let n=new La.NotebookCellData(e.kind,t.join(`
`),e.kind===La.NotebookCellKind.Code?e.document.languageId:"markdown");return e.kind===La.NotebookCellKind.Code&&(n.outputs=[...e.outputs]),n.metadata=Lf(e),n})}d();var UD=require("vscode");var S9=class{constructor(e,t,n){this.disposed=!1;this.dispose=()=>{this.disposed||(this.disposed=!0,this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.disposeCallback(),this.deferred.completed||this.deferred.resolve())};this.promise=()=>this.deferred.promise;this.reject=()=>{this.deferred.reject(),this.dispose()};this.deferred=ke(),this.disposeCallback=t,n&&(this.timeout=setTimeout(this.dispose,n))}},WM=class{constructor(){this.statusCount=0;this.incrementCount=()=>{this.statusCount+=1};this.decrementCount=()=>{let e=this.statusCount-1;this.statusCount=Math.max(e,0)}}set(e,t,n){this.incrementCount();let i=new S9(e,()=>this.decrementCount(),t),o={location:n?UD.ProgressLocation.Notification:UD.ProgressLocation.Window,title:e,cancellable:n!==void 0};return UD.window.withProgress(o,(s,a)=>(a&&n&&a.onCancellationRequested(()=>{n(),i.reject()}),i.promise())).then(y,y),i}async waitWithStatus(e,t,n,i){let o=this.set(t,n,i),s;try{s=await e()}finally{o.dispose()}return s}};var bs=class{constructor(e,t,n,i,o,s,a,l,c,u,p,f,m){this.disposables=e;this.jupyterExporter=t;this.jupyterServerHelper=n;this.fileSystem=i;this.configuration=o;this.dataScienceCodeLensProvider=s;this.debugService=a;this.configService=l;this.interactiveWindowProvider=c;this.kernelProvider=u;this.dataScienceErrorHandler=p;this.ipynbProvider=f;this.fileConverter=m;this.statusProvider=new WM,Ge.workspace.isTrusted||Ge.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted(),this.registerCommand(Q.InsertCellBelowPosition,this.insertCellBelowPosition),this.registerCommand(Q.InsertCellBelow,this.insertCellBelow),this.registerCommand(Q.InsertCellAbove,this.insertCellAbove),this.registerCommand(Q.DeleteCells,this.deleteCells),this.registerCommand(Q.SelectCell,this.selectCell),this.registerCommand(Q.SelectCellContents,this.selectCellContents),this.registerCommand(Q.ExtendSelectionByCellAbove,this.extendSelectionByCellAbove),this.registerCommand(Q.ExtendSelectionByCellBelow,this.extendSelectionByCellBelow),this.registerCommand(Q.MoveCellsUp,this.moveCellsUp),this.registerCommand(Q.MoveCellsDown,this.moveCellsDown),this.registerCommand(Q.ChangeCellToMarkdown,this.changeCellToMarkdown),this.registerCommand(Q.ChangeCellToCode,this.changeCellToCode),this.registerCommand(Q.GotoNextCellInFile,this.gotoNextCellInFile),this.registerCommand(Q.GotoPrevCellInFile,this.gotoPrevCellInFile),this.registerCommand(Q.AddCellBelow,this.addCellBelow),this.registerCommand(Q.CreateNewNotebook,this.createNewNotebook),this.registerCommand(Q.LatestExtension,this.openPythonExtensionPage),this.registerCommand(Q.EnableLoadingWidgetsFrom3rdPartySource,this.enableLoadingWidgetScriptsFromThirdParty),this.registerCommand(Q.CreateNewInteractive,e=>this.createNewInteractiveWindow(e)),this.registerCommand(Q.ImportNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),this.registerCommand(Q.ImportNotebookFile,(e,t="commandpalette")=>this.listenForErrors(()=>e?this.importNotebookOnFile(e):this.importNotebook())),Ge.commands.registerCommand(Q.ExportFileAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFile(e);{let n=Ge.window.activeTextEditor;if(n&&n.document.languageId===qe)return this.exportFile(n.document.uri)}return Promise.resolve()})),this.registerCommand(Q.ExportFileAndOutputAsNotebook,(e,t="commandpalette")=>this.listenForErrors(()=>{if(e)return this.exportFileAndOutput(e);{let n=Ge.window.activeTextEditor;if(n&&n.document.languageId===qe)return this.exportFileAndOutput(n.document.uri)}return Promise.resolve()})),this.registerCommand(Q.ExpandAllCells,async e=>{var t;return this.expandAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.CollapseAllCells,async e=>{var t;return this.collapseAllCells((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.ExportOutputAsNotebook,()=>this.exportCells()),this.registerCommand(Q.InteractiveExportAsNotebook,e=>{var t;return this.export((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.InteractiveExportAs,e=>{var t;return this.exportAs((t=e==null?void 0:e.notebookEditor)==null?void 0:t.notebookUri)}),this.registerCommand(Q.ScrollToCell,(e,t)=>this.scrollToCell(e,t)),this.registerCommand(Q.InteractiveClearAll,this.clearAllCellsInInteractiveWindow),this.registerCommand(Q.InteractiveGoToCode,this.goToCodeInInteractiveWindow),Ge.commands.registerCommand(Q.InteractiveCopyCell,this.copyCellInInteractiveWindow)}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){Ge.workspace.isTrusted&&(this.registerCommand(Q.RunAllCells,this.runAllCells),this.registerCommand(Q.RunCell,this.runCell),this.registerCommand(Q.RunCurrentCell,this.runCurrentCell),this.registerCommand(Q.RunCurrentCellAdvance,this.runCurrentCellAndAdvance),this.registerCommand(Q.ExecSelectionInInteractiveWindow,e=>{this.runSelectionOrLine(e).catch(y)}),this.registerCommand(Q.RunAllCellsAbove,this.runAllCellsAbove),this.registerCommand(Q.RunCellAndAllBelow,this.runCellAndAllBelow),this.registerCommand(Q.RunAllCellsAbovePalette,this.runAllCellsAboveFromCursor),this.registerCommand(Q.RunCellAndAllBelowPalette,this.runCellAndAllBelowFromCursor),this.registerCommand(Q.RunCurrentCellAndAddBelow,this.runCurrentCellAndAddBelow),this.registerCommand(Q.DebugCell,this.debugCell),this.registerCommand(Q.DebugStepOver,this.debugStepOver),this.registerCommand(Q.DebugContinue,this.debugContinue),this.registerCommand(Q.DebugStop,this.debugStop),this.registerCommand(Q.DebugCurrentCellPalette,this.debugCurrentCellFromCursor),this.registerCommand(Q.OpenVariableView,this.openVariableView),this.registerCommand(Q.OpenOutlineView,this.openOutlineView),this.registerCommand(Q.RunToLine,this.runToLine),this.registerCommand(Q.RunFromLine,this.runFromLine),this.registerCommand(Q.RunFileInInteractiveWindows,this.runFileInteractive),this.registerCommand(Q.DebugFileInInteractiveWindows,this.debugFileInteractive))}registerCommand(e,t){let n=Ge.commands.registerCommand(e,t,this);this.disposables.push(n)}getCodeWatcher(e){if(e&&this.dataScienceCodeLensProvider){let t=Ge.workspace.textDocuments.filter(n=>ra(n.uri,e));if(t&&t.length===1)return this.dataScienceCodeLensProvider.getCodeWatcher(t[0]);if(t&&t.length>1)throw new Error(C.documentMismatch(lt(e)))}}async enableLoadingWidgetScriptsFromThirdParty(){this.configService.getSettings(void 0).widgetScriptSources.length>0||await this.configService.updateSetting("widgetScriptSources",["jsdelivr.com","unpkg.com"],void 0,Ge.ConfigurationTarget.Global).catch(y)}async runAllCells(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runAllCells()}async runFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.runFileInteractive()}async debugFileInteractive(e){let t=this.getCodeWatcher(e);if(t||(t=this.getCurrentCodeWatcher()),t)return t.debugFileInteractive()}async runCell(e,t,n,i,o){let s=this.getCodeWatcher(e);if(s)return s.runCell(new Ge.Range(t,n,i,o))}async runAllCellsAbove(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runAllCellsAbove(t,n)}}async runCellAndAllBelow(e,t,n){if(e){let i=this.getCodeWatcher(e);if(i)return i.runCellAndAllBelow(t,n)}}async runToLine(){let e=this.getCurrentCodeWatcher(),t=Ge.window.activeTextEditor;if(e&&t&&t.selection)return e.runToLine(t.selection.start.line)}async runFromLine(){let e=this.getCurrentCodeWatcher(),t=Ge.window.activeTextEditor;if(e&&t&&t.selection)return e.runFromLine(t.selection.start.line)}async runCurrentCell(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCell()}async runCurrentCellAndAdvance(){let e=this.getCurrentCodeWatcher();if(e)return e.runCurrentCellAndAdvance()}async runSelectionOrLine(e){let t=this.getCurrentCodeWatcher();if(t)return t.runSelectionOrLine(Ge.window.activeTextEditor,Tn(e)?void 0:e)}async debugCell(e,t,n,i,o){if(e){let s=this.getCodeWatcher(e);if(s)return s.debugCell(new Ge.Range(t,n,i,o))}}async debugStepOver(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Ge.commands.executeCommand("workbench.action.debug.stepOver").then(y,y)}async debugStop(e){var t;if((t=this.debugService)!=null&&t.activeDebugSession&&this.interactiveWindowProvider){let n=this.interactiveWindowProvider.get(e);if(n&&n.notebookDocument){let i=this.kernelProvider.get(n.notebookDocument);i&&(b.debug(`Interrupt kernel due to debug stop of IW ${e.toString()}`),await i.interrupt())}Ge.commands.executeCommand("workbench.action.debug.stop").then(y,y)}}async debugContinue(){var e;(e=this.debugService)!=null&&e.activeDebugSession&&Ge.commands.executeCommand("workbench.action.debug.continue").then(y,y)}async addCellBelow(){var e;await((e=this.getCurrentCodeWatcher())==null?void 0:e.addEmptyCellToBottom())}async runCurrentCellAndAddBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.runCurrentCellAndAddBelow()}async insertCellBelowPosition(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelowPosition()}async insertCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellBelow()}async insertCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.insertCellAbove()}async deleteCells(){var e;(e=this.getCurrentCodeWatcher())==null||e.deleteCells()}async selectCell(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCell()}async selectCellContents(){var e;(e=this.getCurrentCodeWatcher())==null||e.selectCellContents()}async extendSelectionByCellAbove(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellAbove()}async extendSelectionByCellBelow(){var e;(e=this.getCurrentCodeWatcher())==null||e.extendSelectionByCellBelow()}async moveCellsUp(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsUp()}async moveCellsDown(){var e;(e=this.getCurrentCodeWatcher())==null||e.moveCellsDown()}async changeCellToMarkdown(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToMarkdown()}async changeCellToCode(){var e;(e=this.getCurrentCodeWatcher())==null||e.changeCellToCode()}async gotoNextCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoNextCell()}async gotoPrevCellInFile(){var e;(e=this.getCurrentCodeWatcher())==null||e.gotoPreviousCell()}async runAllCellsAboveFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runAllCellsAbove(e.range.start.line,e.range.start.character)}else return}async runCellAndAllBelowFromCursor(){let e=this.getCurrentCodeLens();if(e){let t=this.getCurrentCodeWatcher();if(t)return t.runCellAndAllBelow(e.range.start.line,e.range.start.character)}else return}async debugCurrentCellFromCursor(){if(this.getCurrentCodeLens()){let t=this.getCurrentCodeWatcher();if(t)return t.debugCurrentCell()}else return}async createNewNotebook(){Ge.window.showInformationMessage('This command has been deprecated and will eventually be removed, please use ["Create: New Jupyter Notebook"](command:workbench.action.openGlobalKeybindings?%5B%22@command:ipynb.newUntitledIpynb%22%5D) instead.').then(y,y),await Ge.commands.executeCommand("ipynb.newUntitledIpynb")}getCurrentCodeLens(){let e=Ge.window.activeTextEditor,t=this.getCurrentCodeWatcher();if(e&&t)return t.getCodeLenses().find(n=>n.range.end.line>=e.selection.anchor.line&&n.range.start.line<=e.selection.anchor.line)}getCurrentCodeWatcher(){let e=Ge.window.activeTextEditor;if(!(!e||!e.document||!this.dataScienceCodeLensProvider))return this.dataScienceCodeLensProvider.getCodeWatcher(e.document)}openPythonExtensionPage(){Ge.env.openExternal(Ge.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter")).then(y,y)}async openVariableView(){return Ge.commands.executeCommand("jupyterViewVariables.focus")}async openOutlineView(){return Ge.commands.executeCommand("outline.focus")}async listenForErrors(e){let t;try{return t=await e(),t}catch(n){b.error("listenForErrors",n),this.dataScienceErrorHandler.handleError(n).then(y,y)}return t}async exportFile(e){let t=lt(e);if(t&&t.length>0&&this.jupyterExporter){let n=Ge.window.activeTextEditor;if(n&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=I9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new ap().showDialog("ipynb",e);if(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},C.exportingFormat,ye(e)),o&&t){let s=C.exportOpenQuestion1;await Ge.window.showInformationMessage(C.exportDialogComplete(ye(e)),s)===s&&await KM(o)}}}}}async exportFileAndOutput(e){let t=lt(e);if(t&&t.length>0&&this.jupyterExporter&&this.jupyterServerHelper&&await this.jupyterServerHelper.isJupyterServerSupported()){let n=Ge.window.activeTextEditor;if(n&&n.document&&this.fileSystem.arePathsSame(n.document.uri,e)){let i=I9(n.document,this.configuration.getSettings(n.document.uri));if(i){let o=await new ap().showDialog("ipynb",e);return o?(await this.waitForStatus(async()=>{var s;if(o){let a=await((s=this.jupyterExporter)==null?void 0:s.serialize(i));await this.fileSystem.writeFile(o,a||"")}},C.exportingFormat,ye(e)),await Ge.workspace.openNotebookDocument(o).then(s=>Ge.window.showNotebookDocument(s)),await Ge.commands.executeCommand("notebook.execute"),o):void 0}}}else this.jupyterServerHelper&&await this.dataScienceErrorHandler.handleError(new cm(C.jupyterNotSupported(await this.jupyterServerHelper.getJupyterServerError())))}async expandAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);b.info(`Expanding all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.expandAllCells()}async collapseAllCells(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);b.info(`Collapsing all cells in interactive window with uri ${t==null?void 0:t.notebookUri}`),t&&await t.collapseAllCells()}exportCells(){var t;let e=(t=this.interactiveWindowProvider)==null?void 0:t.activeWindow;e&&e.export()}exportAs(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.exportAs()}export(e){let t=this.interactiveWindowProvider.getInteractiveWindowWithNotebook(e);t&&t.export()}async createNewInteractiveWindow(e){var t;await((t=this.interactiveWindowProvider)==null?void 0:t.getOrCreate(void 0,e))}waitForStatus(e,t,n,i){let o=t(n||"");return this.statusProvider.waitWithStatus(e,o,void 0,i)}async importNotebook(){let e=C.importDialogFilter,t={};t[e]=["ipynb"];let n=await Ge.window.showOpenDialog({openLabel:C.importDialogTitle,filters:t});n&&n.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(n[0])},C.importingFormat,ye(n[0]))}async importNotebookOnFile(e){let t=lt(e);t&&t.length>0&&await this.waitForStatus(async()=>{await this.fileConverter.importIpynb(e)},C.importingFormat,ye(e))}async scrollToCell(e,t){if(t&&e){let n=this.interactiveWindowProvider.getInteractiveWindowsWithSubmitter(e);for(let i=0;i<n.length;i+=1)if(await n[i].hasCell(t)){n[i].scrollToCell(t);break}}}async clearAllCellsInInteractiveWindow(e){var s,a;let t=(a=this.interactiveWindowProvider.getInteractiveWindowWithNotebook((s=e==null?void 0:e.notebookEditor)==null?void 0:s.notebookUri))==null?void 0:a.notebookUri;if(!t)return;let n=Ge.workspace.notebookDocuments.find(l=>l.uri.toString()===t.toString());if(!n)return;let i=new Ge.WorkspaceEdit,o=Ge.NotebookEdit.deleteCells(new Ge.NotebookRange(0,n.cellCount));i.set(n.uri,[o]),await Ge.workspace.applyEdit(i)}async goToCodeInInteractiveWindow(e){var t;if(e&&((t=e.metadata)!=null&&t.interactive)){let n=Ge.Uri.parse(e.metadata.interactive.uristring),i=e.metadata.interactive.lineIndex,o=await Ge.window.showTextDocument(n,{viewColumn:Ge.ViewColumn.One});o&&(o.revealRange(new Ge.Range(i,0,i,0)),o.selection=new Ge.Selection(new Ge.Position(i,0),new Ge.Position(i,0)))}}async copyCellInInteractiveWindow(e){var t;if(e){let n=this.configuration.getSettings(e.notebook.uri),i=[(t=e.metadata.interactiveWindowCellMarker)!=null?t:n.defaultCellMarker,e.document.getText()].join(`
`);await Ge.env.clipboard.writeText(i)}}};E([Ln("DATASCIENCE.DEBUG_STEP_OVER")],bs.prototype,"debugStepOver",1),E([Ln("DATASCIENCE.DEBUG_STOP")],bs.prototype,"debugStop",1),E([Ln("DATASCIENCE.DEBUG_CONTINUE")],bs.prototype,"debugContinue",1),E([Ar("DATASCIENCE.ADD_CELL_BELOW")],bs.prototype,"addCellBelow",1),E([Ln("DATASCIENCE.EXPORT_PYTHON_FILE")],bs.prototype,"exportFile",1),E([Ln("DATASCIENCE.EXPORT_PYTHON_FILE_AND_OUTPUT")],bs.prototype,"exportFileAndOutput",1),E([Ln("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"command"})],bs.prototype,"importNotebook",1),E([Ln("DATASCIENCE.IMPORT_NOTEBOOK",{scope:"file"})],bs.prototype,"importNotebookOnFile",1),bs=E([(0,Fn.injectable)(),I(0,(0,Fn.inject)(ie)),I(1,(0,Fn.inject)(RI)),I(1,(0,Fn.optional)()),I(2,(0,Fn.inject)(s1)),I(2,(0,Fn.optional)()),I(3,(0,Fn.inject)(xt)),I(4,(0,Fn.inject)(Me)),I(5,(0,Fn.inject)(Pm)),I(5,(0,Fn.optional)()),I(6,(0,Fn.inject)(mo)),I(6,(0,Fn.optional)()),I(7,(0,Fn.inject)(Me)),I(8,(0,Fn.inject)(ys)),I(9,(0,Fn.inject)(He)),I(10,(0,Fn.inject)(xn)),I(11,(0,Fn.inject)(Wo)),I(12,(0,Fn.inject)(v_))],bs);d();var Dv=$(te()),Tm=require("vscode");d();function Ql(r){if(r.metadata.interactive!==void 0)return r.metadata}function Mee(r,e,t){let n=at(r,{trim:!1,removeEmptyEntries:!1}),i=t.stripFirstMarkerNoConcat(n),o=eY(i),s=pI(o,`
`,e.magicCommandsAsComments?UM:void 0);return Qv(s.join(""))}function WD(r){let e=r;return e&&e.input&&Tn(e.input.uri)&&Tn(e.input.inputBoxUri)}var EEe=C.runCurrentCellAndAddBelow,CEe=C.addCellBelowCommandTitle,wEe=C.debugCellCommandTitle,xEe=C.debugCellCommandTitle,DEe=C.debugStepOverCommandTitle,PEe=C.debugContinueCommandTitle,TEe=C.debugStopCommandTitle,kEe=C.runCellLensCommandTitle,NEe=C.runAllCellsLensCommandTitle,REe=C.runAllCellsAboveLensCommandTitle,Oee=C.runCellAndAllBelowLensCommandTitle,AEe=C.scrollToCellTitleFormatMessage,k_=class{constructor(e,t,n,i){this.configService=e;this.generatedCodeStorageFactory=n;this.updateEvent=new Tm.EventEmitter;this.notebookData=new Map;this.codeLensCache=new Map;this.totalCodeLensUpdateTimeInMs=0;this.codeLensUpdateCount=0;this.maxCellCount=0;Tm.workspace.onDidCloseTextDocument(this.onClosedDocument,this,t),Tm.workspace.onDidGrantWorkspaceTrust(()=>this.codeLensCache.clear(),this,t),this.configService.getSettings(void 0).onDidChange(this.onChangedSettings,this,t),Lr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,t),i.onDidDisposeKernel(o=>{this.notebookData.delete(o.notebook.uri.toString())},this,t)}getPerfMeasures(){return{totalCodeLensUpdateTimeInMs:this.totalCodeLensUpdateTimeInMs,codeLensUpdateCount:this.codeLensUpdateCount,maxCellCount:this.maxCellCount}}get updateRequired(){return this.updateEvent.event}createCodeLenses(e){let t=this.getCodeLensCacheData(e);return[...t.documentLenses,...t.gotoCellLens]}getCellRanges(e){return this.getCodeLensCacheData(e).cellRanges}getCodeLensCacheData(e){var l;let t=new St,n=!1,i=e.uri.toString(),o=this.codeLensCache.get(i),s=!1;o||(o={cachedDocumentVersion:void 0,cachedExecutionCounts:new Set,documentLenses:[],cellRanges:[],gotoCellLens:[]},s=!0,this.codeLensCache.set(i,o)),o.cachedDocumentVersion!==e.version&&(o.cellRanges=FD(e,this.configService.getSettings(e.uri)),o.documentLenses=[],o.gotoCellLens=[],o.cachedDocumentVersion=e.version,s=!0);let a=this.getDocumentExecutionCounts(i);if((a.length!==o.cachedExecutionCounts.size||a.find(c=>!(o!=null&&o.cachedExecutionCounts.has(c))))&&(o.gotoCellLens=[],o.cachedExecutionCounts=new Set(a),s=!0),o.documentLenses.length===0&&s&&o.cellRanges.length){n=!0;let c=this.enumerateCommands(e.uri);b.debug(`CodeLensFactory: Generating new code lenses for version ${e.version} of document ${e.uri} for commands ${c.join(", ")}`);let u=!0;o.cellRanges.forEach(p=>{c.forEach(f=>{let m=this.createCodeLens(e,p,f,u);m&&o.documentLenses.push(m)}),u=!1})}else b.ci(`NOT Generating new code lenses for version ${e.version} of document ${e.uri} - needUpdate: ${s}, cellRanges.length: ${o.cellRanges.length}`);if(s&&o.gotoCellLens.length===0&&o.cellRanges.length&&this.configService.getSettings(e.uri).addGotoCodeLenses){let c=this.generatedCodeStorageFactory.get({fileUri:e.uri}),u=c?(l=c.all.find(p=>p.uri.toString()===e.uri.toString()))==null?void 0:l.generatedCodes:void 0;u&&u.length&&o.cellRanges.forEach(p=>{let f=this.createExecutionLens(e,p.range,u);f&&(o==null||o.gotoCellLens.push(f))})}return n&&(this.totalCodeLensUpdateTimeInMs+=t.elapsedTime,this.codeLensUpdateCount+=1,this.maxCellCount=Math.max(this.maxCellCount,o.cellRanges.length)),o}getDocumentExecutionCounts(e){return[...this.notebookData.values()].map(t=>t.documentExecutionCounts.get(e)).filter(t=>t!==void 0)}onDidChangeNotebookCellExecutionState(e){var i;if(e.cell.notebook.notebookType!==vt||e.state!==1||!((i=e.cell.executionSummary)!=null&&i.executionOrder))return;let t=Ql(e.cell),n=this.notebookData.get(e.cell.notebook.uri.toString());n||(n={cellExecutionCounts:new Map,documentExecutionCounts:new Map},this.notebookData.set(e.cell.notebook.uri.toString(),n)),n!==void 0&&t!==void 0&&(n.cellExecutionCounts.set(t.id,e.cell.executionSummary.executionOrder),n.documentExecutionCounts.set(t.interactive.uristring,e.cell.executionSummary.executionOrder),this.updateEvent.fire())}onClosedDocument(e){this.codeLensCache.delete(e.uri.toString())}onChangedSettings(){this.codeLensCache.clear(),this.updateEvent.fire()}enumerateCommands(e){let t,n=this.configService.getSettings(e).codeLenses;n?t=n.split(",").map(s=>s.trim()):t=Ku.DefaultDesignLenses;let i=this.configService.getSettings(e).debugCodeLenses;i?t=t.concat(i.split(",").map(s=>s.trim())):t=t.concat(Ku.DefaultDebuggingLenses);let o=[];return Tm.workspace.isTrusted||(o=[...Ku.DebuggerCommands,...Ku.DebuggerCommands,Q.RunAllCells,Q.RunAllCellsAbove,Q.RunAllCellsAbovePalette,Q.RunCellAndAllBelowPalette,Q.RunCurrentCell,Q.RunCurrentCellAdvance,Q.RunCurrentCellAndAddBelow,Q.RunFileInInteractiveWindows,Q.InterruptKernel,Q.RunToLine,Q.RunCell,Q.DebugCell,Q.DebugContinue,Q.DebugStepOver,Q.DebugStop,Q.RunCellAndAllBelowPalette]),o&&(t=t.filter(s=>!o.includes(s))),t}createCodeLens(e,t,n,i){let{range:o,cell_type:s}=t;switch(n){case Q.RunCurrentCellAndAddBelow:return this.generateCodeLens(o,Q.RunCurrentCellAndAddBelow,EEe);case Q.AddCellBelow:return this.generateCodeLens(o,Q.AddCellBelow,CEe,[e.uri,o.start.line]);case Q.DebugCurrentCellPalette:return this.generateCodeLens(o,Q.DebugCurrentCellPalette,wEe);case Q.DebugCell:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugCell,xEe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case Q.DebugStepOver:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugStepOver,DEe,[e.uri]);case Q.DebugContinue:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugContinue,PEe,[e.uri]);case Q.DebugStop:if(s!=="code")break;return this.generateCodeLens(o,Q.DebugStop,TEe,[e.uri]);case Q.RunCurrentCell:case Q.RunCell:return this.generateCodeLens(o,Q.RunCell,kEe,[e.uri,o.start.line,o.start.character,o.end.line,o.end.character]);case Q.RunAllCells:return this.generateCodeLens(o,Q.RunAllCells,NEe,[e.uri,o.start.line,o.start.character]);case Q.RunAllCellsAbovePalette:case Q.RunAllCellsAbove:return i?this.generateCodeLens(o,Q.RunCellAndAllBelow,Oee,[e.uri,o.start.line,o.start.character]):this.generateCodeLens(o,Q.RunAllCellsAbove,REe,[e.uri,o.start.line,o.start.character]);case Q.RunCellAndAllBelowPalette:case Q.RunCellAndAllBelow:return this.generateCodeLens(o,Q.RunCellAndAllBelow,Oee,[e.uri,o.start.line,o.start.character]);default:b.warn(`Invalid command for code lens ${n}`);break}}findMatchingCellExecutionCount(e){let t=[...this.notebookData.values()].find(n=>n.cellExecutionCounts.get(e));return t==null?void 0:t.cellExecutionCounts.get(e)}createExecutionLens(e,t,n){if(n){let i=n.filter(o=>o.line-2===t.start.line).sort((o,s)=>o.timestamp-s.timestamp);if(i&&i.length){let o=i[i.length-1],s=this.findMatchingCellExecutionCount(o.id);if(s!==void 0)return this.generateCodeLens(t,Q.ScrollToCell,AEe(s),[e.uri,o.id])}}}generateCodeLens(e,t,n,i){return new Tm.CodeLens(e,MEe(t,n,i))}};k_=E([(0,Dv.injectable)(),I(0,(0,Dv.inject)(Me)),I(1,(0,Dv.inject)(ie)),I(2,(0,Dv.inject)(Oa)),I(3,(0,Dv.inject)(He))],k_);function MEe(r,e,t){return{arguments:t,title:e,command:r}}d();var wu=$(te()),Xl=$(require("vscode"));var N_=class{constructor(e,t,n,i,o){this.serviceContainer=e;this.debugLocationTracker=t;this.configuration=n;this.debugService=o;this.totalExecutionTimeInMs=0;this.totalGetCodeLensCalls=0;this.activeCodeWatchers=[];this.didChangeCodeLenses=new Xl.EventEmitter;i.push(this),i.push(Xl.workspace.onDidGrantWorkspaceTrust(()=>{this.activeCodeWatchers=me(this.activeCodeWatchers),this.didChangeCodeLenses.fire()})),i.push(this.debugService.onDidChangeActiveDebugSession(this.onChangeDebugSession.bind(this))),i.push(Xl.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument.bind(this))),this.debugLocationTracker&&i.push(this.debugLocationTracker.updated(this.onDebugLocationUpdated.bind(this)))}dispose(){this.totalGetCodeLensCalls>0&&J("DS_INTERNAL.CODE_LENS_ACQ_TIME",{duration:this.totalExecutionTimeInMs/this.totalGetCodeLensCalls}),me(this.activeCodeWatchers)}get onDidChangeCodeLenses(){return this.didChangeCodeLenses.event}provideCodeLenses(e,t){return[vp,uP].includes(e.uri.scheme)?[]:this.getCodeLensTimed(e)}getCodeWatcher(e){return this.matchWatcher(e.uri)}onDebugLocationUpdated(){this.didChangeCodeLenses.fire()}onChangeDebugSession(e){this.didChangeCodeLenses.fire()}onDidCloseTextDocument(e){let t=this.activeCodeWatchers.findIndex(n=>n.uri&&n.uri.toString()===e.uri.toString());t>=0&&this.activeCodeWatchers.splice(t,1)[0].dispose()}getCodeLensTimed(e){let t=new St,n=this.getCodeLens(e);return this.totalExecutionTimeInMs+=t.elapsedTime,this.totalGetCodeLensCalls+=1,new gr(Sr.HasCodeCells).set(n&&n.length>0).catch(y),this.configuration.getSettings(e.uri).enableCellCodeLens?this.adjustDebuggingLenses(e,n):[]}adjustDebuggingLenses(e,t){let n=Ku.DebuggerCommands;if(this.debugLocationTracker&&this.debugService.activeDebugSession){let i=this.debugLocationTracker.getLocation(this.debugService.activeDebugSession),o;try{o=i?Xl.Uri.parse(i.fileName):void 0}catch(s){}if(i&&(ra(Xl.Uri.file(i.fileName),e.uri,!0)||o&&ra(o,e.uri,!0)))return t.filter(a=>{let l=new Xl.Position(i.lineNumber-1,i.column-1);return a.range.contains(l)}).filter(a=>a.command?n.includes(a.command.command):!1);b.ci(`Detected debugging context because activeDebugSession is name:"${this.debugService.activeDebugSession.name}", type: "${this.debugService.activeDebugSession.type}", but fell through with debugLocation: ${JSON.stringify(i)}, and document.uri: ${e.uri.toString()}`)}else return t.filter(i=>i.command?!n.includes(i.command.command):!1);return[]}getCodeLens(e){let t=this.matchWatcher(e.uri);return t?t.getCodeLenses():(b.debug(`Creating a new watcher for document ${e.uri}`),this.createNewCodeWatcher(e).getCodeLenses())}matchWatcher(e){let t=this.activeCodeWatchers.findIndex(i=>i.uri&&i.uri.toString()==e.toString());if(t>=0)return this.activeCodeWatchers[t];let n=Xl.workspace.textDocuments.filter(i=>i.uri.toString()===e.toString());if(n&&n.length>0)return b.debug(`creating new code watcher with matching document ${e}`),this.createNewCodeWatcher(n[0])}createNewCodeWatcher(e){let t=this.serviceContainer.get(RM);return t.setDocument(e),t.codeLensUpdated(this.onWatcherUpdated.bind(this)),this.activeCodeWatchers.push(t),t}onWatcherUpdated(){this.didChangeCodeLenses.fire()}};N_=E([(0,wu.injectable)(),I(0,(0,wu.inject)(Ur)),I(1,(0,wu.inject)(pM)),I(1,(0,wu.optional)()),I(2,(0,wu.inject)(Me)),I(3,(0,wu.inject)(ie)),I(4,(0,wu.inject)(mo))],N_);d();var km=$(te()),Ee=require("vscode");d();var VM=Symbol("ICodeExecutionHelper");d();var Pv=class extends Error{constructor(t){super("Cell failed to execute");this.cell=t}};function OEe(r,e){if(e<=0)throw new RangeError(`Length must be > 0 not ${e}`);return r<0&&(r+=e),r<0?0:r>=e?e-1:r}var or=class{constructor(e,t,n,i,o){this.interactiveWindowProvider=e;this.configService=t;this.executionHelper=n;this.dataScienceErrorHandler=i;this.codeLensFactory=o;this.version=-1;this.codeLenses=[];this.cells=[];this.codeLensUpdatedEvent=new Ee.EventEmitter;this.disposables=[this.codeLensUpdatedEvent]}setDocument(e){this.document=e,this.version=e.version,this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.disposables.push(this.codeLensFactory.updateRequired(this.onCodeLensFactoryUpdated.bind(this))),this.disposables.push(Ee.workspace.onDidCloseTextDocument(this.onDocumentClosed.bind(this))),this.disposables.push(Ee.workspace.onDidCloseNotebookDocument(this.ondidCloseNotebook.bind(this)))}get codeLensUpdated(){return this.codeLensUpdatedEvent.event}get uri(){var e;return(e=this.document)==null?void 0:e.uri}getVersion(){return this.version}getCodeLenses(){let e=this.document;return e&&e.version!=this.version&&(this.codeLenses=this.codeLensFactory.createCodeLenses(e),this.cells=this.codeLensFactory.getCellRanges(e),this.version=e.version),this.codeLenses}async debugCurrentCell(){if(!(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document))return this.runMatchingCell(Ee.window.activeTextEditor.selection,!1,!0)}dispose(){let e=this.codeLensFactory.getPerfMeasures();e&&e.codeLensUpdateCount>0&&J("DS_INTERNAL.DOCUMENT_WITH_CODE_CELLS",{codeLensUpdateTime:e.totalCodeLensUpdateTimeInMs/e.codeLensUpdateCount,maxCellCount:e.maxCellCount}),me(this.disposables)}async runAllCells(e){let t=await this.getActiveInteractiveWindow(),n=this.codeLenses.filter(s=>s.command&&s.command.command===Q.RunCell&&s.command.arguments&&s.command.arguments.length>=5),i=n.length,o=Promise.resolve(!0);for(let s of n){let a=new Ee.Range(s.command.arguments[1],s.command.arguments[2],s.command.arguments[3],s.command.arguments[4]);if(this.document){i===n.length&&(a=new Ee.Range(new Ee.Position(0,0),a.end));let l=this.document.getText(a);i-=1,o=this.addCode(t,l,this.document.uri,a.start.line,e)}}if(await o,n.length===0)return this.runFileAsOneCell(e!=null?e:!1)}async runFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells();if(this.document)return this.runFileAsOneCell(!1)}async debugFileInteractive(){var e;if(this.document&&this.configService.getSettings((e=this.document)==null?void 0:e.uri).splitRunFileIntoCells)return this.runAllCells(!0);if(this.document)return this.runFileAsOneCell(!0)}async runAllCellsAbove(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===Q.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t);o<0&&(o=i.length);let s=o,a=Promise.resolve(!0);for(let l of i)if(o>0&&this.document){let c=new Ee.Range(l.range.start,l.range.end);o===s&&(c=new Ee.Range(new Ee.Position(0,0),c.end)),o-=1;let u=this.document.getText(c);a=this.addCode(n,u,this.document.uri,l.range.start.line)}else break;await a}async runCellAndAllBelow(e,t){let n=await this.getActiveInteractiveWindow(),i=this.codeLenses.filter(l=>l.command&&l.command.command===Q.RunCell),o=i.findIndex(l=>l.range.start.line>=e&&l.range.start.character>=t),s=o>0?i.length-o:i.length,a=Promise.resolve(!0);for(let l=o;l>=0&&l<i.length;l+=1)if(s>0&&this.document){let c=i[l];s-=1;let u=this.document.getText(c.range);a=this.addCode(n,u,this.document.uri,c.range.start.line)}await a}async runSelectionOrLine(e,t){var n;if(this.document&&e&&ra(e.document.uri,this.document.uri)){let i=await this.getActiveInteractiveWindow(),o;if(t===void 0||Tn(t)?o=this.executionHelper.getSelectedTextToExecute(e):o=t,!o)return;let a=((n=this.configService.getSettings(e.document.uri).normalizeSelectionForInteractiveWindow)!=null?n:!0)?await this.executionHelper.normalizeLines(o):o;if(!a||a.trim().length===0)return;await this.addCode(i,a,this.document.uri,e.selection.start.line)}}async runToLine(e){if(this.document&&e>0){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(e-1),i=this.document.getText(new Ee.Range(0,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,0)}}async runFromLine(e){if(this.document&&e<this.document.lineCount){let t=await this.getActiveInteractiveWindow(),n=this.document.lineAt(this.document.lineCount-1),i=this.document.getText(new Ee.Range(e,0,n.range.end.line,n.range.end.character));i&&i.trim().length&&await this.addCode(t,i,this.document.uri,e)}}async runCell(e){if(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document)return;let t=e.contains(Ee.window.activeTextEditor.selection.start)&&this.configService.getSettings(Ee.window.activeTextEditor.document.uri).enableAutoMoveToNextCell;return this.runMatchingCell(e,t)}async debugCell(e){if(!(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document))return this.runMatchingCell(e,!1,!0)}async runCurrentCell(){if(!(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document))return this.runMatchingCell(Ee.window.activeTextEditor.selection,!1)}async runCurrentCellAndAdvance(){if(!(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document))return this.runMatchingCell(Ee.window.activeTextEditor.selection,!0)}async addEmptyCellToBottom(){let e=Ee.window.activeTextEditor;e&&this.insertCell(e,e.document.lineCount+1)}async runCurrentCellAndAddBelow(){if(!Ee.window.activeTextEditor||!Ee.window.activeTextEditor.document)return;let e=Ee.window.activeTextEditor,t=new Vo(this.configService.getSettings(e.document.uri)),n=0,i=this.getDefaultCellMarker(e.document.uri);e&&e.edit(s=>{let a=!0;for(let l=e.selection.end.line+1;l<e.document.lineCount;l+=1)if(t.isCell(e.document.lineAt(l).text)){a=!1,n=l,s.insert(new Ee.Position(l,0),`${i}

`);break}a&&(n=e.document.lineCount,s.insert(new Ee.Position(e.document.lineCount,0),`
${i}
`))}).then(y,y);let o=new Ee.Position(n+1,0);return this.runMatchingCell(e.selection,!1).then(()=>this.advanceToRange(new Ee.Range(o,o)))}insertCellBelowPosition(){let e=Ee.window.activeTextEditor;e&&e.selection&&this.insertCell(e,e.selection.end.line+1)}insertCellBelow(){let e=Ee.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.end);t?this.insertCell(e,t.range.end.line+1):this.insertCell(e,e.selection.end.line+1)}}insertCellAbove(){let e=Ee.window.activeTextEditor;if(e&&e.selection){let t=this.getCellFromPosition(e.selection.start);t?this.insertCell(e,t.range.start.line):this.insertCell(e,e.selection.start.line)}}deleteCells(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCells(e.selection);if(!t)return;let n=t[0],i=t[1],o=0,s=0,a=i.range.end.line+1,l=0;n.range.start.line>0&&(o=n.range.start.line-1,s=e.document.lineAt(o).range.end.character,a=i.range.end.line,l=i.range.end.character);let c=new Ee.Range(new Ee.Position(o,s),new Ee.Position(a,l));e.edit(u=>{u.replace(c,""),this.codeLensUpdatedEvent.fire()}).then(y,y)}selectCell(){let e=Ee.window.activeTextEditor;if(e&&e.selection){let t=this.getStartEndCells(e.selection);if(t){let n=t[0],i=t[1];e.selection.anchor.isBeforeOrEqual(e.selection.active)?e.selection=new Ee.Selection(n.range.start,i.range.end):e.selection=new Ee.Selection(i.range.end,n.range.start)}}}selectCellContents(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=this.getStartEndCellIndex(e.selection);if(!t)return;let n=t[0],i=t[1],o=e.selection.anchor.isBeforeOrEqual(e.selection.active),s=this.cells,a=[];for(let l=n;l<=i;l+=1){let c=s[l],u=c.range.start.line+1,p=0,f=c.range.end.line,m=c.range.end.character;c.range.start.line===c.range.end.line&&(u=c.range.start.line,p=e.document.lineAt(u).range.end.character,f=u,m=p),o?a.push(new Ee.Selection(u,p,f,m)):a.push(new Ee.Selection(f,m,u,p))}e.selections=a}extendSelectionByCellAbove(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBefore(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let u;i?s<a?u=new Ee.Selection(l.range.start,o[a-1].range.end):u=new Ee.Selection(l.range.end,l.range.start):u=new Ee.Selection(c.range.end,l.range.start),e.selection=u}else{let u;i&&s<a?(u=o[a-1],e.selection=new Ee.Selection(l.range.start,u.range.end)):s>0&&(u=o[s-1],e.selection=new Ee.Selection(c.range.end,u.range.start)),u&&e.revealRange(u.range,Ee.TextEditorRevealType.Default)}}extendSelectionByCellBelow(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getStartEndCellIndex(e.selection);if(!n)return;let i=e.selection.anchor.isBeforeOrEqual(e.selection.active),o=this.cells,s=n[0],a=n[1],l=o[s],c=o[a];if(!l.range.start.isEqual(t.start)||!c.range.end.isEqual(t.end)){let u;i?u=new Ee.Selection(l.range.start,c.range.end):s<a?u=new Ee.Selection(o[s+1].range.start,c.range.end):u=new Ee.Selection(c.range.start,c.range.end),e.selection=u}else{let u;i||s===a?a<o.length-1&&(u=o[a+1],e.selection=new Ee.Selection(l.range.start,u.range.end)):s<a&&(u=o[s+1],e.selection=new Ee.Selection(c.range.end,u.range.start)),u&&e.revealRange(u.range,Ee.TextEditorRevealType.Default)}}async moveCellsUp(){await this.moveCellsDirection(!0)}async moveCellsDown(){await this.moveCellsDirection(!1)}changeCellToMarkdown(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"markdown"))}changeCellToCode(){this.applyToCells((e,t,n)=>this.changeCellTo(e,t,"code"))}gotoNextCell(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getNextCellLens(t.start);n&&i&&this.advanceToRange(i.range)}gotoPreviousCell(){let e=Ee.window.activeTextEditor;if(!e||!e.selection)return;let t=e.selection,n=this.getCurrentCellLens(t.start),i=this.getPreviousCellLens(t.start);n&&i&&this.advanceToRange(i.range)}applyToCells(e){let t=Ee.window.activeTextEditor,n=this.getStartEndCellIndex(t==null?void 0:t.selection);if(!t||!n)return;let i=this.cells,o=n[0],s=n[1];for(let a=o;a<=s;a+=1)e(t,i[a],a)}changeCellTo(e,t,n){if(n==="raw")throw Error("Cell Type raw not implemented");if(t.cell_type===n)return;let i=new Vo(this.configService.getSettings(e.document.uri)),o=e.document.lineAt(t.range.start.line),s=e.document.getText(o.range),a=this.getDefaultCellMarker(e.document.uri),l=n==="markdown"?i.codeExecRegEx.exec(s):i.markdownExecRegEx.exec(s);if(!l)return;let c=l[l.length-1],u=n==="markdown"?`${a} [markdown]${c}`:`${a}${c}`;e.edit(async p=>{p.replace(o.range,u),t.cell_type=n,t.range.start.line<t.range.end.line&&(e.selection=new Ee.Selection(t.range.start.line+1,0,t.range.end.line,t.range.end.character),Ee.commands.executeCommand("editor.action.removeCommentLine").then(y,y),n==="markdown"&&Ee.commands.executeCommand("editor.action.addCommentLine").then(y,y))}).then(y,y)}async moveCellsDirection(e){let t=Ee.window.activeTextEditor;if(!t||!t.selection)return!1;let n=this.getStartEndCellIndex(t.selection);if(!n)return!1;let i=n[0],o=n[1],s=this.cells,a=s[i],l=s[o];if(!a||!l)return!1;let c=new Ee.Range(a.range.start,l.range.end),u=new Ee.Range(t.selection.start.line-c.start.line,t.selection.start.character,t.selection.end.line-c.start.line,t.selection.end.character),p=t.selection.active.isBefore(t.selection.anchor),f;if(e){if(i===0)return!1;{let m=s[i-1];f=this.exchangeTextLines(t,m.range,c).then(g=>(g&&(t.selection=new Ee.Selection(m.range.start.line+u.start.line,u.start.character,m.range.start.line+u.end.line,u.end.character)),g))}}else{if(o===s.length-1)return!1;{let m=s[o+1],h=this.exchangeTextLines(t,c,m.range),g=m.range.end.line-m.range.start.line,v=c.end.line-c.start.line,S=g-v;f=h.then(_=>(_&&(t.selection=new Ee.Selection(m.range.start.line+S+u.start.line,u.start.character,m.range.start.line+S+u.end.line,u.end.character)),_))}}return f.then(m=>(m&&p&&(t.selection=new Ee.Selection(t.selection.active,t.selection.anchor)),!0))}exchangeTextLines(e,t,n){let i=t.start.line,o=t.end.line,s=n.start.line,a=n.end.line;if(o>=s)throw RangeError(`Above lines must be fully above not ${o} <= ${s}`);let l=new Ee.Range(i,0,o,e.document.lineAt(o).range.end.character),c=e.document.getText(l),u=new Ee.Range(s,0,a,e.document.lineAt(a).range.end.character),p=e.document.getText(u),f="";if(o+1<s){let g=o+1,v=s-1,S=new Ee.Range(g,0,v,e.document.lineAt(v).range.end.character);f=`${e.document.getText(S)}
`}let m=`${p}
${f}${c}`,h=new Ee.Range(l.start,u.end);return e.edit(g=>{g.replace(h,m),this.codeLensUpdatedEvent.fire()})}getStartEndCells(e){let t=this.getStartEndCellIndex(e);if(t){let n=this.getCellFromIndex(t[0]),i=this.getCellFromIndex(t[1]);return[n,i]}}getStartEndCellIndex(e){if(!e)return;let t=this.getCellIndex(e.start),n=t;if(e.start.line!==e.end.line&&(n=this.getCellIndex(e.end)),t===-1){if(n===-1)return;{t=0;let i=this.getCellFromIndex(0);if(e.start.line>i.range.start.line)throw RangeError(`Should not be able to pick a range with an end in a cell and start after a cell. ${e.start.line} > ${i.range.end.line}`)}}if(t>=0&&n>=0)return[t,n]}insertCell(e,t){let n=this.getDefaultCellMarker(e.document.uri),i=t>=e.document.lineCount?`
${n}
`:`${n}

`,o=new Ee.Position(t,0),s=new Ee.Position(t+1,0);e.edit(a=>{a.insert(o,i),this.codeLensUpdatedEvent.fire()}).then(y,y),e.selection=new Ee.Selection(s,s)}getDefaultCellMarker(e){return this.configService.getSettings(e).defaultCellMarker||rt.DefaultCodeCellMarker}onCodeLensFactoryUpdated(){this.document&&(this.codeLenses=this.codeLensFactory.createCodeLenses(this.document),this.cells=this.codeLensFactory.getCellRanges(this.document)),this.codeLensUpdatedEvent.fire()}onDocumentClosed(e){this.document&&ra(e.uri,this.document.uri)&&me(this.disposables)}ondidCloseNotebook(e){var t;e.notebookType===vt&&this.configService.getSettings((t=this.document)==null?void 0:t.uri).addGotoCodeLenses&&this.onCodeLensFactoryUpdated()}getActiveInteractiveWindow(){var e;return this.interactiveWindowProvider.getOrCreate((e=this.document)==null?void 0:e.uri)}async addCode(e,t,n,i,o){let s=!1;try{o?s=await e.debugCode(t,n,i):s=await e.addCode(t,n,i)}catch(a){a instanceof Pv||await this.dataScienceErrorHandler.handleError(a)}return s}async runMatchingCell(e,t,n){let i=this.getCurrentCellLens(e.start),o=this.getNextCellLens(e.start);if(i&&this.document){let s=Qv(this.document.getText(i.range));if(t){let l=Ee.window.activeTextEditor,{newCellOnRunLast:c}=this.configService.getSettings(this.document.uri),u=new Vo(this.configService.getSettings(this.document.uri));o?this.advanceToRange(o.range):c&&l&&!u.isEmptyCell(s)&&this.insertCell(l,i.range.end.line+1)}let a=await this.getActiveInteractiveWindow();await this.addCode(a,s,this.document.uri,i.range.start.line,n)}}getCellIndex(e){return this.cells.findIndex(t=>e&&t.range.contains(e))}getCellFromIndex(e){let t=this.cells,n=OEe(e,t.length);return t[n]}getCellFromPosition(e){if(!e){let t=Ee.window.activeTextEditor;t&&t.selection&&(e=t.selection.active)}if(e){let t=this.getCellIndex(e);if(t>=0)return this.cells[t]}}getCurrentCellLens(e){return this.codeLenses.find(t=>t.range.contains(e)&&t.command!==void 0&&t.command.command===Q.RunCell)}getNextCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===Q.RunCell);if(t>=0)return this.codeLenses.find((n,i)=>n.command!==void 0&&n.command.command===Q.RunCell&&i>t)}getPreviousCellLens(e){let t=this.codeLenses.findIndex(n=>n.range.contains(e)&&n.command!==void 0&&n.command.command===Q.RunCell);if(t>=1)return this.codeLenses.find((n,i)=>n.command!==void 0&&i<t&&i+1===t)}async runFileAsOneCell(e){if(this.document){let t=await this.getActiveInteractiveWindow(),n=this.document.getText();await this.addCode(t,n,this.document.uri,0,e)}}advanceToRange(e){let t=Ee.window.activeTextEditor,n=new Ee.Selection(e.start,e.start);t&&(t.selection=n,t.revealRange(e,Ee.TextEditorRevealType.Default))}};E([Ln("DATASCIENCE.DEBUG_CURRENT_CELL")],or.prototype,"debugCurrentCell",1),E([Ln("DATASCIENCE.RUN_ALL_CELLS")],or.prototype,"runAllCells",1),E([Ln("DATASCIENCE.RUN_FILE_INTERACTIVE")],or.prototype,"runFileInteractive",1),E([Ln("DATASCIENCE.DEBUG_FILE_INTERACTIVE")],or.prototype,"debugFileInteractive",1),E([Ln("DATASCIENCE.RUN_ALL_CELLS_ABOVE")],or.prototype,"runAllCellsAbove",1),E([Ln("DATASCIENCE.RUN_CELL_AND_ALL_BELOW")],or.prototype,"runCellAndAllBelow",1),E([Ln("DATASCIENCE.RUN_SELECTION_OR_LINE")],or.prototype,"runSelectionOrLine",1),E([Ln("DATASCIENCE.RUN_TO_LINE")],or.prototype,"runToLine",1),E([Ln("DATASCIENCE.RUN_FROM_LINE")],or.prototype,"runFromLine",1),E([O7("CodeWatcher::runCell",4)],or.prototype,"runCell",1),E([Ln("DATASCIENCE.DEBUG_CURRENT_CELL")],or.prototype,"debugCell",1),E([Ln("DATASCIENCE.RUN_CURRENT_CELL")],or.prototype,"runCurrentCell",1),E([Ln("DATASCIENCE.RUN_CURRENT_CELL_AND_ADVANCE")],or.prototype,"runCurrentCellAndAdvance",1),E([Ar("DATASCIENCE.RUN_CURRENT_CELL_AND_ADD_BELOW")],or.prototype,"runCurrentCellAndAddBelow",1),E([Ar("DATASCIENCE.RUN_INSERT_CELL_BELOW_POSITION")],or.prototype,"insertCellBelowPosition",1),E([Ar("DATASCIENCE.RUN_INSERT_CELL_BELOW")],or.prototype,"insertCellBelow",1),E([Ar("DATASCIENCE.RUN_INSERT_CELL_ABOVE")],or.prototype,"insertCellAbove",1),E([Ar("DATASCIENCE.RUN_DELETE_CELLS")],or.prototype,"deleteCells",1),E([Ar("DATASCIENCE.RUN_SELECT_CELL")],or.prototype,"selectCell",1),E([Ar("DATASCIENCE.RUN_SELECT_CELL_CONTENTS")],or.prototype,"selectCellContents",1),E([Ar("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_ABOVE")],or.prototype,"extendSelectionByCellAbove",1),E([Ar("DATASCIENCE.RUN_EXTEND_SELECTION_BY_CELL_BELOW")],or.prototype,"extendSelectionByCellBelow",1),E([Ar("DATASCIENCE.RUN_MOVE_CELLS_UP")],or.prototype,"moveCellsUp",1),E([Ar("DATASCIENCE.RUN_MOVE_CELLS_DOWN")],or.prototype,"moveCellsDown",1),E([Ar("DATASCIENCE.RUN_CHANGE_CELL_TO_MARKDOWN")],or.prototype,"changeCellToMarkdown",1),E([Ar("DATASCIENCE.RUN_CHANGE_CELL_TO_CODE")],or.prototype,"changeCellToCode",1),E([Ar("DATASCIENCE.GOTO_NEXT_CELL_IN_FILE")],or.prototype,"gotoNextCell",1),E([Ar("DATASCIENCE.GOTO_PREV_CELL_IN_FILE")],or.prototype,"gotoPreviousCell",1),or=E([(0,km.injectable)(),I(0,(0,km.inject)(ys)),I(1,(0,km.inject)(Me)),I(2,(0,km.inject)(VM)),I(3,(0,km.inject)(xn)),I(4,(0,km.inject)(AM))],or);d();var A_=$(te()),Ti=$(require("vscode"));var Nm=require("vscode");var R_=class{constructor(e,t,n){this.configuration=t;this.extensionChecker=n;this.computeDecorations(),e.push(this),e.push(this.configuration.getSettings(void 0).onDidChange(this.settingsChanged,this)),e.push(Ti.window.onDidChangeActiveTextEditor(this.changedEditor,this)),e.push(Ti.window.onDidChangeTextEditorSelection(this.changedSelection,this)),e.push(Ti.workspace.onDidChangeTextDocument(this.changedDocument,this)),this.settingsChanged()}activate(){}dispose(){this.timer&&clearTimeout(this.timer)}settingsChanged(){Ti.window.activeTextEditor&&this.triggerUpdate(Ti.window.activeTextEditor)}changedEditor(){this.triggerUpdate(void 0)}changedDocument(e){Ti.window.activeTextEditor&&e.document===Ti.window.activeTextEditor.document&&this.triggerUpdate(Nm.window.activeTextEditor)}changedSelection(e){e.textEditor&&e.textEditor.selection.anchor&&this.triggerUpdate(e.textEditor)}triggerUpdate(e){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>this.update(e),100)}computeDecorations(){this.currentCellTopUnfocused=Nm.window.createTextEditorDecorationType({borderColor:new Ti.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottomUnfocused=Nm.window.createTextEditorDecorationType({borderColor:new Ti.ThemeColor("interactive.inactiveCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellTop=Nm.window.createTextEditorDecorationType({borderColor:new Ti.ThemeColor("interactive.activeCodeBorder"),borderWidth:"2px 0px 0px 0px",borderStyle:"solid",isWholeLine:!0}),this.currentCellBottom=Nm.window.createTextEditorDecorationType({borderColor:new Ti.ThemeColor("interactive.activeCodeBorder"),borderWidth:"0px 0px 1px 0px",borderStyle:"solid",isWholeLine:!0})}cellDecorationEnabled(e){return e.decorateCells===!1?!1:e.decorateCells==="currentCell"||e.decorateCells==="allCells"}update(e){let t=e===void 0?Nm.window.visibleTextEditors:[e];for(let n of t)if(n&&n.document&&n.document.languageId===qe&&!uI(n.document)&&this.currentCellTop&&this.currentCellBottom&&this.currentCellTopUnfocused&&this.currentCellBottomUnfocused&&this.extensionChecker.isPythonExtensionInstalled){let i=this.configuration.getSettings(n.document.uri);if(this.cellDecorationEnabled(i)){let o=FD(n.document,i),s=o.map(u=>u.range).filter(u=>u.contains(n.selection.anchor)),a=s.length>0?[new Ti.Range(s[0].start,s[0].start)]:[],l=i.decorateCells!=="allCells"&&s.length>0?[new Ti.Range(s[0].end,s[0].end)]:[],c=[];i.decorateCells==="allCells"&&o.forEach(u=>{let p=u.range.start;p!==s[0].start&&c.push(new Ti.Range(p,p))}),Nm.window.activeTextEditor===n?(n.setDecorations(this.currentCellTop,a),n.setDecorations(this.currentCellBottom,l),n.setDecorations(this.currentCellTopUnfocused,c),n.setDecorations(this.currentCellBottomUnfocused,[])):(n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[...c,...a]),n.setDecorations(this.currentCellBottomUnfocused,l))}else n.setDecorations(this.currentCellTop,[]),n.setDecorations(this.currentCellBottom,[]),n.setDecorations(this.currentCellTopUnfocused,[]),n.setDecorations(this.currentCellBottomUnfocused,[])}}};R_=E([(0,A_.injectable)(),I(0,(0,A_.inject)(ie)),I(1,(0,A_.inject)(Me)),I(2,(0,A_.inject)(Eo))],R_);d();var Is=$(te()),Wr=require("vscode");d();var Bt=require("vscode");var Lee=$(iv());var Tv=class{constructor(e,t,n,i,o){this.serviceContainer=e;this._owner=t;this.controllerFactory=n;this.inputUri=o;this._onDidChangeViewState=new Bt.EventEmitter;this.closedEvent=new Bt.EventEmitter;this._submitters=[];this.internalDisposables=[];var s;this.fs=this.serviceContainer.get(xt),this.configuration=this.serviceContainer.get(Me),this.jupyterExporter=this.serviceContainer.get(RI),this.interactiveWindowDebugger=this.serviceContainer.tryGet(Dee),this.errorHandler=this.serviceContainer.get(xn),this.codeGeneratorFactory=this.serviceContainer.get(T_),this.storageFactory=this.serviceContainer.get(Oa),this.kernelProvider=this.serviceContainer.get(He),this.debuggingManager=this.serviceContainer.get(OM),this.notebookUri=WD(i)?i.input.uri:i.notebook.uri,this._owner&&this._submitters.push(this._owner),Bt.window.onDidChangeActiveNotebookEditor(a=>{(a==null?void 0:a.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire()},this.internalDisposables),Bt.workspace.onDidCloseNotebookDocument(a=>{a.uri.toString()===this.notebookUri.toString()&&this.closedEvent.fire()},this.internalDisposables),((s=Bt.window.activeNotebookEditor)==null?void 0:s.notebook.uri.toString())===this.notebookUri.toString()&&this._onDidChangeViewState.fire(),this.cellMatcher=new Vo(this.configuration.getSettings(this.owningResource)),this.notebookDocument&&this.codeGeneratorFactory.getOrCreate(this.notebookDocument)}get onDidChangeViewState(){return this._onDidChangeViewState.event}get closed(){return this.closedEvent.event}get owner(){return this._owner}get submitters(){return this._submitters}get notebookDocument(){return this._notebookDocument||(this._notebookDocument=Bt.workspace.notebookDocuments.find(e=>e.uri.toString()===this.notebookUri.toString())),this._notebookDocument}get kernelConnectionMetadata(){var e;return(e=this.controller)==null?void 0:e.metadata}notifyConnectionReset(){if(this.notebookDocument)this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.setInfoMessageCell(C.noKernelConnected);else{let e=Bt.workspace.onDidOpenNotebookDocument(t=>{t.uri.toString()===this.notebookUri.toString()&&(this._notebookDocument=t,this.controller=this.initController(t),this.internalDisposables.push(this.controller.listenForControllerSelection()),this.controller.setInfoMessageCell(C.noKernelConnected),e.dispose())})}}initController(e){let t=this.controllerFactory.create(e,this.errorHandler,this.kernelProvider,this._owner);return this.internalDisposables.push(t.listenForControllerSelection()),t}async ensureInitialized(){if(!this.notebookDocument&&(b.debug("Showing Interactive editor to initialize codeGenerator from notebook document"),await this.showInteractiveEditor(),!this.notebookDocument))throw new Error("Could not open notebook document for Interactive Window");this.codeGeneratorFactory.get(this.notebookDocument)||this.codeGeneratorFactory.getOrCreate(this.notebookDocument),this.controller||(this.controller=this.initController(this.notebookDocument)),this.controller.controller?this.controller.startKernel().catch(y):(b.info("No controller selected for Interactive Window initialization"),this.controller.setInfoMessageCell(C.selectKernelForEditor))}async showInteractiveEditor(){let e;Bt.window.tabGroups.all.find(i=>{i.tabs.find(o=>{WD(o)&&o.input.uri.toString()==this.notebookUri.toString()&&(e=o)})});let t=this.notebookDocument||await this.openNotebookDocument();return await Bt.window.showNotebookDocument(t,{preserveFocus:!0,viewColumn:e==null?void 0:e.group.viewColumn})}async openNotebookDocument(){return b.debug(`Opening notebook document ${this.notebookUri}`),await Bt.workspace.openNotebookDocument(this.notebookUri)}dispose(){var e;this.internalDisposables.forEach(t=>t.dispose()),(e=this.controller)==null||e.disconnect()}async showErrorForCell(e,t){var o,s,a;let n=(o=this.controller)==null?void 0:o.controller,i=Sy(e);if(n&&i&&t){let l=po.getOrCreate(t,new yv(n));try{await l.appendOutput(i)}catch(c){b.warn(`Could not append error message "${i}" to cell: ${c}`)}finally{l.end(!1,(a=(s=t.executionSummary)==null?void 0:s.timing)==null?void 0:a.endTime)}}else b.info(`Could not append error message to cell "${i}"`)}changeMode(e){var t;(t=this.controller)==null||t.updateMode(e)}async addCode(e,t,n){return this.submitCode(e,t,n,!1)}useNewDebugMode(){var t;return!!(this.configuration.getSettings(this.owner).forceIPyKernelDebugger||(t=this.controller)!=null&&t.metadata&&!tr(this.controller.metadata))}async debugCode(e,t,n){let i=!0,o=Bt.workspace.textDocuments.find(a=>this.fs.arePathsSame(a.uri,t));if(!this.useNewDebugMode()&&o&&o.isUntitled){let a=[...Bt.workspace.textDocuments];if(i=await o.save(),i){let l=Bt.workspace.textDocuments.filter(c=>a.indexOf(c)===-1);l&&l.length>0&&(t=(l.find(u=>u.languageId==="python")||l.find(u=>!u.fileName.endsWith(".interactive"))||l[0]).uri,await Bt.workspace.openTextDocument(t))}}let s=!0;return i?this.submitCode(e,t,n,!0):s}async submitCode(e,t,n,i){var u;if(this.cellMatcher.isEmptyCell(e)||!((u=this.controller)!=null&&u.controller))return!0;this.updateOwners(t);let o=at(e,{trim:!1}),s=new Vo(this.configuration.getSettings(t)),a=-1;s.isMarkdown(o[0])&&Lg(o,(p,f)=>void 0,(p,f)=>{p&&p.length>0&&a===-1&&(a=f)});let c=(a>0?[o.slice(0,a).join(`
`),o.slice(a).join(`
`)]:[e]).map(p=>{let f=ke();this.controller.setPendingCellAdd(f.promise);let m=this.addNotebookCell(p,t,n),h=this.createExecutionPromise(m,i);return h.catch(g=>{g instanceof Pv?m.then(v=>{g.cell!==v&&this.showErrorForCell(C.cellStopOnErrorMessage,v).then(y,y)}).catch(y):m.then(v=>this.errorHandler.getErrorMessageForDisplayInCell(g,"execution",this.owningResource).then(S=>this.showErrorForCell(S,v))).catch(y)}).finally(()=>{f==null||f.resolve()}),h});return c[c.length-1]}async createExecutionPromise(e,t){var a,l;if(!this.controller||!this.notebookDocument)return!1;b.ci("InteractiveWindow.ts.createExecutionPromise.start");let n=this.controller.startKernel(),i=await e,o=!0,s=async()=>void 0;try{let c=await n;await this.generateCodeAndAddMetadata(i,t,c),t&&this.useNewDebugMode()?await this.debuggingManager.start(this.notebookDocument,i):t&&tr(c.kernelConnectionMetadata)&&this.interactiveWindowDebugger&&(s=async()=>{var f;return(f=this.interactiveWindowDebugger)==null?void 0:f.detach(c)},await this.interactiveWindowDebugger.attach(c),await this.interactiveWindowDebugger.updateSourceMaps(((a=this.storageFactory.get({notebook:i.notebook}))==null?void 0:a.all)||[]),this.interactiveWindowDebugger.enable(c)),b.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell");let u=Ql(i);o=await this.kernelProvider.getKernelExecution(c).executeCell(i,(l=u==null?void 0:u.generatedCode)==null?void 0:l.code).then(()=>!0,()=>!1),b.ci("InteractiveWindow.ts.createExecutionPromise.kernel.executeCell.finished")}finally{await s(),b.ci("InteractiveWindow.ts.createExecutionPromise.end")}if(!o)throw new Pv(i);return o}async expandAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{await Bt.commands.executeCommand("notebook.cell.expandCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async collapseAllCells(){this.notebookDocument&&await Promise.all(this.notebookDocument.getCells().map(async(e,t)=>{e.kind===Bt.NotebookCellKind.Code&&await Bt.commands.executeCommand("notebook.cell.collapseCellInput",{ranges:[{start:t,end:t+1}],document:this.notebookUri})}))}async scrollToCell(e){let t=await this.showInteractiveEditor(),n=t.notebook.getCells().find(i=>{var o;return((o=Ql(i))==null?void 0:o.id)===e});if(n){let i=new Bt.NotebookRange(n.index,n.index+1);t.revealRange(i,Bt.NotebookEditorRevealType.Default),t.selection=i}}async hasCell(e){let t=this.notebookDocument;return!!t&&t.getCells().some(n=>{var i;return((i=Ql(n))==null?void 0:i.id)===e})}get owningResource(){if(this.owner)return this.owner;let e=cI();if(e)return e}updateOwners(e){var t;this._owner||(this._owner=e,(t=this.controller)==null||t.updateOwners(e)),this._submitters.find(n=>n.toString()==e.toString())||this._submitters.push(e)}async addNotebookCell(e,t,n){var h,g;let i=this.notebookDocument;if(!i)throw new Error("No notebook document");let o=this.configuration.getSettings(this.owningResource),s=this.cellMatcher.getCellType(e)===KE,a=s?q0(at(e)).join(""):Mee(e,o,this.cellMatcher),l=this.cellMatcher.getFirstMarker(e),c=(g=(h=Bt.workspace.textDocuments.find(v=>{var S;return v.uri.toString()===((S=this.owner)==null?void 0:S.toString())}))==null?void 0:h.languageId)!=null?g:qe,u=new Bt.NotebookCellData(s?Bt.NotebookCellKind.Markup:Bt.NotebookCellKind.Code,a,s?KE:c),p={uristring:t.toString(),lineIndex:n,originalSource:e},f={interactiveWindowCellMarker:l,interactive:p,id:(0,Lee.default)()};u.metadata=f,await Cu(i,v=>{let S=Bt.NotebookEdit.insertCells(i.cellCount,[u]);v.set(i.uri,[S])});let m=i.cellCount-1;return i.cellAt(m)}async generateCodeAndAddMetadata(e,t,n){let i=Ql(e);if(!i)return;let o=!tr(n.kernelConnectionMetadata)||this.configuration.getSettings(void 0).forceIPyKernelDebugger,s=await this.codeGeneratorFactory.getOrCreate(this.notebookDocument).generateCode(i,e.index,t,o),a={...i,generatedCode:s},l=new Bt.WorkspaceEdit,c=Bt.NotebookEdit.updateCellMetadata(e.index,a);l.set(e.notebook.uri,[c]),await Bt.workspace.applyEdit(l)}async export(){var n;if(!this.notebookDocument)throw new Error("no notebook to export.");let e=Aee(this.notebookDocument),t=await new ap().showDialog("ipynb",this.owningResource);t&&await((n=this.jupyterExporter)==null?void 0:n.exportToFile(e,lt(t)))}async exportAs(){var n;if(await this.ensureInitialized(),!this.controller)throw new Error("An active kernel is required to export the notebook.");let e=(n=this.controller.kernel)==null?void 0:n.value,t;if(this.submitters&&this.submitters.length){let i=this.submitters[this.submitters.length-1];t=rr(i.path,Cp(i.path))}Pn()?Bt.commands.executeCommand(Q.ExportAsPythonScript,this.notebookDocument,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y):Bt.commands.executeCommand(Q.Export,this.notebookDocument,t,e==null?void 0:e.kernelConnectionMetadata.interpreter).then(y,y)}};E([$O()],Tv.prototype,"showErrorForCell",1),E([$O()],Tv.prototype,"createExecutionPromise",1);d();function Kee(r){return C.interactiveWindowTitleFormat(rr(r.path))}d();var _9=class{constructor(e,t,n,i,o,s,a){this.controllerService=e;this.mode=t;this.notebook=n;this.errorHandler=i;this.kernelProvider=o;this.owner=s;this.disposables=[];this.controller=a==null?void 0:a.controller,this.metadata=a==null?void 0:a.connection}updateMode(e){this.mode=e}updateOwners(e){this.owner=e}async startKernel(){var e;if((e=this.connectingListener)==null||e.dispose(),this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Interactive Window kernel not selected");this.setInfoMessage(this.metadata,0);try{let t=await this.createKernel(),n=async()=>{this.notebook&&this.metadata&&(this.systemInfoCell=void 0,this.setInfoMessage(this.metadata,1))};return this.disposables.push(t.addHook("willRestart",n)),t.onRestarted(async()=>{b.debug("Restart event handled in IW"),this.fileInKernel=void 0;try{await this.setFileInKernel(t)}catch(i){b.error("Failed to run initialization after restarting")}finally{this.finishSysInfoMessage(t,1)}},this,this.disposables),this.fileInKernel=void 0,await this.setFileInKernel(t),this.finishSysInfoMessage(t,0),t}catch(t){throw this.owner?this.deleteSysInfoCell():await this.finishSysInfoWithFailureMessage(t),t}}async createKernel(){if(this.kernel)return this.kernel.promise;if(!this.controller||!this.metadata)throw new Error("Controller not selected");let e=ke();e.promise.catch(y),this.kernel=e;try{let{kernel:t,actualController:n}=await this.controllerService.createKernel(this.metadata,this.controller,this.owner,this.notebook,this.disposables);return this.metadata=t.kernelConnectionMetadata,this.controller=n,this.disposables.push(t),e.resolve(t),t}catch(t){throw e.reject(t),this.disconnect(),t}}async setFileInKernel(e){let t=this.owner;if(!t){b.ci("Unable to run initialization for IW");return}let n=lt(t),i=this.kernelProvider.getKernelExecution(e);this.mode==="perFile"&&!this.fileInKernel?(b.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):(!this.fileInKernel||this.fileInKernel.toString()!==t.toString())&&this.mode!=="perFile"?(b.debug(`Initializing __file__ in setFileInKernel with ${t} for mode ${this.mode}`),this.fileInKernel=t,await i.executeHidden(`__file__ = '${n.replace(/\\/g,"\\\\")}'`)):b.debug(`Not Initializing __file__ in setFileInKernel with ${n} for mode ${this.mode} currently ${this.fileInKernel}`)}setPendingCellAdd(e){if(this.metadata&&this.notebook){let t=this.controllerService.getRegisteredController(this.metadata);t==null||t.setPendingCellAddition(this.notebook,e)}}listenForControllerSelection(){return this.controllerService.onControllerSelected(e=>{var t,n,i,o;if(!(!this.notebook||e.notebook.uri.toString()!==((n=(t=this.notebook)==null?void 0:t.uri)==null?void 0:n.toString()))&&e.controller.id!==((i=this.controller)==null?void 0:i.id)){let s=!!this.kernel;this.disconnect(),this.controller=e.controller.controller,this.metadata=e.controller.connection,s?this.startKernel().catch(y):((o=this.connectingListener)==null||o.dispose(),this.connectingListener=e.controller.onConnecting(()=>{this.startKernel().catch(y)}),this.disposables.push(this.connectingListener))}},this)}setInfoMessageCell(e){this.systemInfoCell?this.systemInfoCell.updateMessage(e).catch(t=>b.warn(`could not update info cell with message: "${e}", error: ${t}`)):this.systemInfoCell=new FM(this.notebook,e)}setInfoMessage(e,t){let n=Pee(e,t);this.setInfoMessageCell(n)}finishSysInfoMessage(e,t){var i;let n=Tee(e.kernelConnectionMetadata,t);(i=this.systemInfoCell)==null||i.updateMessage(n).catch(o=>b.warn(`System info message was not updated: "${n}" because of error: ${o}`)),this.systemInfoCell=void 0}async finishSysInfoWithFailureMessage(e){var n;let t=await this.errorHandler.getErrorMessageForDisplayInCell(e,"start",this.owner);t=t.split(`
`).join(`  
`),(n=this.systemInfoCell)==null||n.updateMessage(t).catch(i=>b.warn(`System info message was not updated: "${t}" because of error: ${i}`)),this.systemInfoCell=void 0}deleteSysInfoCell(){var e;(e=this.systemInfoCell)==null||e.deleteCell().then(y,y),this.systemInfoCell=void 0}disconnect(){this.disposables.forEach(e=>e.dispose()),this.disposables=[],this.kernel=void 0}},VD=class{constructor(e,t,n){this.controllerService=e;this.mode=t;this.initialController=n}create(e,t,n,i){let o=this.initialController,s=this.controllerService.getSelectedController(e);return s&&(o=s),new _9(this.controllerService,this.mode,e,t,n,i,o)}};var Fee="ds_asked_per_file_interactive",Uee="ds_interactive_window_cache",M_=class{constructor(e,t,n,i,o,s,a,l){this.serviceContainer=e;this.disposables=t;this.fs=n;this.configService=i;this.globalMemento=o;this.workspaceMemento=s;this.notebookEditorProvider=a;this.controllerHelper=l;this._onDidChangeActiveInteractiveWindow=new Wr.EventEmitter;this._windows=[];this.notebookEditorProvider.registerEmbedNotebookProvider(this),this.restoreWindows()}get onDidChangeActiveInteractiveWindow(){return this._onDidChangeActiveInteractiveWindow.event}get activeWindow(){var t;let e=(t=Wr.window.activeNotebookEditor)==null?void 0:t.notebook.uri.toString();return e?this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e}):void 0}restoreWindows(){let e=new Map;Wr.window.tabGroups.all.forEach(t=>{t.tabs.forEach(n=>{WD(n)&&n.input.uri&&e.set(n.input.uri.toString(),n)})}),this.workspaceMemento.get(Uee,[]).forEach(t=>{if(!t.uriString||!e.get(t.uriString))return;let n=e.get(t.uriString);if(!n)return;let i=this.configService.getSettings(n.input.uri).interactiveWindowMode,o=new Tv(this.serviceContainer,Wr.Uri.parse(t.owner),new VD(this.controllerHelper,i),n,Wr.Uri.parse(t.inputBoxUriString));this.updateExecuteConfigSetting().catch(a=>b.warn("Failed to update executeWithShiftEnter setting",a)),o.notifyConnectionReset(),this._windows.push(o),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!1,hasOwner:!!t.owner,mode:i,restored:!0});let s=o.closed(this.onInteractiveWindowClosed.bind(this,o));this.disposables.push(o),this.disposables.push(s),this.disposables.push(o.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this)))}),this._updateWindowCache()}async getOrCreate(e,t){if(!Wr.workspace.isTrusted)throw new Error("Workspace not trusted");let n=await this.getInteractiveMode(e);this.pendingCreations&&await this.pendingCreations.catch(y);let i=this.getExisting(e,n,t);return i||(i=await this.create(e,n,t)),await i.ensureInitialized(),this.updateExecuteConfigSetting().catch(o=>b.warn("Failed to update executeWithShiftEnter setting",o)),i}async updateExecuteConfigSetting(){let e="updatedExecuteInteractiveConfig";if(this.globalMemento.get(e))return;let n=Wr.workspace.getConfiguration("interactiveWindow"),i=n.inspect("executeWithShiftEnter");(i==null?void 0:i.workspaceValue)===void 0&&(i==null?void 0:i.workspaceFolderValue)===void 0&&(i==null?void 0:i.globalValue)===void 0&&(await n.update("executeWithShiftEnter",!0,Wr.ConfigurationTarget.Global),await this.globalMemento.update(e,void 0))}get(e){let t=this.configService.getSettings(e).interactiveWindowMode;return this.getExisting(e,t)}async create(e,t,n){let i=ke();this.pendingCreations=i.promise;try{let o=await this.controllerHelper.getInitialController(e,n);b.info(`Starting interactive window for resource '${ye(e)}' with controller '${o==null?void 0:o.id}'`);let[s,a]=await this.createEditor(o,e,t);o&&o.controller.updateNotebookAffinity(a.notebook,Wr.NotebookControllerAffinity.Preferred),b.debug(`Interactive Window Editor Created: ${a.notebook.uri.toString()} with input box: ${s.toString()}`);let l=new Tv(this.serviceContainer,e,new VD(this.controllerHelper,t,o),a,s);this._windows.push(l),J("DS_INTERNAL.CREATED_INTERACTIVE_WINDOW",{windowCount:this._windows.length},{hasKernel:!!o,hasOwner:!!e,mode:t,restored:!1}),this._updateWindowCache(),this.lastActiveInteractiveWindow=l;let c=l.closed(this.onInteractiveWindowClosed.bind(this,l));return this.disposables.push(l),this.disposables.push(c),this.disposables.push(l.onDidChangeViewState(this.raiseOnDidChangeActiveInteractiveWindow.bind(this))),l}finally{i.resolve()}}async createEditor(e,t,n){let i=e?`${Ye}/${e.id}`:void 0,o=t!==void 0,s=this.getInteractiveViewColumn(t),{inputUri:a,notebookEditor:l}=await Wr.commands.executeCommand("interactive.open",{viewColumn:s,preserveFocus:o},void 0,i,t&&n==="perFile"?Kee(t):void 0);if(!l)throw new Error("Failed to request creation of interactive window from VS Code.");return[a,l]}getInteractiveViewColumn(e){if(e)return Wr.ViewColumn.Beside;let t=this.configService.getSettings(e).interactiveWindowViewColumn;return t==="secondGroup"?Wr.ViewColumn.One:t==="active"?Wr.ViewColumn.Active:Wr.ViewColumn.Beside}async getInteractiveMode(e){let t=this.configService.getSettings(e).interactiveWindowMode;if(t==="multiple"&&e&&!this.globalMemento.get(Fee)&&this._windows.length===1&&(!this._windows[0].owner||!this.fs.arePathsSame(this._windows[0].owner,e))){this.globalMemento.update(Fee,!0).then(y,y);let n=[C.interactiveWindowModeBannerSwitchYes,C.interactiveWindowModeBannerSwitchNo];await Wr.window.showInformationMessage(C.interactiveWindowModeBannerTitle,...n)===n[0]&&(t="perFile",this._windows[0].changeMode(t),await this.configService.updateSetting("interactiveWindow.creationMode",t,e,Wr.ConfigurationTarget.Global))}return t}_updateWindowCache(){let e=this._windows.map(t=>{var n;return{owner:(n=t.owner)==null?void 0:n.toString(),uriString:t.notebookUri.toString(),inputBoxUriString:t.inputUri.toString()}});this.workspaceMemento.update(Uee,e).then(y,y)}getExisting(e,t,n){return t==="single"?this._windows.length>0?this._windows[0]:void 0:t==="multiple"?e?this.activeWindow||this.lastActiveInteractiveWindow||this._windows[0]:void 0:this._windows.find(i=>{var o;return!e&&!i.owner&&!n?!0:e&&i.owner&&this.fs.arePathsSame(e,i.owner)?!n||((o=i.kernelConnectionMetadata)==null?void 0:o.id)===n.id:!1})}raiseOnDidChangeActiveInteractiveWindow(){this.lastActiveInteractiveWindow=this.activeWindow?this.activeWindow:this.lastActiveInteractiveWindow,this._onDidChangeActiveInteractiveWindow.fire(this.activeWindow)}onInteractiveWindowClosed(e){var t;b.debug(`Closing interactive window: ${(t=e.notebookUri)==null?void 0:t.toString()}`),e.dispose(),this._windows=this._windows.filter(n=>n!==e),this._updateWindowCache(),this.lastActiveInteractiveWindow===e&&(this.lastActiveInteractiveWindow=this._windows[0]),this.raiseOnDidChangeActiveInteractiveWindow()}getActiveOrAssociatedInteractiveWindow(){if(this.activeWindow)return this.activeWindow;if(Wr.window.activeTextEditor===void 0)return;let e=Wr.window.activeTextEditor.document.uri;if(e.scheme!==vp)return this.get(e)}findNotebookEditor(e){var n,i;let t;if(e&&e.path.endsWith(".interactive"))t=(n=this.get(e))==null?void 0:n.notebookDocument;else{let o=this.configService.getSettings(e).interactiveWindowMode;t=(i=this.getExisting(e,o))==null?void 0:i.notebookDocument}return t?Wr.window.visibleNotebookEditors.find(o=>o.notebook===t):void 0}findAssociatedNotebookDocument(e){let t=this._windows.find(i=>{var o;return((o=i.inputUri)==null?void 0:o.toString())===e.toString()});return t==null?void 0:t.notebookDocument}getInteractiveWindowWithNotebook(e){let t;return e!==void 0?t=this._windows.find(n=>{var i;return((i=n.notebookUri)==null?void 0:i.toString())===e.toString()}):t=this.getActiveOrAssociatedInteractiveWindow(),t}getInteractiveWindowsWithSubmitter(e){return this._windows.filter(t=>t.submitters.find(n=>this.fs.arePathsSame(e,n)))}};M_=E([(0,Is.injectable)(),I(0,(0,Is.inject)(Ur)),I(1,(0,Is.inject)(ie)),I(2,(0,Is.inject)(xt)),I(3,(0,Is.inject)(Me)),I(4,(0,Is.inject)(_t)),I(4,(0,Is.named)(sr)),I(5,(0,Is.inject)(_t)),I(5,(0,Is.named)(Cs)),I(6,(0,Is.inject)(Wo)),I(7,(0,Is.inject)(MM))],M_);d();var L_=$(te());d();var xu=require("vscode");var jM=class{constructor(e,t,n,i){this.configService=e;this.storage=t;this.notebook=n;this.executionCount=0;this.cellIndexesCounted={};this.disposables=[];i.push(this),xu.workspace.onDidChangeTextDocument(this.onChangedDocument,this,this.disposables),Lr.onDidChangeNotebookCellExecutionState(this.onDidCellStateChange,this,this.disposables)}dispose(){this.disposed||(this.disposed=!0,this.storage.clear(),this.disposables.forEach(e=>e.dispose()))}reset(){this.storage.clear(),this.executionCount=0}async generateCode(e,t,n,i){let{executableLines:o}=this.extractExecutableLines(e);if(this.executionCount+=1,this.cellIndexesCounted[t]=!0,o.length>0&&o.find(s=>s.trim().length>0))return this.generateCodeImpl(e,this.executionCount,n,i)}extractExecutableLines(e){let t=e.interactive.originalSource,n=this.configService.getSettings(this.notebook.uri),i=new Vo(n),o=dI(t);if(n.magicCommandsAsComments&&o.forEach((s,a)=>o[a]=UM(s)),e.interactiveWindowCellMarker&&o.length&&o[0].trim()===e.interactiveWindowCellMarker.trim()){let s=o.slice(1).filter(a=>a.trim().length>0);if(s.length>0&&s[0].trim().startsWith("%%")){let a=o.slice(o.indexOf(s[0]));return{lines:a,executableLines:a}}}return o.length>0&&(i.isCode(o[0])||i.isMarkdown(o[0]))?{lines:o,executableLines:o.slice(1)}:{lines:o,executableLines:o}}onDidCellStateChange(e){var t;e.state===1&&(e.state!==1||e.cell.notebook!==this.notebook||!((t=e.cell.executionSummary)!=null&&t.executionOrder)||this.cellIndexesCounted[e.cell.index]||(this.executionCount+=1,this.cellIndexesCounted[e.cell.index]=!0))}async generateCodeImpl(e,t,n,i){let{lineIndex:o,uristring:s}=e.interactive,a=xu.workspace.textDocuments.find(re=>re.uri.toString()===s);if(!a)return;let{stripped:l,trueStartLine:c}=this.extractStrippedLines(e),u=a.lineAt(c),p=a.lineAt(Math.min(c+l.length-1,a.lineCount-1)),f=0;for(;f<l.length&&l[f].trim().length===0;)f+=1;let m=f+c,h=a.offsetAt(new xu.Position(o,0)),g=a.offsetAt(p.rangeIncludingLineBreak.end),v=(e.interactiveWindowCellMarker||"").length>0,{runtimeLine:S,debuggerStartLine:_}=this.addHiddenLines(n,l,c,m,v,i),D=l.join(""),P=a.getText(new xu.Range(new xu.Position(o,0),p.rangeIncludingLineBreak.end)),M=(await qa(D,"SHA-1")).substring(0,12),x=this.getRuntimeFile(M,t),A=n?-1:0,j={line:u?u.lineNumber+1:1,endLine:p?p.lineNumber+1:1,firstNonBlankLineIndex:m,debuggerStartLine:_,executionCount:t,startOffset:h,endOffset:g,deleted:!1,code:D,trimmedRightCode:l.map(re=>re.replace(/[ \t\r]+\n$/g,`
`)).join(""),realCode:P,runtimeLine:S,runtimeFile:x,id:e.id,timestamp:Date.now(),lineOffsetRelativeToIndexOfFirstLineInCell:A,hasCellMarker:v};return b.info(`Generated code for ${t} = ${x} with ${l.length} lines`),this.storage.store(xu.Uri.parse(e.interactive.uristring),j),j}getRuntimeFile(e,t){return`<ipython-input-${t}-${e}>`}onChangedDocument(e){let t=this.storage.getFileGeneratedCode(e.document.uri);if(t){let n=e.document.getText();e.contentChanges.forEach(i=>{this.handleContentChange(n,i,t)})}}extractStrippedLines(e){let t=dI(e.interactive.originalSource),{lines:n}=this.extractExecutableLines(e),i=e.interactive.lineIndex+1;if(!e.interactiveWindowCellMarker){i=e.interactive.lineIndex;for(let l=0;l<n.length;l+=1)if(n[l]!==t[l]){i+=l+1;break}}let o=0;for(;o<n.length&&n[o].trim().length===0;)o+=1;let s=n.length-1,a=n.length-2;for(;a>0;){let l=n[s],c=n[a];if((l.length===0||l===`
`)&&(c.length===0||c===`
`))n.splice(s,1),s-=1,a-=1;else break}!n[s].endsWith(`
`)&&n[s].length>0&&(n[s]=`${n[s]}
`);for(let l=0;l<n.length;l++)n[l]=n[l].replace(/\r\n/g,`
`);return{stripped:n,trueStartLine:i}}handleContentChange(e,t,n){let i=t.range.start.line-t.range.end.line+t.text.split(`
`).length-1,o=t.text.length-t.rangeLength,s=t.rangeLength<=0?t.rangeOffset:t.rangeOffset+t.rangeLength-1;n.forEach(a=>{a.endOffset<t.rangeOffset||(a.startOffset>s?(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.startOffset===s?a.deleted||t.rangeLength>0||i===0?a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode:(a.line+=i,a.endLine+=i,a.startOffset+=o,a.endOffset+=o):a.deleted=e.substr(a.startOffset,a.endOffset-a.startOffset)!==a.realCode)})}addHiddenLines(e,t,n,i,o,s){let a=s||this.configService.getSettings(void 0).forceIPyKernelDebugger===!0;return e&&this.configService.getSettings(this.notebook.uri).stopOnFirstLineWhileDebugging?a?(t.splice(0,0,`breakpoint()
`),{runtimeLine:1,debuggerStartLine:n+1}):(t.splice(0,0,`breakpoint()
`),{runtimeLine:2,debuggerStartLine:n}):{runtimeLine:1,debuggerStartLine:o?i:i+1}}};var Wee=require("vscode");var O_=class{constructor(e,t,n){this.configService=e;this.storageFactory=t;this.disposables=n;this.codeGenerators=new WeakMap}activate(){Wee.workspace.onDidCloseNotebookDocument(this.onDidCloseNotebook,this,this.disposables)}getOrCreate(e){let t=this.get(e);if(t)return t;let n=new jM(this.configService,this.storageFactory.getOrCreate(e),e,this.disposables);return this.codeGenerators.set(e,n),n}get(e){return this.codeGenerators.get(e)}onDidCloseNotebook(e){var t;(t=this.codeGenerators.get(e))==null||t.dispose(),this.codeGenerators.delete(e)}};O_=E([(0,L_.injectable)(),I(0,(0,L_.inject)(Me)),I(1,(0,L_.inject)(Oa)),I(2,(0,L_.inject)(ie))],O_);d();var Vee=$(te()),jee=require("vscode");d();var BM=class{constructor(){this.codeGeneratorsByFile=new Iu}clear(){this.codeGeneratorsByFile.clear()}get all(){return[...this.codeGeneratorsByFile.entries()].map(e=>({uri:e[0],generatedCodes:e[1].filter(t=>!t.deleted)})).filter(e=>e.generatedCodes.length>0)}getFileGeneratedCode(e){return this.codeGeneratorsByFile.get(e)||[]}store(e,t){let n=this.codeGeneratorsByFile.get(e)||[],i=!1;for(let o=0;o<n.length&&!i;o+=1){let s=n[o];t.line>=s.line&&t.line<=s.endLine?(n.splice(o,1,t),i=!0):s.line>t.line&&(n.splice(o,0,t),i=!0)}i||n.push(t),this.codeGeneratorsByFile.set(e,n)}};var K_=class{constructor(){this.storages=new WeakMap}getOrCreate(e){return this.storages.has(e)||this.storages.set(e,new BM),this.storages.get(e)}get(e){if("notebook"in e)return this.storages.get(e.notebook);{let t=jee.workspace.notebookDocuments.find(n=>{let i=this.storages.get(n);return i==null?void 0:i.all.find(o=>o.uri.toString()===e.fileUri.toString())});return t?this.storages.get(t):void 0}}};K_=E([(0,Vee.injectable)()],K_);d();var Rm=$(te());var F_=class{constructor(e,t,n,i,o){this.kernelProvider=e;this.codeGeneratorFactory=n;this.storageFactory=i;this.controllers=o;this.disposables=[];t.push(this)}dispose(){me(this.disposables)}activate(){this.kernelProvider.onDidCreateKernel(this.onDidCreateKernel,this,this.disposables),this.controllers.onControllerSelected(this.onNotebookControllerSelected,this,this.disposables)}onNotebookControllerSelected({notebook:e}){var t,n;(t=this.storageFactory.get({notebook:e}))==null||t.clear(),(n=this.codeGeneratorFactory.get(e))==null||n.reset()}onDidCreateKernel(e){var n;let t=e.notebook;e.creator!=="jupyterExtension"||t.notebookType!==vt||((n=this.storageFactory.get({notebook:t}))==null||n.clear(),e.onRestarted(()=>{var i;(i=this.storageFactory.get({notebook:t}))==null||i.clear(),this.codeGeneratorFactory.getOrCreate(t).reset()},this,this.disposables))}};F_=E([(0,Rm.injectable)(),I(0,(0,Rm.inject)(He)),I(1,(0,Rm.inject)(ie)),I(2,(0,Rm.inject)(T_)),I(3,(0,Rm.inject)(Oa)),I(4,(0,Rm.inject)(kt))],F_);d();var W_=$(te()),Cte=require("vscode");var Ete=_te(),JM=/(;32m[ ->]*?)(\d+)(.*)/g,U_=class{constructor(e,t,n){this.storageFactory=e;this.platformService=t;this.configurationService=n}format(e,t){var a;if(e.notebook.notebookType!==vt)return t;let n=this.storageFactory.get({notebook:e.notebook}),i=t.some(l=>/^[Input|Cell|File].*?\n.*/.test(l));if(!i&&!n)return t;let o=this.configurationService.getSettings(e.document.uri),s=(a=o==null?void 0:o.formatStackTraces)!=null?a:!1;return t.map(l=>i?this.modifyTracebackFrameIPython8(l,n==null?void 0:n.all,s):s?this.modifyTracebackFrameIPython7(l,n.all):l)}modifyTracebackFrameIPython8(e,t,n){var u,p,f,m,h;e=e.replace(/\u001b\[4\dm/g,""),e=e.replace(/\u001b\[38;.*?\d+m/g,"\x1B[39m"),e=e.replace(/(;32m[ ->]*?)(\d+)(.*)\n/g,(g,v,S,_)=>(_=_.replace(/\u001b\[3\d+m/g,"\x1B[39m"),`${v}${S}${_}
`)),b.ci(`Trace frame to match: ${e}`);let i,o,s=/Cell\s+(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\],\s*line (?<lineNumber>\d+).*/,l=/Input\s+?(?:\u001b\[.+?m)?In\s*\[(?<executionCount>\d+)\].*line: (?<lineNumber>\d).*/.exec(e),c=s.exec(e);if(l&&((u=l.groups)!=null&&u.executionCount)&&((p=l.groups)!=null&&p.lineNumber)?(i=parseInt(l.groups.executionCount),o=(f=l.groups)==null?void 0:f.lineNumber):c&&((m=c.groups)!=null&&m.executionCount)&&((h=c.groups)!=null&&h.lineNumber)&&(i=parseInt(c.groups.executionCount),o=c.groups.lineNumber),t&&i){let g,v;for(let S of t)if(v=S.generatedCodes.find(_=>_.executionCount===i),v){g=S.uri;break}if(v&&g){let S=e;return n&&(S=S.replace(JM,(_,D,P,M)=>{let x=parseInt(P,10),re=(v.hasCellMarker?v.line-1:v.line)-1+v.lineOffsetRelativeToIndexOfFirstLineInCell+x;return`${D}<a href='${g==null?void 0:g.toString()}?line=${re-1}'>${re}</a>${M}`})),S.replace(/.*?\n/,`File \x1B[1;32m${lt(g)}:${o}\x1B[0m
`)}}if(n){let g=/^File.*?\[\d;32m(.*):\d+.*\u001b.*\n/.exec(e);if(g&&g.length>1){let v=xP(g[1],lt(this.platformService.homeDir)),S=Cte.Uri.file(v);return e.replace(JM,(_,D,P,M)=>{let x=parseInt(P,10);return`${D}<a href='${S==null?void 0:S.toString()}?line=${x-1}'>${x}</a>${M}`})}}return e}modifyTracebackFrameIPython7(e,t){return t.map(i=>i.uri).forEach(i=>{let o=lt(i),s=ye(i),a=this.storageFactory.get({fileUri:i});if(a){if(e.includes(o)&&new RegExp(`\\[.*?;32m${Ete(o)}`).test(e)||e.includes(s)&&new RegExp(`\\[.*?;32m${Ete(s)}`).test(e)){let l="",c=/(;32m[ ->]*?)(\d+)(.*)/g;for(let p=c.exec(e);p&&p.length>3;p=c.exec(e)){let f=bu(p[3]).substr(1);l=`${l}${f}
`}let u=this.findCellOffset(a.getFileGeneratedCode(i),l);u!==void 0&&(e=e.replace(JM,(p,f,m,h)=>{let g=parseInt(m,10),v=u+g-1;return`${f}<a href='${i.toString()}?line=${v}'>${v+1}</a>${h}`}))}if(e.includes(o)){let l=this.findCellOffset(a.getFileGeneratedCode(i),e);if(l)return e.replace(JM,(c,u,p,f)=>{let m=parseInt(p,10),h=l+m-1;return`${u}<a href='${i.toString()}?line=${h}'>${h+1}</a>${f}`})}}}),e}findCellOffset(e,t){if(e){for(let n of e)if(n.trimmedRightCode.indexOf(t)>=0)return n.firstNonBlankLineIndex}}};U_=E([(0,W_.injectable)(),I(0,(0,W_.inject)(Oa)),I(1,(0,W_.inject)(hs)),I(2,(0,W_.inject)(Me))],U_);d();var Du=$(te()),Am=require("vscode");d();function wte(r){let e={source:{path:lt(r.uri)},pydevdSourceMaps:[]};return e.pydevdSourceMaps=r.generatedCodes.map(t=>({line:t.debuggerStartLine,endLine:t.endLine,runtimeSource:{path:t.runtimeFile},runtimeLine:t.runtimeLine})),e}d();var qM=class{constructor(e,t,n){this.debugAdapter=e;this.debugCell=t;this.execution=n;this._ready=ke();this.ready=this._ready.promise;J("DATASCIENCE.DEBUGGING.SUCCESSFULLY_STARTED_RUN_AND_DEBUG_CELL")}trace(e,t){b.debug(`[Debug-IW] ${e}: ${t}`)}async willSendEvent(e){return g9(e)?(this.trace("intercept","debugpyAttach request for subprocess, not supported"),!0):e.event==="output"&&kD(e.body.output)?(this.trace("intercept","justMyCode notification"),!0):!1}async willSendRequest(e){let t=Ql(this.debugCell);e.command==="setBreakpoints"&&t&&t.generatedCode&&!this.cellDumpInvoked&&(this.debugCellDumped||(this.debugCellDumped=_v(this.execution,this.debugAdapter)),await this.debugCellDumped),e.command==="configurationDone"&&t&&t.generatedCode&&(this.debugCellDumped||(this.debugCellDumped=_v(this.execution,this.debugAdapter)),await this.debugCellDumped,this._ready.resolve())}};d();var GM=class extends d_{constructor(){super(...arguments);this._ready=ke();this.ready=this._ready.promise}resolve(){this._ready.resolve()}};d();var E9=require("vscode");var YM=class extends f_{constructor(t,n,i,o,s,a,l){super(t,n,i,o,s,a);this.cellToDebugFileSortedInReverseOrderByLineNumber=[];l&&(this.debugLocationTracker=l.createDebugAdapterTracker(t),this.debugLocationTracker.onWillStartSession&&this.debugLocationTracker.onWillStartSession(),this.onDidSendMessage(c=>{var u;(u=this.debugLocationTracker)!=null&&u.onDidSendMessage&&this.debugLocationTracker.onDidSendMessage(c)},this,this.disposables),this.onDidEndSession(()=>{var c;(c=this.debugLocationTracker)!=null&&c.onWillStopSession&&this.debugLocationTracker.onWillStopSession()},this,this.disposables))}handleClientMessageAsync(t){var n,i;return b.ci(`KernelDebugAdapter::handleMessage ${JSON.stringify(t,void 0," ")}`),t.type==="request"&&((n=this.debugLocationTracker)!=null&&n.onWillReceiveMessage)&&this.debugLocationTracker.onWillReceiveMessage(t),t.type==="response"&&((i=this.debugLocationTracker)!=null&&i.onDidSendMessage)&&this.debugLocationTracker.onDidSendMessage(t),super.handleClientMessageAsync(t)}async dumpCell(t){var o,s;let n=this.notebookDocument.cellAt(t),i=Ql(n);if(!i)throw new Error("Not an interactive window cell");try{let a=(((o=i.generatedCode)==null?void 0:o.code)||n.document.getText()).replace(/\r\n/g,`
`),l=await this.session.customRequest("dumpCell",{code:a}),c=_s(l.sourcePath);this.fileToCell.set(c,E9.Uri.parse(i.interactive.uristring));let u=0;i.generatedCode&&!i.generatedCode.hasCellMarker&&(u=i.generatedCode.firstNonBlankLineIndex),this.cellToDebugFileSortedInReverseOrderByLineNumber.push({debugFilePath:c,interactiveWindow:E9.Uri.parse(i.interactive.uristring),metadata:i,lineOffset:u+i.interactive.lineIndex+(((s=i.generatedCode)==null?void 0:s.lineOffsetRelativeToIndexOfFirstLineInCell)||0)}),this.cellToDebugFileSortedInReverseOrderByLineNumber.sort((p,f)=>f.metadata.interactive.lineIndex-p.metadata.interactive.lineIndex)}catch(a){b.error(`Failed to dump cell for ${n.index} with code ${i.interactive.originalSource}`,a)}}translateDebuggerLocationToRealLocation(t,n){var o;if(n=(o=t==null?void 0:t.source)!=null?o:n,!n||!n.path)return;let i=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(s=>s.debugFilePath===n.path);i&&(n.name=rr(i.interactiveWindow.path),n.path=i.interactiveWindow.toString(),typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine+(i.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line+(i.lineOffset||0)))}translateRealLocationToDebuggerLocation(t,n){var s;let i=t.line;if(n=(s=t==null?void 0:t.source)!=null?s:n,!n||!n.path||typeof i!="number")return;let o=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(a=>i>=a.metadata.interactive.lineIndex+1);!o||o.interactiveWindow.path!==n.path||(n.path=o.debugFilePath,typeof(t==null?void 0:t.endLine)=="number"&&(t.endLine=t.endLine-(o.lineOffset||0)),typeof(t==null?void 0:t.line)=="number"&&(t.line=t.line-(o.lineOffset||0)))}async sendRequestToJupyterSession(t){var n,i;if(t.command==="setBreakpoints"){let o=t.arguments;if(delete o.lines,o.source.path!==((n=this.cellToDebugFileSortedInReverseOrderByLineNumber[0])==null?void 0:n.interactiveWindow.path))return super.sendRequestToJupyterSession(t);let s,a=[],l=[],c=()=>{if(a.length){let f=JSON.parse(JSON.stringify(t));f.arguments.breakpoints=a,l.push(super.sendRequestToJupyterSession(f))}};for(let f of(i=t.arguments.breakpoints)!=null?i:[]){let m=this.cellToDebugFileSortedInReverseOrderByLineNumber.find(h=>f.line>=h.metadata.generatedCode.line&&f.line<=h.metadata.generatedCode.endLine);if(m&&m.metadata.interactive.lineIndex!==s)c(),s=m.metadata.interactive.lineIndex,a=[f];else if(m)a.push(f);else{let h={...f,verified:!0};l.push(Promise.resolve({body:{breakpoints:[h]}}))}}c();let u=await Promise.all(l),p=JSON.parse(JSON.stringify(u[0]));return u.slice(1).forEach(f=>{var m;p.body.breakpoints=p.body.breakpoints.concat((m=f.body.breakpoints)!=null?m:[])}),p.command="setBreakpoints",p.type="response",p.success=!0,p.request_seq=t.seq,p}return super.sendRequestToJupyterSession(t)}getDumpFilesForDeletion(){return this.cellToDebugFileSortedInReverseOrderByLineNumber.map(t=>t.debugFilePath)}};d();var xte=require("vscode");var $M=class{constructor(e){this.debugCell=e}trace(e,t){b.debug(`[Debug-IWRestart] ${e}: ${t}`)}async willSendResponse(e){e.command==="initialize"&&e.body&&(e.body.supportsRestartRequest=!0)}async willSendRequest(e){if(e.command==="restart")return this.trace("restart","Showing warning for unsupported restart request"),xte.window.showWarningMessage(C.restartNotSupported,{modal:!0}).then(y,y),{command:e.command,request_seq:e.seq,seq:e.seq,success:!0,type:"response"}}};var V_=class extends p_{constructor(t,n,i,o,s,a,l){super(t,n,l);this.platform=i;this.debugLocationTrackerFactory=o;this.configService=s;this.debugService=a}activate(){super.activate(),this.disposables.push(Am.debug.registerDebugAdapterDescriptorFactory(zL,{createDebugAdapterDescriptor:async t=>this.createDebugAdapterDescriptor(t)}))}getDebugMode(t){return 2}async start(t,n){b.ci("Starting debugging IW"),await this.checkIpykernelAndPrompt(n)===1&&await this.startDebuggingCell(t,n)}async startDebuggingCell(t,n){let i=this.configService.getSettings(t.uri),o={type:zL,name:rr(t.uri.toString()),request:"attach",justMyCode:i.debugJustMyCode,__notebookUri:t.uri.toString(),__mode:2,__cellIndex:n.index},s={suppressSaveBeforeStart:!0};await this.startDebuggingConfig(o,s);let a=this.notebookToDebugger.get(t);if(!a){b.error("Debugger not found, could not start debugging.");return}await a.ready}async createDebugAdapterDescriptor(t){let n=t.configuration;yee(n);let i=Am.workspace.notebookDocuments.find(s=>s.uri.toString()===n.__notebookUri);if(!i||typeof n.__cellIndex!="number"){b.error("Invalid debug session for debugging of IW using Jupyter Protocol");return}if(this.notebookInProgress.has(i)){b.info("Cannot start debugging. Already debugging this notebook");return}if(this.isDebugging(i)){b.info("Cannot start debugging. Already debugging this notebook document. Toolbar should update");return}let o=new GM(i,n,t);this.notebookToDebugger.set(i,o);try{return this.notebookInProgress.add(i),await this.doCreateDebugAdapterDescriptor(n,t,i,o)}finally{this.notebookInProgress.delete(i)}}async doCreateDebugAdapterDescriptor(t,n,i,o){let s=await this.ensureKernelIsRunning(i);if(!(s!=null&&s.session)){Am.window.showInformationMessage(C.kernelWasNotStarted).then(y,y);return}let a=new YM(n,i,s.session,s,this.platform,this.debugService,this.debugLocationTrackerFactory);this.disposables.push(a.onDidEndSession(this.endSession.bind(this)));let l=i.cellAt(t.__cellIndex),c=new qM(a,l,this.kernelProvider.getKernelExecution(s));return a.addDebuggingDelegates([c,new $M(l)]),c.ready.then(()=>o.resolve()).catch(u=>console.error("Failed waiting for controller to be ready",u)),this.trackDebugAdapter(i,a),new Am.DebugAdapterInlineImplementation(a)}async updateSourceMaps(t,n){let i=this.getDebugSession(t.notebook);i&&(b.ci("Sending debug request for source map"),await Promise.all(n.map(async o=>{if(i)return i.customRequest("setPydevdSourceMap",wte(o))})))}};V_=E([(0,Du.injectable)(),I(0,(0,Du.inject)(He)),I(1,(0,Du.inject)(kt)),I(2,(0,Du.inject)(hs)),I(3,(0,Du.inject)(dM)),I(4,(0,Du.inject)(Me)),I(5,(0,Du.inject)(mo)),I(6,(0,Du.inject)(Ur))],V_);d();var kv=$(te()),Dte=require("vscode");var j_=class{constructor(e,t,n,i){this.configService=e;this.fs=t;this.context=n;this.registry=i;this.priority=5}activate(){this.registry.register(this,vt)}async getCode(e){var t;if(!Gt(e.kernelConnectionMetadata))return[];if(!Pn()){if(this.configService.getSettings(void 0).forceIPyKernelDebugger===!0)return[];if(!tr(e.kernelConnectionMetadata))return[]}if(((t=e.notebook)==null?void 0:t.notebookType)===vt){if(!tr(e.kernelConnectionMetadata))return[];this.addRunCellHookContents||(this.addRunCellHookContents=this.fs.readFile(Dte.Uri.joinPath(this.context.extensionUri,"pythonFiles","vscode_datascience_helpers","kernel","addRunCellHook.py")));let n=await this.addRunCellHookContents;return at(n,{trim:!1})}return[]}};j_=E([(0,kv.injectable)(),I(0,(0,kv.inject)(Me)),I(1,(0,kv.inject)(xt)),I(2,(0,kv.inject)(st)),I(3,(0,kv.inject)(Ud))],j_);d();var H_=$(te()),J_=require("vscode");var B_=class{constructor(e,t,n){this.dataScienceCodeLensProvider=e;this.extensionContext=t;this.configurationService=n}activate(){this.configurationService.getSettings().pythonCellFolding&&this.extensionContext.subscriptions.push(J_.languages.registerFoldingRangeProvider([cP],this))}provideFoldingRanges(e,t,n){if([vp,uP].includes(e.uri.scheme))return;let i=this.dataScienceCodeLensProvider.getCodeWatcher(e);if(i){let o=i.getCodeLenses();return n.isCancellationRequested||o.length==0?void 0:o.map(s=>new J_.FoldingRange(s.range.start.line,s.range.end.line,J_.FoldingRangeKind.Region))}}};B_=E([(0,H_.injectable)(),I(0,(0,H_.inject)(Pm)),I(1,(0,H_.inject)(st)),I(2,(0,H_.inject)(Me))],B_);d();var HD=$(te());var Pte=require("vscode");var q_=class{constructor(e,t){this.dataScienceCodeLensProvider=e;this.extensionContext=t}activate(){this.extensionContext.subscriptions.push(Pte.languages.registerCodeLensProvider([cP],this.dataScienceCodeLensProvider))}};q_=E([(0,HD.injectable)(),I(0,(0,HD.inject)(Pm)),I(1,(0,HD.inject)(st))],q_);d();var Ka=$(te());var C9="LastInteractiveKernelSelected",G_=class{constructor(e,t,n,i,o){this.controllerRegistration=e;this.interpreterService=t;this.disposables=n;this.workspaceMemento=i;this.serviceContainer=o;this.onControllerSelected=this.controllerRegistration.onControllerSelected}async getInitialController(e,t){if(t){let n=this.controllerRegistration.get(t,vt);if(n)return n}if(this.workspaceMemento.get(C9)){let n=this.workspaceMemento.get(C9),i=n?this.controllerRegistration.get(n,vt):void 0;if(i)return i}if(this.interpreterService)return await hCe(vt,e,this.interpreterService,this.controllerRegistration)}getSelectedController(e){return this.controllerRegistration.getSelected(e)}getRegisteredController(e){return this.controllerRegistration.get(e,"interactive")}async createKernel(e,t,n,i,o){await Ra(n,e);let s=(u,p)=>{u!=="start"&&u!=="restart"||b.ci(`(onStart) Looking for controller ${p.controller.id} in ${this.controllerRegistration.all.map(f=>`${f.kind}:${f.id}`).join(", ")}`)},a=await Aa.connectToNotebookKernel(e,this.serviceContainer,{resource:n||i.uri,notebook:i,controller:t},new Ir(!1),o,"jupyterExtension",s),l=this.controllerRegistration.registered.find(u=>u.id===a.controller.id);if(!l)throw Error(`Controller ${a.controller.id} not found or not yet created`);let c=l.controller;return this.interpreterService&&gCe(a.kernelConnectionMetadata,n,this.interpreterService).then(async u=>{await this.workspaceMemento.update(C9,u?void 0:a.kernelConnectionMetadata)}).catch(u=>{b.warn("Failed to store kernel connection metadata",u)}),{kernel:a,actualController:c}}};G_=E([(0,Ka.injectable)(),I(0,(0,Ka.inject)(kt)),I(1,(0,Ka.inject)(pm)),I(1,(0,Ka.optional)()),I(2,(0,Ka.inject)(ie)),I(3,(0,Ka.inject)(_t)),I(3,(0,Ka.named)(Cs)),I(4,(0,Ka.inject)(Ur))],G_);async function hCe(r,e,t,n){let i=await t.getActiveInterpreter(e);if(i){let o=await Hx(i),s=Wx.create({kernelSpec:o,interpreter:i,id:QR(o,i)}),a=n.addOrUpdate(s,[r]),l=a[0];return n.trackActiveInterpreterControllers(a),b.ci(`Active Interpreter Controller ${l.connection.kind}:${l.id} created for View ${r} with resource ${ye(e)}`),l}}async function gCe(r,e,t){var i;let n=await t.getActiveInterpreter(e);return(n==null?void 0:n.id)===((i=r.interpreter)==null?void 0:i.id)}function Tte(r){r.addSingleton(ys,M_),r.addSingleton(MM,G_),r.addSingleton(We,bs),r.add(RM,or),r.addSingleton(AM,k_),r.addSingleton(Pm,N_),r.addSingleton(We,q_),r.addSingleton(We,B_),r.addSingleton(We,R_),r.addSingleton(We,F_),r.addSingleton(T_,O_,void 0,[We]),r.addSingleton(Oa,K_),r.addSingleton(wI,U_),r.addSingleton(OM,V_,void 0,[We]),r.addSingleton(We,j_)}d();d();var kte=$(te());d();var go=require("vscode");var zM=class{async normalizeLines(e,t){return e}async getFileToExecute(){let e=go.window.activeTextEditor;if(!e){go.window.showErrorMessage("No open file to run in terminal").then(y,y);return}if(e.document.isUntitled){go.window.showErrorMessage("The active file needs to be saved before it can be run").then(y,y);return}if(e.document.languageId!==qe){go.window.showErrorMessage("The active file is not a Python source file").then(y,y);return}return e.document.isDirty&&await e.document.save(),e.document.uri}getSelectedTextToExecute(e){if(!e)return;let t=e.selection,n;return t.isEmpty?n=e.document.lineAt(t.start.line).text:t.isSingleLine?n=this.getSingleLineSelectionText(e):n=this.getMultiLineSelectionText(e),Qv(n.trimEnd())}async saveFileIfDirty(e){let t=go.workspace.textDocuments.filter(n=>n.uri.path===e.path);t.length===1&&t[0].isDirty&&await t[0].save()}getSingleLineSelectionText(e){let t=e.selection,n=new go.Range(t.start,t.end),i=e.document.getText(n),o=e.document.lineAt(t.start.line).text;return i.trim()===o.trim()?o:i}getMultiLineSelectionText(e){let t=e.selection,n=new go.Range(t.start,t.end),i=e.document.getText(n),o=new go.Range(new go.Position(t.start.line,0),new go.Position(t.end.line,e.document.lineAt(t.end.line).text.length)),s=e.document.getText(o);if(i.trim()===s.trim())return s;let a=e.document.lineAt(t.start.line).text,l=new go.Range(t.start,new go.Position(t.start.line,a.length)),c=e.document.getText(l);return c.trimStart()===a.trimStart()?a+i.substring(c.length):i}};var Y_=class extends zM{};Y_=E([(0,kte.injectable)()],Y_);function Nte(r){r.addSingleton(VM,Y_)}d();d();var Fa=$(te());d();var $s=require("vscode");var QM=class{constructor(e,t,n,i,o,s){this.fileConverter=e;this.fs=t;this.interactiveProvider=n;this.controllerRegistration=i;this.preferredKernel=o;this.kernelFinder=s;this.disposables=[]}register(){this.registerCommand(Q.ExportAsPythonScript,(e,t)=>this.export(e,"python",void 0,t)),this.registerCommand(Q.ExportToHTML,(e,t,n)=>this.export(e,"html",t,n)),this.registerCommand(Q.ExportToPDF,(e,t,n)=>this.export(e,"pdf",t,n)),this.registerCommand(Q.Export,(e,t,n)=>this.export(e,void 0,t,n)),this.registerCommand(Q.NativeNotebookExport,e=>this.nativeNotebookExport(e))}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommand(e,t){let n=$s.commands.registerCommand(e,t,this);this.disposables.push(n)}async nativeNotebookExport(e){var i,o,s;let t=Tn(e)?e:(i=e==null?void 0:e.notebookEditor)==null?void 0:i.notebookUri,n=t?$s.workspace.notebookDocuments.find(a=>this.fs.arePathsSame(a.uri,t)):(o=$s.window.activeNotebookEditor)==null?void 0:o.notebook;if(n){let a,l=this.kernelFinder.registered.find(p=>p.kind==="localPythonEnvironment"),c=new $s.CancellationTokenSource;try{a=l?await this.preferredKernel.findPreferredLocalKernelSpecConnection(n,l,c.token).then(p=>p==null?void 0:p.interpreter):void 0}finally{c.dispose()}let u=((s=this.controllerRegistration.getSelected(n))==null?void 0:s.connection.interpreter)||a;return this.export(n,void 0,void 0,u)}else return this.export(void 0,void 0,void 0,void 0)}async export(e,t,n,i){var o,s,a,l;if(!e){if(e=((o=$s.window.activeNotebookEditor)==null?void 0:o.notebook)||((a=(s=this.interactiveProvider)==null?void 0:s.getActiveOrAssociatedInteractiveWindow())==null?void 0:a.notebookDocument),!e){b.info("Export called without a valid exportable document active");return}i=i||((l=this.controllerRegistration.getSelected(e))==null?void 0:l.connection.interpreter),t&&J("DATASCIENCE.EXPORT_NOTEBOOK_AS_COMMAND",void 0,{format:t})}if(t)await this.fileConverter.export(t,e,n,i);else{let c=await this.showExportQuickPickMenu(e,n,i).then(u=>u);c!==void 0?c.handler():J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK")}}getExportQuickPickItems(e,t,n){let i=[];return(n||e.metadata&&$R(xa(e)))&&i.push({label:C.exportPythonQuickPickLabel,picked:!0,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"python"}),$s.commands.executeCommand(Q.ExportAsPythonScript,e,n).then(y,y)}}),i.push({label:C.exportHTMLQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"html"}),$s.commands.executeCommand(Q.ExportToHTML,e,t,n).then(y,y)}},{label:C.exportPDFQuickPickLabel,picked:!1,handler:()=>{J("DATASCIENCE.CLICKED_EXPORT_NOTEBOOK_AS_QUICK_PICK",void 0,{format:"pdf"}),$s.commands.executeCommand(Q.ExportToPDF,e,t,n).then(y,y)}}),i}async showExportQuickPickMenu(e,t,n){let i=this.getExportQuickPickItems(e,t,n),o={ignoreFocusOut:!1,matchOnDescription:!0,matchOnDetail:!0,placeHolder:C.exportAsQuickPickPlaceholder};return $s.window.showQuickPick(i,o)}};var XM=require("vscode");var $_=class{constructor(e,t,n,i,o,s,a){this.disposables=e;this.fileConverter=t;this.fs=n;this.interactiveProvider=i;this.controllerSelection=o;this.kernelFinder=s;this.jupyterConnection=a;this.exportCommand=new QM(this.fileConverter,this.fs,this.interactiveProvider,o,new o_(a),s),XM.workspace.isTrusted||XM.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){var e;XM.workspace.isTrusted&&((e=this.exportCommand)==null||e.register())}};$_=E([(0,Fa.injectable)(),I(0,(0,Fa.inject)(ie)),I(1,(0,Fa.inject)(v_)),I(2,(0,Fa.inject)(xt)),I(3,(0,Fa.inject)(ys)),I(3,(0,Fa.optional)()),I(4,(0,Fa.inject)(kt)),I(5,(0,Fa.inject)(ui)),I(6,(0,Fa.inject)(vn))],$_);d();var Pu=$(te()),vo=require("vscode");var z_=class{constructor(e,t,n,i,o){this.interactiveProvider=e;this.kernelProvider=n;this.controllers=i;this.jupyterUriProviderRegistration=o;this.disposables=[];this.isPythonFileActive=!1;t.push(this),this.nativeContext=new gr(Sr.IsNativeActive),this.canRestartNotebookKernelContext=new gr(Sr.CanRestartNotebookKernel),this.canInterruptNotebookKernelContext=new gr(Sr.CanInterruptNotebookKernel),this.canRestartInteractiveWindowKernelContext=new gr(Sr.CanRestartInteractiveWindowKernel),this.canInterruptInteractiveWindowKernelContext=new gr(Sr.CanInterruptInteractiveWindowKernel),this.interactiveContext=new gr(Sr.IsInteractiveActive),this.interactiveOrNativeContext=new gr(Sr.IsInteractiveOrNativeActive),this.pythonOrNativeContext=new gr(Sr.IsPythonOrNativeActive),this.pythonOrInteractiveContext=new gr(Sr.IsPythonOrInteractiveActive),this.pythonOrInteractiveOrNativeContext=new gr(Sr.IsPythonOrInteractiveOrNativeActive),this.hasNativeNotebookCells=new gr(Sr.HaveNativeCells),this.isPythonNotebook=new gr(Sr.IsPythonNotebook),this.isJupyterKernelSelected=new gr(Sr.IsJupyterKernelSelected),this.hasNativeNotebookOrInteractiveWindowOpen=new gr(Sr.HasNativeNotebookOrInteractiveWindowOpen),this.kernelSourceContext=new gr(Sr.KernelSource)}dispose(){this.disposables.forEach(e=>e.dispose())}activate(){var e;vo.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,this.disposables),this.kernelProvider.onKernelStatusChanged(this.onDidKernelStatusChange,this,this.disposables),this.interactiveProvider&&(this.interactiveProvider.onDidChangeActiveInteractiveWindow(this.onDidChangeActiveInteractiveWindow,this,this.disposables),this.interactiveProvider.activeWindow&&this.onDidChangeActiveInteractiveWindow()),vo.window.activeNotebookEditor&&this.onDidChangeActiveNotebookEditor(vo.window.activeNotebookEditor),vo.window.onDidChangeActiveNotebookEditor(this.onDidChangeActiveNotebookEditor,this,this.disposables),((e=vo.window.activeTextEditor)==null?void 0:e.document.languageId)===qe&&this.onDidChangeActiveTextEditor(vo.window.activeTextEditor),vo.window.onDidChangeNotebookEditorSelection(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),vo.workspace.onDidOpenNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),vo.workspace.onDidCloseNotebookDocument(this.updateNativeNotebookInteractiveWindowOpenContext,this,this.disposables),this.controllers.onControllerSelectionChanged(()=>this.updateSelectedKernelContext(),this,this.disposables),this.updateSelectedKernelContext()}updateNativeNotebookCellContext(){var t;let e=(((t=vo.window.activeNotebookEditor)==null?void 0:t.notebook.cellCount)||0)>0;this.hasNativeNotebookCells.set(e).catch(y)}onDidChangeActiveInteractiveWindow(e){this.interactiveContext.set(!!e).catch(y),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}onDidChangeActiveNotebookEditor(e){let t=e?e.notebook.notebookType===It:!1;this.nativeContext.set(t).catch(y),this.isPythonNotebook.set(e&&t?$R(xa(e.notebook)):!1).catch(y),this.updateContextOfActiveNotebookKernel(e),this.updateContextOfActiveInteractiveWindowKernel(),this.updateNativeNotebookInteractiveWindowOpenContext(),this.updateNativeNotebookCellContext(),this.updateMergedContexts()}updateNativeNotebookInteractiveWindowOpenContext(){this.hasNativeNotebookOrInteractiveWindowOpen.set(vo.workspace.notebookDocuments.some(e=>e.notebookType===It||e.notebookType===vt)).catch(y)}updateContextOfActiveNotebookKernel(e){let t=e&&e.notebook.notebookType===It?this.kernelProvider.get(e.notebook):void 0;if(t){let n=this.kernelProvider.getKernelExecution(t),i=t.status!=="unknown"||n.executionCount>0||t.startedAtLeastOnce;this.canRestartNotebookKernelContext.set(!!i).catch(y);let o=t.status==="busy";this.canInterruptNotebookKernelContext.set(!!o).catch(y)}else this.canRestartNotebookKernelContext.set(!1).catch(y),this.canInterruptNotebookKernelContext.set(!1).catch(y);this.updateKernelSourceContext(t).catch(y),this.updateSelectedKernelContext()}async updateKernelSourceContext(e){if(!e||!Ot(e.kernelConnectionMetadata)){this.kernelSourceContext.set("").catch(y);return}let t=e.kernelConnectionMetadata,n=await this.jupyterUriProviderRegistration.jupyterCollections.find(i=>i.extensionId===t.serverProviderHandle.extensionId&&i.id===t.serverProviderHandle.id);if(!n){this.kernelSourceContext.set("").catch(y);return}this.kernelSourceContext.set(n.id).catch(y)}updateSelectedKernelContext(){var t,n,i;let e=((t=vo.window.activeNotebookEditor)==null?void 0:t.notebook)||((i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument);e&&br(e)&&this.controllers.getSelected(e)?this.isJupyterKernelSelected.set(!0).catch(y):this.isJupyterKernelSelected.set(!1).catch(y)}updateContextOfActiveInteractiveWindowKernel(){var n,i;let e=(i=(n=this.interactiveProvider)==null?void 0:n.getActiveOrAssociatedInteractiveWindow())==null?void 0:i.notebookDocument,t=e?this.kernelProvider.get(e):void 0;if(t){let o=t.status!=="unknown";this.canRestartInteractiveWindowKernelContext.set(!!o).catch(y);let s=t.status==="busy";this.canInterruptInteractiveWindowKernelContext.set(!!s).catch(y)}else this.canRestartInteractiveWindowKernelContext.set(!1).catch(y),this.canInterruptInteractiveWindowKernelContext.set(!1).catch(y);this.updateSelectedKernelContext()}onDidKernelStatusChange({kernel:e}){var n;let t=e.notebook;t.notebookType===vt?this.updateContextOfActiveInteractiveWindowKernel():t.notebookType===It&&t===((n=vo.window.activeNotebookEditor)==null?void 0:n.notebook)&&this.updateContextOfActiveNotebookKernel(vo.window.activeNotebookEditor)}onDidChangeActiveTextEditor(e){this.isPythonFileActive=(e==null?void 0:e.document.languageId)===qe&&!pB(e.document.uri),this.updateNativeNotebookCellContext(),this.updateMergedContexts(),this.updateContextOfActiveInteractiveWindowKernel()}updateMergedContexts(){this.interactiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0).catch(y),this.pythonOrNativeContext.set(this.nativeContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveContext.set(this.interactiveContext.value===!0||this.isPythonFileActive===!0).catch(y),this.pythonOrInteractiveOrNativeContext.set(this.nativeContext.value===!0||this.interactiveContext.value===!0&&this.isPythonFileActive===!0).catch(y)}};z_=E([(0,Pu.injectable)(),I(0,(0,Pu.inject)(ys)),I(0,(0,Pu.optional)()),I(1,(0,Pu.inject)(ie)),I(2,(0,Pu.inject)(He)),I(3,(0,Pu.inject)(kt)),I(4,(0,Pu.inject)(ur))],z_);d();var Tu=$(te());var w9=require("vscode");var Q_=class{constructor(e,t,n,i){this.disposableRegistry=e;this.configuration=t;this.rawSupported=n;this.commandListeners=i;this.isDisposed=!1;this.startTime=Date.now();this.onSettingsChanged=()=>{let t=this.configuration.getSettings(void 0).sendSelectionToInteractiveWindow;new gr(Sr.OwnsSelection).set(t).catch(y)}}get activationStartTime(){return this.startTime}activate(){this.onSettingsChanged(),this.changeHandler=this.configuration.getSettings(void 0).onDidChange(this.onSettingsChanged.bind(this)),this.disposableRegistry.push(this),this.disposableRegistry.push(w9.window.onDidChangeActiveTextEditor(()=>this.onChangedActiveTextEditor())),this.onChangedActiveTextEditor(),this.computeZmqAvailable(),this.commandListeners&&this.commandListeners.forEach(e=>e.register())}async dispose(){this.changeHandler&&(this.changeHandler.dispose(),this.changeHandler=void 0)}computeZmqAvailable(){new gr(Sr.ZmqAvailable).set(this.rawSupported?this.rawSupported.isSupported:!1).then(y,y)}onChangedActiveTextEditor(){let e=new gr(Sr.HasCodeCells),t=w9.window.activeTextEditor;t&&t.document.languageId===qe?e.set(Ree(t.document,this.configuration.getSettings())).catch(y):e.set(!1).catch(y)}};Q_=E([(0,Tu.injectable)(),I(0,(0,Tu.inject)(ie)),I(1,(0,Tu.inject)(Me)),I(2,(0,Tu.inject)($d)),I(2,(0,Tu.optional)()),I(3,(0,Tu.multiInject)(my))],Q_);d();var Mm=$(te()),ku=require("vscode");var X_=class{constructor(e,t,n){this.jupyterServerHelper=e;this.fileSystem=t;this.errorHandler=n;this.extractPythonMainVersion=async()=>{if(!this.jupyterServerHelper)return 3;let e=await this.jupyterServerHelper.getUsableJupyterPython(),t=await Np(e);return e&&t&&t.major||3}}async exportToFile(e,t,n=!0){let i=await this.serialize(e);try{if(await this.fileSystem.writeFile(ku.Uri.file(t),i||""),!n)return;let o=C.exportOpenQuestion1;ku.window.showInformationMessage(C.exportDialogComplete(t),o).then(async s=>{try{s===o&&await KM(ku.Uri.file(t))}catch(a){await this.errorHandler.handleError(a)}},y)}catch(o){b.error("Error in exporting notebook file"),ku.window.showInformationMessage(C.exportDialogFailed(o)).then(y,y)}}async serialize(e,t){var a;let n=await this.extractPythonMainVersion(),i={language_info:{codemirror_mode:{name:"ipython",version:n},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:`ipython${n}`,version:n},kernelspec:t},o=(a=ku.extensions.getExtension("vscode.ipynb"))==null?void 0:a.exports;if(!o)throw new Error("vscode.ipynb extension not found");let s=new ku.NotebookData(e);return s.metadata={metadata:i,nbformat:GO.major,nbformat_minor:GO.minor},o.exportNotebook(s)}};X_=E([(0,Mm.injectable)(),I(0,(0,Mm.inject)(s1)),I(0,(0,Mm.optional)()),I(1,(0,Mm.inject)(xt)),I(2,(0,Mm.inject)(xn))],X_);d();var Hi=$(te()),ZM=require("vscode");d();var Rv=$(te()),Nv=require("vscode");var Ate=require("vscode");var x9="JUPYTER_API_ACCESS_INFORMATION",Rte=new Set([Ye.split(".")[0],"rchiodo","donjayamanne","SynapseVSCode"]),D9=new Set(["rchiodo","nuant"]),cp=class{constructor(e,t){this.globalState=e;this.context=t;this.extensionAccess=new Map;this.promiseChain=new qv}async getAccessInformation(e){var s,a;let t=!e.extensionId||e.extensionId===dP?"":e.extensionId.split(".")[0]||"";if(this.context.extensionMode===Nv.ExtensionMode.Test||!t||Hd()==="insiders"){if(!Rte.has(t)&&!D9.has(t)){b.warn(`Publisher ${t} is allowed to access the Kernel API with a message.`);let l=((a=(s=Ate.extensions.getExtension(e.extensionId))==null?void 0:s.packageJSON)==null?void 0:a.displayName)||"",c=l&&e.extensionId?`${l} (${e.extensionId})`:e.extensionId||t;Nv.window.showErrorMessage(C.thanksForUsingJupyterKernelApiPleaseRegisterWithUs(c)).then(y,y)}if(!D9.has(t)||!t||this.context.extensionMode===Nv.ExtensionMode.Test)return{extensionId:e.extensionId,accessAllowed:!0}}if(Rte.has(t))return{extensionId:e.extensionId,accessAllowed:!0};if(!D9.has(t))return Nv.window.showErrorMessage(`Please contact the Jupyter Extension to get access to the Kernel API. Publisher ${t}`).then(y,y),b.error(`Publisher ${t} is not allowed to access the Kernel API.`),{extensionId:e.extensionId,accessAllowed:!1};let n=this.globalState.get(x9),i=n==null?void 0:n.find(l=>l.extensionId===e.extensionId);if(i)return J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:i.allowed}),{extensionId:e.extensionId,accessAllowed:i.allowed==="yes"};if(this.extensionAccess.get(e.extensionId))return this.extensionAccess.get(e.extensionId);let o=(async()=>{let l=C.allowExtensionToUseJupyterKernelApi(`${e.displayName} (${e.extensionId})`,Ue.bannerLabelYes),u=await Nv.window.showInformationMessage(l,{modal:!0},Ue.bannerLabelYes,Ue.bannerLabelNo)===Ue.bannerLabelYes;return this.promiseChain.chainFinally(async()=>{let p=[...this.globalState.get(x9,[])];return p=p.filter(f=>f.extensionId!==e.extensionId),p.push({allowed:u?"yes":"no",extensionId:e.extensionId}),this.globalState.update(x9,p)}).then(y,y),J("DATASCIENCE.JUPYTER_KERNEL_API_ACCESS",void 0,{extensionId:e.extensionId,allowed:u?"yes":"no"}),{extensionId:e.extensionId,accessAllowed:u}})();return this.extensionAccess.set(e.extensionId,o),o}};cp=E([(0,Rv.injectable)(),I(0,(0,Rv.inject)(_t)),I(0,(0,Rv.named)(sr)),I(1,(0,Rv.inject)(st))],cp);d();var Mte=new WeakMap;function P9(r){let e=Mte.get(r);return e||(e=vCe(r),Mte.set(r,e)),e}function vCe(r){return new Proxy(r,{get(e,t){return t==="kernel"?e.kernel?yCe(e.kernel):void 0:Reflect.get(e,t)}})}var Ote=new WeakMap;function yCe(r){let e=Ote.get(r);return e||(e=bCe(r),Ote.set(r,e)),e}function bCe(r){return new Proxy(r,{get(e,t){return t==="registerCommTarget"?(n,i)=>(wZ(r,n),Reflect.get(e,t).apply(e,[n,i])):t==="removeCommTarget"?(n,i)=>(xZ(r,n),Reflect.get(e,t).apply(e,[n,i])):Reflect.get(e,t)}})}var Z_=class{constructor(e,t,n,i,o,s,a,l){this.kernelProvider=e;this.kernelFinder=t;this.thirdPartyKernelProvider=n;this.disposables=i;this.controllerRegistration=o;this.apiAccess=s;this.extensions=a;this.serviceContainer=l;this.chainedApiAccess=new qv;this.extensionApi=new Map}async getService(){let e=this.extensions.determineExtensionFromCallStack(),t=await this.chainedApiAccess.chainFinally(()=>this.apiAccess.getAccessInformation(e));if(!t.accessAllowed)return;if(this.extensionApi.get(t.extensionId))return this.extensionApi.get(t.extensionId);let n=new JD(t.extensionId,this.kernelProvider,this.kernelFinder,this.thirdPartyKernelProvider,this.disposables,this.controllerRegistration,this.serviceContainer);return this.extensionApi.set(t.extensionId,n),n}};Z_=E([(0,Hi.injectable)(),I(0,(0,Hi.inject)(He)),I(1,(0,Hi.inject)(ui)),I(2,(0,Hi.inject)(Yg)),I(3,(0,Hi.inject)(ie)),I(4,(0,Hi.inject)(kt)),I(5,(0,Hi.inject)(cp)),I(6,(0,Hi.inject)(Ga)),I(7,(0,Hi.inject)(Ur))],Z_);var JD=class{constructor(e,t,n,i,o,s,a){this.callingExtensionId=e;this.kernelProvider=t;this.kernelFinder=n;this.thirdPartyKernelProvider=i;this.disposables=o;this.controllerRegistration=s;this.serviceContainer=a;this._onDidChangeKernelSpecifications=new ZM.EventEmitter;this._onDidChangeKernels=new ZM.EventEmitter;this.translatedConnections=new WeakMap;this._onDidChangeStatus=new ZM.EventEmitter;this._status=this.kernelFinder.status,this.kernelFinder.onDidChangeStatus(()=>{this._status=this.kernelFinder.status,this._onDidChangeStatus.fire()},this,o),this.kernelProvider.onDidDisposeKernel(l=>{var c;b.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.kernelProvider.onDidStartKernel(l=>{var c;b.ci(`Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidDisposeKernel(l=>{var c;b.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} disposed`),this._onDidChangeKernels.fire()},this,o),this.thirdPartyKernelProvider.onDidStartKernel(l=>{var c;b.ci(`Third party Kernel ${l.kernelConnectionMetadata.id}, ${(c=l.kernelConnectionMetadata.interpreter)==null?void 0:c.uri.toString()} started`),this._onDidChangeKernels.fire()},this,o),this.controllerRegistration.onDidChange(()=>this._onDidChangeKernelSpecifications.fire(),this,o)}get onDidChangeKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernelSpecifications"}),b.debug(`API called from ${this.callingExtensionId}`),this._onDidChangeKernelSpecifications.event}get onDidChangeKernels(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"onDidChangeKernels"}),this._onDidChangeKernels.event}get status(){return this._status}get onDidChangeStatus(){return this._onDidChangeStatus.event}async getKernelSpecifications(){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernelSpecifications"}),this.kernelFinder.kernels.map(e=>this.translateKernelConnectionMetadataToExportedType(e))}getActiveKernels(){J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getActiveKernels"});let e=[],t=new Set;return this.kernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.kernelProvider.get(n.notebook);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.thirdPartyKernelProvider.kernels.filter(n=>n.startedAtLeastOnce||n.kernelConnectionMetadata.kind==="connectToLiveRemoteKernel").forEach(n=>{var o,s;let i=this.thirdPartyKernelProvider.get(n.uri);i&&((s=(o=i.session)==null?void 0:o.kernel)!=null&&s.id)&&t.add(i.session.kernel.id),e.push({metadata:this.translateKernelConnectionMetadataToExportedType(n.kernelConnectionMetadata),uri:n.uri,id:n.id})}),this.controllerRegistration.registered.forEach(n=>{n.controller.notebookType===It&&n.connection.kind==="connectToLiveRemoteKernel"&&(!n.connection.kernelModel.id||t.has(n.connection.kernelModel.id)||e.push({metadata:n.connection,uri:void 0,id:n.id}))}),e}getKernel(e){var n;J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"getKernel"});let t=(n=this.thirdPartyKernelProvider.get(e))!=null?n:this.kernelProvider.get(e);if(t!=null&&t.session)return{metadata:this.translateKernelConnectionMetadataToExportedType(t.kernelConnectionMetadata),connection:P9(t.session)}}async startKernel(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"startKernel"}),this.startOrConnect(e,t)}async connect(e,t){return J("DATASCIENCE.JUPYTER_KERNEL_API_USAGE",void 0,{extensionId:this.callingExtensionId,pemUsed:"connect"}),this.startOrConnect(e,t)}async startOrConnect(e,t){let n=this.kernelFinder.kernels.find(o=>o.id===e.id);if(!n)throw new Error("Not found");let i=await Aa.connectToKernel(n,this.serviceContainer,{resource:t},new Ir(!1),this.disposables,"3rdPartyExtension");if(!(i!=null&&i.session))throw new Error("Not found");return P9(i.session)}translateKernelConnectionMetadataToExportedType(e){if(!this.translatedConnections.has(e)){let t=Object.freeze(Xc.fromJSON(e.toJSON()));this.translatedConnections.set(e,t)}return this.translatedConnections.get(e)}};JD=E([I(1,(0,Hi.inject)(He)),I(2,(0,Hi.inject)(ui)),I(3,(0,Hi.inject)(Yg)),I(4,(0,Hi.inject)(ie)),I(5,(0,Hi.inject)(kt)),I(6,(0,Hi.inject)(Ur))],JD);d();var tE=$(te());var eE=class{constructor(e){this.syncActivationServices=e}activate(){this.syncActivationServices.map(e=>{try{e.activate()}catch(t){b.error(`Error in activating extension, failed in ${e.constructor.name}`,t)}})}};eE=E([(0,tE.injectable)(),I(0,(0,tE.optional)()),I(0,(0,tE.multiInject)(We))],eE);d();d();var Zl=require("vscode");function Lte(r,e){e&&Zl.commands.registerCommand("dataScience.ClearCache",async()=>{let t=[];for(let n of r.globalState.keys())t.push(r.globalState.update(n,void 0).then(y,y));for(let n of r.workspaceState.keys())t.push(r.workspaceState.update(n,void 0).then(y,y));t.push(Zl.commands.executeCommand(Q.ClearSavedJupyterUris).then(y,y)),await Promise.all(t).catch(y),await Promise.all([Zl.workspace.fs.delete(Zl.Uri.joinPath(r.globalStorageUri,"lastExecutedRemoteCell.json")).then(y,y),Zl.workspace.fs.delete(Zl.Uri.joinPath(r.globalStorageUri,"remoteServersMRUList.json")).then(y,y),Zl.workspace.fs.delete(Zl.Uri.joinPath(r.globalStorageUri,PS)).then(y,y)]),b.info("Cache cleared")})}function Kte(r,e){Lte(r,e)}d();d();var rO=$(te()),Qt=require("vscode");var eO=C.percentPipCondaInstallInsteadOfBang("pip"),T9=C.percentPipCondaInstallInsteadOfBang("conda"),Fte=C.matplotlibWidgetInsteadOfOther,tO="Jupyter",rE=class{constructor(e){this.disposables=[];this.notebooksProcessed=new WeakMap;this.cellsToProcess=new Set;this.problems=Qt.languages.createDiagnosticCollection(tO),this.disposables.push(this.problems),e.push(this)}dispose(){me(this.disposables),this.problems.dispose()}activate(){this.disposables.push(Qt.languages.registerCodeActionsProvider(qe,this)),this.disposables.push(Qt.languages.registerHoverProvider(qe,this)),Qt.workspace.onDidChangeTextDocument(t=>{let n=uI(t.document);if(!n)return;let i=n.getCells().find(o=>o.document===t.document);i&&this.analyzeNotebookCell(i)},this,this.disposables),Qt.workspace.onDidCloseNotebookDocument(t=>{this.problems.delete(t.uri);let n=this.notebooksProcessed.get(t);this.notebooksProcessed.delete(t),n&&n.forEach((i,o)=>this.problems.delete(Qt.Uri.parse(o)))},this,this.disposables),Qt.workspace.onDidOpenNotebookDocument(t=>this.analyzeNotebook(t),this,this.disposables);let e=new ic(300);this.disposables.push(e),Qt.workspace.onDidChangeNotebookDocument(t=>{e.trigger(()=>{let n=this.notebooksProcessed.get(t.notebook);t.contentChanges.forEach(i=>{i.removedCells.forEach(o=>{n==null||n.delete(o.document.uri.toString())}),i.addedCells.forEach(o=>this.queueCellForProcessing(o))}),t.cellChanges.forEach(i=>this.queueCellForProcessing(i.cell))})},this,this.disposables),Qt.workspace.notebookDocuments.map(t=>this.analyzeNotebook(t))}provideHover(e,t,n){let i=uI(e);if((i==null?void 0:i.notebookType)!==It)return;let o=this.problems.get(e.uri);if(!o)return;let s=o.find(l=>l.message===eO||l.message===T9);if(!s||!s.range.contains(t))return;let a=s.message===eO?"pip":"conda";return new Qt.Hover(C.pipCondaInstallHoverWarning(a,"https://aka.ms/jupyterCellMagicBangInstall"),s.range)}provideCodeActions(e,t,n,i){if(!uI(e))return[];let o=[];return n.diagnostics.forEach(s=>{switch(s.message){case eO:o.push(this.createReplaceCodeAction(e,"pip",s));break;case T9:o.push(this.createReplaceCodeAction(e,"conda",s));break;case Fte:o.push(this.createGotoWikiAction(e,Qt.Uri.parse("https://aka.ms/vscodejupytermatplotlibwidget"),s));break;default:break}}),o}createReplaceCodeAction(e,t,n){let i=new Qt.CodeAction(C.replacePipCondaInstallCodeAction(t),Qt.CodeActionKind.QuickFix);i.isPreferred=!0,i.diagnostics=[n];let o=new Qt.WorkspaceEdit;return o.replace(e.uri,new Qt.Range(n.range.start,new Qt.Position(n.range.start.line,n.range.start.character+1)),"%"),i.edit=o,i}createGotoWikiAction(e,t,n){let i=new Qt.CodeAction(C.matplotlibWidgetCodeActionTitle,Qt.CodeActionKind.QuickFix);return i.isPreferred=!0,i.diagnostics=[n],i.command={title:C.matplotlibWidgetCodeActionTitle,command:"vscode.open",arguments:[t]},i}analyzeNotebook(e){e.notebookType===It&&e.getCells().forEach((t,n)=>n<100?this.queueCellForProcessing(t):void 0)}queueCellForProcessing(e){this.cellsToProcess.add(e),this.analyzeNotebookCells()}analyzeNotebookCells(){if(this.cellsToProcess.size===0)return;let e=this.cellsToProcess.values().next().value;this.cellsToProcess.delete(e),this.analyzeNotebookCell(e),setTimeout(()=>this.analyzeNotebookCells(),0)}analyzeNotebookCell(e){var n;if(e.kind!==Qt.NotebookCellKind.Code||e.document.languageId!==qe||e.notebook.isClosed||e.document.isClosed||((n=this.notebooksProcessed.get(e.notebook))==null?void 0:n.get(e.document.uri.toString()))===e.document.version)return;this.problems.delete(e.document.uri);let t=this.notebooksProcessed.get(e.notebook)||new Map;t.set(e.document.uri.toString(),e.document.version),this.notebooksProcessed.set(e.notebook,t);for(let i=0;i<Math.min(e.document.lineCount,50);i++){let o=e.document.lineAt(i),s=o.text;if(s.trim().startsWith("!pip install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new Qt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:eO,range:c,severity:Qt.DiagnosticSeverity.Error,source:tO}])}else if(s.trim().startsWith("!conda install")){let a=s.indexOf("!"),l=s.indexOf("l"),c=new Qt.Range(o.lineNumber,a,o.lineNumber,l+2);this.problems.set(e.document.uri,[{message:T9,range:c,severity:Qt.DiagnosticSeverity.Error,source:tO}])}else if(s.trim().startsWith("%matplotlib")&&!s.trim().endsWith("widget")&&!s.trim().endsWith("inline")){let a=s.indexOf("%"),l=s.length,c=new Qt.Range(o.lineNumber,a,o.lineNumber,l);this.problems.set(e.document.uri,[{message:Fte,range:c,severity:Qt.DiagnosticSeverity.Warning,source:tO}])}}}};rE=E([(0,rO.injectable)(),I(0,(0,rO.inject)(ie))],rE);d();var aO=$(te()),Er=require("vscode");d();var Ute=new Map([["method",0],["function",1],["constructor",2],["field",3],["variable",4],["class",5],["struct",6],["interface",7],["module",8],["property",9],["event",10],["operator",11],["unit",12],["value",13],["constant",14],["enum",15],["enumMember",16],["keyword",17],["text",18],["color",19],["file",20],["reference",21],["customcolor",22],["folder",23],["typeParameter",24],["snippet",25],["<unknown>",3]]);d();function nO(r){if(r>=300)return"ZZZZZZZ";if(r<=25)return`A${String.fromCharCode(65+r)}`;let e=String.fromCharCode(65+Math.ceil(r/25)),t=String.fromCharCode(65+r%25);return`${e}${t}`}d();var qte=require("vscode");d();var Av=require("vscode");var ICe=new Map([["julia",CCe],["python",_Ce],["r",wCe]]);function Wte(r,e){let t=ICe.get(e.toLowerCase());return t?t(r):r}var SCe=["Docstring:","Options:","Parameters","Returns","See Also","Notes","Examples","Usage:","Subclasses:"];function _Ce(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=-1,n=!1,i=!1,o=[],s=new Set,a=!1,l="",c=!1,u=!1;if(e.map((f,m)=>{if(m===0){let g=["Signature:","Init signature:"].find(v=>f.toLowerCase().startsWith(v.toLowerCase()));if(g){n=!0,f=f.substring(g.length).trim(),o.push("```python"),f.trim().length&&(o.push(f),c=!0);return}}if(f.startsWith("File:")&&m===e.length-1||f.startsWith("Type:")&&m===0)return;if(!a&&f.toLowerCase().startsWith("String form:".toLowerCase())){i=!0;return}let h=SCe.find(g=>f.trim().toLowerCase().startsWith(g.toLowerCase()));if(h&&!s.has(h)){l=h.toLowerCase(),s.add(h),a=!0,t=m,i=!1,n&&o.push("```","----------"),n=!1,u=!1,l!=="docstring:"&&o.push(`## ${h}`);let g=f.includes(":")?f.split(":")[1].replace("<no docstring>","").trim():"";g.length&&(o.push(g),c=!0);return}if(!i){if(t+1===m&&f.replace(/-/g,"").replace(/:/g,"").replace("<no docstring>","").trim().length===0){t=m,i=!1,n=!1,u=!1;return}if(l==="parameters"||l==="see also"){f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="options:"){f.startsWith("-")&&f.trim().length&&f.includes(":")&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="returns"){f.trim().length&&f.substring(0,1)===f.trim().substring(0,1)?o.push(`* ${f}`):o.push(f),c=c||f.trim().length>0;return}if(l==="examples"&&!n&&(t+1===m||t+2===m))return i=!1,n=!0,c=c||f.trim().length>0,o.push("```python",f);if(!n&&f.startsWith("class ")&&f.trim().endsWith("):")){n=!0,u=!0,o.push("```python",f),c=c||f.trim().length>0;return}if(n&&u&&f.trim().length>0&&f.substring(0,1)!==" "&&f.substring(0,1)!=="	")return n=!1,u=!1,o.push(f,"```");c=c||f.trim().length>0,o.push(f)}}),!c)return"";let p=o.join(`  
`);return n?new Av.MarkdownString(p+"  \n```"):new Av.MarkdownString(p)}var ECe=[{section:"Examples:",header:"Examples",nextLine://g},{section:"Usage note",header:"Usage note",nextLine://g},{section:"Note:",header:"\u2502 Note",nextLine:"\u2502"},{section:"Note:",header:"\u2502 Note",nextLine:String.fromCharCode(9474)}];function CCe(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=!1,n=[],i=new Set,o="",s=!1,a=!1;e.every(c=>c.trim().length===0||c.startsWith("  "))&&e.forEach((c,u)=>e[u]=c.trim().length?c.substring(2):c),e.map((c,u)=>{if(c.trim()==="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500")return a=!1,n.push(c);if(!a)return o="signature",t=!0,a=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");o==="signature"&&c.trim()===""&&(o="",t=!1,s=!1,n.push("```"));let p=ECe.find(f=>c.trim().toLowerCase().startsWith(f.header.toLowerCase()));if(p&&(typeof p.nextLine=="string"?e[u+1].trim()===p.nextLine.trim():e[u+1].trim().replace(p.nextLine,"").length===0)){e[u+1]="",o=p.section.toLowerCase(),i.add(p.header),t&&n.push("```"),t=!1,n.push(`## ${p.section}`),o==="note:"&&!e.slice(u+1).every(f=>f.trim().length===0||f.trim().startsWith("|")||f.trim().startsWith(String.fromCharCode(9474)))&&(o="");return}if(o==="examples:"&&!t)return t=!0,c.trim().length?(s=!0,n.push("```julia",c)):n.push("```julia");if(o==="note:"){n.push(c.trim()?c.trim().substring(1):"");return}t&&!s&&c.trim().length===0||n.push(c)});let l=n.join(`  
`);return t?new Av.MarkdownString(l+"  \n```"):new Av.MarkdownString(l)}function wCe(r){let e=at(r,{trim:!1,removeEmptyEntries:!1}),t=[];e.forEach((a,l)=>e[l]=a.indexOf("     ")===0?a.substring(5):a);let n="",i=!1,o=!1;e.map(a=>{let l=a.replace(/_/g,"").trim();if(a.startsWith("_")&&a.includes(String.fromCharCode(8))&&a.split("_").length===a.split(String.fromCharCode(8)).length&&l){i&&t.push("```"),i=!1,n=l.trim().toLowerCase(),t.push(`## ${l}`);return}if((n==="examples"||n==="examples:"||n==="usage"||n==="usage:")&&!i)return i=!0,a.trim().length?(o=!0,t.push("```r",a)):t.push("```r");if(n==="note:"){t.push(a.trim()?a.trim().substring(1):"");return}i&&!o&&a.trim().length===0||t.push(a)});let s=t.join(`  
`);return i?new Av.MarkdownString(s+"  \n```"):new Av.MarkdownString(s)}d();var Vte=new WeakMap;async function Mv(r,e,t){var f;let n=Vte.get(r)||0;Vte.set(r,n+1);let i=o1(Ye,r),o=`application/vnd.vscode.bg.execution.${n}`,s=`application/vnd.vscode.bg.execution.${n}.result`,a=`application/vnd.vscode.bg.execution.${n}.error`,l="",c=`
def __jupyter_exec_background__():
    from IPython.display import display
    from threading import Thread
    from traceback import format_exc

    # First send a dummy response to get the display id.
    # Later we'll send the real response with the actual data.
    # And that can happen much later even after the execution completes,
    # as that response will be sent from a bg thread.
    output = display({"${o}": ""}, raw=True, display_id=True)

    def do_implementation():
        ${e.map((m,h)=>h===0?m:`        ${m}`).join(`
`)}

    def bg_main():
        try:
            output.update({"${s}": do_implementation()}, raw=True)
        except Exception as e:
            output.update({"${a}": format_exc()}, raw=True)


    Thread(target=bg_main, daemon=True).start()


__jupyter_exec_background__()
del __jupyter_exec_background__
`.trim(),u=new kn;u.add(t.onCancellationRequested(()=>u.dispose()));let p=Us(t,new Promise((m,h)=>{u.add(i.onDidReceiveDisplayUpdate(async g=>{var _;if(t.isCancellationRequested)return m(void 0);let v=$g(g);if(!l||((_=v==null?void 0:v.transient)==null?void 0:_.display_id)!==l)return;let S=g.items.find(D=>D.mime===s);if(S)try{return m(JSON.parse(new TextDecoder().decode(S.data)))}catch(D){return h(new Error("Failed to parse the result",D))}}))})).finally(()=>{r.session&&wz(r.session,l),u.dispose()});for await(let m of i.executeCode(c,t)){if(t.isCancellationRequested)return;let h=$g(m);if(!((f=h==null?void 0:h.transient)!=null&&f.display_id))continue;if(m.items.find(v=>v.mime===o)){l=h.transient.display_id;continue}if(l===h.transient.display_id){let v=m.items.find(S=>S.mime===s||S.mime===a);if((v==null?void 0:v.mime)===s)return JSON.parse(new TextDecoder().decode(v.data));if((v==null?void 0:v.mime)===a){b.warn(`Error in background execution:
`,new TextDecoder().decode(v.data));return}}}if(!t.isCancellationRequested){if(!l){b.warn("Failed to get display id for completions");return}return p}}var xCe=1,Om=hi.IntellisenseResolveTimeout,jte=5,k9=new WeakSet,iO=class extends Error{constructor(){super("Request timed out")}};async function Gte(r,e,t,n,i,o,s,a){var p;if(!r.range||!((p=n.session)!=null&&p.kernel)||k9.has(n)||!Gt(n.kernelConnectionMetadata)&&n.status!=="idle")return r;let l=LCe(e||r,s,a),c=OCe(l,n,t),u=jz(t);try{let f=await Gv(Om,new iO,Us(u.token,c));if(!t.isCancellationRequested&&(f==null?void 0:f.status)==="ok"&&(f!=null&&f.found)){let m=DCe(f);r.documentation=Wte(m,o)}}catch(f){if(f instanceof qte.CancellationError)return r;f instanceof iO&&(u.cancel(),PCe(n,o,i))}finally{u.dispose()}return r}function DCe(r){return!r||r.status!=="ok"||!r.found?";":!r.data||typeof r.data!="object"?"":"text/plain"in r.data?bu(r.data["text/plain"]):""}var Bte=new WeakSet;function PCe(r,e,t){Gt(r.kernelConnectionMetadata)||k9.has(r)||(k9.add(r),b.warn(`Failed to inspect code in kernel ${ut(r.kernelConnectionMetadata)}`),Bte.has(r)||(Bte.add(r),J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION_CANNOT_RESOLVE",void 0,{kernelId:t,kernelConnectionType:r.kernelConnectionMetadata.kind,kernelLanguage:e})))}var N9=new WeakMap,R9=new WeakMap;async function TCe(r,e,t){let n=`return get_ipython().kernel.do_inspect("${Jx(e.code)}", ${e.cursor_pos}, ${e.detail_level})`;return{content:await Mv(r,[n],t)}}var Hte={data:{},found:!1,status:"ok",metadata:{}};function kCe(r,e){var i;if(!((i=r.session)!=null&&i.kernel))return;let t=JSON.stringify(e),n=N9.get(r.session.kernel);return n==null?void 0:n.get(t)}function NCe(r,e,t){var o;if(!((o=r.session)!=null&&o.kernel)||t.status!=="ok"||!t.found)return;let n=JSON.stringify(e),i=N9.get(r.session.kernel)||new Map;N9.set(r.session.kernel,i),i.size>100&&i.clear(),i.set(n,t)}function RCe(r){var t;if(!((t=r.session)!=null&&t.kernel))return!1;let e=R9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};return!Gt(r.kernelConnectionMetadata)&&e.maxTime>Om?(b.warn(`Not sending inspect request as previous requests took over ${Om}s.`),!1):e.numberOfTimesMaxedOut>jte?(b.warn(`Not sending inspect request as there have been at least ${jte} requests that took over ${Om}s.`),!1):e.maxTime>Om&&Date.now()-e.lastRequestTime<3e4?(b.warn(`Not sending inspect request as previous requests took over ${Om}s.`),!1):!0}async function ACe(r,e){var i;if(!((i=r.session)!=null&&i.kernel)||!Jte(r))return;b.info(`Too many pending requests ${Yte(r)} for kernel ${r.id}, waiting for it to be ready.`);let t=r.session.kernel,n=new kn;await Us(e,new Promise(o=>{let s=()=>{if(e.isCancellationRequested)return;if(!Jte(r)){o(),me(n);return}let a=setTimeout(s,100);n.add({dispose:()=>clearTimeout(a)})};n.add(Mg(e.onCancellationRequested)(()=>{o(),t.statusChanged.disconnect(s)})),t.statusChanged.connect(s),n.add({dispose:()=>{t.statusChanged.disconnect(s)}})})).finally(()=>me(n))}function MCe(r,e){var n;if(!((n=r.session)!=null&&n.kernel))return;let t=R9.get(r.session.kernel)||{maxTime:0,lastRequestTime:0,numberOfTimesMaxedOut:0};t.maxTime=Math.max(t.maxTime,e),t.lastRequestTime=Date.now(),e>Om&&(t.numberOfTimesMaxedOut+=1),R9.set(r.session.kernel,t)}async function OCe(r,e,t){var l;if(!((l=e.session)!=null&&l.kernel))return;let n=kCe(e,r);if(n)return n;if(!RCe(e)||(await ACe(e,t),t.isCancellationRequested))return Hte;let i=KCe(e),o=new St,s=at(r.code).reverse()[0].slice(-50);b.trace(`Inspecting code ${s}`);let a=Gt(e.kernelConnectionMetadata)?TCe(e,r,t):e.session.kernel.requestInspect(r);return a.finally(()=>i.dispose()),a.then(({content:c})=>{var p;if(!((p=e.session)!=null&&p.kernel))return;NCe(e,r,c),MCe(e,o.elapsedTime);let u=o.elapsedTime>Om?b.warn:b.debug;return t.isCancellationRequested?u(`Inspected code ${s} in ${o.elapsedTime}ms (but cancelled)`):u(`Inspected code ${s} in ${o.elapsedTime}ms`),c})}function LCe(r,e,t){var l;let n=e.getText(),i=(typeof r.insertText=="string"?r.insertText:(l=r.insertText)==null?void 0:l.value)||(typeof r.label=="string"?r.label:r.label.label)||"",o=n.substring(0,t.character)+i,s=t.character+i.length;return{code:o,cursor_pos:s,detail_level:0}}var qD=new WeakMap;function Jte(r){var e;return(e=r.session)!=null&&e.kernel?Yte(r)>=xCe:!1}function Yte(r){var e,t,n,i,o;return(e=r.session)!=null&&e.kernel?(qD.has((t=r.session)==null?void 0:t.kernel)||qD.set((n=r.session)==null?void 0:n.kernel,{count:0}),((o=qD.get((i=r.session)==null?void 0:i.kernel))==null?void 0:o.count)||0):0}function KCe(r){var t,n,i;if(!((t=r.session)!=null&&t.kernel))return{dispose:y};let e=qD.get((n=r.session)==null?void 0:n.kernel)||{count:0};return qD.set((i=r.session)==null?void 0:i.kernel,e),e.count+=1,{dispose:()=>{e.count-=1}}}var sO=class extends Error{constructor(){super("Request timed out")}},A9=class{constructor(e,t,n){this.kernelId=e;this.kernel=t;this.monacoLanguage=n;this.pendingCompletionRequest=new WeakMap;this.previousCompletionItems=new WeakMap}async provideCompletionItems(e,t,n,i){var a;if(!((a=this.kernel.session)!=null&&a.kernel))return[];let o=e.version;if(this.pendingCompletionRequest.has(e))return[];this.pendingCompletionRequest.set(e,{position:t,version:o});let s=new Er.Disposable(()=>{var l,c;(l=this.pendingCompletionRequest.get(e))!=null&&l.position.isEqual(t)&&((c=this.pendingCompletionRequest.get(e))==null?void 0:c.version)===o&&this.pendingCompletionRequest.delete(e)});try{let l=Fu(Us(n,Promise.resolve(Er.commands.executeCommand("vscode.executeCompletionItemProvider",e.uri,t)).then(m=>(m==null?void 0:m.items)||[]))),c=new St;if(await oc(50),n.isCancellationRequested)return[];let u=await Gv(hi.IntellisenseTimeout,new sO,this.provideCompletionItemsFromKernel(e,t,n,i));if(n.isCancellationRequested||!u||!u.length)return[];let p=await bo(0,l.promise);Gt(this.kernel.kernelConnectionMetadata)&&!l.completed&&c.elapsedTime<hi.IntellisenseTimeout+50&&(p=await bo(hi.IntellisenseTimeout-c.elapsedTime,l.promise));let f=new Set((p||[]).map(m=>typeof m.label=="string"?m.label:m.label.label));return u.filter(m=>!f.has(typeof m.label=="string"?m.label:m.label.label))}catch(l){if(l instanceof sO)return[];throw l instanceof Er.CancellationError||b.debug("Completions failed",l),l}finally{s.dispose()}}async provideCompletionItemsFromKernel(e,t,n,i){var v,S,_,D,P;if(n.isCancellationRequested||!((v=this.kernel.session)!=null&&v.kernel))return[];let o=new St,s={duration:0,timesExceededTimeout:0,requestDuration:0,completionItems:0},a={kernelId:this.kernelId,kernelConnectionType:this.kernel.kernelConnectionMetadata.kind,kernelLanguage:cO(this.kernel),monacoLanguage:this.monacoLanguage,cancelled:!1,kernelStatusBeforeRequest:this.kernel.status,completed:!1,requestSent:!1};if(!Gt(this.kernel.kernelConnectionMetadata)&&this.kernel.status!=="idle")return[];let l=e.getText(),c=e.offsetAt(t);a.requestSent=!0;let u=await Us(n,this.getKernelCompletion(l,c,n));if(b.debug(`Jupyter completion time: ${o.elapsedTime}`),a.cancelled=n.isCancellationRequested,a.completed=!n.isCancellationRequested,a.kernelStatusAfterRequest=this.kernel.status,s.requestDuration=n.isCancellationRequested?0:o.elapsedTime,n.isCancellationRequested)return[];if(((S=u==null?void 0:u.content)==null?void 0:S.status)!=="ok"||((P=(D=(_=u==null?void 0:u.content)==null?void 0:_.matches)==null?void 0:D.length)!=null?P:0)===0)return zte(this.kernel,s,a),[];let p={matches:u.content.matches,cursor:{start:u.content.cursor_start,end:u.content.cursor_end},metadata:u.content.metadata},f=p.metadata?p.metadata._jupyter_types_experimental:[];s.completionItems=p.matches.length,zte(this.kernel,s,a);let m={code:l,cursor:p.cursor,documentRef:new WeakRef(e),position:e.positionAt(p.cursor.start)},h=new Er.Range(e.positionAt(p.cursor.start),e.positionAt(p.cursor.end)),g=[];return Array.isArray(f)&&f.length>=p.matches.length&&f.every(M=>M&&typeof M.text=="string")?g=u.content.matches.map((M,x)=>{let A=f[x],j=A.type?Ute.get(A.type):Er.CompletionItemKind.Field,re=new Er.CompletionItem(M,j);return typeof A.start=="number"&&typeof A.end=="number"?re.range=new Er.Range(e.positionAt(A.start),e.positionAt(A.end)):re.range=h,re.insertText=A.text,re.sortText=nO(x),Gt(this.kernel.kernelConnectionMetadata)&&(M.startsWith("%")||M.startsWith("!"))&&(re.sortText=`ZZZ${re.sortText}`),this.previousCompletionItems.set(re,{...m,originalCompletionItem:JSON.parse(JSON.stringify(re))}),re}):g=p.matches.map((M,x)=>{let A=new Er.CompletionItem(M);return A.range=h,A.sortText=nO(x),Gt(this.kernel.kernelConnectionMetadata)&&(M.startsWith("%")||M.startsWith("!"))&&(A.sortText=`ZZZ${A.sortText}`),this.previousCompletionItems.set(A,{...m,originalCompletionItem:A}),A}),Gt(this.kernel.kernelConnectionMetadata)?VCe(i.triggerCharacter,this.allowStringFilterForPython,g,e,t):g}async resolveCompletionItem(e,t){var l;if(!e.range||!((l=this.kernel.session)!=null&&l.kernel))return e;let n=this.previousCompletionItems.get(e);if(!n)return e;let{documentRef:i,position:o,originalCompletionItem:s}=n,a=i.deref();return a?Gte(e,s,t,this.kernel,this.kernelId,this.monacoLanguage,a,o):e}async getKernelCompletion(e,t,n){var i;if((i=this.kernel.session)!=null&&i.kernel)return Gt(this.kernel.kernelConnectionMetadata)?this.getPythonKernelCompletion(e,t,n):Us(n,this.kernel.session.kernel.requestComplete({code:e,cursor_pos:t}))}async getPythonKernelCompletion(e,t,n){let i=`return get_ipython().kernel.do_complete("${Jx(e)}", ${t})`;return{content:await Mv(this.kernel,[i],n)}}},$te=new WeakMap,oO=new WeakMap;function zte(r,e,t){var o;let n=$te.get(r),i=((o=oO.get(r))==null?void 0:o.count)||0;e.duration>=hi.IntellisenseTimeout&&oO.set(r,{count:i+1,measures:e,properties:t}),e.timesExceededTimeout=i,n?n.elapsedTime>6e4&&(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n.reset(),oO.delete(r)):(J("DATASCIENCE.JUPYTER_KERNEL_CODE_COMPLETION",e,t),n=new St,$te.set(r,new St),oO.delete(r))}var M9=class extends Vr{constructor(t,n){super();this.kernel=t;this.notebookEditorProvider=n;this.cellCompletionProviders=new WeakMap;this.completionItemsSent=new WeakMap;this.monacoLanguage=lO(this.kernel);this.registerCompletionProvider(),this._register(Er.workspace.onDidChangeConfiguration(i=>{var o;if(i.affectsConfiguration("jupyter.enableKernelCompletions"))if(Qte(this.kernel.notebook.uri))this.completionProvider||this.registerCompletionProvider();else{(o=this.completionProvider)==null||o.dispose(),this.completionProvider=void 0;return}!i.affectsConfiguration("jupyter.completionTriggerCharacters")&&!i.affectsConfiguration("jupyter.pythonCompletionTriggerCharacters")||this.registerCompletionProvider()}))}registerCompletionProvider(){var n;if(!Qte(this.kernel.notebook.uri))return;let t=FCe(this.kernel);if(t.length===0){UCe(this.kernel);return}b.trace(`Registering Kernel Completion Provider from kernel ${ut(this.kernel.kernelConnectionMetadata)} for language ${this.monacoLanguage}`),this.allowStringFilterForPython=t.includes("'")||t.includes('"'),(n=this.completionProvider)==null||n.dispose(),this.completionProvider=void 0,this.completionProvider=Er.languages.registerCompletionItemProvider(this.monacoLanguage,this,...t)}dispose(){var t;super.dispose(),(t=this.completionProvider)==null||t.dispose()}async provideCompletionItems(t,n,i,o){if(this.notebookEditorProvider.findAssociatedNotebookDocument(t.uri)!==this.kernel.notebook)return[];let s=this.cellCompletionProviders.get(t);if(!s){let a=await Rt(this.kernel.kernelConnectionMetadata.id);s=new A9(a,this.kernel,this.monacoLanguage),this.cellCompletionProviders.set(t,s)}return s.allowStringFilterForPython=this.allowStringFilterForPython,s.provideCompletionItems(t,n,i,o).then(a=>(a.forEach(l=>this.completionItemsSent.set(l,s)),a))}async resolveCompletionItem(t,n){let i=this.completionItemsSent.get(t);return i?i.resolveCompletionItem(t,n):t}},Lm=class extends Vr{constructor(t){super();this.kernelCompletionProviders=new WeakMap;t.push(this)}activate(){let t=nt.instance.get(He);this._register(t.onDidStartKernel(async n=>{var a;if((a=n.session)!=null&&a.kernel&&Gt(n.kernelConnectionMetadata)&&n.session.kernel.requestComplete({code:"__file__.",cursor_pos:9}),!lO(n)||this.kernelCompletionProviders.has(n))return;let o=nt.instance.get(Wo),s=this._register(new M9(n,o));this.kernelCompletionProviders.set(n,s)})),this._register(t.onDidDisposeKernel(n=>{var i;(i=this.kernelCompletionProviders.get(n))==null||i.dispose()}))}};Lm=E([(0,aO.injectable)(),I(0,(0,aO.inject)(ie))],Lm);function lO(r){return Vc(cO(r))}function cO(r){let e="";switch(r.kernelConnectionMetadata.kind){case"connectToLiveRemoteKernel":e=r.kernelConnectionMetadata.kernelModel.language;break;case"startUsingRemoteKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;case"startUsingLocalKernelSpec":e=r.kernelConnectionMetadata.kernelSpec.language;break;default:e=r.kernelConnectionMetadata.kernelSpec.language;break}return(e||"").toLowerCase()}function Qte(r){return Er.workspace.getConfiguration("jupyter",r).get("enableKernelCompletions",!1)}function FCe(r){let e=Er.workspace.getConfiguration("jupyter",r.notebook.uri).get("completionTriggerCharacters");if(!e||typeof e!="object")return[];let t=cO(r),n=lO(r);return t in e?Array.isArray(e[t])?e[t]:[]:n in e?Array.isArray(e[n])?e[n]:[]:[]}function UCe(r){let e=cO(r),t=lO(r);e.toLowerCase()===t.toLowerCase()?b.warn(Er.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`)):b.warn(Er.l10n.t(`Kernel completions not enabled for '{0}'. 
To enable Kernel completion for this language please add the following setting 
jupyter.completionTriggerCharacters = {1}: [<List of characters that will trigger completions>]}. 
 or the following: 
jupyter.completionTriggerCharacters = {2}: [<List of characters that will trigger completions>]}. 
For more information please see https://aka.ms/vscodeJupyterCompletion`,ut(r.kernelConnectionMetadata),`{${e}`,`{${t}`))}function WCe(r,e){let t=r.indexOf('"'),n=r.indexOf("'"),i=r.lastIndexOf('"'),o=r.lastIndexOf("'"),s=t>=0?t:n,a=i>=0?i:o;return s>=0&&e.character>s&&e.character<=a}function VCe(r,e,t,n,i){let o=t,s=i.character===0?void 0:new Er.Range(i.line,i.character-1,i.line,i.character),l=(s?n.getText(s):void 0)===".",c=n.getWordRangeAtPosition(l||r==="."?new Er.Position(i.line,i.character-1):i),u=c&&s?c.union(s):void 0,p=n.lineAt(i.line).text,f=u?n.getText(u):p,m=f.endsWith(".")||l,h=e&&(r=="'"||r=='"'||WCe(p,i));return b.ci(`Jupyter completions filtering applied: ${h} on ${p}`),o=o.map((g,v)=>{let S=typeof g.label=="string"?g.label:g.label.label,_=typeof g.label=="string"?g.label:g.label.label;if(_.startsWith("%")||_.startsWith("!"))return{...g,sortText:`ZZZ${g.sortText}`};if(h)return g;let D=f?_.indexOf(f):-1,P,M,x;if(f&&m&&_.includes(f)){P=_.substring(_.indexOf(f)+(m?f.length:0)),M=_.substring(_.indexOf(f)+f.length);let A=(typeof g.label=="string"?g.label.length:g.label.label.length)-M.length;x=g.range&&"start"in g.range?new Er.Range(new Er.Position(g.range.start.line,g.range.start.character+A),g.range.end):g.range}if(!M&&D>0){P=_.substring(_.indexOf(f)+(m?f.length:0)),M=_.substring(_.indexOf(f)+f.length);let A=(typeof g.label=="string"?g.label.length:g.label.label.length)-M.length;x=g.range&&"start"in g.range?new Er.Range(new Er.Position(g.range.start.line,g.range.start.character+A),g.range.end):g.range}return P&&M&&x&&(g.label=P,S=M,g.insertText=M,g.filterText=m?`.${M}`:M,g.range=x,g.sortText=nO(v)),S.endsWith("/")?{...g,command:{command:"editor.action.triggerSuggest",title:""}}:(S.includes(" ")&&(S=S.replace(/\\ /g," "),typeof g.label=="string"?g.label=g.label.replace(/\\ /g," "):g.label.label=g.label.label.replace(/\\ /g," ")),h||!S.includes(".")&&!S.endsWith("/")?g:void 0)}).filter(g=>g!==void 0),b.ci(`Jupyter completions for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${t.map(g=>g.label).join(",")}`),b.ci(`Jupyter results for ${f} at pos ${i.line}:${i.character} with trigger: ${r}
   ${o.map(g=>g.label).join(",")}`),o}function Xte(r,e){r.addSingleton(We,rE),r.addSingleton(Lm,Lm),r.addBinding(Lm,We)}d();var iE=$(te());var Zte=require("vscode");var nE=class{constructor(e,t,n){this.extensionChecker=e;this.disposables=t;this.kernelProvider=n}activate(){this.extensionChecker.onPythonExtensionInstallationStatusChanged(this.onPythonExtensionInstallationStatusChanged,this,this.disposables)}async onPythonExtensionInstallationStatusChanged(e){e==="installed"&&this.anyKernelsAreActive()&&Zte.window.showInformationMessage(C.pythonExtensionInstalled,Ue.ok).then(y,y)}anyKernelsAreActive(){return this.kernelProvider.kernels.length>0}};nE=E([(0,iE.injectable)(),I(0,(0,iE.inject)(Eo)),I(1,(0,iE.inject)(ie)),I(2,(0,iE.inject)(He))],nE);d();var uO=$(te()),Nu=require("vscode");var jCe=/^\s*(from (?<fromImport>\w+)(?:\.\w+)* import \w+(?:, \w+)*(?: as \w+)?|import (?<importImport>\w+(?:, \w+)*)(?: as \w+)?)$/,BCe=1e3,HCe=bn(),oE=class{constructor(e,t=1e3){this.pendingChecks=new Iu;this.disposables=new kn;this.sentMatches=new Set;this.processedNotebookCells=new WeakMap;e.push(this.disposables),this.disposables.add(new Nu.Disposable(()=>me(this.pendingChecks.values()))),this.isTelemetryDisabled=k0(),this.disposables.add(Nu.workspace.onDidOpenNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Nu.workspace.onDidCloseNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave"))),this.disposables.add(Nu.workspace.onDidSaveNotebookDocument(i=>this.onOpenedOrClosedNotebookDocument(i,"onOpenCloseOrSave")));let n=this.disposables.add(new ic(t));this.disposables.add(Lr.onDidChangeNotebookCellExecutionState(i=>{n.trigger(()=>{i.state==2&&!this.isTelemetryDisabled&&this.checkNotebookCell(i.cell,"onExecution").catch(y)})},this)),this.disposables.add(N0(i=>this.isTelemetryDisabled=i))}activate(){Nu.workspace.notebookDocuments.forEach(e=>this.checkNotebookDocument(e,"onOpenCloseOrSave"))}getDocumentLines(e){let t=[];for(let n=0;n<Math.min(BCe,e.lineCount);n++){let i=e.lineAt(n);i.isEmptyOrWhitespace||t.push(i.text.trim())}return t}onOpenedOrClosedNotebookDocument(e,t){!br(e)||this.isTelemetryDisabled||this.scheduleCheck(e.uri,this.checkNotebookDocument.bind(this,e,t))}scheduleCheck(e,t){let n=this.pendingChecks.get(e);if(n&&(n.dispose(),this.pendingChecks.delete(e)),HCe)t();else{let i=setTimeout(t,5e3);this.pendingChecks.set(e,new Nu.Disposable(()=>clearTimeout(i)))}}async checkNotebookDocument(e,t){!br(e)||this.isTelemetryDisabled||await Promise.all(e.getCells().map(async n=>this.checkNotebookCell(n,t)))}async checkNotebookCell(e,t){if(!(!br(e.notebook)||e.kind!==Nu.NotebookCellKind.Code||e.document.languageId!==qe||this.processedNotebookCells.get(e)===e.document.version))try{this.processedNotebookCells.set(e,e.document.version);let n=e.notebook.notebookType===It?"notebook":"interactive";await this.sendTelemetryForImports(this.getDocumentLines(e.document),n,t)}catch(n){if(!Ji)throw n}}lookForImports(e){let t=[];try{for(let n of e){if(!n.includes("import")&&!n.includes("from"))continue;let i=n?jCe.exec(n):null;i!==null&&i.groups!==void 0&&(i.groups.fromImport!==void 0?t.push(i.groups.fromImport):i.groups.importImport!==void 0&&t.push(...i.groups.importImport.split(",").map(o=>o.trim())))}}catch(n){}return t}async sendTelemetryForImports(e,t,n){await Promise.all(this.lookForImports(e).map(async i=>{let o=`${i}_${t||""}_${n}`;if(this.sentMatches.has(o))return;this.sentMatches.add(o);let s=await Rt(i);J("HASHED_PACKAGE_NAME",void 0,{hashedNamev2:s,resourceType:t,when:n})}))}};oE=E([(0,uO.injectable)(),I(0,(0,uO.inject)(ie))],oE);d();var Qr=$(te()),rre=$(iv()),dt=require("vscode");d();var Ru=require("vscode");var dO=class{constructor(e,t,n,i,o){this.configService=e;this.agentCreator=t;this.requestCreator=n;this.serverUriStorage=i;this.disposables=o;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");let t=sE(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterConnectionInfo({url:t,isTokenEmpty:e.isTokenEmpty,disposables:n,validationErrorMessage:e.validationErrorMessage}).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(b.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&me(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async getJupyterConnectionInfo(e){let t,n,i,o,s=await this.needPassword(e.url);if(s||e.isTokenEmpty){if(s&&e.isTokenEmpty){let a=Ru.window.createInputBox();e.disposables.push(a),a.title=C.jupyterSelectPasswordTitle,a.placeholder=C.jupyterSelectPasswordPrompt,a.ignoreFocusOut=!0,a.password=!0,a.validationMessage=e.validationErrorMessage||"",a.show(),a.buttons=[Ru.QuickInputButtons.Back],o=await new Promise((l,c)=>{a.onDidTriggerButton(u=>{u===Ru.QuickInputButtons.Back&&c($e.back)},this,e.disposables),a.onDidChangeValue(()=>a.validationMessage="",this,e.disposables),a.onDidAccept(()=>l(a.value),this,e.disposables),a.onDidHide(()=>c($e.cancel),this,e.disposables)})}if(typeof o===void 0&&!o&&e.isTokenEmpty)throw new Ru.CancellationError;if(o||e.isTokenEmpty)if(t=await this.getXSRFToken(e.url,""),t){let a=await this.getSessionCookie(e.url,t,o||"");n=a.sessionCookieName,i=a.sessionCookieValue}else n="authservice_session",i=o,t=await this.getXSRFToken(e.url,`${n}=${i}`);else return{requiresPassword:s}}else return{requiresPassword:s};return t&&n&&(i||e.isTokenEmpty)?(J("DS_INTERNAL.GET_PASSWORD_SUCCESS"),{requestHeaders:{Cookie:`_xsrf=${t}; ${n}=${i||""}`,"X-XSRFToken":t},requiresPassword:s}):(J("DS_INTERNAL.GET_PASSWORD_FAILURE"),{requiresPassword:s})}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getXSRFToken(e,t){var a;let n,i,o=new URL("login?",sE(e)).toString();t!=""?(o=new URL("tree",sE(e)).toString(),i={Connection:"keep-alive",Cookie:t}):i={Connection:"keep-alive"};let s=await this.makeRequest(o,{method:"get",redirect:"manual",headers:i});if(s!==void 0&&s.ok){let l=this.getCookies(s);l.has("_xsrf")&&(n=(a=l.get("_xsrf"))==null?void 0:a.split(";")[0])}return n}async needPassword(e){let t=await this.makeRequest(sE(e),{method:"get",redirect:"follow",headers:{Connection:"keep-alive"}});if(t.status===200&&t.redirected){if(t.url.toLowerCase().includes("/login?"))return!0;if(t.url.toLowerCase().includes("/lab?"))return!1}let n=new URL("tree?",sE(e)).toString();return t=await this.makeRequest(n,{method:"get",redirect:"manual",headers:{Connection:"keep-alive"}}),t.status===404?(b.error(`Jupyter Server not found at ${e}, got 404 for ${n}`),!1):t.status!==200}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=C.jupyterSelfCertEnable,s=C.jupyterSelfCertClose,a=await Ru.window.showErrorMessage(C.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,Ru.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}async getSessionCookie(e,t,n){let i,o,s=new URLSearchParams;s.append("_xsrf",t),s.append("password",n);let a=await this.makeRequest(new URL("login?",sE(e)).toString(),{method:"post",headers:{Cookie:`_xsrf=${t}`,Connection:"keep-alive","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a.status===302){let l=this.getCookies(a);l.size>0&&(i=l.entries().next().value[0],o=l.entries().next().value[1])}return{sessionCookieName:i,sessionCookieValue:o}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function sE(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}d();var fO=require("vscode");var pO=class{constructor(e,t,n,i,o,s,a){this.multiStepFactory=e;this.asyncDisposableRegistry=t;this.configService=n;this.agentCreator=i;this.requestCreator=o;this.serverUriStorage=s;this.disposables=a;this.savedConnectInfo=new Map;this.serverUriStorage.onDidRemove(this.onDidRemoveServers,this,this.disposables)}async getPasswordConnectionInfo(e){if(!e.url||e.url.length<1)throw new Error("Invalid URL");if(!await this.isJupyterHub(e.url))throw new Error("Not a Jupyter Hub Url");let t=ere(e.url),n=e.disposables||[],i=!Array.isArray(e.disposables),o=this.savedConnectInfo.get(e.handle);return o||(o=this.getJupyterHubConnectionInfo(t,e.validationErrorMessage).then(s=>((!s||s.requiresPassword&&Object.keys(s).length===1)&&(b.warn(`Password for ${t} was invalid.`),this.savedConnectInfo.delete(e.handle)),s)),o.catch(()=>this.savedConnectInfo.delete(e.handle)),o.finally(()=>{i&&me(n)}).catch(y),this.savedConnectInfo.set(e.handle,o)),o}async isJupyterHub(e){try{if(e.toLowerCase().includes("/user/")&&e.includes("token="))return!1;if(e.toLowerCase().includes("/user/")&&!e.includes("token="))return!0;let t=await this.makeRequest(new URL("hub/api",ere(e)).toString(),{method:"get"});if(t.status!==200)return!1;try{let n=await t.json();return b.trace(`JupyterHub version is ${n&&n.version} for url ${e}`),n&&n.version}catch(n){}return!1}catch(t){return b.debug(`Error in detecting whether url is isJupyterHub: ${t}`),!1}}async getJupyterHubConnectionInfo(e,t){try{let n=await this.getUserNameAndPassword(t);if(n.username||n.password){let i=await this.getJupyterHubConnectionInfoFromLogin(e,n.username,n.password);if(i){let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromLogin":"gotResponseFromLogin";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}else{J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"emptyResponseFromLogin"}),i=await this.getJupyterHubConnectionInfoFromApi(e,n.username,n.password);let o=Object.keys(i||{}).length===0,s=o?"emptyResponseFromApi":"gotResponseFromApi";J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:o,info:s})}return i}return J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!1,info:"passwordNotRequired"}),{requiresPassword:!1}}catch(n){throw J("DS_INTERNAL.JUPYTER_HUB_PASSWORD",void 0,{failed:!0,info:"failure"}),n}}async getJupyterHubConnectionInfoFromLogin(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=new URLSearchParams;s.append("username",t||""),s.append("password",n||"");let a=await this.makeRequest(`${o}/hub/login?next=`,{method:"POST",headers:{Connection:"keep-alive",Referer:`${o}/hub/login`,"content-type":"application/x-www-form-urlencoded;charset=UTF-8"},body:s.toString(),redirect:"manual"});if(a&&a.status===302){let c=[...this.getCookies(a).entries()].reduce((u,p)=>`${u};${p[0]}=${p[1]}`,"");if(a=await this.makeRequest(`${o}/hub/api/users/${t}/tokens`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),a.ok&&a.status===200){let u=await a.json();if(u&&u.token&&u.id)return await this.makeRequest(`${o}/hub/api/users/${t}/server`,{method:"POST",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}),this.asyncDisposableRegistry.push({dispose:async()=>{this.makeRequest(`${o}/hub/api/users/${t}/tokens/${u.id}`,{method:"DELETE",headers:{Connection:"keep-alive",Cookie:c,Referer:`${o}/hub/login`}}).catch(y)}}),{requestHeaders:{},remappedBaseUrl:`${o}/user/${t}`,remappedToken:u.token,requiresPassword:!0}}}}async getJupyterHubConnectionInfoFromApi(e,t,n){let i=new URL(e),o=`${i.protocol}//${i.host}`,s=await this.makeRequest(`${o}/hub/api/authorizations/token`,{method:"POST",headers:{Connection:"keep-alive","content-type":"application/json;charset=UTF-8"},body:`{ "username": "${t||""}", "password": "${n||""}"  }`,redirect:"manual"});if(s.ok&&s.status===200){let a=await s.json();if(a&&a.user&&a.user.server&&a.token)return{requestHeaders:{},remappedBaseUrl:`${o}${a.user.server}`,remappedToken:a.token,requiresPassword:!0}}return{requiresPassword:!1}}addAllowUnauthorized(e,t,n){if(e.startsWith("https")&&t&&this.agentCreator){let i=this.agentCreator.createHttpRequestAgent();return{...n,agent:i}}return n}async getUserNameAndPassword(e){let t=this.multiStepFactory.create(),n={username:"",password:"",validationMessage:e};return await t.run(this.getUserNameMultiStep.bind(this),n),n}async getUserNameMultiStep(e,t){if(t.username=await e.showInputBox({title:C.jupyterSelectUserAndPasswordTitle,prompt:C.jupyterSelectUserPrompt,validate:this.validateUserNameOrPassword,validationMessage:t.validationMessage,value:""}),t.username)return this.getPasswordMultiStep.bind(this)}async validateUserNameOrPassword(e){}async getPasswordMultiStep(e,t){t.password=await e.showInputBox({title:C.jupyterSelectUserAndPasswordTitle,prompt:C.jupyterSelectPasswordPrompt,validate:this.validateUserNameOrPassword,value:"",password:!0})}async makeRequest(e,t){let n=this.configService.getSettings(void 0).allowUnauthorizedRemoteConnection;try{return await this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!!n,t))}catch(i){if(i.message.indexOf("reason: self signed certificate")>=0){let o=C.jupyterSelfCertEnable,s=C.jupyterSelfCertClose,a=await fO.window.showErrorMessage(C.jupyterSelfCertFail(i.message),{modal:!0},o,s);if(a===o)return J("DATASCIENCE.SELFCERTSMESSAGEENABLED"),await this.configService.updateSetting("allowUnauthorizedRemoteConnection",!0,void 0,fO.ConfigurationTarget.Workspace),this.requestCreator.getFetchMethod()(e,this.addAllowUnauthorized(e,!0,t));a===s&&J("DATASCIENCE.SELFCERTSMESSAGECLOSE")}throw i}}getCookies(e){let t=new Map,i=(e.headers.raw?e.headers.raw():e.headers)["set-cookie"];return i&&i.forEach(o=>{let s=o.substring(0,o.indexOf("=")),a=o.substring(o.indexOf("=")+1);t.set(s,a)}),t}onDidRemoveServers(e){e.forEach(t=>{t.id.startsWith("_builtin")&&this.savedConnectInfo.delete(t.handle)})}};function ere(r){let e=r;return e[e.length-1]!=="/"&&(e=`${e}/`),e}var mO="user-jupyter-server-uri-list-version2";var JCe="DataScienceAllowInsecureConnections",aE=class extends Vr{constructor(t,n,i,o,s,a,l,c,u,p,f,m,h,g=JO){super();this.jupyterConnection=n;this.context=f;this.fs=m;this.jupyterServerProviderRegistry=h;this.id=g;this.extensionId=Ye;this.documentation=dt.Uri.parse("https://aka.ms/vscodeJuptyerExtKernelPickerExistingServer");this.displayName=C.UserJupyterServerUrlProviderDisplayName;this.detail=C.UserJupyterServerUrlProviderDetail;this._onDidChangeHandles=this._register(new dt.EventEmitter);this.onDidChangeHandles=this._onDidChangeHandles.event;this._onDidChangeServers=this._register(new dt.EventEmitter);this.onDidChangeServers=this._onDidChangeServers.event;a.push(this),this.newStorage=new $D(i),this.secureConnectionValidator=new YD(s),this.jupyterServerUriInput=new GD(p),this.jupyterServerUriDisplayName=new O9,this.jupyterPasswordConnect=new dO(t,u,p,o,a),this.jupyterHubPasswordConnect=new pO(l,c,t,u,p,o,a)}activate(){let t=this._register(this.jupyterServerProviderRegistry.createJupyterServerCollection(Ye,this.id,this.displayName,this));t.commandProvider=this,t.documentation=this.documentation,this._register(this.onDidChangeHandles(()=>this._onDidChangeServers.fire(),this)),this._register(dt.commands.registerCommand("dataScience.ClearUserProviderJupyterServerCache",async()=>{await Promise.all([this.newStorage.clear().catch(y),this.fs.delete(dt.Uri.joinPath(this.context.globalStorageUri,PS)).catch(y)]),this._onDidChangeHandles.fire()})),this.initializeServers().catch(y)}async resolveJupyterServer(t,n){let i=await this.getServerUri(t.id);return{...t,connectionInformation:{id:t.id,label:t.label,baseUrl:dt.Uri.parse(i.baseUrl),token:i.token,headers:i.authorizationHeader,mappedRemoteNotebookDir:i.mappedRemoteNotebookDir?dt.Uri.file(i.mappedRemoteNotebookDir):void 0}}}async handleCommand(t,n){let i=new dt.CancellationTokenSource;this._register(new dt.Disposable(()=>{i.cancel(),i.dispose()}));try{let o="url"in t?t.url:void 0,s=await this.captureRemoteJupyterUrl(i.token,o);if(!s||s===$e.cancel)throw new dt.CancellationError;if(s&&s instanceof $e)return;let l=(await this.provideJupyterServers(i.token)).find(c=>c.id===s);if(!l)throw new Error(`Server ${s} not found`);return l}catch(o){if(o instanceof dt.CancellationError)throw o;b.error("Failed to select a Jupyter Server",o);return}finally{i.cancel(),i.dispose()}}async provideCommands(t,n){let i="";try{t=(t||"").trim(),["http:","https:"].includes(new URL(t.trim()).protocol.toLowerCase())&&(i=t)}catch(o){}return i?[{label:C.connectToToTheJupyterServer(i),url:i}]:[{label:C.jupyterSelectUriCommandLabel,canBeAutoSelected:!0}]}async provideJupyterServers(t){return await this.initializeServers(),(await this.newStorage.getServers(!1)).map(i=>({id:i.handle,label:i.serverInfo.displayName}))}async removeJupyterServer(t){await this.initializeServers(),await this.newStorage.remove(t.id),this._onDidChangeHandles.fire()}initializeServers(){if(this._cachedServerInfoInitialized)return this._cachedServerInfoInitialized;let t=ke();return this._cachedServerInfoInitialized=t.promise,(async()=>{this.newStorage.getServers(!1).catch(y),t.resolve()})().then(()=>t.resolve(),n=>t.reject(n)).catch(y),this._cachedServerInfoInitialized}recommendInstallingJupyterHubExtension(){if(!dt.workspace.getConfiguration("jupyter").get("bypassJupyterHubExtensionCheck"))throw dt.extensions.getExtension(Bv)?dt.window.showInformationMessage(C.useJupyterHubExtension,{modal:!0,detail:C.useJupyterHubExtensionDetail}).then(()=>{dt.commands.executeCommand("notebook.selectKernel",{notebookEditor:dt.window.activeNotebookEditor}).then(y,y)},y):dt.window.showInformationMessage(C.installJupyterHub,{modal:!0,detail:C.installJupyterHubDetail},Ue.install,Ue.moreInfo).then(t=>{t===Ue.install?dt.commands.executeCommand("workbench.extensions.installExtension",Bv,{context:{skipWalkthrough:!0}}).then(y,y):t===Ue.moreInfo&&dt.env.openExternal(dt.Uri.parse("https://marketplace.visualstudio.com/items?itemName=ms-toolsai.jupyter-hub")).then(y,y)},y),new dt.CancellationError}async captureRemoteJupyterUrl(t,n=""){await this.initializeServers();let i=[],o={baseUrl:"",displayName:"",token:""},s="",a=!1,l=!1,c,u="Get Url",p="Get Url",f=n,m=!1;if(n){let h=await this.jupyterServerUriInput.parseUserUriAndGetValidationError(n);typeof h.validationError=="string"?(s=h.validationError,u="Get Url"):(m=!0,o=h.jupyterServerUri,u="Check Passwords")}try{let h=!1,g=!1;for(;;)try{if(c=(0,rre.default)(),u==="Get Url"){m=!1,u="Check Passwords",p=void 0;let S=s;s="";let _=await this.jupyterServerUriInput.getUrlFromUser(f||n,S,i);o=_.jupyterServerUri,f=_.url}if(t.isCancellationRequested)return $e.cancel;let v=[];if(u==="Check Passwords"){u="Check Insecure Connections",p=m&&n?void 0:"Get Url";try{let S=s;s="",h=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),h&&this.recommendInstallingJupyterHubExtension();let _=h?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:c,displayName:o.displayName,validationErrorMessage:S,disposables:v}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:c,validationErrorMessage:S,disposables:v});a=_.requiresPassword,o.authorizationHeader=_.requestHeaders,g=!1}catch(S){if(g=!1,S instanceof dt.CancellationError||S==$e.back||S==$e.cancel)throw S;if(!Fs.isSelfCertsError(S)){if(!eu.isSelfCertsExpiredError(S)){Ov(c,o.baseUrl,h,"ConnectionFailure");let _=/(https?:\/\/[^\s]+)/g,D=(S.message||S.toString()).replace(_,P=>`[${P}](${P})`);if(s=(Pn()?C.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:C.remoteJupyterConnectionFailedWithoutServerWithError)(D),o.token.length>0&&(S.message||"").toLowerCase()==="Failed to fetch".toLowerCase())g=!0;else{u="Get Url";continue}}}}finally{v.forEach(S=>this._register(S))}}if(t.isCancellationRequested)return $e.cancel;if(u==="Check Insecure Connections"&&(u="Verify Connection",p=a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),!a&&o.token.length===0&&new URL(o.baseUrl).protocol.toLowerCase()==="http:"&&(l=!0,me(v),!await this.secureConnectionValidator.promptToUseInsecureConnections())))return Ov(c,o.baseUrl,h,"InsecureHTTP"),$e.cancel;if(t.isCancellationRequested)return $e.cancel;if(u==="Verify Connection")try{u="Get Display Name",await this.jupyterConnection.validateRemoteUri({id:this.id,handle:c,extensionId:Ye},o,!0)}catch(S){if(b.warn("Uri verification error",S),g&&s){u="Get Url";continue}if(S instanceof dt.CancellationError||S==$e.back||S==$e.cancel)throw S;if(Fs.isSelfCertsError(S)){s=C.jupyterSelfCertFailErrorMessageOnly,u="Get Url",Ov(c,o.baseUrl,h,"SelfCert");continue}else if(eu.isSelfCertsExpiredError(S)){s=C.jupyterSelfCertExpiredErrorMessageOnly,u="Get Url",Ov(c,o.baseUrl,h,"ExpiredCert");continue}else if(a&&o.token.length===0){s=C.passwordFailure,u="Check Passwords",Ov(c,o.baseUrl,h,"AuthFailure");continue}else{Ov(c,o.baseUrl,h,"ConnectionFailure");let _=/(https?:\/\/[^\s]+)/g,D=(S.message||S.toString()).replace(_,P=>`[${P}](${P})`);s=(Pn()?C.remoteJupyterConnectionFailedWithoutServerWithErrorWeb:C.remoteJupyterConnectionFailedWithoutServerWithError)(D),u="Get Url";continue}}finally{me(v)}if(t.isCancellationRequested)return $e.cancel;if(u==="Get Display Name"){me(v),p=l?"Check Insecure Connections":a&&o.token.length===0?"Check Passwords":"Get Url",p==="Get Url"&&(p=m&&n?void 0:"Get Url"),o.displayName=await this.jupyterServerUriDisplayName.getDisplayName(c,o.displayName||new URL(o.baseUrl).hostname);break}}catch(v){if(v instanceof dt.CancellationError||v===$e.cancel)return $e.cancel;if(v===$e.back){if(!p)return $e.back;u=p;continue}throw v}return t.isCancellationRequested?$e.cancel:(await this.addNewServer({handle:c,uri:f,serverInfo:o}),aA({extensionId:this.extensionId,id:this.id,handle:c},o.displayName),Ov(c,o.baseUrl,h),c)}catch(h){if(h instanceof dt.CancellationError)return $e.cancel;throw h}finally{me(i)}}async addNewServer(t){await this.newStorage.add(t),this._onDidChangeHandles.fire()}async getServerUri(t){let i=(await this.newStorage.getServers(!1)).find(c=>c.handle===t);if(!i)throw new Error("Server not found");let o=i.serverInfo,s=this.jupyterServerUriDisplayName.displayNamesOfHandles.get(t);s&&(o.displayName=s);let a=await this.jupyterHubPasswordConnect.isJupyterHub(o.baseUrl),l=Object.assign({},o);try{let c=a?await this.jupyterHubPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,handle:t,displayName:o.displayName}):await this.jupyterPasswordConnect.getPasswordConnectionInfo({url:o.baseUrl,isTokenEmpty:o.token.length===0,handle:t});l=Object.assign({},o,{authorizationHeader:c.requestHeaders||o.authorizationHeader}),a&&c.remappedBaseUrl&&(l.baseUrl=c.remappedBaseUrl),a&&c.remappedToken&&(l.token=c.remappedToken)}catch(c){b.error("Failed to validate Password info",c)}return l}};aE=E([(0,Qr.injectable)(),I(0,(0,Qr.inject)(Me)),I(1,(0,Qr.inject)(vn)),I(2,(0,Qr.inject)($x)),I(3,(0,Qr.inject)(hr)),I(4,(0,Qr.inject)(_t)),I(4,(0,Qr.named)(sr)),I(5,(0,Qr.inject)(ie)),I(6,(0,Qr.inject)(J1)),I(7,(0,Qr.inject)(Ya)),I(8,(0,Qr.inject)(c1)),I(8,(0,Qr.optional)()),I(9,(0,Qr.inject)(Qg)),I(10,(0,Qr.inject)(st)),I(11,(0,Qr.inject)(xt)),I(12,(0,Qr.inject)(ur)),I(13,(0,Qr.optional)()),I(13,(0,Qr.inject)(Date.now().toString()))],aE);var GD=class{constructor(e){this.requestCreator=e}async getUrlFromUser(e,t="",n){if(!e&&!IP)try{let s=await dt.env.clipboard.readText(),a=s.trim().startsWith("https://github.com/")?void 0:dt.Uri.parse(s.trim(),!0);e=s&&a&&a.scheme.toLowerCase().startsWith("http")?s:""}catch(s){e=""}let i=dt.window.createInputBox();n.push(i),i.title=C.jupyterSelectUriInputTitle,i.placeholder=C.jupyterSelectUriInputPlaceholder,i.value=e,i.validationMessage=t,i.buttons=[dt.QuickInputButtons.Back],i.ignoreFocusOut=!0,i.show();let o=ke();return i.onDidChangeValue(()=>i.validationMessage="",this,n),i.onDidHide(()=>o.reject($e.cancel),this,n),i.onDidTriggerButton(s=>{s===dt.QuickInputButtons.Back&&o.reject($e.back)},this,n),i.onDidAccept(async()=>{let s=await this.parseUserUriAndGetValidationError(i.value);if(typeof s.validationError=="string"){i.validationMessage=s.validationError;return}o.resolve(s)}),o.promise}async parseUserUriAndGetValidationError(e){let t=e.trim().replace(/\/(lab|tree)(\??)$/,""),n=L9(t,"");return n?(n.baseUrl=await qCe(t,this.requestCreator)||n.baseUrl,!t.toLowerCase().startsWith("http:")&&!t.toLowerCase().startsWith("https:")?{validationError:C.jupyterSelectURIMustBeHttpOrHttps}:{jupyterServerUri:n,url:t,validationError:void 0}):{validationError:C.jupyterSelectURIInvalidURI}}};GD=E([I(0,(0,Qr.inject)(Qg))],GD);async function qCe(r,e){var t;try{if(r=((t=L9(r,""))==null?void 0:t.baseUrl)||r,new URL(r).pathname==="/")return r;let n=r.indexOf("token=")>0?r.substring(0,r.indexOf("token=")):r,s=(await e.getFetchMethod()(n,{method:"GET",redirect:"manual"})).headers.get("location");if(s&&s.includes("login?"))return s.substring(0,s.indexOf("login?"))}catch(n){b.debug("Unable to identify the baseUrl of the Jupyter Server",n)}}function Ov(r,e,t,n){e=e.trim().toLowerCase();let i=qt({handle:r,extensionId:Ye,id:JO});Promise.all([Rt(e.toLowerCase()),Rt(i.toLowerCase())]).then(([o,s])=>{J("DATASCIENCE.ENTER_REMOTE_JUPYTER_URL",void 0,{serverIdHash:s,failed:!!n,baseUrlHash:o,isJupyterHub:t,isLocalHost:["localhost","127.0.0.1","::1"].includes(new URL(e).hostname),reason:n})}).catch(o=>b.error(`Failed to hash remote url ${e}`,o))}var O9=class{constructor(){this.displayNamesOfHandles=new Map}async getDisplayName(e,t){let n=[];try{let i=dt.window.createInputBox();n.push(i),i.ignoreFocusOut=!0,i.title=C.jupyterRenameServer,i.value=t,i.placeholder=C.jupyterServerUriDisplayNameInputPlaceholder,i.buttons=[dt.QuickInputButtons.Back],i.show();let o=ke();return n.push(i.onDidHide(()=>o.reject($e.cancel))),i.onDidTriggerButton(s=>{s===dt.QuickInputButtons.Back&&o.reject($e.back)},this,n),i.onDidAccept(()=>{let s=i.value.trim()||t;this.displayNamesOfHandles.set(e,s),o.resolve(s)},this,n),await o.promise}finally{me(n)}}},YD=class{constructor(e){this.globalMemento=e}async promptToUseInsecureConnections(){if(this.globalMemento.get(JCe,!1))return!0;let e=[],t=ke();try{let n=dt.window.createQuickPick();return e.push(n),n.canSelectMany=!1,n.ignoreFocusOut=!0,n.title=C.insecureSessionMessage,n.buttons=[dt.QuickInputButtons.Back],n.items=[{label:Ue.bannerLabelYes},{label:Ue.bannerLabelNo}],n.show(),e.push(n.onDidHide(()=>t.reject($e.cancel))),n.onDidTriggerButton(i=>{i===dt.QuickInputButtons.Back&&t.reject($e.back)},this,e),n.onDidAccept(()=>t.resolve(n.selectedItems.some(i=>i.label===Ue.bannerLabelYes)),this,e),await t.promise}finally{me(e)}}};YD=E([I(0,(0,Qr.inject)(_t)),I(0,(0,Qr.named)(sr))],YD);function L9(r,e){if(!r.startsWith(rt.REMOTE_URI))try{let t=new URL(r);return{baseUrl:`${t.protocol}//${t.host}${t.pathname==="/lab"||t.pathname==="/tree"?"":t.pathname}`,token:t.searchParams.get("token")||"",displayName:e||t.hostname}}catch(t){b.error(`Failed to parse URI ${r}`,t);return}}function tre(r){return r.map(e=>({handle:e.handle,uri:e.uri,displayName:e.serverInfo.displayName}))}function GCe(r){let e=[];return r.forEach(t=>{let n=L9(t.uri,t.displayName);n&&e.push({handle:t.handle,uri:t.uri,serverInfo:n})}),e}var $D=class{constructor(e){this.encryptedStorage=e;this.updatePromise=Promise.resolve()}async getServers(e){if(this.servers&&!e)return this.servers;let t=await this.encryptedStorage.retrieve(hi.JupyterServerRemoteLaunchService,mO);if(!t||t==="[]")return[];try{return this.servers=GCe(JSON.parse(t))}catch(n){return[]}}async add(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e.handle).concat(e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).concat(e);this.servers=t,await this.encryptedStorage.store(hi.JupyterServerRemoteLaunchService,mO,JSON.stringify(tre(t)))}).catch(y))}async remove(e){this.servers&&(this.servers=this.servers.filter(t=>t.handle!==e)),await(this.updatePromise=this.updatePromise.then(async()=>{let t=(await this.getServers(!0)).filter(n=>n.handle!==e);return this.servers=t,this.encryptedStorage.store(hi.JupyterServerRemoteLaunchService,mO,JSON.stringify(tre(t)))}).catch(y))}async clear(){this.servers=[],await(this.updatePromise=this.updatePromise.then(async()=>{this.servers=[],await this.encryptedStorage.store(hi.JupyterServerRemoteLaunchService,mO,void 0)}).catch(y))}};$D=E([I(0,(0,Qr.inject)($x))],$D);d();var zD=$(te()),cE=require("vscode");var lE=class extends Vr{constructor(t,n){super();this.uriProviderRegistration=t;this.serverUriStorage=n;this.handleMappings=new Map;this._onDidChangeHandles=this._register(new cE.EventEmitter);this.extensionId=Ye;this.id=aP;this.displayName="Jupyter Server for Testing";this.onDidChangeServers=this._onDidChangeHandles.event}async provideJupyterServers(t){return Array.from(this.handleMappings.values()).map(n=>n.server)}async resolveJupyterServer(t,n){return t}activate(){this._register(this.uriProviderRegistration.createJupyterServerCollection(Ye,this.id,this.displayName,this)),this._register(cE.commands.registerCommand("jupyter.selectjupyteruri",this.selectJupyterUri,this))}async selectJupyterUri(t){var c;b.info(`Setting Jupyter Server URI to remote: ${t}`);let n=t.toString(!0),i=new URL(n),o=cE.Uri.parse(`${i.protocol}//${i.host}${i.pathname==="/lab"?"":i.pathname}`),s=(c=i.searchParams.get("token"))!=null?c:"",a=await qa(t.toString(!0),"SHA-1"),l={label:this.displayName,id:a,connectionInformation:{baseUrl:o,token:s}};this.handleMappings.set(a,{uri:t,server:l}),await this.serverUriStorage.add({id:this.id,handle:a,extensionId:Ye}),this._onDidChangeHandles.fire()}};lE=E([(0,zD.injectable)(),I(0,(0,zD.inject)(ur)),I(1,(0,zD.inject)(hr))],lE);d();var hO=$(te());var QD=require("vscode");var uE=class{constructor(e){this.disposables=e}activate(){this.registerCommandsIfTrusted()}dispose(){this.disposables.forEach(e=>e.dispose())}registerCommandsIfTrusted(){QD.workspace.isTrusted&&this.registerCommand(Q.ContinueEditSessionInCodespace,this.continueEditSessionInCodespace)}registerCommand(e,t){let n=QD.commands.registerCommand(e,t,this);this.disposables.push(n)}async continueEditSessionInCodespace(){await QD.commands.executeCommand("_workbench.editSessions.actions.continueEditSession.github.codespaces.continueEditSessionInCodespaceWithJupyterServer")}};uE=E([(0,hO.injectable)(),I(0,(0,hO.inject)(ie))],uE);d();var nre=$(te());var ire=require("vscode");var dE=class{activate(){this.eagerlyActivateOtherExtensions().catch(y)}async eagerlyActivateOtherExtensions(){await Promise.all(ire.extensions.all.filter(e=>{var t,n;return(n=(t=e.packageJSON)==null?void 0:t.contributes)==null?void 0:n.pythonRemoteServerProvider}).map(e=>e.isActive?Promise.resolve():e.activate().then(y,y)))}};dE=E([(0,nre.injectable)()],dE);d();var gO=$(te()),ore=require("vscode");var pE=class{constructor(e){this.uriStorage=e}activate(){ore.commands.registerCommand("jupyter.getUsedAzMLServerHandles",()=>{let e=[];return this.uriStorage.all.forEach(n=>{n.provider.extensionId.toLowerCase()==="ms-toolsai.vscode-ai".toLowerCase()&&e.push(n.provider)}),e})}};pE=E([(0,gO.injectable)(),I(0,(0,gO.inject)(hr))],pE);d();var up=require("vscode");var sre=$(te());var fE=class{activate(){let e=nt.instance.get(ie),t=new kn;e.push(t),e.push(up.commands.registerCommand("jupyter.manageAccessToKernels",()=>YCe(t)))}};fE=E([(0,sre.injectable)()],fE);async function YCe(r){let e=await Tz(),t=[];Array.from(e.entries()).forEach(([s])=>{var l,c;let a=(c=(l=up.extensions.getExtension(s))==null?void 0:l.packageJSON)==null?void 0:c.displayName;a&&t.push({label:a,description:s,extensionId:s})});let n=[];r.add({dispose:()=>{n=me(n)}});let i=up.window.createQuickPick();i.title=up.l10n.t("Manage Access To Jupyter Kernels"),i.placeholder=up.l10n.t("Choose which extensions can access Jupyter Kernels"),i.items=t,i.selectedItems=t.filter(s=>e.get(s.extensionId)===!0),i.canSelectMany=!0,i.ignoreFocusOut=!1;let o=!1;n.push(i),i.show(),await Promise.race([vx(i.onDidAccept,void 0,n).then(()=>o=!0),vx(i.onDidHide,void 0,n)]),o&&(await kz(i.selectedItems.map(s=>s.extensionId)),n=me(n))}d();var cre=require("vscode");d();var vO=class{constructor(){this.cache=new Map;this.executionCount=0}getResults(e,t){return this.executionCount!==e&&(this.cache.clear(),this.executionCount=e),this.cache.get(t)}setResults(e,t,n){if(this.executionCount<e)this.cache.clear(),this.executionCount=e;else if(this.executionCount>e)return;this.cache.set(t,n)}},are=vO,lre=vO;var Lv=$(te());var mE=class{constructor(e,t){this.variables=e;this.kernelProvider=t;this.variableResultCache=new are;this.variableSummaryCache=new lre;this.runningKernels=new Set;this._onDidChangeVariables=new cre.EventEmitter;this.onDidChangeVariables=this._onDidChangeVariables.event;this.kernelProvider.onKernelStatusChanged(this.onKernelStatusChanged,this)}onKernelStatusChanged({kernel:e}){if("variableProvider"in e.controller&&e.controller.variableProvider!==this)return;let t=e.notebook.uri.toString(),n=this.runningKernels.has(t);e.status==="idle"&&!n?this.runningKernels.add(t):e.status!=="busy"&&e.status!=="idle"&&n&&(this.runningKernels.delete(t),this._onDidChangeVariables.fire(e.notebook))}_getVariableResultCacheKey(e,t,n){let i="",o=t;return o&&(i=`${o.name}.${o.propertyChain.join(".")}[[${n}`),`${e}:${i}`}async*provideVariables(e,t,n,i,o){if(o.isCancellationRequested)return;let s=this.kernelProvider.get(e);if(!s||s.status==="dead"||s.status==="terminating")return;let a=this.kernelProvider.getKernelExecution(s).executionCount,l=this._getVariableResultCacheKey(e.uri.toString(),t,i),c=this.variableResultCache.getResults(a,l);if(t){let u=t;if(!c&&u.getChildren)c=(await u.getChildren(i,o)).map(f=>this.createVariableResult(f,s)),this.variableResultCache.setResults(a,l,c);else if(!c)return;for(let p of c)yield p;if(n===2&&u.count&&c.length>0&&u.count>i+c.length)for await(let p of this.provideVariables(e,t,n,i+c.length,o))yield p}else{c||(c=(await this.variables.getAllVariableDiscriptions(s,void 0,i,o)).map(p=>this.createVariableResult(p,s)),this.variableResultCache.setResults(a,l,c));for(let u of c)yield u}}_getVariableSummaryCacheKey(e,t){return`${e}:${t.name}`}async*provideVariablesWithSummarization(e,t,n,i,o){var l;let s=this.kernelProvider.get(e),a=this.provideVariables(e,t,n,i,o);for await(let c of a)if(s&&s.status!=="dead"&&s.status!=="terminating"){let u=this._getVariableSummaryCacheKey(e.uri.toString(),c.variable),p=this.kernelProvider.getKernelExecution(s).executionCount,f=this.variableSummaryCache.getResults(p,u);f==null&&c.variable.type==="pandas.core.frame.DataFrame"&&(f=await this.variables.getVariableValueSummary({name:c.variable.name,value:c.variable.value,supportsDataExplorer:!1,type:(l=c.variable.type)!=null?l:"",size:0,count:0,shape:"",truncated:!0},s,o),this.variableSummaryCache.setResults(p,u,f!=null?f:null)),yield{hasNamedChildren:c.hasNamedChildren,indexedChildrenCount:c.indexedChildrenCount,variable:{name:c.variable.name,value:c.variable.value,expression:c.variable.expression,type:c.variable.type,language:c.variable.language,summary:f!=null?f:""}}}}createVariableResult(e,t){var s;let n=(s=e.count)!=null?s:0,i=!!e.hasNamedChildren,o={getChildren:(a,l)=>this.getChildren(o,a,t,l),expression:$Ce(e.root,e.propertyChain),...e};return{variable:o,hasNamedChildren:i,indexedChildrenCount:n}}async getChildren(e,t,n,i){let o=e;return await this.variables.getAllVariableDiscriptions(n,o,t,i)}};mE=E([(0,Lv.injectable)(),I(0,(0,Lv.inject)(Bi)),I(0,(0,Lv.named)(rt.KERNEL_VARIABLES)),I(1,(0,Lv.inject)(He))],mE);function $Ce(r,e){let t=r;for(let n of e)typeof n=="string"?t+=`.${n}`:t+=`[${n}]`;return t}d();var dp=$(te()),yO=require("vscode");var zCe=/Type:\s*(\w+)/,QCe=/Value:\s*(.*)/,XCe=/String form:\s*([\s\S]+?)\n/,ZCe=/Docstring:\s*(.*)/,ewe=/Length:\s+(.*)/,twe=/^\s+\[(\d+) rows x (\d+) columns\]/m,rwe=new Set(["DataFrame","list","dict","ndarray","Series","Tensor","EagerTensor","DataArray"]),hE=class{constructor(e,t,n,i){this.configService=e;this.disposables=n;this.kernelProvider=i;this.variableRequesters=new Map;this.cachedVariables=new Map;this.refreshEventEmitter=new yO.EventEmitter;this.variableRequesters.set(qe,t)}get refreshRequired(){return this.refreshEventEmitter.event}async getAllVariableDiscriptions(e,t,n,i){let o=Zc(e.kernelConnectionMetadata)||qe,s=this.variableRequesters.get(o);return s?s.getAllVariableDiscriptions(e,t,n,i):[]}async getVariables(e,t){return this.getVariablesBasedOnKernel(t,e)}async getMatchingVariable(e,t,n){let i=this.cachedVariables.get(t.uri.toString());if(i){let o=i.variables.find(s=>s.name===e);return o&&!o.value&&(o=await this.getVariableValueFromKernel(o,t,n)),o}else{let o=await this.getVariableNamesAndTypesFromKernel(t,n);if(o){let s=o.find(a=>a.name===e);if(s)return this.getVariableValueFromKernel({name:e,value:void 0,supportsDataExplorer:!1,type:s.type,fullType:s.fullType,size:0,count:0,shape:"",truncated:!0},t,n)}}}async getVariableValueSummary(e,t,n){if(!t)return;let i=Zc(t==null?void 0:t.kernelConnectionMetadata)||qe,o=this.variableRequesters.get(i);if(o)return o.getVariableValueSummary(e,t,n)}async getDataFrameInfo(e,t,n,i){if(!t)return e;let o=Zc(t==null?void 0:t.kernelConnectionMetadata)||qe,s=this.variableRequesters.get(o);if(s){i&&(e=await this.getFullVariable(e,t));let a=e.name;return n&&(a=`${e.name}${n}`),s.getDataFrameInfo(e,t,a)}return e}async getDataFrameRows(e,t,n,i,o){let s=Zc(i==null?void 0:i.kernelConnectionMetadata)||qe,a=this.variableRequesters.get(s);if(a){let l=e.name;return o&&(l=`${e.name}${o}`),a.getDataFrameRows(t,n,i,l)}return{data:[]}}async getFullVariable(e,t,n){let i=Zc(t==null?void 0:t.kernelConnectionMetadata)||qe,o=this.variableRequesters.get(i);return o?o.getFullVariable(e,t,n):e}async getVariablesBasedOnKernel(e,t){var l;let n=this.cachedVariables.get(e.uri.toString()),i=this.kernelProvider.getKernelExecution(e).pendingCells.length>0,o=this.kernelProvider.getKernelExecution(e);(!n||!i&&(n.currentExecutionCount!==t.executionCount||n.currentExecutionCount!==o.executionCount))&&(n={currentExecutionCount:o.executionCount,variables:(await this.getVariableNamesAndTypesFromKernel(e)).map(c=>({name:c.name,value:void 0,supportsDataExplorer:!1,type:c.type,fullType:c.fullType,size:0,shape:"",count:0,truncated:!0,fileName:e.notebook.uri}))});let s=this.configService.getSettings(e.resourceUri).variableExplorerExclude?(l=this.configService.getSettings().variableExplorerExclude)==null?void 0:l.split(";"):[],a={executionCount:o.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};if(n){let c=t.sortColumn,u=(m,h)=>{let g=m[c]?m[c]:"",v=h[c]?h[c]:"";return t.sortAscending?g.localeCompare(v,void 0,{sensitivity:"base"}):v.localeCompare(g,void 0,{sensitivity:"base"})};n.variables.sort(u);let p=t.startIndex?t.startIndex:0,f=t.pageSize?t.pageSize:100;a.pageStartIndex=p;for(let m=p;m<p+f&&m<n.variables.length;){if(s&&s.indexOf(n.variables[m].type)>=0){n.variables.splice(m,1);continue}let h=typeof n.variables[m].value=="string"?n.variables[m]:await this.getVariableValueFromKernel(n.variables[m],e);n.variables[m]=h,a.pageResponse.push(h),m+=1}this.cachedVariables.set(e.uri.toString(),n),a.totalCount=n.variables.length}return a}async getVariableProperties(e,t,n){let i=await this.getMatchingVariable(e,t,n),o=Zc(t.kernelConnectionMetadata)||qe,s=this.variableRequesters.get(o);return s?s.getVariableProperties(e,n,i):{}}async getVariableNamesAndTypesFromKernel(e,t){let n=Zc(e.kernelConnectionMetadata)||qe,i=this.variableRequesters.get(n);return i?i.getVariableNamesAndTypesFromKernel(e,t):[]}inspect(e,t,n=0,i){let o=ke();try{e.requestInspect({code:t,cursor_pos:n,detail_level:0}).then(s=>{s&&s.content.status==="ok"?o.resolve(s.content.data):o.resolve(void 0)}).catch(s=>{o.reject(s)})}catch(s){o.reject(s)}return i&&this.disposables.push(i.onCancellationRequested(()=>o.reject(new yO.CancellationError))),o.promise}async getVariableValueFromKernel(e,t,n){var o;let i={...e};if(!t.disposed&&((o=t.session)!=null&&o.kernel)){let s=await this.inspect(t.session.kernel,e.name,0,n);if(s&&s.hasOwnProperty("text/plain")){let a=bu(s["text/plain"].toString()),l=zCe.exec(a),c=ewe.exec(a),u=twe.exec(a);l&&(i.type=l[1]),i.value=[QCe,XCe,ZCe].reduce((p,f)=>{var m;return p||((m=f.exec(a))==null?void 0:m[1])||""},""),c&&(i.count=parseInt(c[1],10)),u&&(i.shape=`(${u[1]}, ${u[2]})`)}s&&s.type&&(i.type=s.type.toString()),s&&s.value&&(i.value=s.value.toString()),rwe.has(i.type)&&(i.supportsDataExplorer=!0)}return i.type&&i.count&&!i.shape&&Gt(t.kernelConnectionMetadata)&&i.supportsDataExplorer&&i.type!=="list"&&(i=await this.getFullVariable(i,t)),i}};hE=E([(0,dp.injectable)(),I(0,(0,dp.inject)(Me)),I(1,(0,dp.inject)(LA)),I(1,(0,dp.named)(rt.PYTHON_VARIABLES_REQUESTER)),I(2,(0,dp.inject)(ie)),I(3,(0,dp.inject)(He))],hE);d();var XD=$(te());d();var gE=class extends ot{constructor(){super("unknown",C.jupyterDataRateExceeded)}};async function bO(r,{code:e,initializeCode:t,cleanupCode:n},i){var o;if(r.disposed||r.disposing||!((o=r.session)!=null&&o.kernel)||!r.session.kernel||r.session.isDisposed)return[];try{return t&&await Vi(r.session.kernel,t,i),await Vi(r.session.kernel,e,i)}catch(s){if(s instanceof nn)return[];throw s}finally{n&&await Vi(r.session.kernel,n,i)}}var vE=class{constructor(e,t){this.varScriptGenerator=e;this.dfScriptGenerator=t}async getDataFrameInfo(e,t,n){var c;let{code:i,cleanupCode:o,initializeCode:s}=await this.dfScriptGenerator.generateCodeToGetDataFrameInfo({isDebugging:!1,variableName:n}),a=await bO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameInfo",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"}),l=((c=t.notebook)==null?void 0:c.uri)||t.resourceUri||t.uri;return{...e,...this.deserializeJupyterResult(a),fileName:l}}async getDataFrameRows(e,t,n,i){let{code:o,cleanupCode:s,initializeCode:a}=await this.dfScriptGenerator.generateCodeToGetDataFrameRows({isDebugging:!1,variableName:i,startIndex:e,endIndex:t}),l=await bO(n,{code:o,cleanupCode:s,initializeCode:a},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getDataFrameRows",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return l.length===0?{data:[]}:hM(this.deserializeJupyterResult(l))}async getVariableProperties(e,t,n){let i={};return n&&n.value&&(i[`${e}`]=n.value),i}async getVariableValueSummary(e,t,n){let i=await this.varScriptGenerator.generateCodeToGetVariableValueSummary(e.name);try{let o=await Mv(t,i.split(/\r?\n/),n);return o==null?void 0:o.summary}catch(o){b.warn(`Exception when getting variable summary for variable "${e.name}": ${o.message}`);return}}async getAllVariableDiscriptions(e,t,n,i){if(!e.session)return[];let o=t?{root:t.root,propertyChain:t.propertyChain,startIndex:n}:void 0,s=await this.varScriptGenerator.generateCodeToGetAllVariableDescriptions(o),a=await Mv(e,s.split(/\r?\n/),i);if(e.disposed||e.disposing||i!=null&&i.isCancellationRequested||!a)return[];try{return a}catch(l){return b.error(l),[]}}async getVariableNamesAndTypesFromKernel(e,t){if(e.session){let{code:n,cleanupCode:i,initializeCode:o}=await this.varScriptGenerator.generateCodeToGetVariableTypes({isDebugging:!1}),s=await bO(e,{code:n,cleanupCode:i,initializeCode:o},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getVariableNamesAndTypesFromKernel",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});if(e.disposed||e.disposing)return[];let a=this.deserializeJupyterResult(s),l=[];for(let c of a){let u={...c,value:void 0,supportsDataExplorer:!1,size:0,shape:"",count:0,truncated:!0};l.push(u)}return l}return[]}async getFullVariable(e,t,n){let{code:i,cleanupCode:o,initializeCode:s}=await this.varScriptGenerator.generateCodeToGetVariableInfo({isDebugging:!1,variableName:e.name}),a=await bO(t,{code:i,cleanupCode:o,initializeCode:s},{traceErrors:!0,traceErrorsMessage:"Failure in execute_request for getFullVariable",telemetryName:"DATASCIENCE.PYTHON_VARIABLE_FETCHING_CODE_FAILURE"});return{...e,...this.deserializeJupyterResult(a)}}extractJupyterResultText(e){if(e.length>0){let t=e[0];if(t&&t.output_type==="stream"&&t.name==="stderr"&&t.hasOwnProperty("text")){let n=t.text;if(n.includes("iopub_data_rate_limit"))throw new gE;{let i=C.jupyterGetVariablesExecutionError(n);throw b.error(i),new Error(i)}}if(t&&t.output_type==="execute_result"){let n=t.data;if(n&&n.hasOwnProperty("text/plain"))return n["text/plain"]}if(t&&t.output_type==="stream"&&t.hasOwnProperty("text"))return t.text;if(t&&t.output_type==="error"&&t.hasOwnProperty("traceback")){let i=t.traceback.map(bu).join(`\r
`),o=C.jupyterGetVariablesExecutionError(i);throw b.error(o),new Error(o)}}throw new Error(C.jupyterGetVariablesBadResults)}deserializeJupyterResult(e){let t=this.extractJupyterResultText(e);return JSON.parse(t)}};vE=E([(0,XD.injectable)(),I(0,(0,XD.inject)(hy)),I(1,(0,XD.inject)(gy))],vE);function ure(r,e,t){e.addSingleton(We,Q_),e.addSingleton(We,z_),e.addSingleton(We,$_),e.addSingleton(We,oE),e.addSingleton(We,dE),e.addSingleton(We,lE),e.add(Y1,eE),e.add(RI,X_),e.addSingleton(p1,Z_),e.addSingleton(cp,cp),e.addSingleton(We,nE),Xte(e,t),Kte(r,t),e.addSingleton(We,aE),e.addSingleton(We,uE),e.addSingleton(We,pE),e.addSingleton(We,fE),e.addSingleton(KA,mE),e.addSingleton(Bi,hE,rt.KERNEL_VARIABLES),e.addSingleton(LA,vE,rt.PYTHON_VARIABLES_REQUESTER)}d();d();var ZD=$(te()),pre=require("vscode");d();var dre=class{};"force_variable_refresh","settings_updated","activate","show_data_explorer","get_variables_request","get_variables_response","variable_explorer_toggle","set_variable_explorer_height","variable_explorer_height_response","open_link","variables_complete","update_settings","loc_init","update_variable_view_execution_count","get_html_by_id_request","get_html_by_id_response","restart_kernel";var IO=Symbol("INotebookWatcher"),SO=Symbol("IVariableViewProvider");var yE=class{constructor(e,t){this.extensionContext=e;this.variableViewProvider=t}activate(){this.extensionContext.subscriptions.push(pre.window.registerWebviewViewProvider(this.variableViewProvider.viewType,this.variableViewProvider,{webviewOptions:{retainContextWhenHidden:!1}}))}};yE=E([(0,ZD.injectable)(),I(0,(0,ZD.inject)(st)),I(1,(0,ZD.inject)(SO))],yE);d();var zs=$(te());d();var CO=require("vscode");d();var _O=class{constructor(e,t){this.disposedCallback=t,this.callback=e}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}};d();d();var fp=require("vscode");var pp=class{constructor(e,t,n){this.configService=e;this.rootPath=t;this.scripts=n;this.disposed=!1;this.themeIsDarkPromise=ke();this.webviewInit=ke();this._disposables=[];this.onMessageListeners=[];this._onDidDisposeWebviewPanel=new fp.EventEmitter;this.onDataScienceSettingsChanged=async()=>{let e=JSON.stringify(await this.generateDataScienceExtraSettings());this.postMessageInternal("update_settings",e).catch(y)};this.onWebViewLoadFailed=async()=>{this.dispose()};this.onPossibleSettingsChange=async e=>{if(e.affectsConfiguration("workbench.colorTheme")||e.affectsConfiguration("editor.fontSize")||e.affectsConfiguration("editor.fontFamily")||e.affectsConfiguration("editor.cursorStyle")||e.affectsConfiguration("editor.cursorBlinking")||e.affectsConfiguration("editor.autoClosingBrackets")||e.affectsConfiguration("editor.autoClosingQuotes")||e.affectsConfiguration("editor.autoSurround")||e.affectsConfiguration("editor.autoIndent")||e.affectsConfiguration("editor.scrollBeyondLastLine")||e.affectsConfiguration("editor.fontLigatures")||e.affectsConfiguration("editor.scrollbar.verticalScrollbarSize")||e.affectsConfiguration("editor.scrollbar.horizontalScrollbarSize")||e.affectsConfiguration("files.autoSave")||e.affectsConfiguration("files.autoSaveDelay")||e.affectsConfiguration("jupyter.widgetScriptSources")){let t=await this.generateDataScienceExtraSettings();if(t){let n=JSON.stringify(t);this.postMessageInternal("update_settings",n).catch(y)}}};this._disposables.push(fp.workspace.onDidChangeConfiguration(this.onPossibleSettingsChange,this)),this._disposables.push(this.configService.getSettings(void 0).onDidChange(this.onDataScienceSettingsChanged.bind(this)))}get onDidDispose(){return this._onDidDisposeWebviewPanel.event}dispose(){this.disposed||(this.disposed=!0,this._disposables.forEach(e=>e.dispose())),this.webviewInit=void 0,this._onDidDisposeWebviewPanel.fire()}getHTMLById(e){if(!this.activeHTMLRequest)this.activeHTMLRequest=ke(),this.postMessageInternal("get_html_by_id_request",e).catch(y);else throw new Error("getHTMLById request already in progress");return this.activeHTMLRequest.promise}addMessageListener(e){this.onMessageListeners.push(e)}removeMessageListener(e){let t=this.onMessageListeners.indexOf(e);t>=0&&this.onMessageListeners.splice(t,1)}asWebviewUri(e){var t;if(!this.webview)throw new Error("asWebViewUri called too early");return(t=this.webview)==null?void 0:t.asWebviewUri(e)}postMessage(e,t){return this.postMessageInternal(e.toString(),t)}onMessage(e,t){switch(e){case"started":this.webViewRendered();break;case"get_html_by_id_response":this.activeHTMLRequest&&(this.activeHTMLRequest.resolve(t),this.activeHTMLRequest=void 0);break;default:break}this.onMessageListeners.forEach(n=>{n(e,t)})}async loadWebview(e,t){var n;if(this.disposed=!1,this.webviewInit=this.webviewInit||ke(),this.webview===void 0){let i=await this.generateDataScienceExtraSettings(),o=(n=fp.workspace.getWorkspaceFolder(e))==null?void 0:n.uri;this.webview=await this.provideWebview(e,i,o,t),this._disposables.push(this.webview.loadFailed(this.onWebViewLoadFailed,this))}this.onDataScienceSettingsChanged().catch(y),this.sendLocStrings().catch(y)}async generateDataScienceExtraSettings(){let e=this.owningResource,t=fp.workspace.getConfiguration("editor"),n=fp.workspace.getConfiguration("workbench"),i=n?n.get("colorTheme",qO):qO,o=fp.extensions.getExtension(Zs);return{...JSON.parse(JSON.stringify(this.configService.getSettings(e))),extraSettings:{editor:{cursor:this.getValue(t,"cursorStyle","line"),cursorBlink:this.getValue(t,"cursorBlinking","blink"),autoClosingBrackets:this.getValue(t,"autoClosingBrackets","languageDefined"),autoClosingQuotes:this.getValue(t,"autoClosingQuotes","languageDefined"),autoSurround:this.getValue(t,"autoSurround","languageDefined"),autoIndent:this.getValue(t,"autoIndent",!1),fontLigatures:this.getValue(t,"fontLigatures",!1),scrollBeyondLastLine:this.getValue(t,"scrollBeyondLastLine",!0),verticalScrollbarSize:this.getValue(t,"scrollbar.verticalScrollbarSize",14),horizontalScrollbarSize:this.getValue(t,"scrollbar.horizontalScrollbarSize",10),fontSize:this.getValue(t,"fontSize",14),fontFamily:this.getValue(t,"fontFamily","Consolas, 'Courier New', monospace")},theme:i,hasPythonExtension:o!==void 0,isWeb:Ni()==="Unknown"}}}async sendLocStrings(){let e={collapseSingle:Jt.collapseSingle,expandSingle:Jt.expandSingle,openExportFileYes:C.openExportFileYes,openExportFileNo:C.openExportFileNo,noRowsInDataViewer:Jt.noRowsInDataViewer,sliceIndexError:Jt.sliceIndexError,sliceMismatchedAxesError:Jt.sliceMismatchedAxesError,filterRowsTooltip:Jt.sliceMismatchedAxesError,fetchingDataViewer:Jt.fetchingDataViewer,dataViewerHideFilters:Jt.dataViewerHideFilters,dataViewerShowFilters:Jt.dataViewerShowFilters,refreshDataViewer:Jt.refreshDataViewer,clearFilters:Jt.refreshDataViewer,sliceSummaryTitle:Jt.sliceSummaryTitle,sliceData:Jt.sliceData,sliceSubmitButton:Jt.sliceSubmitButton,sliceDropdownAxisLabel:Jt.sliceDropdownAxisLabel,sliceDropdownIndexLabel:Jt.sliceDropdownIndexLabel,variableExplorerNameColumn:Jt.variableExplorerNameColumn,variableExplorerTypeColumn:Jt.variableExplorerTypeColumn,variableExplorerCountColumn:Jt.variableExplorerCountColumn,variableExplorerValueColumn:Jt.variableExplorerValueColumn,collapseVariableExplorerLabel:Jt.collapseVariableExplorerLabel,variableLoadingValue:Jt.variableLoadingValue,showDataExplorerTooltip:Jt.showDataExplorerTooltip,noRowsInVariableExplorer:Jt.noRowsInVariableExplorer,loadingRowsInVariableExplorer:Jt.loadingRowsInVariableExplorer,previousPlot:Jt.previousPlot,nextPlot:Jt.nextPlot,panPlot:Jt.panPlot,zoomInPlot:Jt.zoomInPlot,zoomOutPlot:Jt.zoomOutPlot,exportPlot:Jt.exportPlot,deletePlot:Jt.deletePlot,selectedImageListLabel:Jt.selectedImageListLabel,selectedImageLabel:Jt.selectedImageLabel};this.postMessageInternal("loc_init",JSON.stringify(e)).catch(y)}async postMessageInternal(e,t){var n;this.webviewInit&&(await this.webviewInit.promise,(n=this.webview)==null||n.postMessage({type:e.toString(),payload:t}))}webViewRendered(){this.webviewInit&&!this.webviewInit.resolved&&this.webviewInit.resolve(),this.sendLocStrings().catch(y),this.onDataScienceSettingsChanged().catch(y)}getValue(e,t,n){return e?e.get(t,n):n}};E([$v()],pp.prototype,"getHTMLById",1),E([$v()],pp.prototype,"addMessageListener",1),E([$v()],pp.prototype,"removeMessageListener",1);var EO=class extends pp{constructor(t,n,i,o,s){super(t,o,s);this.configService=t;this.provider=i;this.messageListener=n(this.onMessage.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webviewView(){return this.webview&&this.webview}async provideWebview(t,n,i,o){if(!o)throw new Error("WebviewViews must be passed an initial VS Code Webview");return this.provider.create({additionalPaths:i?[i]:[],rootPath:this.rootPath,cwd:t,listener:this.messageListener,scripts:this.scripts,settings:n,webviewHost:o})}};var Kv=class extends EO{constructor(t,n,i,o,s,a,l,c){let u=Gi(i.extensionUri,"dist","webviews","webview-side","viewers");super(t,(p,f)=>new _O(p,f),n,u,[Gi(u,"variableView.js")]);this.variables=o;this.disposables=s;this.notebookWatcher=a;this.experiments=l;this.dataViewerDelegator=c;this.notebookWatcher.onDidFinishExecutingActiveNotebook(this.activeNotebookExecuted,this,this.disposables),this.notebookWatcher.onDidChangeActiveNotebook(this.activeNotebookChanged,this,this.disposables),this.notebookWatcher.onDidRestartActiveNotebook(this.activeNotebookRestarted,this,this.disposables),this.variables.refreshRequired(this.sendRefreshMessage,this,this.disposables),CO.window.onDidChangeActiveTextEditor(this.activeTextEditorChanged,this,this.disposables)}get owningResource(){}async load(t){await super.loadWebview(CO.Uri.file(process.cwd()),t).catch(b.error),this.webviewView&&this.disposables.push(this.webviewView.onDidChangeVisibility(()=>{this.handleVisibilityChanged()})),this.handleVisibilityChanged()}get title(){return"variableView"}onMessage(t,n){switch(t){case"get_variables_request":this.handleMessage(t,n,this.requestVariables);break;case"show_data_explorer":this.handleMessage(t,n,this.showDataViewer);break;default:break}super.onMessage(t,n)}handleMessage(t,n,i){let o=n;i.bind(this)(o)}handleVisibilityChanged(){let t=new gr("jupyter.variableViewVisible"),n=!1;this.webviewView&&(n=this.webviewView.visible),t.set(n).catch(y),n&&(J("DS_INTERNAL.NATIVE_VARIABLE_VIEW_MADE_VISIBLE"),this.notebookWatcher.activeNotebookExecutionCount!==void 0?this.postMessage("update_variable_view_execution_count",{executionCount:this.notebookWatcher.activeNotebookExecutionCount}).catch(y):this.postMessage("force_variable_refresh").catch(y))}async showDataViewer(t){var n,i;return t.variable.fileName=(i=t.variable.fileName)!=null?i:(n=this.notebookWatcher.activeKernel)==null?void 0:n.notebook.uri,this.dataViewerDelegator.showContributedDataViewer(t.variable)}postProcessSupportsDataExplorer(t){let n=this.dataViewerDelegator.getVariableViewers();return t.pageResponse.forEach(i=>{this.experiments.inExperiment("DataViewerContribution")&&(i.supportsDataExplorer=n.some(o=>o.jupyterVariableViewers.dataTypes.includes(i.type)))}),t}async requestVariables(t){let n=this.notebookWatcher.activeKernel;if(n){let i=await this.variables.getVariables(t,n);this.postMessage("get_variables_response",this.postProcessSupportsDataExplorer(i)).catch(y),J("DS_INTERNAL.VARIABLE_EXPLORER_VARIABLE_COUNT",{variableCount:i.totalCount})}else{let i={executionCount:t.executionCount,pageStartIndex:-1,pageResponse:[],totalCount:0,refreshCount:t.refreshCount};this.postMessage("get_variables_response",i).catch(y)}}async activeNotebookExecuted(t){this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y)}async activeNotebookChanged(t){t.executionCount?this.postMessage("update_variable_view_execution_count",{executionCount:t.executionCount}).catch(y):this.postMessage("update_variable_view_execution_count",{executionCount:0}).catch(y),this.postMessage("force_variable_refresh").catch(y)}activeTextEditorChanged(){this.postMessage("force_variable_refresh").catch(y)}async activeNotebookRestarted(){this.postMessage("restart_kernel").catch(y)}async sendRefreshMessage(){this.postMessage("force_variable_refresh").catch(y)}};E([Ar("DS_INTERNAL.NATIVE_VARIABLE_VIEW_LOADED")],Kv.prototype,"load",1),E([In()],Kv.prototype,"showDataViewer",1),E([In()],Kv.prototype,"requestVariables",1);d();var ec=require("vscode");var wO=$(te());var tc=class{constructor(e){this.experiments=e}async showContributedDataViewer(e){try{if(this.experiments.inExperiment("DataViewerContribution")){let t=this.getMatchingVariableViewers(e);if(t.length===0)return ec.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers");if(t.length===1){let n=t[0].jupyterVariableViewers.command;return ec.commands.executeCommand(n,e)}else{let n=t.filter(o=>o.extension.id!==Ye);if(n.length===1){let o=n[0].jupyterVariableViewers.command;return ec.commands.executeCommand(o,e)}let i=ec.window.createQuickPick();i.title="Select DataFrame Viewer",i.items=t.map(o=>{var s,a;return{label:o.jupyterVariableViewers.title,detail:(a=(s=o.extension.packageJSON)==null?void 0:s.displayName)!=null?a:o.extension.id,command:o.jupyterVariableViewers.command}}),i.onDidAccept(async()=>{let o=i.selectedItems[0];if(o)return i.hide(),ec.commands.executeCommand(o.command,e)}),i.show()}}else return ec.commands.executeCommand(Q.ShowJupyterDataViewer,e)}catch(t){b.error(t),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),ec.window.showErrorMessage(C.showDataViewerFail).then(y,y)}}getMatchingVariableViewers(e){return this.getVariableViewers().filter(n=>n.jupyterVariableViewers.dataTypes.includes(e.type))}getVariableViewers(){return ec.extensions.all.filter(t=>{var n,i,o,s;return((i=(n=t.packageJSON)==null?void 0:n.contributes)==null?void 0:i.jupyterVariableViewers)&&((s=(o=t.packageJSON)==null?void 0:o.contributes)==null?void 0:s.jupyterVariableViewers.length)}).map(t=>{var i;let n=(i=t.packageJSON)==null?void 0:i.contributes;return n!=null&&n.jupyterVariableViewers?n.jupyterVariableViewers.map(o=>({extension:t,jupyterVariableViewers:o})):[]}).flat()}};tc=E([(0,wO.injectable)(),I(0,(0,wO.inject)(wc))],tc);var bE=class{constructor(e,t,n,i,o,s,a,l){this.configuration=e;this.webviewViewProvider=t;this.context=n;this.variables=i;this.disposables=o;this.notebookWatcher=s;this.experiments=a;this.dataViewerDelegator=l;this.viewType="jupyterViewVariables"}get activeVariableView(){if(!bn())throw new Error("activeVariableView only for test code");return this.variableView?Promise.resolve(this.variableView):(this.activeVariableViewPromise=ke(),this.activeVariableViewPromise.promise)}async resolveWebviewView(e,t,n){e.webview.options={enableScripts:!0},this.variableView=new Kv(this.configuration,this.webviewViewProvider,this.context,this.variables,this.disposables,this.notebookWatcher,this.experiments,this.dataViewerDelegator),this.activeVariableViewPromise&&this.activeVariableViewPromise.resolve(this.variableView),await this.variableView.load(e)}};bE=E([(0,zs.injectable)(),I(0,(0,zs.inject)(Me)),I(1,(0,zs.inject)(m1)),I(2,(0,zs.inject)(st)),I(3,(0,zs.inject)(Bi)),I(3,(0,zs.named)(rt.ALL_VARIABLES)),I(4,(0,zs.inject)(ie)),I(5,(0,zs.inject)(IO)),I(6,(0,zs.inject)(wc)),I(7,(0,zs.inject)(tc))],bE);d();var hp=$(te());d();var mre=1e3,fre;(t=>(t.Fetching="fetching",t.Skipped="skipped"))(fre||(fre={}));var Qs;(p=>(p.Started="started",p.UpdateSettings="update_settings",p.InitializeData="init",p.GetAllRowsRequest="get_all_rows_request",p.GetAllRowsResponse="get_all_rows_response",p.GetRowsRequest="get_rows_request",p.GetRowsResponse="get_rows_response",p.CompletedData="complete",p.GetSliceRequest="get_slice_request",p.RefreshDataViewer="refresh_data_viewer",p.SliceEnablementStateChanged="slice_enablement_state_changed"))(Qs||(Qs={}));var IE=Symbol("IDataViewerFactory"),xO=Symbol("IDataViewer"),DO=Symbol("IJupyterVariableDataProvider"),PO=Symbol("IJupyterVariableDataProviderFactory"),SE=Symbol("IDataViewerDependencyService");var mp=class{constructor(e,t){this.variableManager=e;this.dependencyService=t;this.initialized=!1}get kernel(){return this._kernel}static getNormalizedColumns(e){return e.map(t=>{let n;switch(t.type){case"bool":n="bool";break;case"integer":case"int32":case"int64":case"float":case"float32":case"float64":case"number":n="number";break;default:n="string"}return{key:t.key,type:n}})}static parseShape(e){try{if(e.startsWith("(")&&e.endsWith(")"))return e.substring(1,e.length-1).split(",").map(t=>parseInt(t))}catch(t){b.error(`Could not parse IJupyterVariable with malformed shape: ${e}`)}}dispose(){}setDependencies(e,t){this._kernel=t,this.variable=e}async getDataFrameInfo(e,t){let n={};await this.ensureInitialized();let i=this.variable;return i&&((e||t)&&(i=await this.variableManager.getDataFrameInfo(i,this._kernel,e,t)),n={columns:i.columns?mp.getNormalizedColumns(i.columns):i.columns,indexColumn:i.indexColumn,rowCount:i.rowCount,dataDimensionality:i.dataDimensionality,shape:mp.parseShape(i.shape),sliceExpression:e,type:i.type,maximumRowChunkSize:i.maximumRowChunkSize,name:i.name,fileName:lt(i.fileName)}),t&&(this.variable=i),n}async getAllRows(e){let t=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(t=(await this.variableManager.getDataFrameRows(this.variable,0,this.variable.rowCount,this._kernel,e)).data),t}async getRows(e,t,n){let i=[];return await this.ensureInitialized(),this.variable&&this.variable.rowCount&&(i=(await this.variableManager.getDataFrameRows(this.variable,e,t,this._kernel,n)).data),i}async ensureInitialized(){var e,t;!this.initialized&&this.variable&&(this.initialized=!0,(e=this._kernel)!=null&&e.kernelConnectionMetadata&&this.dependencyService&&await this.dependencyService.checkAndInstallMissingDependencies(yp()?this._kernel:((t=this._kernel)==null?void 0:t.kernelConnectionMetadata.interpreter)||this._kernel),this.variable=await this.variableManager.getDataFrameInfo(this.variable,this._kernel))}};mp=E([(0,hp.injectable)(),I(0,(0,hp.inject)(Bi)),I(0,(0,hp.named)(rt.ALL_VARIABLES)),I(1,(0,hp.inject)(SE)),I(1,(0,hp.optional)())],mp);d();var TO=$(te());var _E=class{constructor(e){this.serviceContainer=e}async create(e,t){let n=this.serviceContainer.get(DO);return n.setDependencies(e,t),n}};_E=E([(0,TO.injectable)(),I(0,(0,TO.inject)(Ur))],_E);d();var Or=$(te()),Ss=require("vscode");d();var NO=require("vscode");var kO=class{constructor(e){this.configuration=e}async isRequestedColumnSizeAllowed(e,t){if(e>mre&&await this.shouldAskForLargeData(t)){let n=C.tooManyColumnsMessage,i=C.tooManyColumnsYes,o=C.tooManyColumnsNo,s=C.tooManyColumnsDontAskAgain,a=await NO.window.showWarningMessage(n,i,o,s);return a===s&&await this.disableAskForLargeData(),a===i}return!0}async shouldAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();return t&&t.askForLargeDataFrames===!0}async disableAskForLargeData(e){let t=e?this.configuration.getSettings(e):this.configuration.getSettings();t&&(t.askForLargeDataFrames=!1,this.configuration.updateSetting("askForLargeDataFrames",!1,void 0,NO.ConfigurationTarget.Global).catch(y))}};var hre="ds_prompt_about_deprecation",EE=class{constructor(e,t,n,i,o,s,a,l,c,u,p,f,m,h,g){this.disposables=e;this.debugService=t;this.jupyterVariableDataProviderFactory=i;this.dataViewerFactory=o;this.variableProvider=s;this.errorHandler=a;this.dataViewerDependencyService=l;this.interpreterService=c;this.platformService=u;this.kernelProvider=p;this.interactiveWindowProvider=f;this.experimentService=m;this.globalMemento=h;this.dataViewerDelegator=g;this.dataViewerChecker=new kO(n),Ss.workspace.isTrusted||Ss.workspace.onDidGrantWorkspaceTrust(this.registerCommandsIfTrusted,this,this.disposables)}activate(){this.registerCommandsIfTrusted()}registerCommandsIfTrusted(){Ss.workspace.isTrusted&&(this.registerCommand(Q.ShowDataViewer,this.delegateDataViewer),this.registerCommand(Q.ShowJupyterDataViewer,this.showJupyterVariableView))}registerCommand(e,t){let n=Ss.commands.registerCommand(e,t,this);this.disposables.push(n)}async delegateDataViewer(e){let t="variable"in e?await this.getVariableFromRequest(e):e;if(t)return this.dataViewerDelegator.showContributedDataViewer(t)}async getVariableFromRequest(e){if(this.variableProvider){let t=mM(e.variable);return this.variableProvider.getFullVariable(t)}}async showJupyterVariableView(e){var n,i;J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_REQUEST_EX");let t=this.experimentService.inExperiment("DataViewerDeprecation");if(!this.globalMemento.get(hre)&&t&&(this.globalMemento.update(hre,!0).then(y,y),Ss.window.showInformationMessage(C.dataViewerDeprecationMessage,C.dataViewerDeprecationRecommendationActionMessage).then(o=>{o===C.dataViewerDeprecationRecommendationActionMessage&&Ss.commands.executeCommand("workbench.extensions.search","@tag:jupyterVariableViewers").then(y,y)},y)),(n=this.debugService)!=null&&n.activeDebugSession&&this.variableProvider&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory)try{if(this.debugService.activeDebugSession.configuration&&this.dataViewerDependencyService&&this.interpreterService){let l=await this.getDebugAdapterPython(this.debugService.activeDebugSession.configuration);l&&await this.dataViewerDependencyService.checkAndInstallMissingDependencies(l)}let o=await this.jupyterVariableDataProviderFactory.create(e),s=await o.getDataFrameInfo(),a=(i=s==null?void 0:s.columns)==null?void 0:i.length;if(a&&await this.dataViewerChecker.isRequestedColumnSizeAllowed(a)){let l=`${C.dataExplorerTitle} - ${e.name}`,c=await this.dataViewerFactory.create(o,l);return J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_SUCCESS_EX"),c}}catch(o){J("OPEN_DATAVIEWER_FROM_VARIABLE_WINDOW_ERROR_EX",void 0,void 0,o),b.error(o),this.errorHandler.handleError(o).then(y,y)}else try{let o=this.getActiveKernel();if(o&&this.jupyterVariableDataProviderFactory&&this.dataViewerFactory){let s=await this.jupyterVariableDataProviderFactory.create(e,o),a=`${C.dataExplorerTitle} - ${e.name}`;return await this.dataViewerFactory.create(s,a)}}catch(o){b.error(o),J("DATASCIENCE.FAILED_SHOW_DATA_EXPLORER"),Ss.window.showErrorMessage(C.showDataViewerFail).then(y,y)}}getActiveKernel(){var s,a;let e=(s=Ss.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==It?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=(a=this.dataViewerFactory)==null?void 0:a.activeViewer;return o?this.kernelProvider.kernels.find(l=>l===o.kernel):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Ss.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}async getDebugAdapterPython(e){if(!this.interpreterService){b.info("Interpreter Service missing when trying getDebugAdapterPython");return}let t="";if(e.debugAdapterPython!==void 0?(b.info("Found debugAdapterPython on Debug Configuration to use"),t=e.debugAdapterPython):e.pythonPath&&(b.info("Found pythonPath on Debug Configuration to use"),t=e.pythonPath),t){let n=t;return n.startsWith("~")&&this.platformService.homeDir&&(n=xP(n,this.platformService.homeDir.path)),this.interpreterService.getInterpreterDetails(Ss.Uri.file(n))}else return this.interpreterService.getActiveInterpreter()}};EE=E([(0,Or.injectable)(),I(0,(0,Or.inject)(ie)),I(1,(0,Or.inject)(mo)),I(1,(0,Or.optional)()),I(2,(0,Or.inject)(Me)),I(3,(0,Or.inject)(PO)),I(3,(0,Or.optional)()),I(4,(0,Or.inject)(IE)),I(4,(0,Or.optional)()),I(5,(0,Or.inject)(Bi)),I(5,(0,Or.optional)()),I(5,(0,Or.named)(rt.DEBUGGER_VARIABLES)),I(6,(0,Or.inject)(xn)),I(7,(0,Or.inject)(SE)),I(7,(0,Or.optional)()),I(8,(0,Or.inject)(pm)),I(8,(0,Or.optional)()),I(9,(0,Or.inject)(hs)),I(10,(0,Or.inject)(He)),I(11,(0,Or.inject)(ys)),I(12,(0,Or.inject)(wc)),I(13,(0,Or.inject)(_t)),I(13,(0,Or.named)(sr)),I(14,(0,Or.inject)(tc))],EE);d();var Fv=$(te()),Au=require("vscode");var CE=class{constructor(e,t,n,i){this.interactiveWindowProvider=e;this.kernelProvider=t;this.dataViewerFactory=n;this.disposables=i;this._onDidFinisheExecutingActiveNotebook=new Au.EventEmitter;this._onDidChangeActiveNotebook=new Au.EventEmitter;this._onDidRestartActiveNotebook=new Au.EventEmitter;this._executionCountTracker=new WeakMap;Au.window.onDidChangeActiveNotebookEditor(this.activeEditorChanged,this,this.disposables),Au.workspace.onDidCloseNotebookDocument(this.notebookEditorClosed,this,this.disposables),this.kernelProvider.onDidRestartKernel(o=>{this.handleRestart({state:1,notebook:o.notebook})},this,this.disposables),Lr.onDidChangeNotebookCellExecutionState(this.onDidChangeNotebookCellExecutionState,this,this.disposables)}get onDidChangeActiveNotebook(){return this._onDidChangeActiveNotebook.event}get onDidFinishExecutingActiveNotebook(){return this._onDidFinisheExecutingActiveNotebook.event}get onDidRestartActiveNotebook(){return this._onDidRestartActiveNotebook.event}get activeKernel(){var s;let e=(s=Au.window.activeNotebookEditor)==null?void 0:s.notebook,t=(e==null?void 0:e.notebookType)==It?this.kernelProvider.get(e):void 0;if(t)return t;let n=this.getActiveInteractiveWindowDocument(),i=n?this.kernelProvider.get(n):void 0;if(i)return i;let o=this.dataViewerFactory.activeViewer;return o?this.kernelProvider.kernels.find(a=>a===o.kernel):void 0}get activeNotebookExecutionCount(){var t;let e=(t=this.activeKernel)==null?void 0:t.notebook;return e?this._executionCountTracker.get(e):void 0}getActiveInteractiveWindowDocument(){let e=this.interactiveWindowProvider.getActiveOrAssociatedInteractiveWindow();if(e)return Au.workspace.notebookDocuments.find(t=>t===(e==null?void 0:e.notebookDocument))}onDidChangeNotebookCellExecutionState(e){br(e.cell.notebook)&&e.state===1&&this.handleExecute({notebook:e.cell.notebook,state:0,cell:e.cell})}handleExecute(e){var t,n,i,o,s,a;this.isNonSilentExecution(e)&&(((n=(t=e.cell)==null?void 0:t.executionSummary)==null?void 0:n.executionOrder)!==void 0&&this._executionCountTracker.set(e.notebook,(i=e.cell.executionSummary)==null?void 0:i.executionOrder),this.isActiveNotebookEvent(e)&&((s=(o=e.cell)==null?void 0:o.executionSummary)==null?void 0:s.executionOrder)!==void 0&&this.activeKernel&&this.kernelProvider.getKernelExecution(this.activeKernel).pendingCells.length===0&&this._onDidFinisheExecutingActiveNotebook.fire({executionCount:(a=e.cell.executionSummary)==null?void 0:a.executionOrder}))}handleRestart(e){this._executionCountTracker.delete(e.notebook),this.isActiveNotebookEvent(e)&&this._onDidRestartActiveNotebook.fire()}notebookEditorClosed(e){this._executionCountTracker.delete(e)}activeEditorChanged(e){let t={};if(e&&br(e.notebook)){let n=this._executionCountTracker.get(e.notebook);n&&(t.executionCount=n)}this._onDidChangeActiveNotebook.fire(t)}isNonSilentExecution(e){var t;return!!(e.state===0&&e.cell&&((t=e.cell.executionSummary)!=null&&t.executionOrder))}isActiveNotebookEvent(e){var t;return((t=this.activeKernel)==null?void 0:t.notebook)===e.notebook}};CE=E([(0,Fv.injectable)(),I(0,(0,Fv.inject)(ys)),I(1,(0,Fv.inject)(He)),I(2,(0,Fv.inject)(IE)),I(3,(0,Fv.inject)(ie))],CE);d();var eP=$(te());var gre=require("vscode");var Km=class{constructor(e,t){this.serviceContainer=e;this.disposables=t;this.knownViewers=new Set;t.push(this),this.viewContext=new gr(Sr.IsDataViewerActive),this.disposables.push(gre.commands.registerCommand(Q.RefreshDataViewer,this.refreshDataViewer,this))}dispose(){for(let e of this.knownViewers)e.dispose()}async create(e,t){let n,i=this.serviceContainer.get(xO);try{this.knownViewers.add(i),i.onDidDisposeDataViewer(this.updateOpenDataViewers,this,this.disposables),i.onDidChangeDataViewerViewState(this.updateViewStateContext,this,this.disposables),await i.showData(e,t),n=i}finally{n||i.dispose()}return n}get activeViewer(){return[...this.knownViewers.values()].find(e=>e.active)}updateOpenDataViewers(e){this.knownViewers.delete(e)}async updateViewStateContext(){let e=!1;this.knownViewers.forEach(t=>{t.active&&(e=!0)}),await this.viewContext.set(e)}refreshDataViewer(){for(let e of this.knownViewers)e.active&&e.refreshData().then(y,y)}};E([Ar("DATASCIENCE.START_SHOW_DATA_EXPLORER")],Km.prototype,"create",1),E([h1(1e3)],Km.prototype,"refreshDataViewer",1),Km=E([(0,eP.injectable)(),I(0,(0,eP.inject)(Ur)),I(1,(0,eP.inject)(ie))],Km);d();var Mu=$(te()),Ua=require("vscode");d();var RO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged(e)}};d();d();var F9;function U9(r,e){return F9&&F9.hasOwnProperty(r)?F9[r]:e}function W9(r,...e){return r.replace(/{(\d+)}/g,(t,n)=>e[n]===void 0?t:e[n])}var nwe=/^\s*((?<StartRange>-?\d+:)|(?<StopRange>-?:\d+)|(?:(?<Start>-?\d+)(?::(?<Stop>-?\d+))?(?::(?<Step>-?\d+))?))\s*$/;function V9(r){let e=r.length-2;return"["+r.map(()=>e>0?(e-=1,"0"):":").join(", ")+"]"}function iwe(r,e){if(r.startsWith("[")&&r.endsWith("]")){let t,n=r.substring(1,r.length-1).split(",").map((i,o)=>{var a;let s=nwe.exec(i);if((a=s==null?void 0:s.groups)!=null&&a.Start&&!s.groups.Stop){let l=parseInt(s.groups.Start),c=e[o];return(l>=0&&l>=c||l<0&&l<-c)&&(t={shapeIndex:o,value:l}),l}});if(t){let{shapeIndex:i,value:o}=t,s=U9("sliceIndexError","Index {0} out of range for axis {1} with {2} elements");return W9(s,o.toString(),i.toString(),e[i].toString())}else if(n&&n.length!==e.length){let i=U9("sliceMismatchedAxesError","Expected {0} axes, got {1} in slice expression");return W9(i,e.length.toString(),n.length.toString())}}return""}function vre(r,e){return iwe(r,e)===""}d();var wE=class extends pp{constructor(t,n,i,o,s,a,l){super(t,o,s);this.configService=t;this.provider=n;this._title=a;this.viewColumn=l;this.viewState={visible:!1,active:!1};this.webPanelViewStateChanged=t=>{let n=t.isVisible(),i=t.isActive(),o={visible:n,active:i},s={visible:this.viewState.visible,active:this.viewState.active};this.viewState.visible=n,this.viewState.active=i,this.onViewStateChanged({current:o,previous:s})};this.messageListener=i(this.onMessage.bind(this),this.webPanelViewStateChanged.bind(this),this.dispose.bind(this))}get isDisposed(){return this.disposed}get webPanel(){if(this.webview)return this.webview}async show(t){this.isDisposed||this.webPanel&&await this.webPanel.show(t)}dispose(){this.isDisposed||this.webPanel&&this.webPanel.close(),super.dispose()}get title(){return this._title}setTitle(t){this._title=t,!this.isDisposed&&this.webPanel&&this.webPanel.setTitle(t)}onViewStateChanged(t){}async provideWebview(t,n,i,o){return this.provider.create({viewColumn:this.viewColumn,listener:this.messageListener,title:this.title,rootPath:this.rootPath,scripts:this.scripts,settings:n,cwd:t,webviewHost:o,additionalPaths:i?[i]:[]})}};var yre="JupyterDataViewerPreferredViewColumn",Uv=class extends wE{constructor(t,n,i,o,s){var l;let a=Gi(s.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(c,u,p)=>new RO(c,u,p),a,[Gi(a,"dataExplorer.js")],C.dataExplorerTitle,(l=i.get(yre))!=null?l:Ua.ViewColumn.One);this.globalMemento=i;this.errorHandler=o;this.context=s;this.pendingRowsCount=0;this.sentDataViewerSliceDimensionalityTelemetry=!1;this._onDidDisposeDataViewer=new Ua.EventEmitter;this._onDidChangeDataViewerViewState=new Ua.EventEmitter;this.onDidDispose(this.dataViewerDisposed,this)}get active(){var t;return!!((t=this.webPanel)!=null&&t.isActive())}get refreshPending(){return this.pendingRowsCount>0}get onDidDisposeDataViewer(){return this._onDidDisposeDataViewer.event}get onDidChangeDataViewerViewState(){return this._onDidChangeDataViewerViewState.event}async showData(t,n){if(!this.isDisposed){this.dataProvider=t,await super.loadWebview(Ua.Uri.file(process.cwd())).catch(b.error),super.setTitle(n),await super.show(!0);let i=await this.prepDataFrameInfo();if(i.shape&&i.shape.length>2){this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length);let o=V9(i.shape);i=await this.getDataFrameInfo(o)}this.postMessage(Qs.InitializeData,i).catch(y)}}get kernel(){if(this.dataProvider&&"kernel"in this.dataProvider)return this.dataProvider.kernel}dataViewerDisposed(){this._onDidDisposeDataViewer.fire(this)}async refreshData(){let t=this.currentSliceExpression;this.dataFrameInfoPromise=void 0;let n=await this.getDataFrameInfo(void 0,!0);if(t!==void 0&&n.shape!==void 0)if(vre(t,n.shape))n=await this.getDataFrameInfo(t);else{let i=V9(n.shape);n=await this.getDataFrameInfo(i)}b.info(`Refreshing data viewer for variable ${n.name}`),this.postMessage(Qs.InitializeData,n).catch(y)}dispose(){super.dispose(),this.dataProvider&&(this.dataProvider.dispose(),this.dataProvider=void 0)}async onViewStateChanged(t){var n;t.current.active&&t.current.visible&&t.previous.active&&t.current.visible&&await this.globalMemento.update(yre,(n=this.webPanel)==null?void 0:n.viewColumn),this._onDidChangeDataViewerViewState.fire()}get owningResource(){}onMessage(t,n){switch(t){case Qs.GetAllRowsRequest:this.getAllRows(n).catch(y);break;case Qs.GetRowsRequest:this.getRowChunk(n).catch(y);break;case Qs.GetSliceRequest:this.getSlice(n).catch(y);break;case Qs.RefreshDataViewer:this.refreshData().catch(y),J("DATASCIENCE.REFRESH_DATA_VIEWER");break;case Qs.SliceEnablementStateChanged:J("DATASCIENCE.DATA_VIEWER_SLICE_ENABLEMENT_STATE_CHANGED",void 0,{newState:n.newState?"checked":"unchecked"});break;default:break}super.onMessage(t,n)}getDataFrameInfo(t,n){return(!this.dataFrameInfoPromise||t!==this.currentSliceExpression)&&(this.dataFrameInfoPromise=this.dataProvider?this.dataProvider.getDataFrameInfo(t,n):Promise.resolve({}),this.currentSliceExpression=t),this.dataFrameInfoPromise}async prepDataFrameInfo(){this.rowsTimer=new St;let t=await this.getDataFrameInfo();try{J("DATASCIENCE.SHOW_DATA_EXPLORER",void 0,{rows:t.rowCount?t.rowCount:0,columns:t.columns?t.columns.length:0}),this.pendingRowsCount=t.rowCount?t.rowCount:0}catch(n){}return t}async getAllRows(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.dataProvider.getAllRows(t);return this.pendingRowsCount=0,this.postMessage(Qs.GetAllRowsResponse,n)}})}getSlice(t){return this.wrapRequest(async()=>{var n;if(this.dataProvider){let i=await this.getDataFrameInfo(t.slice);return(n=i.shape)!=null&&n.length&&this.maybeSendSliceDataDimensionalityTelemetry(i.shape.length),J("DATASCIENCE.DATA_VIEWER_SLICE_OPERATION",void 0,{source:t.source}),this.postMessage(Qs.InitializeData,i)}})}getRowChunk(t){return this.wrapRequest(async()=>{if(this.dataProvider){let n=await this.getDataFrameInfo(t.sliceExpression),i=await this.dataProvider.getRows(t.start,Math.min(t.end,n.rowCount?n.rowCount:0),t.sliceExpression);return this.pendingRowsCount=Math.max(0,this.pendingRowsCount-i.length),this.postMessage(Qs.GetRowsResponse,{rows:i,start:t.start,end:t.end})}})}async wrapRequest(t){try{return await t()}catch(n){if(n instanceof gE){b.error(n.message);let i=C.pythonInteractiveHelpLink;Ua.window.showErrorMessage(C.jupyterDataRateExceeded,i).then(o=>{o===i&&Ua.env.openExternal(Ua.Uri.parse(lP.JupyterDataRateHelpLink))},y),this.dispose()}b.error(n),this.errorHandler.handleError(n).then(y,y)}finally{this.sendElapsedTimeTelemetry()}}sendElapsedTimeTelemetry(){this.rowsTimer&&this.pendingRowsCount===0&&J("DATASCIENCE.SHOW_DATA_EXPLORER_ROWS_LOADED",void 0,{rowsTimer:this.rowsTimer.elapsedTime})}maybeSendSliceDataDimensionalityTelemetry(t){this.sentDataViewerSliceDimensionalityTelemetry||(J("DATASCIENCE.DATA_VIEWER_DATA_DIMENSIONALITY",{numberOfDimensions:t}),this.sentDataViewerSliceDimensionalityTelemetry=!0)}};E([Ar("DATAVIEWER.WEBVIEW_LOADED")],Uv.prototype,"showData",1),Uv=E([(0,Mu.injectable)(),I(0,(0,Mu.inject)(LI)),I(1,(0,Mu.inject)(Me)),I(2,(0,Mu.inject)(_t)),I(2,(0,Mu.named)(sr)),I(3,(0,Mu.inject)(xn)),I(4,(0,Mu.inject)(st))],Uv);d();var bre=$(te());d();d();d();var AO="0.20.0";var MO=require("vscode");var tP=class{async getVersion(e,t){try{let n=await this._getVersion(e,t);return typeof n=="string"?tY(n):n}catch(n){b.warn(C.failedToGetVersionOfPandas,n.message);return}}async promptInstall(e,t,n){let i=n?C.pandasTooOldForViewingFormat(n,AO):C.pandasRequiredForViewing(AO);if((Z9()?Ue.install:await MO.window.showErrorMessage(i,{modal:!0},Ue.install))===Ue.install)await this._doInstall(e,t);else throw J("DATASCIENCE.USER_DID_NOT_INSTALL_PANDAS"),new Error(i)}async checkOrInstall(e){let t=new MO.CancellationTokenSource;try{let n=await this.getVersion(e,t.token);if(t.token.isCancellationRequested){J("DS_INTERNAL.SHOW_DATA_PANDAS_INSTALL_CANCELED");return}if(n){if(n.compare(AO)>0){J("DS_INTERNAL.SHOW_DATA_PANDAS_OK");return}J("DS_INTERNAL.SHOW_DATA_PANDAS_TOO_OLD");let i=`${n.major}.${n.minor}.${n.build}`;await this.promptInstall(e,t,i)}J("DS_INTERNAL.SHOW_DATA_NO_PANDAS"),await this.promptInstall(e,t)}finally{t.dispose()}}};E([Ar("DS_INTERNAL.PYTHON_MODULE_INSTALL",{action:"displayed",moduleName:Pi.get(23)})],tP.prototype,"promptInstall",1);var j9="5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d",owe=`import pandas as _VSCODE_pandas;print(_VSCODE_pandas.__version__);print("${j9}"); del _VSCODE_pandas`;function swe(r){return(r.kernelConnectionMetadata.interpreter&&Zr(r.kernelConnectionMetadata.interpreter))==="Conda"?"%conda":"%pip"}var OO=class extends tP{async execute(e,t){var o;if(!((o=t.session)!=null&&o.kernel))throw new nn;let n=await Vi(t.session.kernel,e),i=n.find(s=>s.output_type==="error");return i&&b.warn(C.failedToGetVersionOfPandas,i.message),n.map(s=>{var a;return(a=s.text)==null?void 0:a.toString()})}async _getVersion(e){let n=(await this.execute(owe,e)).map(s=>s?s.toString():void 0).find(s=>s);if(!(n!=null&&n.includes(j9)))return b.warn(C.failedToGetVersionOfPandas,`Output is ${n}`),"";let i=at(n.trim()),o=i.indexOf(j9);return o>=0?i[o-1]:""}async _doInstall(e){let t=`${swe(e)} install pandas`;try{await this.execute(t,e),J("DATASCIENCE.USER_INSTALLED_PANDAS")}catch(n){throw J("DATASCIENCE.USER_INSTALLED_PANDAS",void 0,void 0,n),new Error(C.failedToInstallPandas)}}async checkAndInstallMissingDependencies(e){var t;if(J("DATAVIEWER.USING_KERNEL"),!((t=e.session)!=null&&t.kernel))throw J("DATASCIENCE.NO_ACTIVE_KERNEL_SESSION"),new Error("No no active kernel session.");await this.checkOrInstall(e)}};var xE=class{constructor(){this.withKernel=new OO}async checkAndInstallMissingDependencies(e){return this.withKernel.checkAndInstallMissingDependencies(e)}};xE=E([(0,bre.injectable)()],xE);d();var Xs;(s=>(s.Started="started",s.UpdateSettings="update_settings",s.SendPlot="send_plot",s.CopyPlot="copy_plot",s.ExportPlot="export_plot",s.RemovePlot="remove_plot"))(Xs||(Xs={}));var Ire=class{};Xs.Started,Xs.UpdateSettings,Xs.SendPlot,Xs.CopyPlot,Xs.ExportPlot,Xs.RemovePlot;var LO=Symbol("IPlotViewerProvider"),KO=Symbol("IPlotViewer");d();var Wv=$(te());var Ou=require("vscode");d();var FO=class{constructor(e,t,n){this.disposedCallback=n,this.callback=e,this.viewChanged=t}dispose(){this.disposedCallback()}onMessage(e,t){this.callback(e,t)}onChangeViewState(e){this.viewChanged&&this.viewChanged(e)}};var DE=class extends wE{constructor(t,n,i,o){let s=new St,a=Gi(o.extensionUri,"dist","webviews","webview-side","viewers");super(n,t,(l,c,u)=>new FO(l,c,u),a,[Gi(a,"plotViewer.js")],C.plotViewerTitle,Ou.ViewColumn.One);this.fs=i;this.context=o;this.closedEvent=new Ou.EventEmitter;this.removedEvent=new Ou.EventEmitter;this.addPlot=async t=>{this.isDisposed||(await super.show(!1),this.postMessage(Xs.SendPlot,t).catch(y))};super.loadWebview(Ou.Uri.file(process.cwd())).catch(b.error).finally(()=>{J("PLOTVIEWER.WEBVIEW_LOADED",{duration:s.elapsedTime})})}get closed(){return this.closedEvent.event}get removed(){return this.removedEvent.event}async show(){if(!this.isDisposed)return super.show(!0)}dispose(){super.dispose(),this.removedEvent.dispose(),this.closedEvent&&this.closedEvent.fire(this)}get owningResource(){}onMessage(t,n){switch(t){case Xs.CopyPlot:this.copyPlot(n.toString()).catch(y);break;case Xs.ExportPlot:this.exportPlot(n).catch(y);break;case Xs.RemovePlot:this.removePlot(n);break;default:break}super.onMessage(t,n)}removePlot(t){this.removedEvent.fire(t)}copyPlot(t){return Promise.resolve()}async exportPlot(t){b.info("exporting plot...");let n={};n[C.pngFilter]=["png"],n[C.svgFilter]=["svg"];let i=await Ou.window.showSaveDialog({saveLabel:C.exportPlotTitle,filters:n});try{if(i)switch(Cp(i.path).toLowerCase()){case".png":let s=JR(t.png.replace("data:image/png;base64",""));await this.fs.writeFile(i,s);break;default:case".svg":await this.fs.writeFile(i,t.svg);break}}catch(o){b.error(o),Ou.window.showErrorMessage(C.exportImageFailed(o.toString())).then(y,y)}}};DE=E([(0,Wv.injectable)(),I(0,(0,Wv.inject)(LI)),I(1,(0,Wv.inject)(Me)),I(2,(0,Wv.inject)(xt)),I(3,(0,Wv.inject)(st))],DE);d();var rP=$(te());var PE=class{constructor(e,t){this.serviceContainer=e;this.imageList=[];this.closedViewer=()=>{this.currentViewer&&(this.currentViewer=void 0),this.currentViewerClosed&&(this.currentViewerClosed.dispose(),this.currentViewerClosed=void 0)};this.removedPlot=e=>{this.imageList.splice(e,1)};t.push(this)}dispose(){this.currentViewer&&this.currentViewer.dispose()}async showPlot(e){this.imageList.push(e);let t=this.currentViewer?[e]:this.imageList,n=await this.getOrCreate();await Promise.all(t.map(n.addPlot))}async getOrCreate(){return this.currentViewer||(this.currentViewer=this.serviceContainer.get(KO),this.currentViewerClosed=this.currentViewer.closed(this.closedViewer),this.currentViewer.removed(this.removedPlot),J("DATASCIENCE.OPEN_PLOT_VIEWER"),await this.currentViewer.show()),this.currentViewer}};PE=E([(0,rP.injectable)(),I(0,(0,rP.inject)(Ur)),I(1,(0,rP.inject)(ie))],PE);d();var WO=$(te()),Fm=require("vscode");var Sre="image/svg+xml",UO={"image/png":"png","image/jpeg":"jpeg","image/gif":"gif",[Sre]:"svg"},TE=class{constructor(e){this.fs=e}async savePlot(e,t,n){if(e.isClosed)return;let i=awe(e,t,n);if(!i)return b.error(`No plot to save ${ye(e.uri)}, id: ${t} for ${n}`);if(!(n.toLowerCase()in UO))return b.error(`Unsupported MimeType ${ye(e.uri)}, id: ${t} for ${n}`);let o=await this.getSaveTarget(i,n);o&&(o.path.toLowerCase().endsWith("pdf")?await this.saveAsPdf(i,o):await this.saveAsImage(i,o))}getSaveTarget(e,t){var l;let n=UO[t.toLowerCase()],i={};e.items.find(c=>c.mime.toLowerCase()===Sre)&&(i[C.pdfFilter]=["pdf"],i[C.svgFilter]=["svg"]),n==="png"&&(i[C.pngFilter]=["png"]),Object.keys(i).length===0&&(i.Images=[n]);let o=(((l=Fm.workspace.workspaceFolders)==null?void 0:l.length)||0)>0?Fm.workspace.workspaceFolders[0].uri:void 0,s="output",a=o?Fm.Uri.joinPath(o,s):Fm.Uri.file(s);return Fm.window.showSaveDialog({defaultUri:a,saveLabel:C.exportPlotTitle,filters:i})}async saveAsImage(e,t){let n=Cp(t.path).substring(1),i=Object.keys(UO).find(s=>UO[s]===n),o=e.items.find(s=>s.mime===i);if(!o)throw new Error(`Unsupported MimeType ${t.toString()}, available mime Types: ${e.items.map(s=>s.mime).join(", ")}`);await this.fs.writeFile(t,o.data)}async saveAsPdf(e,t){return b.error("Save as PDF is not yet supported on the web.")}};TE=E([(0,WO.injectable)(),I(0,(0,WO.inject)(xt))],TE);function awe(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e&&i.items.find(o=>o.mime===t))return i}d();var VO=$(te());var lwe="image/svg+xml",cwe="image/png",gp=class{constructor(e){this.plotViewProvider=e}async openPlot(e,t){if(e.isClosed)return;let n=_re(e,t,lwe),i;if(n)i=new TextDecoder().decode(n.data);else{let o=_re(e,t,cwe);if(!o)return b.error(`No SVG or PNG Plot to open ${ye(e.uri)}, id: ${t}`);i=uwe(o)}i&&await this.plotViewProvider.showPlot(i)}};gp=E([(0,VO.injectable)(),I(0,(0,VO.inject)(LO))],gp);function _re(r,e,t){for(let n of r.getCells())for(let i of n.outputs)if(i.id===e)return i.items.find(o=>o.mime===t)}function uwe(r){let e=r.data,t=qR(e),n=dwe(e);return`<?xml version="1.0" encoding="utf-8" standalone="no"?>
<svg height="${n.height}" width="${n.width}" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <g>
        <image xmlns="http://www.w3.org/2000/svg" x="0" y="0" height="100%" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/png;base64,${t}"/>
    </g>
</svg>`}function dwe(r){if(!pwe(r))throw new Error("The buffer is not a valid png");let e=new DataView(new Uint8Array(r).buffer);return{width:e.getUint32(16,!1),height:e.getUint32(20,!1)}}function pwe(r){return r[0]===137&&r[1]===80&&r[2]===78&&r[3]===71&&r[4]===13&&r[5]===10&&r[6]===26&&r[7]===10&&r.length>8+21}d();var nP=$(te()),BO=require("vscode");d();var jO=Symbol("IPlotSaveHandler");var kE=class{constructor(e,t){this.plotSaveHandler=e;this.plotViewHandler=t;this.disposables=[]}dispose(){me(this.disposables)}activate(){this.activateImpl().catch(y)}async activateImpl(){let e=BO.extensions.getExtension(Jv);if(!e)return;e.isActive||await e.activate(),e.exports.onDidReceiveMessage(({editor:n,message:i})=>{var s;let o=n.notebook||((s=BO.window.activeNotebookEditor)==null?void 0:s.notebook);o&&(i.type==="saveImageAs"?this.plotSaveHandler.savePlot(o,i.outputId,i.mimeType).catch(y):i.type==="openImageInPlotViewer"&&this.plotViewHandler.openPlot(o,i.outputId).catch(y))},this,this.disposables)}};kE=E([(0,nP.injectable)(),I(0,(0,nP.inject)(jO)),I(1,(0,nP.inject)(gp))],kE);d();var iP=$(te()),HO=require("vscode");var NE=class{constructor(e,t){this.kernelProvider=e;this.controllers=t;this.disposables=[];this.widgetOutputsPerNotebook=new WeakMap}dispose(){me(this.disposables)}activate(){let e=HO.notebooks.createRendererMessaging("jupyter-ipywidget-renderer");e.onDidReceiveMessage(this.onDidReceiveMessage.bind(this,e),this,this.disposables),this.kernelProvider.onDidStartKernel(this.onDidStartKernel,this,this.disposables)}onDidStartKernel(e){this.hookupKernel(e),e.onStarted(()=>this.hookupKernel(e),this,this.disposables),e.onRestarted(()=>this.hookupKernel(e),this,this.disposables)}hookupKernel(e){var s,a,l;this.widgetOutputsPerNotebook.delete(e.notebook);let t=(s=e.session)==null?void 0:s.kernel,n=(l=(a=e.session)==null?void 0:a.kernel)==null?void 0:l.iopubMessage;if(!n)return;let i=li(),o=(c,u)=>{c===t&&(i.KernelMessage.isDisplayDataMsg(u)||i.KernelMessage.isUpdateDisplayDataMsg(u)||i.KernelMessage.isExecuteReplyMsg(u)||i.KernelMessage.isExecuteResultMsg(u))&&this.trackModelId(e.notebook,u)};n.connect(o),this.disposables.push(new HO.Disposable(()=>n.disconnect(o)))}trackModelId(e,t){let n=t.content;if(n.data&&typeof n.data=="object"&&yo in n.data){let i=n.data[yo];if(i&&"model_id"in i){let o=this.widgetOutputsPerNotebook.get(e)||new Set;o.add(i.model_id),this.widgetOutputsPerNotebook.set(e,o)}}}onDidReceiveMessage(e,{editor:t,message:n}){n&&typeof n=="object"&&n.command==="query-widget-state"&&this.queryWidgetState(e,t,n),n&&typeof n=="object"&&n.command==="ipywidget-renderer-loaded"&&this.sendWidgetVersionAndState(e,t)}queryWidgetState(e,t,n){let i=this.widgetOutputsPerNotebook.get(t.notebook),o=!!this.controllers.getSelected(t.notebook),s=!!(i!=null&&i.has(n.model_id));e.postMessage({command:"query-widget-state",model_id:n.model_id,hasWidgetState:s,kernelSelected:o},t).then(y,y)}sendWidgetVersionAndState(e,t){let n=this.kernelProvider.get(t.notebook),i=n==null?void 0:n.ipywidgetsVersion;n!=null&&n.ipywidgetsVersion&&b.trace(`IPyWidget version in Kernel is ${n==null?void 0:n.ipywidgetsVersion}.`);let o=!!this.controllers.getSelected(t.notebook);e.postMessage({command:"ipywidget-renderer-init",version:i,widgetState:void 0,kernelSelected:o},t).then(y,y)}};NE=E([(0,iP.injectable)(),I(0,(0,iP.inject)(He)),I(1,(0,iP.inject)(kt))],NE);function Ere(r){r.addSingleton(We,kE),r.addSingleton(We,EE),r.add(xO,Uv),r.addSingleton(IE,Km),r.addSingleton(SE,xE),r.addSingleton(tc,tc),r.add(KO,DE),r.addSingleton(LO,PE),r.addSingleton(jO,TE),r.addSingleton(gp,gp),r.addSingleton(IO,CE),r.addSingleton(We,yE),r.addSingleton(We,NE),r.addSingleton(SO,bE),r.add(DO,mp),r.addSingleton(PO,_E)}d();var kre=$(LL());d();var Cre=$(te());var Vv=class{constructor(e){this.container=e}getContainer(){return this.container}add(e,t,n,i){n?this.container.bind(e).to(t).whenTargetNamed(n):this.container.bind(e).to(t),i&&i.forEach(o=>{this.addBinding(e,o)})}addFactory(e,t){this.container.bind(e).toFactory(t)}addBinding(e,t){this.container.bind(t).toService(e)}addSingleton(e,t,n,i){n?this.container.bind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.bind(e).to(t).inSingletonScope(),i&&i.forEach(o=>{this.addBinding(e,o)})}addSingletonInstance(e,t,n){n?this.container.bind(e).toConstantValue(t).whenTargetNamed(n):this.container.bind(e).toConstantValue(t)}get(e,t){return t?this.container.getNamed(e,t):this.container.get(e)}tryGet(e,t){try{return t?this.container.getNamed(e,t):this.container.get(e)}catch(n){}}getAll(e,t){return t?this.container.getAllNamed(e,t):this.container.getAll(e)}rebind(e,t,n){n?this.container.rebind(e).to(t).whenTargetNamed(n):this.container.rebind(e).to(t)}rebindSingleton(e,t,n){n?this.container.rebind(e).to(t).inSingletonScope().whenTargetNamed(n):this.container.rebind(e).to(t).inSingletonScope()}rebindInstance(e,t,n){n?this.container.rebind(e).toConstantValue(t).whenTargetNamed(n):this.container.rebind(e).toConstantValue(t)}dispose(){this.container.unbindAll(),this.container.unload()}};E([$v()],Vv.prototype,"getContainer",1),Vv=E([(0,Cre.injectable)()],Vv);var Dn=require("vscode");d();var xre=require("vscode");function Dre(r){let e=xre.window.createOutputChannel(C.jupyterServerConsoleOutputChannel,"log");r.push(e);let t={get(n,i){let o=n[i];if(typeof o=="function"){if(i==="append")return(...s)=>{e.append(...s),wre(...s)};if(i==="appendLine")return(...s)=>{e.appendLine(...s),wre(...s)}}return o}};return new Proxy(e,t)}function wre(...r){r.length===1?b.debug(at(r[0]).map((e,t)=>t===0?e:`    ${e}`).join(`
`)):b.debug(...r)}d();var Pre=require("vscode");function Tre(){let r=Pre.workspace.getConfiguration("python"),e=r==null?void 0:r.get("languageServer");return!(e!=="Pylance"&&e!=="Default")}function Nre(r,e){let t=R7(e);t.appendLine(`${Dn.env.appName} (${Dn.version}, ${Dn.env.remoteName}, ${Dn.env.appHost})`),t.appendLine(`Jupyter Extension Version: ${r.extension.packageJSON.version}.`);let n=Dn.extensions.getExtension(Zs);n?t.appendLine(`Python Extension Version: ${n.packageJSON.version}.`):t.appendLine("Python Extension not installed.");let i=Dn.extensions.getExtension(oB);return i?t.appendLine(`Pylance Extension Version${Tre()?"":" (Not Used) "}: ${i.packageJSON.version}.`):t.appendLine("Pylance Extension not installed."),e!=null&&e.platform&&t.appendLine(`Platform: ${e.platform} (${e.arch}).`),!Dn.workspace.workspaceFolders||Dn.workspace.workspaceFolders.length===0?t.appendLine("No workspace folder opened."):Dn.workspace.workspaceFolders.length===1?t.appendLine(`Workspace folder ${ye(Dn.workspace.workspaceFolders[0].uri)}, Home = ${e==null?void 0:e.homePath}`):t.appendLine(`Multiple Workspace folders opened ${Dn.workspace.workspaceFolders.map(o=>ye(o.uri)).join(", ")}`),t}function Rre(r,e){let t=new kre.Container({skipBaseClassChecks:!0}),n=new Vv(t),i=new nt(t);return n.addSingletonInstance(Ur,i),n.addSingletonInstance(bZ,n),n.addSingletonInstance(ie,r.subscriptions),n.addSingletonInstance(_t,r.globalState,sr),n.addSingletonInstance(_t,r.workspaceState,Cs),n.addSingletonInstance(st,r),n.addSingletonInstance(Hm,e,Hv),n.addSingletonInstance(Hm,Dre(r.subscriptions),iB),[n,i]}function Are(){let r=ke(),e={location:Dn.ProgressLocation.Window,title:Ue.loadingExtension};return Dn.window.withProgress(e,()=>r.promise).then(y,y),{dispose:()=>r.resolve()}}function Mre(r,e,t){fwe(Ue.handleExtensionActivationError),console.error("extension activation failed",r),b.error("extension activation failed",r),eQ(r,e,t)}function fwe(r){try{Dn.window.showErrorMessage(r).then(y,y)}catch(e){b.error("failed to notify user",e)}}async function Ore(r,e){let t=e.get(wc),n=new St;await t.activate();let i=n.elapsedTime;J("DS_INTERNAL.EXPERIMENT_LOAD",{duration:i}),Dn.commands.executeCommand("setContext","jupyter.vscode.channel",Hd()).then(y,y),e.get(Y1).activate();let o=e.get(vT);o.initialize(),r.subscriptions.push(o)}var B9=class{constructor(){this.started=Date.now()}get elapsedTime(){return Date.now()-this.started}reset(){this.started=Date.now()}},RE=new B9,oP={totalActivateTime:0,codeLoadingTime:0,startActivateTime:0,endActivateTime:0,workspaceFolderCount:0};typeof requestAnimationFrame=="undefined"&&typeof setImmediate=="undefined"&&(self.setImmediate=r=>setTimeout(r),self.clearImmediate=r=>clearTimeout(r));oP.codeLoadingTime=RE.elapsedTime;var H9;async function mwe(r){oP.startActivateTime=RE.elapsedTime;let e=Nre(r,{addConsoleLogger:bn()});sY(RE),UB(r.subscriptions),X9(rc.env.uiKind==rc.UIKind.Web),tB(!0),r.subscriptions.push({dispose:()=>ME.isExiting=!0});try{let[t,n]=gwe(r,e);return await n,Zz(oP,RE),t}catch(t){return oP.endActivateTime=RE.elapsedTime,Mre(t,oP,RE),b.error("Failed to active the Jupyter Extension",t),{ready:Promise.resolve(),registerPythonApi:y,registerRemoteServerProvider:()=>({dispose:y}),getKernelService:()=>Promise.resolve(void 0),addRemoteJupyterServer:()=>Promise.resolve(void 0),openNotebook:()=>Promise.reject(),createJupyterServerCollection:()=>{throw new Error("Not Implemented")},kernels:{getKernel:()=>Promise.resolve(void 0)}}}}function hwe(){if(ME.isExiting=!0,H9){let r=H9.get(Ya);if(r)return r.dispose()}return Promise.resolve()}function gwe(r,e){let t=Are();try{let[n,i]=Rre(r,e);H9=i,rY(()=>Promise.resolve(new Map));let o=vwe(r,n,i);return[zz(o,n,i,r),o,i]}finally{t.dispose()}}async function vwe(r,e,t){let n=r.extensionMode===rc.ExtensionMode.Development||rc.workspace.getConfiguration("jupyter").get("development",!1);e.addSingletonInstance(K7,n),n&&rc.commands.executeCommand("setContext","jupyter.development",!0).then(y,y),rc.commands.executeCommand("setContext","jupyter.webExtension",!0).then(y,y),AX(e),xee(e,n),yZ(e,n),Tte(e),Nte(e),ure(r,e,n),Ere(e),await Ore(r,t)}
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

@microsoft/dynamicproto-js/lib/dist/esm/dynamicproto-js.js:
  (*!
   * Microsoft Dynamic Proto Utility, 1.1.8
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

@lumino/polling/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

@lumino/disposable/dist/index.js:
  (*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** *)

strip-comments/index.js:
  (*!
   * strip-comments <https://github.com/jonschlinkert/strip-comments>
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
